/*! For license information please see main.2f1738a9.js.LICENSE.txt */
(()=>{"use strict";var e={579:(e,t,a)=>{e.exports=a(1153)},1153:(e,t,a)=>{var n=a(5043),s=Symbol.for("react.element"),r=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,l=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,a){var n,r={},c=null,d=null;for(n in void 0!==a&&(c=""+a),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(d=t.ref),t)i.call(t,n)&&!o.hasOwnProperty(n)&&(r[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps)void 0===r[n]&&(r[n]=t[n]);return{$$typeof:s,type:e,key:c,ref:d,props:r,_owner:l.current}}t.Fragment=r,t.jsx=c,t.jsxs=c},1387:(e,t,a)=>{function n(){return n=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},n.apply(this,arguments)}var s;a.d(t,{AO:()=>u,B6:()=>_,Gh:()=>R,HS:()=>I,Oi:()=>l,Rr:()=>h,pX:()=>z,pb:()=>T,rc:()=>s,tH:()=>q,ue:()=>m,yD:()=>P,zR:()=>i}),function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"}(s||(s={}));const r="popstate";function i(e){return void 0===e&&(e={}),p(function(e,t){let{pathname:a,search:n,hash:s}=e.location;return d("",{pathname:a,search:n,hash:s},t.state&&t.state.usr||null,t.state&&t.state.key||"default")},function(e,t){return"string"===typeof t?t:u(t)},null,e)}function l(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}function o(e,t){if(!e){"undefined"!==typeof console&&console.warn(t);try{throw new Error(t)}catch(a){}}}function c(e,t){return{usr:e.state,key:e.key,idx:t}}function d(e,t,a,s){return void 0===a&&(a=null),n({pathname:"string"===typeof e?e:e.pathname,search:"",hash:""},"string"===typeof t?h(t):t,{state:a,key:t&&t.key||s||Math.random().toString(36).substr(2,8)})}function u(e){let{pathname:t="/",search:a="",hash:n=""}=e;return a&&"?"!==a&&(t+="?"===a.charAt(0)?a:"?"+a),n&&"#"!==n&&(t+="#"===n.charAt(0)?n:"#"+n),t}function h(e){let t={};if(e){let a=e.indexOf("#");a>=0&&(t.hash=e.substr(a),e=e.substr(0,a));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function p(e,t,a,i){void 0===i&&(i={});let{window:o=document.defaultView,v5Compat:h=!1}=i,p=o.history,f=s.Pop,m=null,x=g();function g(){return(p.state||{idx:null}).idx}function v(){f=s.Pop;let e=g(),t=null==e?null:e-x;x=e,m&&m({action:f,location:b.location,delta:t})}function y(e){let t="null"!==o.location.origin?o.location.origin:o.location.href,a="string"===typeof e?e:u(e);return a=a.replace(/ $/,"%20"),l(t,"No window.location.(origin|href) available to create URL for href: "+a),new URL(a,t)}null==x&&(x=0,p.replaceState(n({},p.state,{idx:x}),""));let b={get action(){return f},get location(){return e(o,p)},listen(e){if(m)throw new Error("A history only accepts one active listener");return o.addEventListener(r,v),m=e,()=>{o.removeEventListener(r,v),m=null}},createHref:e=>t(o,e),createURL:y,encodeLocation(e){let t=y(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:function(e,t){f=s.Push;let n=d(b.location,e,t);a&&a(n,e),x=g()+1;let r=c(n,x),i=b.createHref(n);try{p.pushState(r,"",i)}catch(l){if(l instanceof DOMException&&"DataCloneError"===l.name)throw l;o.location.assign(i)}h&&m&&m({action:f,location:b.location,delta:1})},replace:function(e,t){f=s.Replace;let n=d(b.location,e,t);a&&a(n,e),x=g();let r=c(n,x),i=b.createHref(n);p.replaceState(r,"",i),h&&m&&m({action:f,location:b.location,delta:0})},go:e=>p.go(e)};return b}var f;!function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"}(f||(f={}));new Set(["lazy","caseSensitive","path","id","index","children"]);function m(e,t,a){return void 0===a&&(a="/"),x(e,t,a,!1)}function x(e,t,a,n){let s=T(("string"===typeof t?h(t):t).pathname||"/",a);if(null==s)return null;let r=g(e);!function(e){e.sort((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){let a=e.length===t.length&&e.slice(0,-1).every((e,a)=>e===t[a]);return a?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map(e=>e.childrenIndex),t.routesMeta.map(e=>e.childrenIndex)))}(r);let i=null;for(let l=0;null==i&&l<r.length;++l){let e=L(s);i=C(r[l],e,n)}return i}function g(e,t,a,n){void 0===t&&(t=[]),void 0===a&&(a=[]),void 0===n&&(n="");let s=(e,s,r)=>{let i={relativePath:void 0===r?e.path||"":r,caseSensitive:!0===e.caseSensitive,childrenIndex:s,route:e};i.relativePath.startsWith("/")&&(l(i.relativePath.startsWith(n),'Absolute route path "'+i.relativePath+'" nested under path "'+n+'" is not valid. An absolute child route path must start with the combined path of all its parent routes.'),i.relativePath=i.relativePath.slice(n.length));let o=I([n,i.relativePath]),c=a.concat(i);e.children&&e.children.length>0&&(l(!0!==e.index,'Index routes must not have child routes. Please remove all child routes from route path "'+o+'".'),g(e.children,t,c,o)),(null!=e.path||e.index)&&t.push({path:o,score:A(o,e.index),routesMeta:c})};return e.forEach((e,t)=>{var a;if(""!==e.path&&null!=(a=e.path)&&a.includes("?"))for(let n of v(e.path))s(e,t,n);else s(e,t)}),t}function v(e){let t=e.split("/");if(0===t.length)return[];let[a,...n]=t,s=a.endsWith("?"),r=a.replace(/\?$/,"");if(0===n.length)return s?[r,""]:[r];let i=v(n.join("/")),l=[];return l.push(...i.map(e=>""===e?r:[r,e].join("/"))),s&&l.push(...i),l.map(t=>e.startsWith("/")&&""===t?"/":t)}const y=/^:[\w-]+$/,b=3,j=2,w=1,N=10,S=-2,k=e=>"*"===e;function A(e,t){let a=e.split("/"),n=a.length;return a.some(k)&&(n+=S),t&&(n+=j),a.filter(e=>!k(e)).reduce((e,t)=>e+(y.test(t)?b:""===t?w:N),n)}function C(e,t,a){void 0===a&&(a=!1);let{routesMeta:n}=e,s={},r="/",i=[];for(let l=0;l<n.length;++l){let e=n[l],o=l===n.length-1,c="/"===r?t:t.slice(r.length)||"/",d=_({path:e.relativePath,caseSensitive:e.caseSensitive,end:o},c),u=e.route;if(!d&&o&&a&&!n[n.length-1].route.index&&(d=_({path:e.relativePath,caseSensitive:e.caseSensitive,end:!1},c)),!d)return null;Object.assign(s,d.params),i.push({params:s,pathname:I([r,d.pathname]),pathnameBase:B(I([r,d.pathnameBase])),route:u}),"/"!==d.pathnameBase&&(r=I([r,d.pathnameBase]))}return i}function _(e,t){"string"===typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[a,n]=function(e,t,a){void 0===t&&(t=!1);void 0===a&&(a=!0);o("*"===e||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were "'+e.replace(/\*$/,"/*")+'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "'+e.replace(/\*$/,"/*")+'".');let n=[],s="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(e,t,a)=>(n.push({paramName:t,isOptional:null!=a}),a?"/?([^\\/]+)?":"/([^\\/]+)"));e.endsWith("*")?(n.push({paramName:"*"}),s+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):a?s+="\\/*$":""!==e&&"/"!==e&&(s+="(?:(?=\\/|$))");let r=new RegExp(s,t?void 0:"i");return[r,n]}(e.path,e.caseSensitive,e.end),s=t.match(a);if(!s)return null;let r=s[0],i=r.replace(/(.)\/+$/,"$1"),l=s.slice(1);return{params:n.reduce((e,t,a)=>{let{paramName:n,isOptional:s}=t;if("*"===n){let e=l[a]||"";i=r.slice(0,r.length-e.length).replace(/(.)\/+$/,"$1")}const o=l[a];return e[n]=s&&!o?void 0:(o||"").replace(/%2F/g,"/"),e},{}),pathname:r,pathnameBase:i,pattern:e}}function L(e){try{return e.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(t){return o(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding ('+t+")."),e}}function T(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let a=t.endsWith("/")?t.length-1:t.length,n=e.charAt(a);return n&&"/"!==n?null:e.slice(a)||"/"}function E(e,t,a,n){return"Cannot include a '"+e+"' character in a manually specified `to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the `to."+a+'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.'}function D(e){return e.filter((e,t)=>0===t||e.route.path&&e.route.path.length>0)}function P(e,t){let a=D(e);return t?a.map((e,t)=>t===a.length-1?e.pathname:e.pathnameBase):a.map(e=>e.pathnameBase)}function R(e,t,a,s){let r;void 0===s&&(s=!1),"string"===typeof e?r=h(e):(r=n({},e),l(!r.pathname||!r.pathname.includes("?"),E("?","pathname","search",r)),l(!r.pathname||!r.pathname.includes("#"),E("#","pathname","hash",r)),l(!r.search||!r.search.includes("#"),E("#","search","hash",r)));let i,o=""===e||""===r.pathname,c=o?"/":r.pathname;if(null==c)i=a;else{let e=t.length-1;if(!s&&c.startsWith("..")){let t=c.split("/");for(;".."===t[0];)t.shift(),e-=1;r.pathname=t.join("/")}i=e>=0?t[e]:"/"}let d=function(e,t){void 0===t&&(t="/");let{pathname:a,search:n="",hash:s=""}="string"===typeof e?h(e):e,r=a?a.startsWith("/")?a:function(e,t){let a=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(e=>{".."===e?a.length>1&&a.pop():"."!==e&&a.push(e)}),a.length>1?a.join("/"):"/"}(a,t):t;return{pathname:r,search:F(n),hash:O(s)}}(r,i),u=c&&"/"!==c&&c.endsWith("/"),p=(o||"."===c)&&a.endsWith("/");return d.pathname.endsWith("/")||!u&&!p||(d.pathname+="/"),d}const I=e=>e.join("/").replace(/\/\/+/g,"/"),B=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),F=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",O=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"";class q extends Error{}function z(e){return null!=e&&"number"===typeof e.status&&"string"===typeof e.statusText&&"boolean"===typeof e.internal&&"data"in e}const M=["post","put","patch","delete"],U=(new Set(M),["get",...M]);new Set(U),new Set([301,302,303,307,308]),new Set([307,308]);Symbol("deferred")},1389:(e,t,a)=>{a.d(t,{Ay:()=>Ks,jsPDF:()=>Ks});var n=a(2284),s=Uint8Array,r=Uint16Array,i=Int32Array,l=new s([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),o=new s([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),c=new s([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),d=function(e,t){for(var a=new r(31),n=0;n<31;++n)a[n]=t+=1<<e[n-1];var s=new i(a[30]);for(n=1;n<30;++n)for(var l=a[n];l<a[n+1];++l)s[l]=l-a[n]<<5|n;return{b:a,r:s}},u=d(l,2),h=u.b,p=u.r;h[28]=258,p[258]=28;for(var f=d(o,0),m=(f.b,f.r),x=new r(32768),g=0;g<32768;++g){var v=(43690&g)>>1|(21845&g)<<1;v=(61680&(v=(52428&v)>>2|(13107&v)<<2))>>4|(3855&v)<<4,x[g]=((65280&v)>>8|(255&v)<<8)>>1}var y=function(e,t,a){for(var n=e.length,s=0,i=new r(t);s<n;++s)e[s]&&++i[e[s]-1];var l,o=new r(t);for(s=1;s<t;++s)o[s]=o[s-1]+i[s-1]<<1;if(a){l=new r(1<<t);var c=15-t;for(s=0;s<n;++s)if(e[s])for(var d=s<<4|e[s],u=t-e[s],h=o[e[s]-1]++<<u,p=h|(1<<u)-1;h<=p;++h)l[x[h]>>c]=d}else for(l=new r(n),s=0;s<n;++s)e[s]&&(l[s]=x[o[e[s]-1]++]>>15-e[s]);return l},b=new s(288);for(g=0;g<144;++g)b[g]=8;for(g=144;g<256;++g)b[g]=9;for(g=256;g<280;++g)b[g]=7;for(g=280;g<288;++g)b[g]=8;var j=new s(32);for(g=0;g<32;++g)j[g]=5;var w=y(b,9,0),N=y(j,5,0),S=function(e){return(e+7)/8|0},k=function(e,t,a){return(null==t||t<0)&&(t=0),(null==a||a>e.length)&&(a=e.length),new s(e.subarray(t,a))},A=function(e,t,a){a<<=7&t;var n=t/8|0;e[n]|=a,e[n+1]|=a>>8},C=function(e,t,a){a<<=7&t;var n=t/8|0;e[n]|=a,e[n+1]|=a>>8,e[n+2]|=a>>16},_=function(e,t){for(var a=[],n=0;n<e.length;++n)e[n]&&a.push({s:n,f:e[n]});var i=a.length,l=a.slice();if(!i)return{t:I,l:0};if(1==i){var o=new s(a[0].s+1);return o[a[0].s]=1,{t:o,l:1}}a.sort(function(e,t){return e.f-t.f}),a.push({s:-1,f:25001});var c=a[0],d=a[1],u=0,h=1,p=2;for(a[0]={s:-1,f:c.f+d.f,l:c,r:d};h!=i-1;)c=a[a[u].f<a[p].f?u++:p++],d=a[u!=h&&a[u].f<a[p].f?u++:p++],a[h++]={s:-1,f:c.f+d.f,l:c,r:d};var f=l[0].s;for(n=1;n<i;++n)l[n].s>f&&(f=l[n].s);var m=new r(f+1),x=L(a[h-1],m,0);if(x>t){n=0;var g=0,v=x-t,y=1<<v;for(l.sort(function(e,t){return m[t.s]-m[e.s]||e.f-t.f});n<i;++n){var b=l[n].s;if(!(m[b]>t))break;g+=y-(1<<x-m[b]),m[b]=t}for(g>>=v;g>0;){var j=l[n].s;m[j]<t?g-=1<<t-m[j]++-1:++n}for(;n>=0&&g;--n){var w=l[n].s;m[w]==t&&(--m[w],++g)}x=t}return{t:new s(m),l:x}},L=function(e,t,a){return-1==e.s?Math.max(L(e.l,t,a+1),L(e.r,t,a+1)):t[e.s]=a},T=function(e){for(var t=e.length;t&&!e[--t];);for(var a=new r(++t),n=0,s=e[0],i=1,l=function(e){a[n++]=e},o=1;o<=t;++o)if(e[o]==s&&o!=t)++i;else{if(!s&&i>2){for(;i>138;i-=138)l(32754);i>2&&(l(i>10?i-11<<5|28690:i-3<<5|12305),i=0)}else if(i>3){for(l(s),--i;i>6;i-=6)l(8304);i>2&&(l(i-3<<5|8208),i=0)}for(;i--;)l(s);i=1,s=e[o]}return{c:a.subarray(0,n),n:t}},E=function(e,t){for(var a=0,n=0;n<t.length;++n)a+=e[n]*t[n];return a},D=function(e,t,a){var n=a.length,s=S(t+2);e[s]=255&n,e[s+1]=n>>8,e[s+2]=255^e[s],e[s+3]=255^e[s+1];for(var r=0;r<n;++r)e[s+r+4]=a[r];return 8*(s+4+n)},P=function(e,t,a,n,s,i,d,u,h,p,f){A(t,f++,a),++s[256];for(var m=_(s,15),x=m.t,g=m.l,v=_(i,15),S=v.t,k=v.l,L=T(x),P=L.c,R=L.n,I=T(S),B=I.c,F=I.n,O=new r(19),q=0;q<P.length;++q)++O[31&P[q]];for(q=0;q<B.length;++q)++O[31&B[q]];for(var z=_(O,7),M=z.t,U=z.l,W=19;W>4&&!M[c[W-1]];--W);var H,V,G,J,Y=p+5<<3,K=E(s,b)+E(i,j)+d,Q=E(s,x)+E(i,S)+d+14+3*W+E(O,M)+2*O[16]+3*O[17]+7*O[18];if(h>=0&&Y<=K&&Y<=Q)return D(t,f,e.subarray(h,h+p));if(A(t,f,1+(Q<K)),f+=2,Q<K){H=y(x,g,0),V=x,G=y(S,k,0),J=S;var $=y(M,U,0);A(t,f,R-257),A(t,f+5,F-1),A(t,f+10,W-4),f+=14;for(q=0;q<W;++q)A(t,f+3*q,M[c[q]]);f+=3*W;for(var X=[P,B],Z=0;Z<2;++Z){var ee=X[Z];for(q=0;q<ee.length;++q){var te=31&ee[q];A(t,f,$[te]),f+=M[te],te>15&&(A(t,f,ee[q]>>5&127),f+=ee[q]>>12)}}}else H=w,V=b,G=N,J=j;for(q=0;q<u;++q){var ae=n[q];if(ae>255){C(t,f,H[(te=ae>>18&31)+257]),f+=V[te+257],te>7&&(A(t,f,ae>>23&31),f+=l[te]);var ne=31&ae;C(t,f,G[ne]),f+=J[ne],ne>3&&(C(t,f,ae>>5&8191),f+=o[ne])}else C(t,f,H[ae]),f+=V[ae]}return C(t,f,H[256]),f+V[256]},R=new i([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),I=new s(0),B=function(e,t,a,n,c,d){var u=d.z||e.length,h=new s(n+u+5*(1+Math.ceil(u/7e3))+c),f=h.subarray(n,h.length-c),x=d.l,g=7&(d.r||0);if(t){g&&(f[0]=d.r>>3);for(var v=R[t-1],y=v>>13,b=8191&v,j=(1<<a)-1,w=d.p||new r(32768),N=d.h||new r(j+1),A=Math.ceil(a/3),C=2*A,_=function(t){return(e[t]^e[t+1]<<A^e[t+2]<<C)&j},L=new i(25e3),T=new r(288),E=new r(32),I=0,B=0,F=d.i||0,O=0,q=d.w||0,z=0;F+2<u;++F){var M=_(F),U=32767&F,W=N[M];if(w[U]=W,N[M]=U,q<=F){var H=u-F;if((I>7e3||O>24576)&&(H>423||!x)){g=P(e,f,0,L,T,E,B,O,z,F-z,g),O=I=B=0,z=F;for(var V=0;V<286;++V)T[V]=0;for(V=0;V<30;++V)E[V]=0}var G=2,J=0,Y=b,K=U-W&32767;if(H>2&&M==_(F-K))for(var Q=Math.min(y,H)-1,$=Math.min(32767,F),X=Math.min(258,H);K<=$&&--Y&&U!=W;){if(e[F+G]==e[F+G-K]){for(var Z=0;Z<X&&e[F+Z]==e[F+Z-K];++Z);if(Z>G){if(G=Z,J=K,Z>Q)break;var ee=Math.min(K,Z-2),te=0;for(V=0;V<ee;++V){var ae=F-K+V&32767,ne=ae-w[ae]&32767;ne>te&&(te=ne,W=ae)}}}K+=(U=W)-(W=w[U])&32767}if(J){L[O++]=268435456|p[G]<<18|m[J];var se=31&p[G],re=31&m[J];B+=l[se]+o[re],++T[257+se],++E[re],q=F+G,++I}else L[O++]=e[F],++T[e[F]]}}for(F=Math.max(F,q);F<u;++F)L[O++]=e[F],++T[e[F]];g=P(e,f,x,L,T,E,B,O,z,F-z,g),x||(d.r=7&g|f[g/8|0]<<3,g-=7,d.h=N,d.p=w,d.i=F,d.w=q)}else{for(F=d.w||0;F<u+x;F+=65535){var ie=F+65535;ie>=u&&(f[g/8|0]=x,ie=u),g=D(f,g+1,e.subarray(F,ie))}d.i=u}return k(h,0,n+S(g)+c)},F=function(){var e=1,t=0;return{p:function(a){for(var n=e,s=t,r=0|a.length,i=0;i!=r;){for(var l=Math.min(i+2655,r);i<l;++i)s+=n+=a[i];n=(65535&n)+15*(n>>16),s=(65535&s)+15*(s>>16)}e=n,t=s},d:function(){return(255&(e%=65521))<<24|(65280&e)<<8|(255&(t%=65521))<<8|t>>8}}},O=function(e,t,a,n,r){if(!r&&(r={l:1},t.dictionary)){var i=t.dictionary.subarray(-32768),l=new s(i.length+e.length);l.set(i),l.set(e,i.length),e=l,r.w=i.length}return B(e,null==t.level?6:t.level,null==t.mem?r.l?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(e.length)))):20:12+t.mem,a,n,r)},q=function(e,t,a){for(;a;++t)e[t]=a,a>>>=8},z=function(e,t){var a=t.level,n=0==a?0:a<6?1:9==a?3:2;if(e[0]=120,e[1]=n<<6|(t.dictionary&&32),e[1]|=31-(e[0]<<8|e[1])%31,t.dictionary){var s=F();s.p(t.dictionary),q(e,2,s.d())}};function M(e,t){t||(t={});var a=F();a.p(e);var n=O(e,t,t.dictionary?6:2,4);return z(n,t),q(n,n.length-4,a.d()),n}var U="undefined"!=typeof TextDecoder&&new TextDecoder;try{U.decode(I,{stream:!0})}catch(Wi){}"function"==typeof queueMicrotask?queueMicrotask:"function"==typeof setTimeout&&setTimeout;function W(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=Array(t);a<t;a++)n[a]=e[a];return n}function H(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var n,s,r,i,l=[],o=!0,c=!1;try{if(r=(a=a.call(e)).next,0===t){if(Object(a)!==a)return;o=!1}else for(;!(o=(n=r.call(a)).done)&&(l.push(n.value),l.length!==t);o=!0);}catch(e){c=!0,s=e}finally{try{if(!o&&null!=a.return&&(i=a.return(),Object(i)!==i))return}finally{if(c)throw s}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return W(e,t);var a={}.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?W(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var V=a(4980);function G(e){return new TextDecoder(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf8").decode(e)}const J=new TextEncoder;const Y=(()=>{const e=new Uint8Array(4);return!((new Uint32Array(e.buffer)[0]=1)&e[0])})(),K={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class Q{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8192,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,V.A)(this,"buffer",void 0),(0,V.A)(this,"byteLength",void 0),(0,V.A)(this,"byteOffset",void 0),(0,V.A)(this,"length",void 0),(0,V.A)(this,"offset",void 0),(0,V.A)(this,"lastWrittenByte",void 0),(0,V.A)(this,"littleEndian",void 0),(0,V.A)(this,"_data",void 0),(0,V.A)(this,"_mark",void 0),(0,V.A)(this,"_marks",void 0);let a=!1;"number"===typeof e?e=new ArrayBuffer(e):(a=!0,this.lastWrittenByte=e.byteLength);const n=t.offset?t.offset>>>0:0,s=e.byteLength-n;let r=n;(ArrayBuffer.isView(e)||e instanceof Q)&&(e.byteLength!==e.buffer.byteLength&&(r=e.byteOffset+n),e=e.buffer),this.lastWrittenByte=a?s:0,this.buffer=e,this.length=s,this.byteLength=s,this.byteOffset=r,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,r,s),this._mark=0,this._marks=[]}available(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return this.offset+e<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return this.offset+=e,this}back(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return this.offset-=e,this}seek(e){return this.offset=e,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const e=this._marks.pop();if(void 0===e)throw new Error("Mark stack empty");return this.seek(e),this}rewind(){return this.offset=0,this}ensureAvailable(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;if(!this.available(e)){const t=2*(this.offset+e),a=new Uint8Array(t);a.set(new Uint8Array(this.buffer)),this.buffer=a.buffer,this.length=t,this.byteLength=t,this._data=new DataView(this.buffer)}return this}readBoolean(){return 0!==this.readUint8()}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return this.readArray(e,"uint8")}readArray(e,t){const a=K[t].BYTES_PER_ELEMENT*e,n=this.byteOffset+this.offset,s=this.buffer.slice(n,n+a);if(this.littleEndian===Y&&"uint8"!==t&&"int8"!==t){const e=new Uint8Array(this.buffer.slice(n,n+a));e.reverse();const s=new K[t](e.buffer);return this.offset+=a,s.reverse(),s}const r=new K[t](s);return this.offset+=a,r}readInt16(){const e=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,e}readUint16(){const e=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,e}readInt32(){const e=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,e}readUint32(){const e=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat32(){const e=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat64(){const e=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e}readBigInt64(){const e=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,e}readBigUint64(){const e=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,e}readChar(){return String.fromCharCode(this.readInt8())}readChars(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t="";for(let a=0;a<e;a++)t+=this.readChar();return t}readUtf8(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return G(this.readBytes(e))}decodeText(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf8";return G(this.readBytes(e),t)}writeBoolean(e){return this.writeUint8(e?255:0),this}writeInt8(e){return this.ensureAvailable(1),this._data.setInt8(this.offset++,e),this._updateLastWrittenByte(),this}writeUint8(e){return this.ensureAvailable(1),this._data.setUint8(this.offset++,e),this._updateLastWrittenByte(),this}writeByte(e){return this.writeUint8(e)}writeBytes(e){this.ensureAvailable(e.length);for(let t=0;t<e.length;t++)this._data.setUint8(this.offset++,e[t]);return this._updateLastWrittenByte(),this}writeInt16(e){return this.ensureAvailable(2),this._data.setInt16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(e){return this.ensureAvailable(2),this._data.setUint16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(e){return this.ensureAvailable(4),this._data.setInt32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(e){return this.ensureAvailable(4),this._data.setUint32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(e){return this.ensureAvailable(4),this._data.setFloat32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(e){return this.ensureAvailable(8),this._data.setFloat64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(e){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(e){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(e){return this.writeUint8(e.charCodeAt(0))}writeChars(e){for(let t=0;t<e.length;t++)this.writeUint8(e.charCodeAt(t));return this}writeUtf8(e){return this.writeBytes(function(e){return J.encode(e)}(e))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}function $(e){let t=e.length;for(;--t>=0;)e[t]=0}const X=256,Z=286,ee=30,te=15,ae=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),ne=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),se=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),re=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),ie=new Array(576);$(ie);const le=new Array(60);$(le);const oe=new Array(512);$(oe);const ce=new Array(256);$(ce);const de=new Array(29);$(de);const ue=new Array(ee);function he(e,t,a,n,s){this.static_tree=e,this.extra_bits=t,this.extra_base=a,this.elems=n,this.max_length=s,this.has_stree=e&&e.length}let pe,fe,me;function xe(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}$(ue);const ge=e=>e<256?oe[e]:oe[256+(e>>>7)],ve=(e,t)=>{e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255},ye=(e,t,a)=>{e.bi_valid>16-a?(e.bi_buf|=t<<e.bi_valid&65535,ve(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=a-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=a)},be=(e,t,a)=>{ye(e,a[2*t],a[2*t+1])},je=(e,t)=>{let a=0;do{a|=1&e,e>>>=1,a<<=1}while(--t>0);return a>>>1},we=(e,t,a)=>{const n=new Array(16);let s,r,i=0;for(s=1;s<=te;s++)i=i+a[s-1]<<1,n[s]=i;for(r=0;r<=t;r++){let t=e[2*r+1];0!==t&&(e[2*r]=je(n[t]++,t))}},Ne=e=>{let t;for(t=0;t<Z;t++)e.dyn_ltree[2*t]=0;for(t=0;t<ee;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.sym_next=e.matches=0},Se=e=>{e.bi_valid>8?ve(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},ke=(e,t,a,n)=>{const s=2*t,r=2*a;return e[s]<e[r]||e[s]===e[r]&&n[t]<=n[a]},Ae=(e,t,a)=>{const n=e.heap[a];let s=a<<1;for(;s<=e.heap_len&&(s<e.heap_len&&ke(t,e.heap[s+1],e.heap[s],e.depth)&&s++,!ke(t,n,e.heap[s],e.depth));)e.heap[a]=e.heap[s],a=s,s<<=1;e.heap[a]=n},Ce=(e,t,a)=>{let n,s,r,i,l=0;if(0!==e.sym_next)do{n=255&e.pending_buf[e.sym_buf+l++],n+=(255&e.pending_buf[e.sym_buf+l++])<<8,s=e.pending_buf[e.sym_buf+l++],0===n?be(e,s,t):(r=ce[s],be(e,r+X+1,t),i=ae[r],0!==i&&(s-=de[r],ye(e,s,i)),n--,r=ge(n),be(e,r,a),i=ne[r],0!==i&&(n-=ue[r],ye(e,n,i)))}while(l<e.sym_next);be(e,256,t)},_e=(e,t)=>{const a=t.dyn_tree,n=t.stat_desc.static_tree,s=t.stat_desc.has_stree,r=t.stat_desc.elems;let i,l,o,c=-1;for(e.heap_len=0,e.heap_max=573,i=0;i<r;i++)0!==a[2*i]?(e.heap[++e.heap_len]=c=i,e.depth[i]=0):a[2*i+1]=0;for(;e.heap_len<2;)o=e.heap[++e.heap_len]=c<2?++c:0,a[2*o]=1,e.depth[o]=0,e.opt_len--,s&&(e.static_len-=n[2*o+1]);for(t.max_code=c,i=e.heap_len>>1;i>=1;i--)Ae(e,a,i);o=r;do{i=e.heap[1],e.heap[1]=e.heap[e.heap_len--],Ae(e,a,1),l=e.heap[1],e.heap[--e.heap_max]=i,e.heap[--e.heap_max]=l,a[2*o]=a[2*i]+a[2*l],e.depth[o]=(e.depth[i]>=e.depth[l]?e.depth[i]:e.depth[l])+1,a[2*i+1]=a[2*l+1]=o,e.heap[1]=o++,Ae(e,a,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],((e,t)=>{const a=t.dyn_tree,n=t.max_code,s=t.stat_desc.static_tree,r=t.stat_desc.has_stree,i=t.stat_desc.extra_bits,l=t.stat_desc.extra_base,o=t.stat_desc.max_length;let c,d,u,h,p,f,m=0;for(h=0;h<=te;h++)e.bl_count[h]=0;for(a[2*e.heap[e.heap_max]+1]=0,c=e.heap_max+1;c<573;c++)d=e.heap[c],h=a[2*a[2*d+1]+1]+1,h>o&&(h=o,m++),a[2*d+1]=h,d>n||(e.bl_count[h]++,p=0,d>=l&&(p=i[d-l]),f=a[2*d],e.opt_len+=f*(h+p),r&&(e.static_len+=f*(s[2*d+1]+p)));if(0!==m){do{for(h=o-1;0===e.bl_count[h];)h--;e.bl_count[h]--,e.bl_count[h+1]+=2,e.bl_count[o]--,m-=2}while(m>0);for(h=o;0!==h;h--)for(d=e.bl_count[h];0!==d;)u=e.heap[--c],u>n||(a[2*u+1]!==h&&(e.opt_len+=(h-a[2*u+1])*a[2*u],a[2*u+1]=h),d--)}})(e,t),we(a,c,e.bl_count)},Le=(e,t,a)=>{let n,s,r=-1,i=t[1],l=0,o=7,c=4;for(0===i&&(o=138,c=3),t[2*(a+1)+1]=65535,n=0;n<=a;n++)s=i,i=t[2*(n+1)+1],++l<o&&s===i||(l<c?e.bl_tree[2*s]+=l:0!==s?(s!==r&&e.bl_tree[2*s]++,e.bl_tree[32]++):l<=10?e.bl_tree[34]++:e.bl_tree[36]++,l=0,r=s,0===i?(o=138,c=3):s===i?(o=6,c=3):(o=7,c=4))},Te=(e,t,a)=>{let n,s,r=-1,i=t[1],l=0,o=7,c=4;for(0===i&&(o=138,c=3),n=0;n<=a;n++)if(s=i,i=t[2*(n+1)+1],!(++l<o&&s===i)){if(l<c)do{be(e,s,e.bl_tree)}while(0!==--l);else 0!==s?(s!==r&&(be(e,s,e.bl_tree),l--),be(e,16,e.bl_tree),ye(e,l-3,2)):l<=10?(be(e,17,e.bl_tree),ye(e,l-3,3)):(be(e,18,e.bl_tree),ye(e,l-11,7));l=0,r=s,0===i?(o=138,c=3):s===i?(o=6,c=3):(o=7,c=4)}};let Ee=!1;const De=(e,t,a,n)=>{ye(e,0+(n?1:0),3),Se(e),ve(e,a),ve(e,~a),a&&e.pending_buf.set(e.window.subarray(t,t+a),e.pending),e.pending+=a};var Pe=e=>{Ee||((()=>{let e,t,a,n,s;const r=new Array(16);for(a=0,n=0;n<28;n++)for(de[n]=a,e=0;e<1<<ae[n];e++)ce[a++]=n;for(ce[a-1]=n,s=0,n=0;n<16;n++)for(ue[n]=s,e=0;e<1<<ne[n];e++)oe[s++]=n;for(s>>=7;n<ee;n++)for(ue[n]=s<<7,e=0;e<1<<ne[n]-7;e++)oe[256+s++]=n;for(t=0;t<=te;t++)r[t]=0;for(e=0;e<=143;)ie[2*e+1]=8,e++,r[8]++;for(;e<=255;)ie[2*e+1]=9,e++,r[9]++;for(;e<=279;)ie[2*e+1]=7,e++,r[7]++;for(;e<=287;)ie[2*e+1]=8,e++,r[8]++;for(we(ie,287,r),e=0;e<ee;e++)le[2*e+1]=5,le[2*e]=je(e,5);pe=new he(ie,ae,257,Z,te),fe=new he(le,ne,0,ee,te),me=new he(new Array(0),se,0,19,7)})(),Ee=!0),e.l_desc=new xe(e.dyn_ltree,pe),e.d_desc=new xe(e.dyn_dtree,fe),e.bl_desc=new xe(e.bl_tree,me),e.bi_buf=0,e.bi_valid=0,Ne(e)},Re=(e,t,a,n)=>{let s,r,i=0;e.level>0?(2===e.strm.data_type&&(e.strm.data_type=(e=>{let t,a=4093624447;for(t=0;t<=31;t++,a>>>=1)if(1&a&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<X;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0})(e)),_e(e,e.l_desc),_e(e,e.d_desc),i=(e=>{let t;for(Le(e,e.dyn_ltree,e.l_desc.max_code),Le(e,e.dyn_dtree,e.d_desc.max_code),_e(e,e.bl_desc),t=18;t>=3&&0===e.bl_tree[2*re[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t})(e),s=e.opt_len+3+7>>>3,r=e.static_len+3+7>>>3,r<=s&&(s=r)):s=r=a+5,a+4<=s&&-1!==t?De(e,t,a,n):4===e.strategy||r===s?(ye(e,2+(n?1:0),3),Ce(e,ie,le)):(ye(e,4+(n?1:0),3),((e,t,a,n)=>{let s;for(ye(e,t-257,5),ye(e,a-1,5),ye(e,n-4,4),s=0;s<n;s++)ye(e,e.bl_tree[2*re[s]+1],3);Te(e,e.dyn_ltree,t-1),Te(e,e.dyn_dtree,a-1)})(e,e.l_desc.max_code+1,e.d_desc.max_code+1,i+1),Ce(e,e.dyn_ltree,e.dyn_dtree)),Ne(e),n&&Se(e)},Ie=(e,t,a)=>(e.pending_buf[e.sym_buf+e.sym_next++]=t,e.pending_buf[e.sym_buf+e.sym_next++]=t>>8,e.pending_buf[e.sym_buf+e.sym_next++]=a,0===t?e.dyn_ltree[2*a]++:(e.matches++,t--,e.dyn_ltree[2*(ce[a]+X+1)]++,e.dyn_dtree[2*ge(t)]++),e.sym_next===e.sym_end),Be=e=>{ye(e,2,3),be(e,256,ie),(e=>{16===e.bi_valid?(ve(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)})(e)},Fe={_tr_init:Pe,_tr_stored_block:De,_tr_flush_block:Re,_tr_tally:Ie,_tr_align:Be};var Oe=(e,t,a,n)=>{let s=65535&e,r=e>>>16&65535,i=0;for(;0!==a;){i=a>2e3?2e3:a,a-=i;do{s=s+t[n++]|0,r=r+s|0}while(--i);s%=65521,r%=65521}return s|r<<16};const qe=new Uint32Array((()=>{let e,t=[];for(var a=0;a<256;a++){e=a;for(var n=0;n<8;n++)e=1&e?3988292384^e>>>1:e>>>1;t[a]=e}return t})());var ze=(e,t,a,n)=>{const s=qe,r=n+a;e^=-1;for(let i=n;i<r;i++)e=e>>>8^s[255&(e^t[i])];return-1^e},Me={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},Ue={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:We,_tr_stored_block:He,_tr_flush_block:Ve,_tr_tally:Ge,_tr_align:Je}=Fe,{Z_NO_FLUSH:Ye,Z_PARTIAL_FLUSH:Ke,Z_FULL_FLUSH:Qe,Z_FINISH:$e,Z_BLOCK:Xe,Z_OK:Ze,Z_STREAM_END:et,Z_STREAM_ERROR:tt,Z_DATA_ERROR:at,Z_BUF_ERROR:nt,Z_DEFAULT_COMPRESSION:st,Z_FILTERED:rt,Z_HUFFMAN_ONLY:it,Z_RLE:lt,Z_FIXED:ot,Z_DEFAULT_STRATEGY:ct,Z_UNKNOWN:dt,Z_DEFLATED:ut}=Ue,ht=258,pt=262,ft=42,mt=113,xt=666,gt=(e,t)=>(e.msg=Me[t],t),vt=e=>2*e-(e>4?9:0),yt=e=>{let t=e.length;for(;--t>=0;)e[t]=0},bt=e=>{let t,a,n,s=e.w_size;t=e.hash_size,n=t;do{a=e.head[--n],e.head[n]=a>=s?a-s:0}while(--t);t=s,n=t;do{a=e.prev[--n],e.prev[n]=a>=s?a-s:0}while(--t)};let jt=(e,t,a)=>(t<<e.hash_shift^a)&e.hash_mask;const wt=e=>{const t=e.state;let a=t.pending;a>e.avail_out&&(a=e.avail_out),0!==a&&(e.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+a),e.next_out),e.next_out+=a,t.pending_out+=a,e.total_out+=a,e.avail_out-=a,t.pending-=a,0===t.pending&&(t.pending_out=0))},Nt=(e,t)=>{Ve(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,wt(e.strm)},St=(e,t)=>{e.pending_buf[e.pending++]=t},kt=(e,t)=>{e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t},At=(e,t,a,n)=>{let s=e.avail_in;return s>n&&(s=n),0===s?0:(e.avail_in-=s,t.set(e.input.subarray(e.next_in,e.next_in+s),a),1===e.state.wrap?e.adler=Oe(e.adler,t,s,a):2===e.state.wrap&&(e.adler=ze(e.adler,t,s,a)),e.next_in+=s,e.total_in+=s,s)},Ct=(e,t)=>{let a,n,s=e.max_chain_length,r=e.strstart,i=e.prev_length,l=e.nice_match;const o=e.strstart>e.w_size-pt?e.strstart-(e.w_size-pt):0,c=e.window,d=e.w_mask,u=e.prev,h=e.strstart+ht;let p=c[r+i-1],f=c[r+i];e.prev_length>=e.good_match&&(s>>=2),l>e.lookahead&&(l=e.lookahead);do{if(a=t,c[a+i]===f&&c[a+i-1]===p&&c[a]===c[r]&&c[++a]===c[r+1]){r+=2,a++;do{}while(c[++r]===c[++a]&&c[++r]===c[++a]&&c[++r]===c[++a]&&c[++r]===c[++a]&&c[++r]===c[++a]&&c[++r]===c[++a]&&c[++r]===c[++a]&&c[++r]===c[++a]&&r<h);if(n=ht-(h-r),r=h-ht,n>i){if(e.match_start=t,i=n,n>=l)break;p=c[r+i-1],f=c[r+i]}}}while((t=u[t&d])>o&&0!==--s);return i<=e.lookahead?i:e.lookahead},_t=e=>{const t=e.w_size;let a,n,s;do{if(n=e.window_size-e.lookahead-e.strstart,e.strstart>=t+(t-pt)&&(e.window.set(e.window.subarray(t,t+t-n),0),e.match_start-=t,e.strstart-=t,e.block_start-=t,e.insert>e.strstart&&(e.insert=e.strstart),bt(e),n+=t),0===e.strm.avail_in)break;if(a=At(e.strm,e.window,e.strstart+e.lookahead,n),e.lookahead+=a,e.lookahead+e.insert>=3)for(s=e.strstart-e.insert,e.ins_h=e.window[s],e.ins_h=jt(e,e.ins_h,e.window[s+1]);e.insert&&(e.ins_h=jt(e,e.ins_h,e.window[s+3-1]),e.prev[s&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=s,s++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<pt&&0!==e.strm.avail_in)},Lt=(e,t)=>{let a,n,s,r=e.pending_buf_size-5>e.w_size?e.w_size:e.pending_buf_size-5,i=0,l=e.strm.avail_in;do{if(a=65535,s=e.bi_valid+42>>3,e.strm.avail_out<s)break;if(s=e.strm.avail_out-s,n=e.strstart-e.block_start,a>n+e.strm.avail_in&&(a=n+e.strm.avail_in),a>s&&(a=s),a<r&&(0===a&&t!==$e||t===Ye||a!==n+e.strm.avail_in))break;i=t===$e&&a===n+e.strm.avail_in?1:0,He(e,0,0,i),e.pending_buf[e.pending-4]=a,e.pending_buf[e.pending-3]=a>>8,e.pending_buf[e.pending-2]=~a,e.pending_buf[e.pending-1]=~a>>8,wt(e.strm),n&&(n>a&&(n=a),e.strm.output.set(e.window.subarray(e.block_start,e.block_start+n),e.strm.next_out),e.strm.next_out+=n,e.strm.avail_out-=n,e.strm.total_out+=n,e.block_start+=n,a-=n),a&&(At(e.strm,e.strm.output,e.strm.next_out,a),e.strm.next_out+=a,e.strm.avail_out-=a,e.strm.total_out+=a)}while(0===i);return l-=e.strm.avail_in,l&&(l>=e.w_size?(e.matches=2,e.window.set(e.strm.input.subarray(e.strm.next_in-e.w_size,e.strm.next_in),0),e.strstart=e.w_size,e.insert=e.strstart):(e.window_size-e.strstart<=l&&(e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,e.insert>e.strstart&&(e.insert=e.strstart)),e.window.set(e.strm.input.subarray(e.strm.next_in-l,e.strm.next_in),e.strstart),e.strstart+=l,e.insert+=l>e.w_size-e.insert?e.w_size-e.insert:l),e.block_start=e.strstart),e.high_water<e.strstart&&(e.high_water=e.strstart),i?4:t!==Ye&&t!==$e&&0===e.strm.avail_in&&e.strstart===e.block_start?2:(s=e.window_size-e.strstart,e.strm.avail_in>s&&e.block_start>=e.w_size&&(e.block_start-=e.w_size,e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,s+=e.w_size,e.insert>e.strstart&&(e.insert=e.strstart)),s>e.strm.avail_in&&(s=e.strm.avail_in),s&&(At(e.strm,e.window,e.strstart,s),e.strstart+=s,e.insert+=s>e.w_size-e.insert?e.w_size-e.insert:s),e.high_water<e.strstart&&(e.high_water=e.strstart),s=e.bi_valid+42>>3,s=e.pending_buf_size-s>65535?65535:e.pending_buf_size-s,r=s>e.w_size?e.w_size:s,n=e.strstart-e.block_start,(n>=r||(n||t===$e)&&t!==Ye&&0===e.strm.avail_in&&n<=s)&&(a=n>s?s:n,i=t===$e&&0===e.strm.avail_in&&a===n?1:0,He(e,e.block_start,a,i),e.block_start+=a,wt(e.strm)),i?3:1)},Tt=(e,t)=>{let a,n;for(;;){if(e.lookahead<pt){if(_t(e),e.lookahead<pt&&t===Ye)return 1;if(0===e.lookahead)break}if(a=0,e.lookahead>=3&&(e.ins_h=jt(e,e.ins_h,e.window[e.strstart+3-1]),a=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==a&&e.strstart-a<=e.w_size-pt&&(e.match_length=Ct(e,a)),e.match_length>=3)if(n=Ge(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){e.match_length--;do{e.strstart++,e.ins_h=jt(e,e.ins_h,e.window[e.strstart+3-1]),a=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!==--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=jt(e,e.ins_h,e.window[e.strstart+1]);else n=Ge(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(n&&(Nt(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<2?e.strstart:2,t===$e?(Nt(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(Nt(e,!1),0===e.strm.avail_out)?1:2},Et=(e,t)=>{let a,n,s;for(;;){if(e.lookahead<pt){if(_t(e),e.lookahead<pt&&t===Ye)return 1;if(0===e.lookahead)break}if(a=0,e.lookahead>=3&&(e.ins_h=jt(e,e.ins_h,e.window[e.strstart+3-1]),a=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==a&&e.prev_length<e.max_lazy_match&&e.strstart-a<=e.w_size-pt&&(e.match_length=Ct(e,a),e.match_length<=5&&(e.strategy===rt||3===e.match_length&&e.strstart-e.match_start>4096)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){s=e.strstart+e.lookahead-3,n=Ge(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=s&&(e.ins_h=jt(e,e.ins_h,e.window[e.strstart+3-1]),a=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!==--e.prev_length);if(e.match_available=0,e.match_length=2,e.strstart++,n&&(Nt(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if(n=Ge(e,0,e.window[e.strstart-1]),n&&Nt(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(n=Ge(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,t===$e?(Nt(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(Nt(e,!1),0===e.strm.avail_out)?1:2};function Dt(e,t,a,n,s){this.good_length=e,this.max_lazy=t,this.nice_length=a,this.max_chain=n,this.func=s}const Pt=[new Dt(0,0,0,0,Lt),new Dt(4,4,8,4,Tt),new Dt(4,5,16,8,Tt),new Dt(4,6,32,32,Tt),new Dt(4,4,16,16,Et),new Dt(8,16,32,32,Et),new Dt(8,16,128,128,Et),new Dt(8,32,128,256,Et),new Dt(32,128,258,1024,Et),new Dt(32,258,258,4096,Et)];function Rt(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=ut,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),yt(this.dyn_ltree),yt(this.dyn_dtree),yt(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),yt(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(573),yt(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const It=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.status!==ft&&57!==t.status&&69!==t.status&&73!==t.status&&91!==t.status&&103!==t.status&&t.status!==mt&&t.status!==xt?1:0},Bt=e=>{if(It(e))return gt(e,tt);e.total_in=e.total_out=0,e.data_type=dt;const t=e.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=2===t.wrap?57:t.wrap?ft:mt,e.adler=2===t.wrap?0:1,t.last_flush=-2,We(t),Ze},Ft=e=>{const t=Bt(e);return t===Ze&&(e=>{e.window_size=2*e.w_size,yt(e.head),e.max_lazy_match=Pt[e.level].max_lazy,e.good_match=Pt[e.level].good_length,e.nice_match=Pt[e.level].nice_length,e.max_chain_length=Pt[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=2,e.match_available=0,e.ins_h=0})(e.state),t},Ot=(e,t,a,n,s,r)=>{if(!e)return tt;let i=1;if(t===st&&(t=6),n<0?(i=0,n=-n):n>15&&(i=2,n-=16),s<1||s>9||a!==ut||n<8||n>15||t<0||t>9||r<0||r>ot||8===n&&1!==i)return gt(e,tt);8===n&&(n=9);const l=new Rt;return e.state=l,l.strm=e,l.status=ft,l.wrap=i,l.gzhead=null,l.w_bits=n,l.w_size=1<<l.w_bits,l.w_mask=l.w_size-1,l.hash_bits=s+7,l.hash_size=1<<l.hash_bits,l.hash_mask=l.hash_size-1,l.hash_shift=~~((l.hash_bits+3-1)/3),l.window=new Uint8Array(2*l.w_size),l.head=new Uint16Array(l.hash_size),l.prev=new Uint16Array(l.w_size),l.lit_bufsize=1<<s+6,l.pending_buf_size=4*l.lit_bufsize,l.pending_buf=new Uint8Array(l.pending_buf_size),l.sym_buf=l.lit_bufsize,l.sym_end=3*(l.lit_bufsize-1),l.level=t,l.strategy=r,l.method=a,Ft(e)};var qt=(e,t)=>{if(It(e)||t>Xe||t<0)return e?gt(e,tt):tt;const a=e.state;if(!e.output||0!==e.avail_in&&!e.input||a.status===xt&&t!==$e)return gt(e,0===e.avail_out?nt:tt);const n=a.last_flush;if(a.last_flush=t,0!==a.pending){if(wt(e),0===e.avail_out)return a.last_flush=-1,Ze}else if(0===e.avail_in&&vt(t)<=vt(n)&&t!==$e)return gt(e,nt);if(a.status===xt&&0!==e.avail_in)return gt(e,nt);if(a.status===ft&&0===a.wrap&&(a.status=mt),a.status===ft){let t=ut+(a.w_bits-8<<4)<<8,n=-1;if(n=a.strategy>=it||a.level<2?0:a.level<6?1:6===a.level?2:3,t|=n<<6,0!==a.strstart&&(t|=32),t+=31-t%31,kt(a,t),0!==a.strstart&&(kt(a,e.adler>>>16),kt(a,65535&e.adler)),e.adler=1,a.status=mt,wt(e),0!==a.pending)return a.last_flush=-1,Ze}if(57===a.status)if(e.adler=0,St(a,31),St(a,139),St(a,8),a.gzhead)St(a,(a.gzhead.text?1:0)+(a.gzhead.hcrc?2:0)+(a.gzhead.extra?4:0)+(a.gzhead.name?8:0)+(a.gzhead.comment?16:0)),St(a,255&a.gzhead.time),St(a,a.gzhead.time>>8&255),St(a,a.gzhead.time>>16&255),St(a,a.gzhead.time>>24&255),St(a,9===a.level?2:a.strategy>=it||a.level<2?4:0),St(a,255&a.gzhead.os),a.gzhead.extra&&a.gzhead.extra.length&&(St(a,255&a.gzhead.extra.length),St(a,a.gzhead.extra.length>>8&255)),a.gzhead.hcrc&&(e.adler=ze(e.adler,a.pending_buf,a.pending,0)),a.gzindex=0,a.status=69;else if(St(a,0),St(a,0),St(a,0),St(a,0),St(a,0),St(a,9===a.level?2:a.strategy>=it||a.level<2?4:0),St(a,3),a.status=mt,wt(e),0!==a.pending)return a.last_flush=-1,Ze;if(69===a.status){if(a.gzhead.extra){let t=a.pending,n=(65535&a.gzhead.extra.length)-a.gzindex;for(;a.pending+n>a.pending_buf_size;){let s=a.pending_buf_size-a.pending;if(a.pending_buf.set(a.gzhead.extra.subarray(a.gzindex,a.gzindex+s),a.pending),a.pending=a.pending_buf_size,a.gzhead.hcrc&&a.pending>t&&(e.adler=ze(e.adler,a.pending_buf,a.pending-t,t)),a.gzindex+=s,wt(e),0!==a.pending)return a.last_flush=-1,Ze;t=0,n-=s}let s=new Uint8Array(a.gzhead.extra);a.pending_buf.set(s.subarray(a.gzindex,a.gzindex+n),a.pending),a.pending+=n,a.gzhead.hcrc&&a.pending>t&&(e.adler=ze(e.adler,a.pending_buf,a.pending-t,t)),a.gzindex=0}a.status=73}if(73===a.status){if(a.gzhead.name){let t,n=a.pending;do{if(a.pending===a.pending_buf_size){if(a.gzhead.hcrc&&a.pending>n&&(e.adler=ze(e.adler,a.pending_buf,a.pending-n,n)),wt(e),0!==a.pending)return a.last_flush=-1,Ze;n=0}t=a.gzindex<a.gzhead.name.length?255&a.gzhead.name.charCodeAt(a.gzindex++):0,St(a,t)}while(0!==t);a.gzhead.hcrc&&a.pending>n&&(e.adler=ze(e.adler,a.pending_buf,a.pending-n,n)),a.gzindex=0}a.status=91}if(91===a.status){if(a.gzhead.comment){let t,n=a.pending;do{if(a.pending===a.pending_buf_size){if(a.gzhead.hcrc&&a.pending>n&&(e.adler=ze(e.adler,a.pending_buf,a.pending-n,n)),wt(e),0!==a.pending)return a.last_flush=-1,Ze;n=0}t=a.gzindex<a.gzhead.comment.length?255&a.gzhead.comment.charCodeAt(a.gzindex++):0,St(a,t)}while(0!==t);a.gzhead.hcrc&&a.pending>n&&(e.adler=ze(e.adler,a.pending_buf,a.pending-n,n))}a.status=103}if(103===a.status){if(a.gzhead.hcrc){if(a.pending+2>a.pending_buf_size&&(wt(e),0!==a.pending))return a.last_flush=-1,Ze;St(a,255&e.adler),St(a,e.adler>>8&255),e.adler=0}if(a.status=mt,wt(e),0!==a.pending)return a.last_flush=-1,Ze}if(0!==e.avail_in||0!==a.lookahead||t!==Ye&&a.status!==xt){let n=0===a.level?Lt(a,t):a.strategy===it?((e,t)=>{let a;for(;;){if(0===e.lookahead&&(_t(e),0===e.lookahead)){if(t===Ye)return 1;break}if(e.match_length=0,a=Ge(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,a&&(Nt(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===$e?(Nt(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(Nt(e,!1),0===e.strm.avail_out)?1:2})(a,t):a.strategy===lt?((e,t)=>{let a,n,s,r;const i=e.window;for(;;){if(e.lookahead<=ht){if(_t(e),e.lookahead<=ht&&t===Ye)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=3&&e.strstart>0&&(s=e.strstart-1,n=i[s],n===i[++s]&&n===i[++s]&&n===i[++s])){r=e.strstart+ht;do{}while(n===i[++s]&&n===i[++s]&&n===i[++s]&&n===i[++s]&&n===i[++s]&&n===i[++s]&&n===i[++s]&&n===i[++s]&&s<r);e.match_length=ht-(r-s),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=3?(a=Ge(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(a=Ge(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),a&&(Nt(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===$e?(Nt(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(Nt(e,!1),0===e.strm.avail_out)?1:2})(a,t):Pt[a.level].func(a,t);if(3!==n&&4!==n||(a.status=xt),1===n||3===n)return 0===e.avail_out&&(a.last_flush=-1),Ze;if(2===n&&(t===Ke?Je(a):t!==Xe&&(He(a,0,0,!1),t===Qe&&(yt(a.head),0===a.lookahead&&(a.strstart=0,a.block_start=0,a.insert=0))),wt(e),0===e.avail_out))return a.last_flush=-1,Ze}return t!==$e?Ze:a.wrap<=0?et:(2===a.wrap?(St(a,255&e.adler),St(a,e.adler>>8&255),St(a,e.adler>>16&255),St(a,e.adler>>24&255),St(a,255&e.total_in),St(a,e.total_in>>8&255),St(a,e.total_in>>16&255),St(a,e.total_in>>24&255)):(kt(a,e.adler>>>16),kt(a,65535&e.adler)),wt(e),a.wrap>0&&(a.wrap=-a.wrap),0!==a.pending?Ze:et)},zt=(e,t)=>{let a=t.length;if(It(e))return tt;const n=e.state,s=n.wrap;if(2===s||1===s&&n.status!==ft||n.lookahead)return tt;if(1===s&&(e.adler=Oe(e.adler,t,a,0)),n.wrap=0,a>=n.w_size){0===s&&(yt(n.head),n.strstart=0,n.block_start=0,n.insert=0);let e=new Uint8Array(n.w_size);e.set(t.subarray(a-n.w_size,a),0),t=e,a=n.w_size}const r=e.avail_in,i=e.next_in,l=e.input;for(e.avail_in=a,e.next_in=0,e.input=t,_t(n);n.lookahead>=3;){let e=n.strstart,t=n.lookahead-2;do{n.ins_h=jt(n,n.ins_h,n.window[e+3-1]),n.prev[e&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=e,e++}while(--t);n.strstart=e,n.lookahead=2,_t(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=2,n.match_available=0,e.next_in=i,e.input=l,e.avail_in=r,n.wrap=s,Ze},Mt={deflateInit:(e,t)=>Ot(e,t,ut,15,8,ct),deflateInit2:Ot,deflateReset:Ft,deflateResetKeep:Bt,deflateSetHeader:(e,t)=>It(e)||2!==e.state.wrap?tt:(e.state.gzhead=t,Ze),deflate:qt,deflateEnd:e=>{if(It(e))return tt;const t=e.state.status;return e.state=null,t===mt?gt(e,at):Ze},deflateSetDictionary:zt,deflateInfo:"pako deflate (from Nodeca project)"};const Ut=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var Wt=function(e){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const a=t.shift();if(a){if("object"!==typeof a)throw new TypeError(a+"must be non-object");for(const t in a)Ut(a,t)&&(e[t]=a[t])}}return e},Ht=e=>{let t=0;for(let n=0,s=e.length;n<s;n++)t+=e[n].length;const a=new Uint8Array(t);for(let n=0,s=0,r=e.length;n<r;n++){let t=e[n];a.set(t,s),s+=t.length}return a};let Vt=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(Hi){Vt=!1}const Gt=new Uint8Array(256);for(let Vi=0;Vi<256;Vi++)Gt[Vi]=Vi>=252?6:Vi>=248?5:Vi>=240?4:Vi>=224?3:Vi>=192?2:1;Gt[254]=Gt[254]=1;var Jt=e=>{if("function"===typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(e);let t,a,n,s,r,i=e.length,l=0;for(s=0;s<i;s++)a=e.charCodeAt(s),55296===(64512&a)&&s+1<i&&(n=e.charCodeAt(s+1),56320===(64512&n)&&(a=65536+(a-55296<<10)+(n-56320),s++)),l+=a<128?1:a<2048?2:a<65536?3:4;for(t=new Uint8Array(l),r=0,s=0;r<l;s++)a=e.charCodeAt(s),55296===(64512&a)&&s+1<i&&(n=e.charCodeAt(s+1),56320===(64512&n)&&(a=65536+(a-55296<<10)+(n-56320),s++)),a<128?t[r++]=a:a<2048?(t[r++]=192|a>>>6,t[r++]=128|63&a):a<65536?(t[r++]=224|a>>>12,t[r++]=128|a>>>6&63,t[r++]=128|63&a):(t[r++]=240|a>>>18,t[r++]=128|a>>>12&63,t[r++]=128|a>>>6&63,t[r++]=128|63&a);return t},Yt=(e,t)=>{const a=t||e.length;if("function"===typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(e.subarray(0,t));let n,s;const r=new Array(2*a);for(s=0,n=0;n<a;){let t=e[n++];if(t<128){r[s++]=t;continue}let i=Gt[t];if(i>4)r[s++]=65533,n+=i-1;else{for(t&=2===i?31:3===i?15:7;i>1&&n<a;)t=t<<6|63&e[n++],i--;i>1?r[s++]=65533:t<65536?r[s++]=t:(t-=65536,r[s++]=55296|t>>10&1023,r[s++]=56320|1023&t)}}return((e,t)=>{if(t<65534&&e.subarray&&Vt)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));let a="";for(let n=0;n<t;n++)a+=String.fromCharCode(e[n]);return a})(r,s)},Kt=(e,t)=>{(t=t||e.length)>e.length&&(t=e.length);let a=t-1;for(;a>=0&&128===(192&e[a]);)a--;return a<0||0===a?t:a+Gt[e[a]]>t?a:t};var Qt=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};const $t=Object.prototype.toString,{Z_NO_FLUSH:Xt,Z_SYNC_FLUSH:Zt,Z_FULL_FLUSH:ea,Z_FINISH:ta,Z_OK:aa,Z_STREAM_END:na,Z_DEFAULT_COMPRESSION:sa,Z_DEFAULT_STRATEGY:ra,Z_DEFLATED:ia}=Ue;function la(e){this.options=Wt({level:sa,method:ia,chunkSize:16384,windowBits:15,memLevel:8,strategy:ra},e||{});let t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Qt,this.strm.avail_out=0;let a=Mt.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(a!==aa)throw new Error(Me[a]);if(t.header&&Mt.deflateSetHeader(this.strm,t.header),t.dictionary){let e;if(e="string"===typeof t.dictionary?Jt(t.dictionary):"[object ArrayBuffer]"===$t.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,a=Mt.deflateSetDictionary(this.strm,e),a!==aa)throw new Error(Me[a]);this._dict_set=!0}}function oa(e,t){const a=new la(t);if(a.push(e,!0),a.err)throw a.msg||Me[a.err];return a.result}la.prototype.push=function(e,t){const a=this.strm,n=this.options.chunkSize;let s,r;if(this.ended)return!1;for(r=t===~~t?t:!0===t?ta:Xt,"string"===typeof e?a.input=Jt(e):"[object ArrayBuffer]"===$t.call(e)?a.input=new Uint8Array(e):a.input=e,a.next_in=0,a.avail_in=a.input.length;;)if(0===a.avail_out&&(a.output=new Uint8Array(n),a.next_out=0,a.avail_out=n),(r===Zt||r===ea)&&a.avail_out<=6)this.onData(a.output.subarray(0,a.next_out)),a.avail_out=0;else{if(s=Mt.deflate(a,r),s===na)return a.next_out>0&&this.onData(a.output.subarray(0,a.next_out)),s=Mt.deflateEnd(this.strm),this.onEnd(s),this.ended=!0,s===aa;if(0!==a.avail_out){if(r>0&&a.next_out>0)this.onData(a.output.subarray(0,a.next_out)),a.avail_out=0;else if(0===a.avail_in)break}else this.onData(a.output)}return!0},la.prototype.onData=function(e){this.chunks.push(e)},la.prototype.onEnd=function(e){e===aa&&(this.result=Ht(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var ca={Deflate:la,deflate:oa,deflateRaw:function(e,t){return(t=t||{}).raw=!0,oa(e,t)},gzip:function(e,t){return(t=t||{}).gzip=!0,oa(e,t)},constants:Ue};const da=16209;var ua=function(e,t){let a,n,s,r,i,l,o,c,d,u,h,p,f,m,x,g,v,y,b,j,w,N,S,k;const A=e.state;a=e.next_in,S=e.input,n=a+(e.avail_in-5),s=e.next_out,k=e.output,r=s-(t-e.avail_out),i=s+(e.avail_out-257),l=A.dmax,o=A.wsize,c=A.whave,d=A.wnext,u=A.window,h=A.hold,p=A.bits,f=A.lencode,m=A.distcode,x=(1<<A.lenbits)-1,g=(1<<A.distbits)-1;e:do{p<15&&(h+=S[a++]<<p,p+=8,h+=S[a++]<<p,p+=8),v=f[h&x];t:for(;;){if(y=v>>>24,h>>>=y,p-=y,y=v>>>16&255,0===y)k[s++]=65535&v;else{if(!(16&y)){if(0===(64&y)){v=f[(65535&v)+(h&(1<<y)-1)];continue t}if(32&y){A.mode=16191;break e}e.msg="invalid literal/length code",A.mode=da;break e}b=65535&v,y&=15,y&&(p<y&&(h+=S[a++]<<p,p+=8),b+=h&(1<<y)-1,h>>>=y,p-=y),p<15&&(h+=S[a++]<<p,p+=8,h+=S[a++]<<p,p+=8),v=m[h&g];a:for(;;){if(y=v>>>24,h>>>=y,p-=y,y=v>>>16&255,!(16&y)){if(0===(64&y)){v=m[(65535&v)+(h&(1<<y)-1)];continue a}e.msg="invalid distance code",A.mode=da;break e}if(j=65535&v,y&=15,p<y&&(h+=S[a++]<<p,p+=8,p<y&&(h+=S[a++]<<p,p+=8)),j+=h&(1<<y)-1,j>l){e.msg="invalid distance too far back",A.mode=da;break e}if(h>>>=y,p-=y,y=s-r,j>y){if(y=j-y,y>c&&A.sane){e.msg="invalid distance too far back",A.mode=da;break e}if(w=0,N=u,0===d){if(w+=o-y,y<b){b-=y;do{k[s++]=u[w++]}while(--y);w=s-j,N=k}}else if(d<y){if(w+=o+d-y,y-=d,y<b){b-=y;do{k[s++]=u[w++]}while(--y);if(w=0,d<b){y=d,b-=y;do{k[s++]=u[w++]}while(--y);w=s-j,N=k}}}else if(w+=d-y,y<b){b-=y;do{k[s++]=u[w++]}while(--y);w=s-j,N=k}for(;b>2;)k[s++]=N[w++],k[s++]=N[w++],k[s++]=N[w++],b-=3;b&&(k[s++]=N[w++],b>1&&(k[s++]=N[w++]))}else{w=s-j;do{k[s++]=k[w++],k[s++]=k[w++],k[s++]=k[w++],b-=3}while(b>2);b&&(k[s++]=k[w++],b>1&&(k[s++]=k[w++]))}break}}break}}while(a<n&&s<i);b=p>>3,a-=b,p-=b<<3,h&=(1<<p)-1,e.next_in=a,e.next_out=s,e.avail_in=a<n?n-a+5:5-(a-n),e.avail_out=s<i?i-s+257:257-(s-i),A.hold=h,A.bits=p};const ha=15,pa=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),fa=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),ma=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),xa=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var ga=(e,t,a,n,s,r,i,l)=>{const o=l.bits;let c,d,u,h,p,f,m=0,x=0,g=0,v=0,y=0,b=0,j=0,w=0,N=0,S=0,k=null;const A=new Uint16Array(16),C=new Uint16Array(16);let _,L,T,E=null;for(m=0;m<=ha;m++)A[m]=0;for(x=0;x<n;x++)A[t[a+x]]++;for(y=o,v=ha;v>=1&&0===A[v];v--);if(y>v&&(y=v),0===v)return s[r++]=20971520,s[r++]=20971520,l.bits=1,0;for(g=1;g<v&&0===A[g];g++);for(y<g&&(y=g),w=1,m=1;m<=ha;m++)if(w<<=1,w-=A[m],w<0)return-1;if(w>0&&(0===e||1!==v))return-1;for(C[1]=0,m=1;m<ha;m++)C[m+1]=C[m]+A[m];for(x=0;x<n;x++)0!==t[a+x]&&(i[C[t[a+x]]++]=x);if(0===e?(k=E=i,f=20):1===e?(k=pa,E=fa,f=257):(k=ma,E=xa,f=0),S=0,x=0,m=g,p=r,b=y,j=0,u=-1,N=1<<y,h=N-1,1===e&&N>852||2===e&&N>592)return 1;for(;;){_=m-j,i[x]+1<f?(L=0,T=i[x]):i[x]>=f?(L=E[i[x]-f],T=k[i[x]-f]):(L=96,T=0),c=1<<m-j,d=1<<b,g=d;do{d-=c,s[p+(S>>j)+d]=_<<24|L<<16|T}while(0!==d);for(c=1<<m-1;S&c;)c>>=1;if(0!==c?(S&=c-1,S+=c):S=0,x++,0===--A[m]){if(m===v)break;m=t[a+i[x]]}if(m>y&&(S&h)!==u){for(0===j&&(j=y),p+=g,b=m-j,w=1<<b;b+j<v&&(w-=A[b+j],!(w<=0));)b++,w<<=1;if(N+=1<<b,1===e&&N>852||2===e&&N>592)return 1;u=S&h,s[u]=y<<24|b<<16|p-r}}return 0!==S&&(s[p+S]=m-j<<24|64<<16),l.bits=y,0};const{Z_FINISH:va,Z_BLOCK:ya,Z_TREES:ba,Z_OK:ja,Z_STREAM_END:wa,Z_NEED_DICT:Na,Z_STREAM_ERROR:Sa,Z_DATA_ERROR:ka,Z_MEM_ERROR:Aa,Z_BUF_ERROR:Ca,Z_DEFLATED:_a}=Ue,La=16180,Ta=16190,Ea=16191,Da=16192,Pa=16194,Ra=16199,Ia=16200,Ba=16206,Fa=16209,Oa=e=>(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24);function qa(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const za=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.mode<La||t.mode>16211?1:0},Ma=e=>{if(za(e))return Sa;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=La,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(852),t.distcode=t.distdyn=new Int32Array(592),t.sane=1,t.back=-1,ja},Ua=e=>{if(za(e))return Sa;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,Ma(e)},Wa=(e,t)=>{let a;if(za(e))return Sa;const n=e.state;return t<0?(a=0,t=-t):(a=5+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?Sa:(null!==n.window&&n.wbits!==t&&(n.window=null),n.wrap=a,n.wbits=t,Ua(e))},Ha=(e,t)=>{if(!e)return Sa;const a=new qa;e.state=a,a.strm=e,a.window=null,a.mode=La;const n=Wa(e,t);return n!==ja&&(e.state=null),n};let Va,Ga,Ja=!0;const Ya=e=>{if(Ja){Va=new Int32Array(512),Ga=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(ga(1,e.lens,0,288,Va,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;ga(2,e.lens,0,32,Ga,0,e.work,{bits:5}),Ja=!1}e.lencode=Va,e.lenbits=9,e.distcode=Ga,e.distbits=5},Ka=(e,t,a,n)=>{let s;const r=e.state;return null===r.window&&(r.wsize=1<<r.wbits,r.wnext=0,r.whave=0,r.window=new Uint8Array(r.wsize)),n>=r.wsize?(r.window.set(t.subarray(a-r.wsize,a),0),r.wnext=0,r.whave=r.wsize):(s=r.wsize-r.wnext,s>n&&(s=n),r.window.set(t.subarray(a-n,a-n+s),r.wnext),(n-=s)?(r.window.set(t.subarray(a-n,a),0),r.wnext=n,r.whave=r.wsize):(r.wnext+=s,r.wnext===r.wsize&&(r.wnext=0),r.whave<r.wsize&&(r.whave+=s))),0};var Qa=(e,t)=>{let a,n,s,r,i,l,o,c,d,u,h,p,f,m,x,g,v,y,b,j,w,N,S=0;const k=new Uint8Array(4);let A,C;const _=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(za(e)||!e.output||!e.input&&0!==e.avail_in)return Sa;a=e.state,a.mode===Ea&&(a.mode=Da),i=e.next_out,s=e.output,o=e.avail_out,r=e.next_in,n=e.input,l=e.avail_in,c=a.hold,d=a.bits,u=l,h=o,N=ja;e:for(;;)switch(a.mode){case La:if(0===a.wrap){a.mode=Da;break}for(;d<16;){if(0===l)break e;l--,c+=n[r++]<<d,d+=8}if(2&a.wrap&&35615===c){0===a.wbits&&(a.wbits=15),a.check=0,k[0]=255&c,k[1]=c>>>8&255,a.check=ze(a.check,k,2,0),c=0,d=0,a.mode=16181;break}if(a.head&&(a.head.done=!1),!(1&a.wrap)||(((255&c)<<8)+(c>>8))%31){e.msg="incorrect header check",a.mode=Fa;break}if((15&c)!==_a){e.msg="unknown compression method",a.mode=Fa;break}if(c>>>=4,d-=4,w=8+(15&c),0===a.wbits&&(a.wbits=w),w>15||w>a.wbits){e.msg="invalid window size",a.mode=Fa;break}a.dmax=1<<a.wbits,a.flags=0,e.adler=a.check=1,a.mode=512&c?16189:Ea,c=0,d=0;break;case 16181:for(;d<16;){if(0===l)break e;l--,c+=n[r++]<<d,d+=8}if(a.flags=c,(255&a.flags)!==_a){e.msg="unknown compression method",a.mode=Fa;break}if(57344&a.flags){e.msg="unknown header flags set",a.mode=Fa;break}a.head&&(a.head.text=c>>8&1),512&a.flags&&4&a.wrap&&(k[0]=255&c,k[1]=c>>>8&255,a.check=ze(a.check,k,2,0)),c=0,d=0,a.mode=16182;case 16182:for(;d<32;){if(0===l)break e;l--,c+=n[r++]<<d,d+=8}a.head&&(a.head.time=c),512&a.flags&&4&a.wrap&&(k[0]=255&c,k[1]=c>>>8&255,k[2]=c>>>16&255,k[3]=c>>>24&255,a.check=ze(a.check,k,4,0)),c=0,d=0,a.mode=16183;case 16183:for(;d<16;){if(0===l)break e;l--,c+=n[r++]<<d,d+=8}a.head&&(a.head.xflags=255&c,a.head.os=c>>8),512&a.flags&&4&a.wrap&&(k[0]=255&c,k[1]=c>>>8&255,a.check=ze(a.check,k,2,0)),c=0,d=0,a.mode=16184;case 16184:if(1024&a.flags){for(;d<16;){if(0===l)break e;l--,c+=n[r++]<<d,d+=8}a.length=c,a.head&&(a.head.extra_len=c),512&a.flags&&4&a.wrap&&(k[0]=255&c,k[1]=c>>>8&255,a.check=ze(a.check,k,2,0)),c=0,d=0}else a.head&&(a.head.extra=null);a.mode=16185;case 16185:if(1024&a.flags&&(p=a.length,p>l&&(p=l),p&&(a.head&&(w=a.head.extra_len-a.length,a.head.extra||(a.head.extra=new Uint8Array(a.head.extra_len)),a.head.extra.set(n.subarray(r,r+p),w)),512&a.flags&&4&a.wrap&&(a.check=ze(a.check,n,p,r)),l-=p,r+=p,a.length-=p),a.length))break e;a.length=0,a.mode=16186;case 16186:if(2048&a.flags){if(0===l)break e;p=0;do{w=n[r+p++],a.head&&w&&a.length<65536&&(a.head.name+=String.fromCharCode(w))}while(w&&p<l);if(512&a.flags&&4&a.wrap&&(a.check=ze(a.check,n,p,r)),l-=p,r+=p,w)break e}else a.head&&(a.head.name=null);a.length=0,a.mode=16187;case 16187:if(4096&a.flags){if(0===l)break e;p=0;do{w=n[r+p++],a.head&&w&&a.length<65536&&(a.head.comment+=String.fromCharCode(w))}while(w&&p<l);if(512&a.flags&&4&a.wrap&&(a.check=ze(a.check,n,p,r)),l-=p,r+=p,w)break e}else a.head&&(a.head.comment=null);a.mode=16188;case 16188:if(512&a.flags){for(;d<16;){if(0===l)break e;l--,c+=n[r++]<<d,d+=8}if(4&a.wrap&&c!==(65535&a.check)){e.msg="header crc mismatch",a.mode=Fa;break}c=0,d=0}a.head&&(a.head.hcrc=a.flags>>9&1,a.head.done=!0),e.adler=a.check=0,a.mode=Ea;break;case 16189:for(;d<32;){if(0===l)break e;l--,c+=n[r++]<<d,d+=8}e.adler=a.check=Oa(c),c=0,d=0,a.mode=Ta;case Ta:if(0===a.havedict)return e.next_out=i,e.avail_out=o,e.next_in=r,e.avail_in=l,a.hold=c,a.bits=d,Na;e.adler=a.check=1,a.mode=Ea;case Ea:if(t===ya||t===ba)break e;case Da:if(a.last){c>>>=7&d,d-=7&d,a.mode=Ba;break}for(;d<3;){if(0===l)break e;l--,c+=n[r++]<<d,d+=8}switch(a.last=1&c,c>>>=1,d-=1,3&c){case 0:a.mode=16193;break;case 1:if(Ya(a),a.mode=Ra,t===ba){c>>>=2,d-=2;break e}break;case 2:a.mode=16196;break;case 3:e.msg="invalid block type",a.mode=Fa}c>>>=2,d-=2;break;case 16193:for(c>>>=7&d,d-=7&d;d<32;){if(0===l)break e;l--,c+=n[r++]<<d,d+=8}if((65535&c)!==(c>>>16^65535)){e.msg="invalid stored block lengths",a.mode=Fa;break}if(a.length=65535&c,c=0,d=0,a.mode=Pa,t===ba)break e;case Pa:a.mode=16195;case 16195:if(p=a.length,p){if(p>l&&(p=l),p>o&&(p=o),0===p)break e;s.set(n.subarray(r,r+p),i),l-=p,r+=p,o-=p,i+=p,a.length-=p;break}a.mode=Ea;break;case 16196:for(;d<14;){if(0===l)break e;l--,c+=n[r++]<<d,d+=8}if(a.nlen=257+(31&c),c>>>=5,d-=5,a.ndist=1+(31&c),c>>>=5,d-=5,a.ncode=4+(15&c),c>>>=4,d-=4,a.nlen>286||a.ndist>30){e.msg="too many length or distance symbols",a.mode=Fa;break}a.have=0,a.mode=16197;case 16197:for(;a.have<a.ncode;){for(;d<3;){if(0===l)break e;l--,c+=n[r++]<<d,d+=8}a.lens[_[a.have++]]=7&c,c>>>=3,d-=3}for(;a.have<19;)a.lens[_[a.have++]]=0;if(a.lencode=a.lendyn,a.lenbits=7,A={bits:a.lenbits},N=ga(0,a.lens,0,19,a.lencode,0,a.work,A),a.lenbits=A.bits,N){e.msg="invalid code lengths set",a.mode=Fa;break}a.have=0,a.mode=16198;case 16198:for(;a.have<a.nlen+a.ndist;){for(;S=a.lencode[c&(1<<a.lenbits)-1],x=S>>>24,g=S>>>16&255,v=65535&S,!(x<=d);){if(0===l)break e;l--,c+=n[r++]<<d,d+=8}if(v<16)c>>>=x,d-=x,a.lens[a.have++]=v;else{if(16===v){for(C=x+2;d<C;){if(0===l)break e;l--,c+=n[r++]<<d,d+=8}if(c>>>=x,d-=x,0===a.have){e.msg="invalid bit length repeat",a.mode=Fa;break}w=a.lens[a.have-1],p=3+(3&c),c>>>=2,d-=2}else if(17===v){for(C=x+3;d<C;){if(0===l)break e;l--,c+=n[r++]<<d,d+=8}c>>>=x,d-=x,w=0,p=3+(7&c),c>>>=3,d-=3}else{for(C=x+7;d<C;){if(0===l)break e;l--,c+=n[r++]<<d,d+=8}c>>>=x,d-=x,w=0,p=11+(127&c),c>>>=7,d-=7}if(a.have+p>a.nlen+a.ndist){e.msg="invalid bit length repeat",a.mode=Fa;break}for(;p--;)a.lens[a.have++]=w}}if(a.mode===Fa)break;if(0===a.lens[256]){e.msg="invalid code -- missing end-of-block",a.mode=Fa;break}if(a.lenbits=9,A={bits:a.lenbits},N=ga(1,a.lens,0,a.nlen,a.lencode,0,a.work,A),a.lenbits=A.bits,N){e.msg="invalid literal/lengths set",a.mode=Fa;break}if(a.distbits=6,a.distcode=a.distdyn,A={bits:a.distbits},N=ga(2,a.lens,a.nlen,a.ndist,a.distcode,0,a.work,A),a.distbits=A.bits,N){e.msg="invalid distances set",a.mode=Fa;break}if(a.mode=Ra,t===ba)break e;case Ra:a.mode=Ia;case Ia:if(l>=6&&o>=258){e.next_out=i,e.avail_out=o,e.next_in=r,e.avail_in=l,a.hold=c,a.bits=d,ua(e,h),i=e.next_out,s=e.output,o=e.avail_out,r=e.next_in,n=e.input,l=e.avail_in,c=a.hold,d=a.bits,a.mode===Ea&&(a.back=-1);break}for(a.back=0;S=a.lencode[c&(1<<a.lenbits)-1],x=S>>>24,g=S>>>16&255,v=65535&S,!(x<=d);){if(0===l)break e;l--,c+=n[r++]<<d,d+=8}if(g&&0===(240&g)){for(y=x,b=g,j=v;S=a.lencode[j+((c&(1<<y+b)-1)>>y)],x=S>>>24,g=S>>>16&255,v=65535&S,!(y+x<=d);){if(0===l)break e;l--,c+=n[r++]<<d,d+=8}c>>>=y,d-=y,a.back+=y}if(c>>>=x,d-=x,a.back+=x,a.length=v,0===g){a.mode=16205;break}if(32&g){a.back=-1,a.mode=Ea;break}if(64&g){e.msg="invalid literal/length code",a.mode=Fa;break}a.extra=15&g,a.mode=16201;case 16201:if(a.extra){for(C=a.extra;d<C;){if(0===l)break e;l--,c+=n[r++]<<d,d+=8}a.length+=c&(1<<a.extra)-1,c>>>=a.extra,d-=a.extra,a.back+=a.extra}a.was=a.length,a.mode=16202;case 16202:for(;S=a.distcode[c&(1<<a.distbits)-1],x=S>>>24,g=S>>>16&255,v=65535&S,!(x<=d);){if(0===l)break e;l--,c+=n[r++]<<d,d+=8}if(0===(240&g)){for(y=x,b=g,j=v;S=a.distcode[j+((c&(1<<y+b)-1)>>y)],x=S>>>24,g=S>>>16&255,v=65535&S,!(y+x<=d);){if(0===l)break e;l--,c+=n[r++]<<d,d+=8}c>>>=y,d-=y,a.back+=y}if(c>>>=x,d-=x,a.back+=x,64&g){e.msg="invalid distance code",a.mode=Fa;break}a.offset=v,a.extra=15&g,a.mode=16203;case 16203:if(a.extra){for(C=a.extra;d<C;){if(0===l)break e;l--,c+=n[r++]<<d,d+=8}a.offset+=c&(1<<a.extra)-1,c>>>=a.extra,d-=a.extra,a.back+=a.extra}if(a.offset>a.dmax){e.msg="invalid distance too far back",a.mode=Fa;break}a.mode=16204;case 16204:if(0===o)break e;if(p=h-o,a.offset>p){if(p=a.offset-p,p>a.whave&&a.sane){e.msg="invalid distance too far back",a.mode=Fa;break}p>a.wnext?(p-=a.wnext,f=a.wsize-p):f=a.wnext-p,p>a.length&&(p=a.length),m=a.window}else m=s,f=i-a.offset,p=a.length;p>o&&(p=o),o-=p,a.length-=p;do{s[i++]=m[f++]}while(--p);0===a.length&&(a.mode=Ia);break;case 16205:if(0===o)break e;s[i++]=a.length,o--,a.mode=Ia;break;case Ba:if(a.wrap){for(;d<32;){if(0===l)break e;l--,c|=n[r++]<<d,d+=8}if(h-=o,e.total_out+=h,a.total+=h,4&a.wrap&&h&&(e.adler=a.check=a.flags?ze(a.check,s,h,i-h):Oe(a.check,s,h,i-h)),h=o,4&a.wrap&&(a.flags?c:Oa(c))!==a.check){e.msg="incorrect data check",a.mode=Fa;break}c=0,d=0}a.mode=16207;case 16207:if(a.wrap&&a.flags){for(;d<32;){if(0===l)break e;l--,c+=n[r++]<<d,d+=8}if(4&a.wrap&&c!==(4294967295&a.total)){e.msg="incorrect length check",a.mode=Fa;break}c=0,d=0}a.mode=16208;case 16208:N=wa;break e;case Fa:N=ka;break e;case 16210:return Aa;default:return Sa}return e.next_out=i,e.avail_out=o,e.next_in=r,e.avail_in=l,a.hold=c,a.bits=d,(a.wsize||h!==e.avail_out&&a.mode<Fa&&(a.mode<Ba||t!==va))&&Ka(e,e.output,e.next_out,h-e.avail_out),u-=e.avail_in,h-=e.avail_out,e.total_in+=u,e.total_out+=h,a.total+=h,4&a.wrap&&h&&(e.adler=a.check=a.flags?ze(a.check,s,h,e.next_out-h):Oe(a.check,s,h,e.next_out-h)),e.data_type=a.bits+(a.last?64:0)+(a.mode===Ea?128:0)+(a.mode===Ra||a.mode===Pa?256:0),(0===u&&0===h||t===va)&&N===ja&&(N=Ca),N},$a={inflateReset:Ua,inflateReset2:Wa,inflateResetKeep:Ma,inflateInit:e=>Ha(e,15),inflateInit2:Ha,inflate:Qa,inflateEnd:e=>{if(za(e))return Sa;let t=e.state;return t.window&&(t.window=null),e.state=null,ja},inflateGetHeader:(e,t)=>{if(za(e))return Sa;const a=e.state;return 0===(2&a.wrap)?Sa:(a.head=t,t.done=!1,ja)},inflateSetDictionary:(e,t)=>{const a=t.length;let n,s,r;return za(e)?Sa:(n=e.state,0!==n.wrap&&n.mode!==Ta?Sa:n.mode===Ta&&(s=1,s=Oe(s,t,a,0),s!==n.check)?ka:(r=Ka(e,t,a,a),r?(n.mode=16210,Aa):(n.havedict=1,ja)))},inflateInfo:"pako inflate (from Nodeca project)"};var Xa=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1};const Za=Object.prototype.toString,{Z_NO_FLUSH:en,Z_FINISH:tn,Z_OK:an,Z_STREAM_END:nn,Z_NEED_DICT:sn,Z_STREAM_ERROR:rn,Z_DATA_ERROR:ln,Z_MEM_ERROR:on}=Ue;function cn(e){this.options=Wt({chunkSize:65536,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0===(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Qt,this.strm.avail_out=0;let a=$a.inflateInit2(this.strm,t.windowBits);if(a!==an)throw new Error(Me[a]);if(this.header=new Xa,$a.inflateGetHeader(this.strm,this.header),t.dictionary&&("string"===typeof t.dictionary?t.dictionary=Jt(t.dictionary):"[object ArrayBuffer]"===Za.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(a=$a.inflateSetDictionary(this.strm,t.dictionary),a!==an)))throw new Error(Me[a])}function dn(e,t){const a=new cn(t);if(a.push(e),a.err)throw a.msg||Me[a.err];return a.result}cn.prototype.push=function(e,t){const a=this.strm,n=this.options.chunkSize,s=this.options.dictionary;let r,i,l;if(this.ended)return!1;for(i=t===~~t?t:!0===t?tn:en,"[object ArrayBuffer]"===Za.call(e)?a.input=new Uint8Array(e):a.input=e,a.next_in=0,a.avail_in=a.input.length;;){for(0===a.avail_out&&(a.output=new Uint8Array(n),a.next_out=0,a.avail_out=n),r=$a.inflate(a,i),r===sn&&s&&(r=$a.inflateSetDictionary(a,s),r===an?r=$a.inflate(a,i):r===ln&&(r=sn));a.avail_in>0&&r===nn&&a.state.wrap>0&&0!==e[a.next_in];)$a.inflateReset(a),r=$a.inflate(a,i);switch(r){case rn:case ln:case sn:case on:return this.onEnd(r),this.ended=!0,!1}if(l=a.avail_out,a.next_out&&(0===a.avail_out||r===nn))if("string"===this.options.to){let e=Kt(a.output,a.next_out),t=a.next_out-e,s=Yt(a.output,e);a.next_out=t,a.avail_out=n-t,t&&a.output.set(a.output.subarray(e,e+t),0),this.onData(s)}else this.onData(a.output.length===a.next_out?a.output:a.output.subarray(0,a.next_out));if(r!==an||0!==l){if(r===nn)return r=$a.inflateEnd(this.strm),this.onEnd(r),this.ended=!0,!0;if(0===a.avail_in)break}}return!0},cn.prototype.onData=function(e){this.chunks.push(e)},cn.prototype.onEnd=function(e){e===an&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=Ht(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var un={Inflate:cn,inflate:dn,inflateRaw:function(e,t){return(t=t||{}).raw=!0,dn(e,t)},ungzip:dn,constants:Ue};const{Deflate:hn,deflate:pn,deflateRaw:fn,gzip:mn}=ca,{Inflate:xn,inflate:gn,inflateRaw:vn,ungzip:yn}=un;var bn=xn,jn=gn;const wn=[];for(let Vi=0;Vi<256;Vi++){let e=Vi;for(let t=0;t<8;t++)1&e?e=3988292384^e>>>1:e>>>=1;wn[Vi]=e}const Nn=4294967295;function Sn(e,t){return(function(e,t,a){let n=e;for(let s=0;s<a;s++)n=wn[255&(n^t[s])]^n>>>8;return n}(Nn,e,t)^Nn)>>>0}function kn(e,t,a){const n=e.readUint32(),s=Sn(new Uint8Array(e.buffer,e.byteOffset+e.offset-t-4,t),t);if(s!==n)throw new Error("CRC mismatch for chunk ".concat(a,". Expected ").concat(n,", found ").concat(s))}function An(e,t,a){for(let n=0;n<a;n++)t[n]=e[n]}function Cn(e,t,a,n){let s=0;for(;s<n;s++)t[s]=e[s];for(;s<a;s++)t[s]=e[s]+t[s-n]&255}function _n(e,t,a,n){let s=0;if(0===a.length)for(;s<n;s++)t[s]=e[s];else for(;s<n;s++)t[s]=e[s]+a[s]&255}function Ln(e,t,a,n,s){let r=0;if(0===a.length){for(;r<s;r++)t[r]=e[r];for(;r<n;r++)t[r]=e[r]+(t[r-s]>>1)&255}else{for(;r<s;r++)t[r]=e[r]+(a[r]>>1)&255;for(;r<n;r++)t[r]=e[r]+(t[r-s]+a[r]>>1)&255}}function Tn(e,t,a,n,s){let r=0;if(0===a.length){for(;r<s;r++)t[r]=e[r];for(;r<n;r++)t[r]=e[r]+t[r-s]&255}else{for(;r<s;r++)t[r]=e[r]+a[r]&255;for(;r<n;r++)t[r]=e[r]+En(t[r-s],a[r],a[r-s])&255}}function En(e,t,a){const n=e+t-a,s=Math.abs(n-e),r=Math.abs(n-t),i=Math.abs(n-a);return s<=r&&s<=i?e:r<=i?t:a}function Dn(e,t,a,n,s,r){switch(e){case 0:An(t,a,s);break;case 1:Cn(t,a,s,r);break;case 2:_n(t,a,n,s);break;case 3:Ln(t,a,n,s,r);break;case 4:Tn(t,a,n,s,r);break;default:throw new Error("Unsupported filter: ".concat(e))}}const Pn=new Uint16Array([255]),Rn=255===new Uint8Array(Pn.buffer)[0];function In(e){return(255&e)<<8|e>>8&255}const Bn=new Uint16Array([255]),Fn=255===new Uint8Array(Bn.buffer)[0],On=new Uint8Array(0);function qn(e){const{data:t,width:a,height:n,channels:s,depth:r}=e,i=Math.ceil(r/8)*s,l=Math.ceil(r/8*s*a),o=new Uint8Array(n*l);let c,d,u=On,h=0;for(let p=0;p<n;p++){switch(c=t.subarray(h+1,h+1+l),d=o.subarray(p*l,(p+1)*l),t[h]){case 0:An(c,d,l);break;case 1:Cn(c,d,l,i);break;case 2:_n(c,d,u,l);break;case 3:Ln(c,d,u,l,i);break;case 4:Tn(c,d,u,l,i);break;default:throw new Error("Unsupported filter: ".concat(t[h]))}u=d,h+=l+1}if(16===r){const e=new Uint16Array(o.buffer);if(Fn)for(let t=0;t<e.length;t++)e[t]=zn(e[t]);return e}return o}function zn(e){return(255&e)<<8|e>>8&255}const Mn=Uint8Array.of(137,80,78,71,13,10,26,10);function Un(e){if(!function(e){if(e.length<Mn.length)return!1;for(let t=0;t<Mn.length;t++)if(e[t]!==Mn[t])return!1;return!0}(e.readBytes(Mn.length)))throw new Error("wrong PNG signature")}const Wn="tEXt",Hn=new TextDecoder("latin1");function Vn(e){if(Jn(e),0===e.length||e.length>79)throw new Error("keyword length must be between 1 and 79")}const Gn=/^[\u0000-\u00FF]*$/;function Jn(e){if(!Gn.test(e))throw new Error("invalid latin1 text")}function Yn(e,t,a){const n=Kn(t);e[n]=function(e,t){return Hn.decode(e.readBytes(t))}(t,a-n.length-1)}function Kn(e){for(e.mark();0!==e.readByte(););const t=e.offset;e.reset();const a=Hn.decode(e.readBytes(t-e.offset-1));return e.skip(1),Vn(a),a}const Qn=-1,$n=0,Xn=2,Zn=3,es=4,ts=6,as=-1,ns=0,ss=-1,rs=0,is=-1,ls=0,os=1,cs=0,ds=1,us=2,hs=0,ps=1;class fs extends Q{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(e),(0,V.A)(this,"_checkCrc",void 0),(0,V.A)(this,"_inflator",void 0),(0,V.A)(this,"_png",void 0),(0,V.A)(this,"_apng",void 0),(0,V.A)(this,"_end",void 0),(0,V.A)(this,"_hasPalette",void 0),(0,V.A)(this,"_palette",void 0),(0,V.A)(this,"_hasTransparency",void 0),(0,V.A)(this,"_transparency",void 0),(0,V.A)(this,"_compressionMethod",void 0),(0,V.A)(this,"_filterMethod",void 0),(0,V.A)(this,"_interlaceMethod",void 0),(0,V.A)(this,"_colorType",void 0),(0,V.A)(this,"_isAnimated",void 0),(0,V.A)(this,"_numberOfFrames",void 0),(0,V.A)(this,"_numberOfPlays",void 0),(0,V.A)(this,"_frames",void 0),(0,V.A)(this,"_writingDataChunks",void 0);const{checkCrc:a=!1}=t;this._checkCrc=a,this._inflator=new bn,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=as,this._filterMethod=ss,this._interlaceMethod=is,this._colorType=Qn,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(Un(this);!this._end;){const e=this.readUint32(),t=this.readChars(4);this.decodeChunk(e,t)}return this.decodeImage(),this._png}decodeApng(){for(Un(this);!this._end;){const e=this.readUint32(),t=this.readChars(4);this.decodeApngChunk(e,t)}return this.decodeApngImage(),this._apng}decodeChunk(e,t){const a=this.offset;switch(t){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(e);break;case"IDAT":this.decodeIDAT(e);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(e);break;case"iCCP":this.decodeiCCP(e);break;case Wn:Yn(this._png.text,this,e);break;case"pHYs":this.decodepHYs();break;default:this.skip(e)}if(this.offset-a!==e)throw new Error("Length mismatch while decoding chunk ".concat(t));this._checkCrc?kn(this,e+4,t):this.skip(4)}decodeApngChunk(e,t){const a=this.offset;switch("fdAT"!==t&&"IDAT"!==t&&this._writingDataChunks&&this.pushDataToFrame(),t){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(e);break;default:this.decodeChunk(e,t),this.offset=a+e}if(this.offset-a!==e)throw new Error("Length mismatch while decoding chunk ".concat(t));this._checkCrc?kn(this,e+4,t):this.skip(4)}decodeIHDR(){const e=this._png;e.width=this.readUint32(),e.height=this.readUint32(),e.depth=function(e){if(1!==e&&2!==e&&4!==e&&8!==e&&16!==e)throw new Error("invalid bit depth: ".concat(e));return e}(this.readUint8());const t=this.readUint8();let a;switch(this._colorType=t,t){case $n:a=1;break;case Xn:a=3;break;case Zn:a=1;break;case es:a=2;break;case ts:a=4;break;default:throw new Error("Unknown color type: ".concat(t))}if(this._png.channels=a,this._compressionMethod=this.readUint8(),this._compressionMethod!==ns)throw new Error("Unsupported compression method: ".concat(this._compressionMethod));this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const e={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(e)}decodePLTE(e){if(e%3!==0)throw new RangeError("PLTE field length must be a multiple of 3. Got ".concat(e));const t=e/3;this._hasPalette=!0;const a=[];this._palette=a;for(let n=0;n<t;n++)a.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(e){this._writingDataChunks=!0;const t=e,a=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,a,t)),this._inflator.err)throw new Error("Error while decompressing the data: ".concat(this._inflator.err));this.skip(e)}decodeFDAT(e){this._writingDataChunks=!0;let t=e,a=this.offset+this.byteOffset;if(a+=4,t-=4,this._inflator.push(new Uint8Array(this.buffer,a,t)),this._inflator.err)throw new Error("Error while decompressing the data: ".concat(this._inflator.err));this.skip(e)}decodetRNS(e){switch(this._colorType){case $n:case Xn:if(e%2!==0)throw new RangeError("tRNS chunk length must be a multiple of 2. Got ".concat(e));if(e/2>this._png.width*this._png.height)throw new Error("tRNS chunk contains more alpha values than there are pixels (".concat(e/2," vs ").concat(this._png.width*this._png.height,")"));this._hasTransparency=!0,this._transparency=new Uint16Array(e/2);for(let t=0;t<e/2;t++)this._transparency[t]=this.readUint16();break;case Zn:{if(e>this._palette.length)throw new Error("tRNS chunk contains more alpha values than there are palette colors (".concat(e," vs ").concat(this._palette.length,")"));let t=0;for(;t<e;t++){const e=this.readByte();this._palette[t].push(e)}for(;t<this._palette.length;t++)this._palette[t].push(255);break}default:throw new Error("tRNS chunk is not supported for color type ".concat(this._colorType))}}decodeiCCP(e){const t=Kn(this),a=this.readUint8();if(a!==ns)throw new Error("Unsupported iCCP compression method: ".concat(a));const n=this.readBytes(e-t.length-2);this._png.iccEmbeddedProfile={name:t,profile:jn(n)}}decodepHYs(){const e=this.readUint32(),t=this.readUint32(),a=this.readByte();this._png.resolution={x:e,y:t,unit:a}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let e=0;e<this._numberOfFrames;e++){const t={sequenceNumber:this._frames[e].sequenceNumber,delayNumber:this._frames[e].delayNumber,delayDenominator:this._frames[e].delayDenominator,data:8===this._apng.depth?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},a=this._frames.at(e);if(a){if(a.data=qn({data:a.data,width:a.width,height:a.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),0===e||0===a.xOffset&&0===a.yOffset&&a.width===this._png.width&&a.height===this._png.height)t.data=a.data;else{const n=this._apng.frames.at(e-1);this.disposeFrame(a,n,t),this.addFrameDataToCanvas(t,a)}this._apng.frames.push(t)}}return this._apng}disposeFrame(e,t,a){switch(e.disposeOp){case cs:break;case ds:for(let t=0;t<this._png.height;t++)for(let n=0;n<this._png.width;n++){const s=(t*e.width+n)*this._png.channels;for(let e=0;e<this._png.channels;e++)a.data[s+e]=0}break;case us:a.data.set(t.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(e,t){const a=1<<this._png.depth,n=(e,a)=>({index:((e+t.yOffset)*this._png.width+t.xOffset+a)*this._png.channels,frameIndex:(e*t.width+a)*this._png.channels});switch(t.blendOp){case hs:for(let a=0;a<t.height;a++)for(let s=0;s<t.width;s++){const{index:r,frameIndex:i}=n(a,s);for(let a=0;a<this._png.channels;a++)e.data[r+a]=t.data[i+a]}break;case ps:for(let s=0;s<t.height;s++)for(let r=0;r<t.width;r++){const{index:i,frameIndex:l}=n(s,r);for(let n=0;n<this._png.channels;n++){const s=t.data[l+this._png.channels-1]/a,r=n%(this._png.channels-1)===0?1:t.data[l+n],o=Math.floor(s*r+(1-s)*e.data[i+n]);e.data[i+n]+=o}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){var e;if(this._inflator.err)throw new Error("Error while decompressing the data: ".concat(this._inflator.err));const t=this._isAnimated?(null===(e=this._frames)||void 0===e?void 0:e.at(0)).data:this._inflator.result;if(this._filterMethod!==rs)throw new Error("Filter method ".concat(this._filterMethod," not supported"));if(this._interlaceMethod===ls)this._png.data=qn({data:t,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else{if(this._interlaceMethod!==os)throw new Error("Interlace method ".concat(this._interlaceMethod," not supported"));this._png.data=function(e){const{data:t,width:a,height:n,channels:s,depth:r}=e,i=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],l=Math.ceil(r/8)*s,o=new Uint8Array(n*a*l);let c=0;for(let d=0;d<7;d++){const e=i[d],s=Math.ceil((a-e.x)/e.xStep),r=Math.ceil((n-e.y)/e.yStep);if(s<=0||r<=0)continue;const u=s*l,h=new Uint8Array(u);for(let i=0;i<r;i++){const r=t[c++],d=t.subarray(c,c+u);c+=u;const p=new Uint8Array(u);Dn(r,d,p,h,u,l),h.set(p);for(let t=0;t<s;t++){const s=e.x+t*e.xStep,r=e.y+i*e.yStep;if(!(s>=a||r>=n))for(let e=0;e<l;e++)o[(r*a+s)*l+e]=p[t*l+e]}}}if(16===r){const e=new Uint16Array(o.buffer);if(Rn)for(let t=0;t<e.length;t++)e[t]=In(e[t]);return e}return o}({data:t,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth})}this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const e=this._inflator.result,t=this._frames.at(-1);t?t.data=e:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:cs,blendOp:hs,data:e}),this._inflator=new bn,this._writingDataChunks=!1}}a(9379);var ms;!function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.METRE=1]="METRE"}(ms||(ms={}));var xs=function(){return"undefined"!=typeof window?window:"undefined"!=typeof a.g?a.g:"undefined"!=typeof self?self:this}();function gs(){xs.console&&"function"==typeof xs.console.log&&xs.console.log.apply(xs.console,arguments)}var vs={log:gs,warn:function(e){xs.console&&("function"==typeof xs.console.warn?xs.console.warn.apply(xs.console,arguments):gs.call(null,arguments))},error:function(e){xs.console&&("function"==typeof xs.console.error?xs.console.error.apply(xs.console,arguments):gs(e))}};function ys(e,t,a){var n=new XMLHttpRequest;n.open("GET",e),n.responseType="blob",n.onload=function(){ws(n.response,t,a)},n.onerror=function(){vs.error("could not download file")},n.send()}function bs(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(a){}return t.status>=200&&t.status<=299}function js(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(a){var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var ws=xs.saveAs||("object"!==("undefined"==typeof window?"undefined":(0,n.A)(window))||window!==xs?function(){}:"undefined"!=typeof HTMLAnchorElement&&"download"in HTMLAnchorElement.prototype?function(e,t,a){var n=xs.URL||xs.webkitURL,s=document.createElement("a");t=t||e.name||"download",s.download=t,s.rel="noopener","string"==typeof e?(s.href=e,s.origin!==location.origin?bs(s.href)?ys(e,t,a):js(s,s.target="_blank"):js(s)):(s.href=n.createObjectURL(e),setTimeout(function(){n.revokeObjectURL(s.href)},4e4),setTimeout(function(){js(s)},0))}:"msSaveOrOpenBlob"in navigator?function(e,t,a){if(t=t||e.name||"download","string"==typeof e)if(bs(e))ys(e,t,a);else{var s=document.createElement("a");s.href=e,s.target="_blank",setTimeout(function(){js(s)})}else navigator.msSaveOrOpenBlob(function(e,t){return void 0===t?t={autoBom:!1}:"object"!==(0,n.A)(t)&&(vs.warn("Deprecated: Expected third argument to be a object"),t={autoBom:!t}),t.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob([String.fromCharCode(65279),e],{type:e.type}):e}(e,a),t)}:function(e,t,a,s){if((s=s||open("","_blank"))&&(s.document.title=s.document.body.innerText="downloading..."),"string"==typeof e)return ys(e,t,a);var r="application/octet-stream"===e.type,i=/constructor/i.test(xs.HTMLElement)||xs.safari,l=/CriOS\/[\d]+/.test(navigator.userAgent);if((l||r&&i)&&"object"===("undefined"==typeof FileReader?"undefined":(0,n.A)(FileReader))){var o=new FileReader;o.onloadend=function(){var e=o.result;e=l?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),s?s.location.href=e:location=e,s=null},o.readAsDataURL(e)}else{var c=xs.URL||xs.webkitURL,d=c.createObjectURL(e);s?s.location=d:location.href=d,s=null,setTimeout(function(){c.revokeObjectURL(d)},4e4)}});function Ns(e){var t;e=e||"",this.ok=!1,"#"==e.charAt(0)&&(e=e.substr(1,6)),e={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[e=(e=e.replace(/ /g,"")).toLowerCase()]||e;for(var a=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(e){return[parseInt(e[1]),parseInt(e[2]),parseInt(e[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(e){return[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(e){return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)]}}],n=0;n<a.length;n++){var s=a[n].re,r=a[n].process,i=s.exec(e);i&&(t=r(i),this.r=t[0],this.g=t[1],this.b=t[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var e=this.r.toString(16),t=this.g.toString(16),a=this.b.toString(16);return 1==e.length&&(e="0"+e),1==t.length&&(t="0"+t),1==a.length&&(a="0"+a),"#"+e+t+a}}var Ss=xs.atob.bind(xs),ks=xs.btoa.bind(xs);function As(e,t){var a=e[0],n=e[1],s=e[2],r=e[3];a=_s(a,n,s,r,t[0],7,-680876936),r=_s(r,a,n,s,t[1],12,-389564586),s=_s(s,r,a,n,t[2],17,606105819),n=_s(n,s,r,a,t[3],22,-1044525330),a=_s(a,n,s,r,t[4],7,-176418897),r=_s(r,a,n,s,t[5],12,1200080426),s=_s(s,r,a,n,t[6],17,-1473231341),n=_s(n,s,r,a,t[7],22,-45705983),a=_s(a,n,s,r,t[8],7,1770035416),r=_s(r,a,n,s,t[9],12,-1958414417),s=_s(s,r,a,n,t[10],17,-42063),n=_s(n,s,r,a,t[11],22,-1990404162),a=_s(a,n,s,r,t[12],7,1804603682),r=_s(r,a,n,s,t[13],12,-40341101),s=_s(s,r,a,n,t[14],17,-1502002290),a=Ls(a,n=_s(n,s,r,a,t[15],22,1236535329),s,r,t[1],5,-165796510),r=Ls(r,a,n,s,t[6],9,-1069501632),s=Ls(s,r,a,n,t[11],14,643717713),n=Ls(n,s,r,a,t[0],20,-373897302),a=Ls(a,n,s,r,t[5],5,-701558691),r=Ls(r,a,n,s,t[10],9,38016083),s=Ls(s,r,a,n,t[15],14,-660478335),n=Ls(n,s,r,a,t[4],20,-405537848),a=Ls(a,n,s,r,t[9],5,568446438),r=Ls(r,a,n,s,t[14],9,-1019803690),s=Ls(s,r,a,n,t[3],14,-187363961),n=Ls(n,s,r,a,t[8],20,1163531501),a=Ls(a,n,s,r,t[13],5,-1444681467),r=Ls(r,a,n,s,t[2],9,-51403784),s=Ls(s,r,a,n,t[7],14,1735328473),a=Ts(a,n=Ls(n,s,r,a,t[12],20,-1926607734),s,r,t[5],4,-378558),r=Ts(r,a,n,s,t[8],11,-2022574463),s=Ts(s,r,a,n,t[11],16,1839030562),n=Ts(n,s,r,a,t[14],23,-35309556),a=Ts(a,n,s,r,t[1],4,-1530992060),r=Ts(r,a,n,s,t[4],11,1272893353),s=Ts(s,r,a,n,t[7],16,-155497632),n=Ts(n,s,r,a,t[10],23,-1094730640),a=Ts(a,n,s,r,t[13],4,681279174),r=Ts(r,a,n,s,t[0],11,-358537222),s=Ts(s,r,a,n,t[3],16,-722521979),n=Ts(n,s,r,a,t[6],23,76029189),a=Ts(a,n,s,r,t[9],4,-640364487),r=Ts(r,a,n,s,t[12],11,-421815835),s=Ts(s,r,a,n,t[15],16,530742520),a=Es(a,n=Ts(n,s,r,a,t[2],23,-995338651),s,r,t[0],6,-198630844),r=Es(r,a,n,s,t[7],10,1126891415),s=Es(s,r,a,n,t[14],15,-1416354905),n=Es(n,s,r,a,t[5],21,-57434055),a=Es(a,n,s,r,t[12],6,1700485571),r=Es(r,a,n,s,t[3],10,-1894986606),s=Es(s,r,a,n,t[10],15,-1051523),n=Es(n,s,r,a,t[1],21,-2054922799),a=Es(a,n,s,r,t[8],6,1873313359),r=Es(r,a,n,s,t[15],10,-30611744),s=Es(s,r,a,n,t[6],15,-1560198380),n=Es(n,s,r,a,t[13],21,1309151649),a=Es(a,n,s,r,t[4],6,-145523070),r=Es(r,a,n,s,t[11],10,-1120210379),s=Es(s,r,a,n,t[2],15,718787259),n=Es(n,s,r,a,t[9],21,-343485551),e[0]=qs(a,e[0]),e[1]=qs(n,e[1]),e[2]=qs(s,e[2]),e[3]=qs(r,e[3])}function Cs(e,t,a,n,s,r){return t=qs(qs(t,e),qs(n,r)),qs(t<<s|t>>>32-s,a)}function _s(e,t,a,n,s,r,i){return Cs(t&a|~t&n,e,t,s,r,i)}function Ls(e,t,a,n,s,r,i){return Cs(t&n|a&~n,e,t,s,r,i)}function Ts(e,t,a,n,s,r,i){return Cs(t^a^n,e,t,s,r,i)}function Es(e,t,a,n,s,r,i){return Cs(a^(t|~n),e,t,s,r,i)}function Ds(e){var t,a=e.length,n=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=e.length;t+=64)As(n,Ps(e.substring(t-64,t)));e=e.substring(t-64);var s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<e.length;t++)s[t>>2]|=e.charCodeAt(t)<<(t%4<<3);if(s[t>>2]|=128<<(t%4<<3),t>55)for(As(n,s),t=0;t<16;t++)s[t]=0;return s[14]=8*a,As(n,s),n}function Ps(e){var t,a=[];for(t=0;t<64;t+=4)a[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return a}var Rs="0123456789abcdef".split("");function Is(e){for(var t="",a=0;a<4;a++)t+=Rs[e>>8*a+4&15]+Rs[e>>8*a&15];return t}function Bs(e){return String.fromCharCode(255&e,(65280&e)>>8,(16711680&e)>>16,(4278190080&e)>>24)}function Fs(e){return Ds(e).map(Bs).join("")}var Os="5d41402abc4b2a76b9719d911017c592"!=function(e){for(var t=0;t<e.length;t++)e[t]=Is(e[t]);return e.join("")}(Ds("hello"));function qs(e,t){if(Os){var a=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(a>>16)<<16|65535&a}return e+t&4294967295}function zs(e,t){var a,n,s,r;if(e!==a){for(var i=(s=e,r=1+(256/e.length|0),new Array(r+1).join(s)),l=[],o=0;o<256;o++)l[o]=o;var c=0;for(o=0;o<256;o++){var d=l[o];c=(c+d+i.charCodeAt(o))%256,l[o]=l[c],l[c]=d}a=e,n=l}else l=n;var u=t.length,h=0,p=0,f="";for(o=0;o<u;o++)p=(p+(d=l[h=(h+1)%256]))%256,l[h]=l[p],l[p]=d,i=l[(l[h]+l[p])%256],f+=String.fromCharCode(t.charCodeAt(o)^i);return f}var Ms={print:4,modify:8,copy:16,"annot-forms":32};function Us(e,t,a,n){this.v=1,this.r=2;var s=192;e.forEach(function(e){if(void 0!==Ms.perm)throw new Error("Invalid permission: "+e);s+=Ms[e]}),this.padding="(\xbfN^Nu\x8aAd\0NV\xff\xfa\x01\b..\0\xb6\xd0h>\x80/\f\xa9\xfedSiz";var r=(t+this.padding).substr(0,32),i=(a+this.padding).substr(0,32);this.O=this.processOwnerPassword(r,i),this.P=-(1+(255^s)),this.encryptionKey=Fs(r+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(n)).substr(0,5),this.U=zs(this.encryptionKey,this.padding)}function Ws(e){if(/[^\u0000-\u00ff]/.test(e))throw new Error("Invalid PDF Name Object: "+e+", Only accept ASCII characters.");for(var t="",a=e.length,n=0;n<a;n++){var s=e.charCodeAt(n);t+=s<33||35===s||37===s||40===s||41===s||47===s||60===s||62===s||91===s||93===s||123===s||125===s||s>126?"#"+("0"+s.toString(16)).slice(-2):e[n]}return t}function Hs(e){if("object"!==(0,n.A)(e))throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var t={};this.subscribe=function(e,a,n){if(n=n||!1,"string"!=typeof e||"function"!=typeof a||"boolean"!=typeof n)throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");t.hasOwnProperty(e)||(t[e]={});var s=Math.random().toString(35);return t[e][s]=[a,!!n],s},this.unsubscribe=function(e){for(var a in t)if(t[a][e])return delete t[a][e],0===Object.keys(t[a]).length&&delete t[a],!0;return!1},this.publish=function(a){if(t.hasOwnProperty(a)){var n=Array.prototype.slice.call(arguments,1),s=[];for(var r in t[a]){var i=t[a][r];try{i[0].apply(e,n)}catch(js){xs.console&&vs.error("jsPDF PubSub Error",js.message,js)}i[1]&&s.push(r)}s.length&&s.forEach(this.unsubscribe)}},this.getTopics=function(){return t}}function Vs(e){if(!(this instanceof Vs))return new Vs(e);var t="opacity,stroke-opacity".split(",");for(var a in e)e.hasOwnProperty(a)&&t.indexOf(a)>=0&&(this[a]=e[a]);this.id="",this.objectNumber=-1}function Gs(e,t){this.gState=e,this.matrix=t,this.id="",this.objectNumber=-1}function Js(e,t,a,n,s){if(!(this instanceof Js))return new Js(e,t,a,n,s);this.type="axial"===e?2:3,this.coords=t,this.colors=a,Gs.call(this,n,s)}function Ys(e,t,a,n,s){if(!(this instanceof Ys))return new Ys(e,t,a,n,s);this.boundingBox=e,this.xStep=t,this.yStep=a,this.stream="",this.cloneIndex=0,Gs.call(this,n,s)}function Ks(e){var t,a="string"==typeof arguments[0]?arguments[0]:"p",s=arguments[1],r=arguments[2],i=arguments[3],l=[],o=1,c=16,d="S",u=null;"object"===(0,n.A)(e=e||{})&&(a=e.orientation,s=e.unit||s,r=e.format||r,i=e.compress||e.compressPdf||i,null!==(u=e.encryption||null)&&(u.userPassword=u.userPassword||"",u.ownerPassword=u.ownerPassword||"",u.userPermissions=u.userPermissions||[]),o="number"==typeof e.userUnit?Math.abs(e.userUnit):1,void 0!==e.precision&&(t=e.precision),void 0!==e.floatPrecision&&(c=e.floatPrecision),d=e.defaultPathOperation||"S"),l=e.filters||(!0===i?["FlateEncode"]:l),s=s||"mm",a=(""+(a||"P")).toLowerCase();var h=e.putOnlyUsedFonts||!1,p={},f={internal:{},__private__:{}};f.__private__.PubSub=Hs;var m="1.3",x=f.__private__.getPdfVersion=function(){return m};f.__private__.setPdfVersion=function(e){m=e};var g={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};f.__private__.getPageFormats=function(){return g};var v=f.__private__.getPageFormat=function(e){return g[e]};r=r||"a4";var y="compat",b="advanced",j=y;function w(){this.saveGraphicsState(),X(new De(pe,0,0,-pe,0,pa()*pe).toString()+" cm"),this.setFontSize(this.getFontSize()/pe),d="n",j=b}function N(){this.restoreGraphicsState(),d="S",j=y}var S=f.__private__.combineFontStyleAndFontWeight=function(e,t){if("bold"==e&&"normal"==t||"bold"==e&&400==t||"normal"==e&&"italic"==t||"bold"==e&&"italic"==t)throw new Error("Invalid Combination of fontweight and fontstyle");return t&&(e=400==t||"normal"===t?"italic"===e?"italic":"normal":700!=t&&"bold"!==t||"normal"!==e?(700==t?"bold":t)+""+e:"bold"),e};f.advancedAPI=function(e){var t=j===y;return t&&w.call(this),"function"!=typeof e||(e(this),t&&N.call(this)),this},f.compatAPI=function(e){var t=j===b;return t&&N.call(this),"function"!=typeof e||(e(this),t&&w.call(this)),this},f.isAdvancedAPI=function(){return j===b};var k,A=function(e){if(j!==b)throw new Error(e+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},C=f.roundToPrecision=f.__private__.roundToPrecision=function(e,a){var n=t||a;if(isNaN(e)||isNaN(n))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return e.toFixed(n).replace(/0+$/,"")};k=f.hpf=f.__private__.hpf="number"==typeof c?function(e){if(isNaN(e))throw new Error("Invalid argument passed to jsPDF.hpf");return C(e,c)}:"smart"===c?function(e){if(isNaN(e))throw new Error("Invalid argument passed to jsPDF.hpf");return C(e,e>-1&&e<1?16:5)}:function(e){if(isNaN(e))throw new Error("Invalid argument passed to jsPDF.hpf");return C(e,16)};var _=f.f2=f.__private__.f2=function(e){if(isNaN(e))throw new Error("Invalid argument passed to jsPDF.f2");return C(e,2)},L=f.__private__.f3=function(e){if(isNaN(e))throw new Error("Invalid argument passed to jsPDF.f3");return C(e,3)},T=f.scale=f.__private__.scale=function(e){if(isNaN(e))throw new Error("Invalid argument passed to jsPDF.scale");return j===y?e*pe:j===b?e:void 0},E=function(e){return T(function(e){return j===y?pa()-e:j===b?e:void 0}(e))};f.__private__.setPrecision=f.setPrecision=function(e){"number"==typeof parseInt(e,10)&&(t=parseInt(e,10))};var D,P="00000000000000000000000000000000",R=f.__private__.getFileId=function(){return P},I=f.__private__.setFileId=function(e){return P=void 0!==e&&/^[a-fA-F0-9]{32}$/.test(e)?e.toUpperCase():P.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),null!==u&&(yt=new Us(u.userPermissions,u.userPassword,u.ownerPassword,P)),P};f.setFileId=function(e){return I(e),this},f.getFileId=function(){return R()};var B=f.__private__.convertDateToPDFDate=function(e){var t=e.getTimezoneOffset(),a=t<0?"+":"-",n=Math.floor(Math.abs(t/60)),s=Math.abs(t%60),r=[a,M(n),"'",M(s),"'"].join("");return["D:",e.getFullYear(),M(e.getMonth()+1),M(e.getDate()),M(e.getHours()),M(e.getMinutes()),M(e.getSeconds()),r].join("")},F=f.__private__.convertPDFDateToDate=function(e){var t=parseInt(e.substr(2,4),10),a=parseInt(e.substr(6,2),10)-1,n=parseInt(e.substr(8,2),10),s=parseInt(e.substr(10,2),10),r=parseInt(e.substr(12,2),10),i=parseInt(e.substr(14,2),10);return new Date(t,a,n,s,r,i,0)},O=f.__private__.setCreationDate=function(e){var t;if(void 0===e&&(e=new Date),e instanceof Date)t=B(e);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(e))throw new Error("Invalid argument passed to jsPDF.setCreationDate");t=e}return D=t},q=f.__private__.getCreationDate=function(e){var t=D;return"jsDate"===e&&(t=F(D)),t};f.setCreationDate=function(e){return O(e),this},f.getCreationDate=function(e){return q(e)};var z,M=f.__private__.padd2=function(e){return("0"+parseInt(e)).slice(-2)},U=f.__private__.padd2Hex=function(e){return("00"+(e=e.toString())).substr(e.length)},W=0,H=[],V=[],G=0,J=[],Y=[],K=!1,Q=V;f.__private__.setCustomOutputDestination=function(e){K=!0,Q=e};var $=function(e){K||(Q=e)};f.__private__.resetCustomOutputDestination=function(){K=!1,Q=V};var X=f.__private__.out=function(e){return e=e.toString(),G+=e.length+1,Q.push(e),Q},Z=f.__private__.write=function(e){return X(1===arguments.length?e.toString():Array.prototype.join.call(arguments," "))},ee=f.__private__.getArrayBuffer=function(e){for(var t=e.length,a=new ArrayBuffer(t),n=new Uint8Array(a);t--;)n[t]=e.charCodeAt(t);return a},te=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];f.__private__.getStandardFonts=function(){return te};var ae=e.fontSize||16;f.__private__.setFontSize=f.setFontSize=function(e){return ae=j===b?e/pe:e,this};var ne,se=f.__private__.getFontSize=f.getFontSize=function(){return j===y?ae:ae*pe},re=e.R2L||!1;f.__private__.setR2L=f.setR2L=function(e){return re=e,this},f.__private__.getR2L=f.getR2L=function(){return re};var ie,le=f.__private__.setZoomMode=function(e){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(e))ne=e;else if(isNaN(e)){if(-1===[void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(e))throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+e+'" is not recognized.');ne=e}else ne=parseInt(e,10)};f.__private__.getZoomMode=function(){return ne};var oe,ce=f.__private__.setPageMode=function(e){if(-1==[void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(e))throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+e+'" is not recognized.');ie=e};f.__private__.getPageMode=function(){return ie};var de=f.__private__.setLayoutMode=function(e){if(-1==[void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(e))throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+e+'" is not recognized.');oe=e};f.__private__.getLayoutMode=function(){return oe},f.__private__.setDisplayMode=f.setDisplayMode=function(e,t,a){return le(e),de(t),ce(a),this};var ue={title:"",subject:"",author:"",keywords:"",creator:""};f.__private__.getDocumentProperty=function(e){if(-1===Object.keys(ue).indexOf(e))throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return ue[e]},f.__private__.getDocumentProperties=function(){return ue},f.__private__.setDocumentProperties=f.setProperties=f.setDocumentProperties=function(e){for(var t in ue)ue.hasOwnProperty(t)&&e[t]&&(ue[t]=e[t]);return this},f.__private__.setDocumentProperty=function(e,t){if(-1===Object.keys(ue).indexOf(e))throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return ue[e]=t};var he,pe,fe,me,xe,ge={},ve={},ye=[],be={},je={},we={},Ne={},Se=null,ke=0,Ae=[],Ce=new Hs(f),_e=e.hotfixes||[],Le={},Te={},Ee=[],De=function e(t,a,n,s,r,i){if(!(this instanceof e))return new e(t,a,n,s,r,i);isNaN(t)&&(t=1),isNaN(a)&&(a=0),isNaN(n)&&(n=0),isNaN(s)&&(s=1),isNaN(r)&&(r=0),isNaN(i)&&(i=0),this._matrix=[t,a,n,s,r,i]};Object.defineProperty(De.prototype,"sx",{get:function(){return this._matrix[0]},set:function(e){this._matrix[0]=e}}),Object.defineProperty(De.prototype,"shy",{get:function(){return this._matrix[1]},set:function(e){this._matrix[1]=e}}),Object.defineProperty(De.prototype,"shx",{get:function(){return this._matrix[2]},set:function(e){this._matrix[2]=e}}),Object.defineProperty(De.prototype,"sy",{get:function(){return this._matrix[3]},set:function(e){this._matrix[3]=e}}),Object.defineProperty(De.prototype,"tx",{get:function(){return this._matrix[4]},set:function(e){this._matrix[4]=e}}),Object.defineProperty(De.prototype,"ty",{get:function(){return this._matrix[5]},set:function(e){this._matrix[5]=e}}),Object.defineProperty(De.prototype,"a",{get:function(){return this._matrix[0]},set:function(e){this._matrix[0]=e}}),Object.defineProperty(De.prototype,"b",{get:function(){return this._matrix[1]},set:function(e){this._matrix[1]=e}}),Object.defineProperty(De.prototype,"c",{get:function(){return this._matrix[2]},set:function(e){this._matrix[2]=e}}),Object.defineProperty(De.prototype,"d",{get:function(){return this._matrix[3]},set:function(e){this._matrix[3]=e}}),Object.defineProperty(De.prototype,"e",{get:function(){return this._matrix[4]},set:function(e){this._matrix[4]=e}}),Object.defineProperty(De.prototype,"f",{get:function(){return this._matrix[5]},set:function(e){this._matrix[5]=e}}),Object.defineProperty(De.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(De.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(De.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(De.prototype,"isIdentity",{get:function(){return 1===this.sx&&0===this.shy&&0===this.shx&&1===this.sy&&0===this.tx&&0===this.ty}}),De.prototype.join=function(e){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(k).join(e)},De.prototype.multiply=function(e){var t=e.sx*this.sx+e.shy*this.shx,a=e.sx*this.shy+e.shy*this.sy,n=e.shx*this.sx+e.sy*this.shx,s=e.shx*this.shy+e.sy*this.sy,r=e.tx*this.sx+e.ty*this.shx+this.tx,i=e.tx*this.shy+e.ty*this.sy+this.ty;return new De(t,a,n,s,r,i)},De.prototype.decompose=function(){var e=this.sx,t=this.shy,a=this.shx,n=this.sy,s=this.tx,r=this.ty,i=Math.sqrt(e*e+t*t),l=(e/=i)*a+(t/=i)*n;a-=e*l,n-=t*l;var o=Math.sqrt(a*a+n*n);return l/=o,e*(n/=o)<t*(a/=o)&&(e=-e,t=-t,l=-l,i=-i),{scale:new De(i,0,0,o,0,0),translate:new De(1,0,0,1,s,r),rotate:new De(e,t,-t,e,0,0),skew:new De(1,0,l,1,0,0)}},De.prototype.toString=function(e){return this.join(" ")},De.prototype.inversed=function(){var e=this.sx,t=this.shy,a=this.shx,n=this.sy,s=this.tx,r=this.ty,i=1/(e*n-t*a),l=n*i,o=-t*i,c=-a*i,d=e*i;return new De(l,o,c,d,-l*s-c*r,-o*s-d*r)},De.prototype.applyToPoint=function(e){var t=e.x*this.sx+e.y*this.shx+this.tx,a=e.x*this.shy+e.y*this.sy+this.ty;return new aa(t,a)},De.prototype.applyToRectangle=function(e){var t=this.applyToPoint(e),a=this.applyToPoint(new aa(e.x+e.w,e.y+e.h));return new na(t.x,t.y,a.x-t.x,a.y-t.y)},De.prototype.clone=function(){var e=this.sx,t=this.shy,a=this.shx,n=this.sy,s=this.tx,r=this.ty;return new De(e,t,a,n,s,r)},f.Matrix=De;var Pe=f.matrixMult=function(e,t){return t.multiply(e)},Re=new De(1,0,0,1,0,0);f.unitMatrix=f.identityMatrix=Re;var Ie=function(e,t){if(!je[e]){var a=(t instanceof Js?"Sh":"P")+(Object.keys(be).length+1).toString(10);t.id=a,je[e]=a,be[a]=t,Ce.publish("addPattern",t)}};f.ShadingPattern=Js,f.TilingPattern=Ys,f.addShadingPattern=function(e,t){return A("addShadingPattern()"),Ie(e,t),this},f.beginTilingPattern=function(e){A("beginTilingPattern()"),ra(e.boundingBox[0],e.boundingBox[1],e.boundingBox[2]-e.boundingBox[0],e.boundingBox[3]-e.boundingBox[1],e.matrix)},f.endTilingPattern=function(e,t){A("endTilingPattern()"),t.stream=Y[z].join("\n"),Ie(e,t),Ce.publish("endTilingPattern",t),Ee.pop().restore()};var Be,Fe=f.__private__.newObject=function(){var e=Oe();return qe(e,!0),e},Oe=f.__private__.newObjectDeferred=function(){return W++,H[W]=function(){return G},W},qe=function(e,t){return t="boolean"==typeof t&&t,H[e]=G,t&&X(e+" 0 obj"),e},ze=f.__private__.newAdditionalObject=function(){var e={objId:Oe(),content:""};return J.push(e),e},Me=Oe(),Ue=Oe(),We=f.__private__.decodeColorString=function(e){var t=e.split(" ");if(2!==t.length||"g"!==t[1]&&"G"!==t[1])5!==t.length||"k"!==t[4]&&"K"!==t[4]||(t=[(1-t[0])*(1-t[3]),(1-t[1])*(1-t[3]),(1-t[2])*(1-t[3]),"r"]);else{var a=parseFloat(t[0]);t=[a,a,a,"r"]}for(var n="#",s=0;s<3;s++)n+=("0"+Math.floor(255*parseFloat(t[s])).toString(16)).slice(-2);return n},He=f.__private__.encodeColorString=function(e){var t;"string"==typeof e&&(e={ch1:e});var a=e.ch1,s=e.ch2,r=e.ch3,i=e.ch4,l="draw"===e.pdfColorType?["G","RG","K"]:["g","rg","k"];if("string"==typeof a&&"#"!==a.charAt(0)){var o=new Ns(a);if(o.ok)a=o.toHex();else if(!/^\d*\.?\d*$/.test(a))throw new Error('Invalid color "'+a+'" passed to jsPDF.encodeColorString.')}if("string"==typeof a&&/^#[0-9A-Fa-f]{3}$/.test(a)&&(a="#"+a[1]+a[1]+a[2]+a[2]+a[3]+a[3]),"string"==typeof a&&/^#[0-9A-Fa-f]{6}$/.test(a)){var c=parseInt(a.substr(1),16);a=c>>16&255,s=c>>8&255,r=255&c}if(void 0===s||void 0===i&&a===s&&s===r)t="string"==typeof a?a+" "+l[0]:2===e.precision?_(a/255)+" "+l[0]:L(a/255)+" "+l[0];else if(void 0===i||"object"===(0,n.A)(i)){if(i&&!isNaN(i.a)&&0===i.a)return["1.","1.","1.",l[1]].join(" ");t="string"==typeof a?[a,s,r,l[1]].join(" "):2===e.precision?[_(a/255),_(s/255),_(r/255),l[1]].join(" "):[L(a/255),L(s/255),L(r/255),l[1]].join(" ")}else t="string"==typeof a?[a,s,r,i,l[2]].join(" "):2===e.precision?[_(a),_(s),_(r),_(i),l[2]].join(" "):[L(a),L(s),L(r),L(i),l[2]].join(" ");return t},Ve=f.__private__.getFilters=function(){return l},Ge=f.__private__.putStream=function(e){var t=(e=e||{}).data||"",a=e.filters||Ve(),n=e.alreadyAppliedFilters||[],s=e.addLength1||!1,r=t.length,i=e.objectId,l=function(e){return e};if(null!==u&&void 0===i)throw new Error("ObjectId must be passed to putStream for file encryption");null!==u&&(l=yt.encryptor(i,0));var o={};!0===a&&(a=["FlateEncode"]);var c=e.additionalKeyValues||[],d=(o=void 0!==Ks.API.processDataByFilters?Ks.API.processDataByFilters(t,a):{data:t,reverseChain:[]}).reverseChain+(Array.isArray(n)?n.join(" "):n.toString());if(0!==o.data.length&&(c.push({key:"Length",value:o.data.length}),!0===s&&c.push({key:"Length1",value:r})),0!=d.length)if(d.split("/").length-1==1)c.push({key:"Filter",value:d});else{c.push({key:"Filter",value:"["+d+"]"});for(var h=0;h<c.length;h+=1)if("DecodeParms"===c[h].key){for(var p=[],f=0;f<o.reverseChain.split("/").length-1;f+=1)p.push("null");p.push(c[h].value),c[h].value="["+p.join(" ")+"]"}}X("<<");for(var m=0;m<c.length;m++)X("/"+c[m].key+" "+c[m].value);X(">>"),0!==o.data.length&&(X("stream"),X(l(o.data)),X("endstream"))},Je=f.__private__.putPage=function(e){var t=e.number,a=e.data,n=e.objId,s=e.contentsObjId;qe(n,!0),X("<</Type /Page"),X("/Parent "+e.rootDictionaryObjId+" 0 R"),X("/Resources "+e.resourceDictionaryObjId+" 0 R"),X("/MediaBox ["+parseFloat(k(e.mediaBox.bottomLeftX))+" "+parseFloat(k(e.mediaBox.bottomLeftY))+" "+k(e.mediaBox.topRightX)+" "+k(e.mediaBox.topRightY)+"]"),null!==e.cropBox&&X("/CropBox ["+k(e.cropBox.bottomLeftX)+" "+k(e.cropBox.bottomLeftY)+" "+k(e.cropBox.topRightX)+" "+k(e.cropBox.topRightY)+"]"),null!==e.bleedBox&&X("/BleedBox ["+k(e.bleedBox.bottomLeftX)+" "+k(e.bleedBox.bottomLeftY)+" "+k(e.bleedBox.topRightX)+" "+k(e.bleedBox.topRightY)+"]"),null!==e.trimBox&&X("/TrimBox ["+k(e.trimBox.bottomLeftX)+" "+k(e.trimBox.bottomLeftY)+" "+k(e.trimBox.topRightX)+" "+k(e.trimBox.topRightY)+"]"),null!==e.artBox&&X("/ArtBox ["+k(e.artBox.bottomLeftX)+" "+k(e.artBox.bottomLeftY)+" "+k(e.artBox.topRightX)+" "+k(e.artBox.topRightY)+"]"),"number"==typeof e.userUnit&&1!==e.userUnit&&X("/UserUnit "+e.userUnit),Ce.publish("putPage",{objId:n,pageContext:Ae[t],pageNumber:t,page:a}),X("/Contents "+s+" 0 R"),X(">>"),X("endobj");var r=a.join("\n");return j===b&&(r+="\nQ"),qe(s,!0),Ge({data:r,filters:Ve(),objectId:s}),X("endobj"),n},Ye=f.__private__.putPages=function(){var e,t,a=[];for(e=1;e<=ke;e++)Ae[e].objId=Oe(),Ae[e].contentsObjId=Oe();for(e=1;e<=ke;e++)a.push(Je({number:e,data:Y[e],objId:Ae[e].objId,contentsObjId:Ae[e].contentsObjId,mediaBox:Ae[e].mediaBox,cropBox:Ae[e].cropBox,bleedBox:Ae[e].bleedBox,trimBox:Ae[e].trimBox,artBox:Ae[e].artBox,userUnit:Ae[e].userUnit,rootDictionaryObjId:Me,resourceDictionaryObjId:Ue}));qe(Me,!0),X("<</Type /Pages");var n="/Kids [";for(t=0;t<ke;t++)n+=a[t]+" 0 R ";X(n+"]"),X("/Count "+ke),X(">>"),X("endobj"),Ce.publish("postPutPages")},Ke=function(e){Ce.publish("putFont",{font:e,out:X,newObject:Fe,putStream:Ge}),!0!==e.isAlreadyPutted&&(e.objectNumber=Fe(),X("<<"),X("/Type /Font"),X("/BaseFont /"+Ws(e.postScriptName)),X("/Subtype /Type1"),"string"==typeof e.encoding&&X("/Encoding /"+e.encoding),X("/FirstChar 32"),X("/LastChar 255"),X(">>"),X("endobj"))},Qe=function(e){e.objectNumber=Fe();var t=[];t.push({key:"Type",value:"/XObject"}),t.push({key:"Subtype",value:"/Form"}),t.push({key:"BBox",value:"["+[k(e.x),k(e.y),k(e.x+e.width),k(e.y+e.height)].join(" ")+"]"}),t.push({key:"Matrix",value:"["+e.matrix.toString()+"]"});var a=e.pages[1].join("\n");Ge({data:a,additionalKeyValues:t,objectId:e.objectNumber}),X("endobj")},$e=function(e,t){t||(t=21);var a=Fe(),n=function(e,t){var a,n=[],s=1/(t-1);for(a=0;a<1;a+=s)n.push(a);if(n.push(1),0!=e[0].offset){var r={offset:0,color:e[0].color};e.unshift(r)}if(1!=e[e.length-1].offset){var i={offset:1,color:e[e.length-1].color};e.push(i)}for(var l="",o=0,c=0;c<n.length;c++){for(a=n[c];a>e[o+1].offset;)o++;var d=e[o].offset,u=(a-d)/(e[o+1].offset-d),h=e[o].color,p=e[o+1].color;l+=U(Math.round((1-u)*h[0]+u*p[0]).toString(16))+U(Math.round((1-u)*h[1]+u*p[1]).toString(16))+U(Math.round((1-u)*h[2]+u*p[2]).toString(16))}return l.trim()}(e.colors,t),s=[];s.push({key:"FunctionType",value:"0"}),s.push({key:"Domain",value:"[0.0 1.0]"}),s.push({key:"Size",value:"["+t+"]"}),s.push({key:"BitsPerSample",value:"8"}),s.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),s.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Ge({data:n,additionalKeyValues:s,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:a}),X("endobj"),e.objectNumber=Fe(),X("<< /ShadingType "+e.type),X("/ColorSpace /DeviceRGB");var r="/Coords ["+k(parseFloat(e.coords[0]))+" "+k(parseFloat(e.coords[1]))+" ";2===e.type?r+=k(parseFloat(e.coords[2]))+" "+k(parseFloat(e.coords[3])):r+=k(parseFloat(e.coords[2]))+" "+k(parseFloat(e.coords[3]))+" "+k(parseFloat(e.coords[4]))+" "+k(parseFloat(e.coords[5])),X(r+="]"),e.matrix&&X("/Matrix ["+e.matrix.toString()+"]"),X("/Function "+a+" 0 R"),X("/Extend [true true]"),X(">>"),X("endobj")},Xe=function(e,t){var a=Oe(),n=Fe();t.push({resourcesOid:a,objectOid:n}),e.objectNumber=n;var s=[];s.push({key:"Type",value:"/Pattern"}),s.push({key:"PatternType",value:"1"}),s.push({key:"PaintType",value:"1"}),s.push({key:"TilingType",value:"1"}),s.push({key:"BBox",value:"["+e.boundingBox.map(k).join(" ")+"]"}),s.push({key:"XStep",value:k(e.xStep)}),s.push({key:"YStep",value:k(e.yStep)}),s.push({key:"Resources",value:a+" 0 R"}),e.matrix&&s.push({key:"Matrix",value:"["+e.matrix.toString()+"]"}),Ge({data:e.stream,additionalKeyValues:s,objectId:e.objectNumber}),X("endobj")},Ze=function(e){for(var t in e.objectNumber=Fe(),X("<<"),e)switch(t){case"opacity":X("/ca "+_(e[t]));break;case"stroke-opacity":X("/CA "+_(e[t]))}X(">>"),X("endobj")},et=function(e){qe(e.resourcesOid,!0),X("<<"),X("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),function(){for(var e in X("/Font <<"),ge)ge.hasOwnProperty(e)&&(!1===h||!0===h&&p.hasOwnProperty(e))&&X("/"+e+" "+ge[e].objectNumber+" 0 R");X(">>")}(),function(){if(Object.keys(be).length>0){for(var e in X("/Shading <<"),be)be.hasOwnProperty(e)&&be[e]instanceof Js&&be[e].objectNumber>=0&&X("/"+e+" "+be[e].objectNumber+" 0 R");Ce.publish("putShadingPatternDict"),X(">>")}}(),function(e){if(Object.keys(be).length>0){for(var t in X("/Pattern <<"),be)be.hasOwnProperty(t)&&be[t]instanceof f.TilingPattern&&be[t].objectNumber>=0&&be[t].objectNumber<e&&X("/"+t+" "+be[t].objectNumber+" 0 R");Ce.publish("putTilingPatternDict"),X(">>")}}(e.objectOid),function(){if(Object.keys(we).length>0){var e;for(e in X("/ExtGState <<"),we)we.hasOwnProperty(e)&&we[e].objectNumber>=0&&X("/"+e+" "+we[e].objectNumber+" 0 R");Ce.publish("putGStateDict"),X(">>")}}(),function(){for(var e in X("/XObject <<"),Le)Le.hasOwnProperty(e)&&Le[e].objectNumber>=0&&X("/"+e+" "+Le[e].objectNumber+" 0 R");Ce.publish("putXobjectDict"),X(">>")}(),X(">>"),X("endobj")},tt=function(e){ve[e.fontName]=ve[e.fontName]||{},ve[e.fontName][e.fontStyle]=e.id},at=function(e,t,a,n,s){var r={id:"F"+(Object.keys(ge).length+1).toString(10),postScriptName:e,fontName:t,fontStyle:a,encoding:n,isStandardFont:s||!1,metadata:{}};return Ce.publish("addFont",{font:r,instance:this}),ge[r.id]=r,tt(r),r.id},nt=f.__private__.pdfEscape=f.pdfEscape=function(e,t){return function(e,t){var a,n,s,r,i,l,o,c,d;if(s=(t=t||{}).sourceEncoding||"Unicode",i=t.outputEncoding,(t.autoencode||i)&&ge[he].metadata&&ge[he].metadata[s]&&ge[he].metadata[s].encoding&&(r=ge[he].metadata[s].encoding,!i&&ge[he].encoding&&(i=ge[he].encoding),!i&&r.codePages&&(i=r.codePages[0]),"string"==typeof i&&(i=r[i]),i)){for(o=!1,l=[],a=0,n=e.length;a<n;a++)(c=i[e.charCodeAt(a)])?l.push(String.fromCharCode(c)):l.push(e[a]),l[a].charCodeAt(0)>>8&&(o=!0);e=l.join("")}for(a=e.length;void 0===o&&0!==a;)e.charCodeAt(a-1)>>8&&(o=!0),a--;if(!o)return e;for(l=t.noBOM?[]:[254,255],a=0,n=e.length;a<n;a++){if((d=(c=e.charCodeAt(a))>>8)>>8)throw new Error("Character at position "+a+" of string '"+e+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");l.push(d),l.push(c-(d<<8))}return String.fromCharCode.apply(void 0,l)}(e,t).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},st=f.__private__.beginPage=function(e){Y[++ke]=[],Ae[ke]={objId:0,contentsObjId:0,userUnit:Number(o),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(e[0]),topRightY:Number(e[1])}},lt(ke),$(Y[z])},rt=function(e,t){var n,s,i;switch(a=t||a,"string"==typeof e&&(n=v(e.toLowerCase()),Array.isArray(n)&&(s=n[0],i=n[1])),Array.isArray(e)&&(s=e[0]*pe,i=e[1]*pe),isNaN(s)&&(s=r[0],i=r[1]),(s>14400||i>14400)&&(vs.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),s=Math.min(14400,s),i=Math.min(14400,i)),r=[s,i],a.substr(0,1)){case"l":i>s&&(r=[i,s]);break;case"p":s>i&&(r=[i,s])}st(r),qt(Ft),X(Jt),0!==Zt&&X(Zt+" J"),0!==ea&&X(ea+" j"),Ce.publish("addPage",{pageNumber:ke})},it=function(e){e>0&&e<=ke&&(Y.splice(e,1),Ae.splice(e,1),ke--,z>ke&&(z=ke),this.setPage(z))},lt=function(e){e>0&&e<=ke&&(z=e)},ot=f.__private__.getNumberOfPages=f.getNumberOfPages=function(){return Y.length-1},ct=function(e,t,a){var n,s=void 0;return a=a||{},e=void 0!==e?e:ge[he].fontName,t=void 0!==t?t:ge[he].fontStyle,n=e.toLowerCase(),void 0!==ve[n]&&void 0!==ve[n][t]?s=ve[n][t]:void 0!==ve[e]&&void 0!==ve[e][t]?s=ve[e][t]:!1===a.disableWarning&&vs.warn("Unable to look up font label for font '"+e+"', '"+t+"'. Refer to getFontList() for available fonts."),s||a.noFallback||null==(s=ve.times[t])&&(s=ve.times.normal),s},dt=f.__private__.putInfo=function(){var e=Fe(),t=function(e){return e};for(var a in null!==u&&(t=yt.encryptor(e,0)),X("<<"),X("/Producer ("+nt(t("jsPDF "+Ks.version))+")"),ue)ue.hasOwnProperty(a)&&ue[a]&&X("/"+a.substr(0,1).toUpperCase()+a.substr(1)+" ("+nt(t(ue[a]))+")");X("/CreationDate ("+nt(t(D))+")"),X(">>"),X("endobj")},ut=f.__private__.putCatalog=function(e){var t=(e=e||{}).rootDictionaryObjId||Me;switch(Fe(),X("<<"),X("/Type /Catalog"),X("/Pages "+t+" 0 R"),ne||(ne="fullwidth"),ne){case"fullwidth":X("/OpenAction [3 0 R /FitH null]");break;case"fullheight":X("/OpenAction [3 0 R /FitV null]");break;case"fullpage":X("/OpenAction [3 0 R /Fit]");break;case"original":X("/OpenAction [3 0 R /XYZ null null 1]");break;default:var a=""+ne;"%"===a.substr(a.length-1)&&(ne=parseInt(ne)/100),"number"==typeof ne&&X("/OpenAction [3 0 R /XYZ null null "+_(ne)+"]")}switch(oe||(oe="continuous"),oe){case"continuous":X("/PageLayout /OneColumn");break;case"single":X("/PageLayout /SinglePage");break;case"two":case"twoleft":X("/PageLayout /TwoColumnLeft");break;case"tworight":X("/PageLayout /TwoColumnRight")}ie&&X("/PageMode /"+ie),Ce.publish("putCatalog"),X(">>"),X("endobj")},ht=f.__private__.putTrailer=function(){X("trailer"),X("<<"),X("/Size "+(W+1)),X("/Root "+W+" 0 R"),X("/Info "+(W-1)+" 0 R"),null!==u&&X("/Encrypt "+yt.oid+" 0 R"),X("/ID [ <"+P+"> <"+P+"> ]"),X(">>")},pt=f.__private__.putHeader=function(){X("%PDF-"+m),X("%\xba\xdf\xac\xe0")},ft=f.__private__.putXRef=function(){var e="0000000000";X("xref"),X("0 "+(W+1)),X("0000000000 65535 f ");for(var t=1;t<=W;t++)"function"==typeof H[t]?X((e+H[t]()).slice(-10)+" 00000 n "):void 0!==H[t]?X((e+H[t]).slice(-10)+" 00000 n "):X("0000000000 00000 n ")},mt=f.__private__.buildDocument=function(){var e;W=0,G=0,V=[],H=[],J=[],Me=Oe(),Ue=Oe(),$(V),Ce.publish("buildDocument"),pt(),Ye(),function(){Ce.publish("putAdditionalObjects");for(var e=0;e<J.length;e++){var t=J[e];qe(t.objId,!0),X(t.content),X("endobj")}Ce.publish("postPutAdditionalObjects")}(),e=[],function(){for(var e in ge)ge.hasOwnProperty(e)&&(!1===h||!0===h&&p.hasOwnProperty(e))&&Ke(ge[e])}(),function(){var e;for(e in we)we.hasOwnProperty(e)&&Ze(we[e])}(),function(){for(var e in Le)Le.hasOwnProperty(e)&&Qe(Le[e])}(),function(e){var t;for(t in be)be.hasOwnProperty(t)&&(be[t]instanceof Js?$e(be[t]):be[t]instanceof Ys&&Xe(be[t],e))}(e),Ce.publish("putResources"),e.forEach(et),et({resourcesOid:Ue,objectOid:Number.MAX_SAFE_INTEGER}),Ce.publish("postPutResources"),null!==u&&(yt.oid=Fe(),X("<<"),X("/Filter /Standard"),X("/V "+yt.v),X("/R "+yt.r),X("/U <"+yt.toHexString(yt.U)+">"),X("/O <"+yt.toHexString(yt.O)+">"),X("/P "+yt.P),X(">>"),X("endobj")),dt(),ut();var t=G;return ft(),ht(),X("startxref"),X(""+t),X("%%EOF"),$(Y[z]),V.join("\n")},xt=f.__private__.getBlob=function(e){return new Blob([ee(e)],{type:"application/pdf"})},gt=f.output=f.__private__.output=(Be=function(e,t){switch("string"==typeof(t=t||{})?t={filename:t}:t.filename=t.filename||"generated.pdf",e){case void 0:return mt();case"save":f.save(t.filename);break;case"arraybuffer":return ee(mt());case"blob":return xt(mt());case"bloburi":case"bloburl":if(void 0!==xs.URL&&"function"==typeof xs.URL.createObjectURL)return xs.URL&&xs.URL.createObjectURL(xt(mt()))||void 0;vs.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var a="",n=mt();try{a=ks(n)}catch(u){a=ks(unescape(encodeURIComponent(n)))}return"data:application/pdf;filename="+t.filename+";base64,"+a;case"pdfobjectnewwindow":if("[object Window]"===Object.prototype.toString.call(xs)){var s="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",r=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';t.pdfObjectUrl&&(s=t.pdfObjectUrl,r="");var i='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+s+'"'+r+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(t)+");<\/script></body></html>",l=xs.open();return null!==l&&l.document.write(i),l}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if("[object Window]"===Object.prototype.toString.call(xs)){var o='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(t.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+t.filename+'" width="500px" height="400px" /></body></html>',c=xs.open();if(null!==c){c.document.write(o);var d=this;c.document.documentElement.querySelector("#pdfViewer").onload=function(){c.document.title=t.filename,c.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(d.output("bloburl"))}}return c}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if("[object Window]"!==Object.prototype.toString.call(xs))throw new Error("The option dataurlnewwindow just works in a browser-environment.");var h='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",t)+'"></iframe></body></html>',p=xs.open();if(null!==p&&(p.document.write(h),p.document.title=t.filename),p||"undefined"==typeof safari)return p;break;case"datauri":case"dataurl":return xs.document.location.href=this.output("datauristring",t);default:return null}},Be.foo=function(){try{return Be.apply(this,arguments)}catch(t){var e=t.stack||"";~e.indexOf(" at ")&&(e=e.split(" at ")[1]);var a="Error in function "+e.split("\n")[0].split("<")[0]+": "+t.message;if(!xs.console)throw new Error(a);xs.console.error(a,t),xs.alert&&alert(a)}},Be.foo.bar=Be,Be.foo),vt=function(e){return!0===Array.isArray(_e)&&_e.indexOf(e)>-1};switch(s){case"pt":pe=1;break;case"mm":pe=72/25.4;break;case"cm":pe=72/2.54;break;case"in":pe=72;break;case"px":pe=1==vt("px_scaling")?.75:96/72;break;case"pc":case"em":pe=12;break;case"ex":pe=6;break;default:if("number"!=typeof s)throw new Error("Invalid unit: "+s);pe=s}var yt=null;O(),I();var bt=f.__private__.getPageInfo=f.getPageInfo=function(e){if(isNaN(e)||e%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:Ae[e].objId,pageNumber:e,pageContext:Ae[e]}},jt=f.__private__.getPageInfoByObjId=function(e){if(isNaN(e)||e%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var t in Ae)if(Ae[t].objId===e)break;return bt(t)},wt=f.__private__.getCurrentPageInfo=f.getCurrentPageInfo=function(){return{objId:Ae[z].objId,pageNumber:z,pageContext:Ae[z]}};f.addPage=function(){return rt.apply(this,arguments),this},f.setPage=function(){return lt.apply(this,arguments),$.call(this,Y[z]),this},f.insertPage=function(e){return this.addPage(),this.movePage(z,e),this},f.movePage=function(e,t){var a,n;if(e>t){a=Y[e],n=Ae[e];for(var s=e;s>t;s--)Y[s]=Y[s-1],Ae[s]=Ae[s-1];Y[t]=a,Ae[t]=n,this.setPage(t)}else if(e<t){a=Y[e],n=Ae[e];for(var r=e;r<t;r++)Y[r]=Y[r+1],Ae[r]=Ae[r+1];Y[t]=a,Ae[t]=n,this.setPage(t)}return this},f.deletePage=function(){return it.apply(this,arguments),this},f.__private__.text=f.text=function(e,t,a,s,r){var i,l,o,c,d,u,h,f,m,x=(s=s||{}).scope||this;if("number"==typeof e&&"number"==typeof t&&("string"==typeof a||Array.isArray(a))){var g=a;a=t,t=e,e=g}if(arguments[3]instanceof De==0?(o=arguments[4],c=arguments[5],"object"===(0,n.A)(h=arguments[3])&&null!==h||("string"==typeof o&&(c=o,o=null),"string"==typeof h&&(c=h,h=null),"number"==typeof h&&(o=h,h=null),s={flags:h,angle:o,align:c})):(A("The transform parameter of text() with a Matrix value"),m=r),isNaN(t)||isNaN(a)||null==e)throw new Error("Invalid arguments passed to jsPDF.text");if(0===e.length)return x;var v,y="",w="number"==typeof s.lineHeightFactor?s.lineHeightFactor:Bt,N=x.internal.scaleFactor;function S(e){return e=e.split("\t").join(Array(s.TabLen||9).join(" ")),nt(e,h)}function C(e){for(var t,a=e.concat(),n=[],s=a.length;s--;)"string"==typeof(t=a.shift())?n.push(t):Array.isArray(e)&&(1===t.length||void 0===t[1]&&void 0===t[2])?n.push(t[0]):n.push([t[0],t[1],t[2]]);return n}function _(e,t){var a;if("string"==typeof e)a=t(e)[0];else if(Array.isArray(e)){for(var n,s,r=e.concat(),i=[],l=r.length;l--;)"string"==typeof(n=r.shift())?i.push(t(n)[0]):Array.isArray(n)&&"string"==typeof n[0]&&(s=t(n[0],n[1],n[2]),i.push([s[0],s[1],s[2]]));a=i}return a}var L=!1,E=!0;if("string"==typeof e)L=!0;else if(Array.isArray(e)){var D=e.concat();l=[];for(var P,R=D.length;R--;)("string"!=typeof(P=D.shift())||Array.isArray(P)&&"string"!=typeof P[0])&&(E=!1);L=E}if(!1===L)throw new Error('Type of text must be string or Array. "'+e+'" is not recognized.');"string"==typeof e&&(e=e.match(/[\r?\n]/)?e.split(/\r\n|\r|\n/g):[e]);var I=ae/x.internal.scaleFactor,B=I*(w-1);switch(s.baseline){case"bottom":a-=B;break;case"top":a+=I-B;break;case"hanging":a+=I-2*B;break;case"middle":a+=I/2-B}if((u=s.maxWidth||0)>0&&("string"==typeof e?e=x.splitTextToSize(e,u):"[object Array]"===Object.prototype.toString.call(e)&&(e=e.reduce(function(e,t){return e.concat(x.splitTextToSize(t,u))},[]))),i={text:e,x:t,y:a,options:s,mutex:{pdfEscape:nt,activeFontKey:he,fonts:ge,activeFontSize:ae}},Ce.publish("preProcessText",i),e=i.text,o=(s=i.options).angle,m instanceof De==0&&o&&"number"==typeof o){o*=Math.PI/180,0===s.rotationDirection&&(o=-o),j===b&&(o=-o);var F=Math.cos(o),O=Math.sin(o);m=new De(F,O,-O,F,0,0)}else o&&o instanceof De&&(m=o);j!==b||m||(m=Re),void 0!==(d=s.charSpace||$t)&&(y+=k(T(d))+" Tc\n",this.setCharSpace(this.getCharSpace()||0)),void 0!==(f=s.horizontalScale)&&(y+=k(100*f)+" Tz\n"),s.lang;var q=-1,z=void 0!==s.renderingMode?s.renderingMode:s.stroke,M=x.internal.getCurrentPageInfo().pageContext;switch(z){case 0:case!1:case"fill":q=0;break;case 1:case!0:case"stroke":q=1;break;case 2:case"fillThenStroke":q=2;break;case 3:case"invisible":q=3;break;case 4:case"fillAndAddForClipping":q=4;break;case 5:case"strokeAndAddPathForClipping":q=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":q=6;break;case 7:case"addToPathForClipping":q=7}var U=void 0!==M.usedRenderingMode?M.usedRenderingMode:-1;-1!==q?y+=q+" Tr\n":-1!==U&&(y+="0 Tr\n"),-1!==q&&(M.usedRenderingMode=q),c=s.align||"left";var W,H=ae*w,V=x.internal.pageSize.getWidth(),G=ge[he];d=s.charSpace||$t,u=s.maxWidth||0,h=Object.assign({autoencode:!0,noBOM:!0},s.flags);var J=[],Y=function(e){return x.getStringUnitWidth(e,{font:G,charSpace:d,fontSize:ae,doKerning:!1})*ae/N};if("[object Array]"===Object.prototype.toString.call(e)){var K;l=C(e),"left"!==c&&(W=l.map(Y));var Q,$=0;if("right"===c){t-=W[0],e=[],R=l.length;for(var Z=0;Z<R;Z++)0===Z?(Q=Wt(t),K=Ht(a)):(Q=T($-W[Z]),K=-H),e.push([l[Z],Q,K]),$=W[Z]}else if("center"===c){t-=W[0]/2,e=[],R=l.length;for(var ee=0;ee<R;ee++)0===ee?(Q=Wt(t),K=Ht(a)):(Q=T(($-W[ee])/2),K=-H),e.push([l[ee],Q,K]),$=W[ee]}else if("left"===c){e=[],R=l.length;for(var te=0;te<R;te++)e.push(l[te])}else if("justify"===c&&"Identity-H"===G.encoding){e=[],R=l.length,u=0!==u?u:V;for(var ne=0,se=0;se<R;se++)if(K=0===se?Ht(a):-H,Q=0===se?Wt(t):ne,se<R-1){var ie=T((u-W[se])/(l[se].split(" ").length-1)),le=l[se].split(" ");e.push([le[0]+" ",Q,K]),ne=0;for(var oe=1;oe<le.length;oe++){var ce=(Y(le[oe-1]+" "+le[oe])-Y(le[oe]))*N+ie;oe==le.length-1?e.push([le[oe],ce,0]):e.push([le[oe]+" ",ce,0]),ne-=ce}}else e.push([l[se],Q,K]);e.push(["",ne,0])}else{if("justify"!==c)throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(e=[],R=l.length,u=0!==u?u:V,se=0;se<R;se++){K=0===se?Ht(a):-H,Q=0===se?Wt(t):0;var de=l[se].split(" ").length-1,ue=de>0?(u-W[se])/de:0;se<R-1?J.push(k(T(ue))):J.push(0),e.push([l[se],Q,K])}}}!0===("boolean"==typeof s.R2L?s.R2L:re)&&(e=_(e,function(e,t,a){return[e.split("").reverse().join(""),t,a]})),i={text:e,x:t,y:a,options:s,mutex:{pdfEscape:nt,activeFontKey:he,fonts:ge,activeFontSize:ae}},Ce.publish("postProcessText",i),e=i.text,v=i.mutex.isHex||!1;var pe=ge[he].encoding;"WinAnsiEncoding"!==pe&&"StandardEncoding"!==pe||(e=_(e,function(e,t,a){return[S(e),t,a]})),l=C(e),e=[];for(var fe,me,xe,ve=Array.isArray(l[0])?1:0,ye="",be=function(e,t,a){var n="";return a instanceof De?(a="number"==typeof s.angle?Pe(a,new De(1,0,0,1,e,t)):Pe(new De(1,0,0,1,e,t),a),j===b&&(a=Pe(new De(1,0,0,-1,0,0),a)),n=a.join(" ")+" Tm\n"):n=k(e)+" "+k(t)+" Td\n",n},je=0;je<l.length;je++){switch(ye="",ve){case 1:xe=(v?"<":"(")+l[je][0]+(v?">":")"),fe=parseFloat(l[je][1]),me=parseFloat(l[je][2]);break;case 0:xe=(v?"<":"(")+l[je]+(v?">":")"),fe=Wt(t),me=Ht(a)}void 0!==J&&void 0!==J[je]&&(ye=J[je]+" Tw\n"),0===je?e.push(ye+be(fe,me,m)+xe):0===ve?e.push(ye+xe):1===ve&&e.push(ye+be(fe,me,m)+xe)}e=0===ve?e.join(" Tj\nT* "):e.join(" Tj\n"),e+=" Tj\n";var we="BT\n/";return we+=he+" "+ae+" Tf\n",we+=k(ae*w)+" TL\n",we+=Kt+"\n",we+=y,we+=e,X(we+="ET"),p[he]=!0,x};var Nt=f.__private__.clip=f.clip=function(e){return X("evenodd"===e?"W*":"W"),this};f.clipEvenOdd=function(){return Nt("evenodd")},f.__private__.discardPath=f.discardPath=function(){return X("n"),this};var St=f.__private__.isValidStyle=function(e){var t=!1;return-1!==[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(e)&&(t=!0),t};f.__private__.setDefaultPathOperation=f.setDefaultPathOperation=function(e){return St(e)&&(d=e),this};var kt=f.__private__.getStyle=f.getStyle=function(e){var t=d;switch(e){case"D":case"S":t="S";break;case"F":t="f";break;case"FD":case"DF":t="B";break;case"f":case"f*":case"B":case"B*":t=e}return t},At=f.close=function(){return X("h"),this};f.stroke=function(){return X("S"),this},f.fill=function(e){return Ct("f",e),this},f.fillEvenOdd=function(e){return Ct("f*",e),this},f.fillStroke=function(e){return Ct("B",e),this},f.fillStrokeEvenOdd=function(e){return Ct("B*",e),this};var Ct=function(e,t){"object"===(0,n.A)(t)?Tt(t,e):X(e)},_t=function(e){null===e||j===b&&void 0===e||(e=kt(e),X(e))};function Lt(e,t,a,n,s){var r=new Ys(t||this.boundingBox,a||this.xStep,n||this.yStep,this.gState,s||this.matrix);r.stream=this.stream;var i=e+"$$"+this.cloneIndex+++"$$";return Ie(i,r),r}var Tt=function(e,t){var a=je[e.key],n=be[a];if(n instanceof Js)X("q"),X(Et(t)),n.gState&&f.setGState(n.gState),X(e.matrix.toString()+" cm"),X("/"+a+" sh"),X("Q");else if(n instanceof Ys){var s=new De(1,0,0,-1,0,pa());e.matrix&&(s=s.multiply(e.matrix||Re),a=Lt.call(n,e.key,e.boundingBox,e.xStep,e.yStep,s).id),X("q"),X("/Pattern cs"),X("/"+a+" scn"),n.gState&&f.setGState(n.gState),X(t),X("Q")}},Et=function(e){switch(e){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},Dt=f.moveTo=function(e,t){return X(k(T(e))+" "+k(E(t))+" m"),this},Pt=f.lineTo=function(e,t){return X(k(T(e))+" "+k(E(t))+" l"),this},Rt=f.curveTo=function(e,t,a,n,s,r){return X([k(T(e)),k(E(t)),k(T(a)),k(E(n)),k(T(s)),k(E(r)),"c"].join(" ")),this};f.__private__.line=f.line=function(e,t,a,n,s){if(isNaN(e)||isNaN(t)||isNaN(a)||isNaN(n)||!St(s))throw new Error("Invalid arguments passed to jsPDF.line");return j===y?this.lines([[a-e,n-t]],e,t,[1,1],s||"S"):this.lines([[a-e,n-t]],e,t,[1,1]).stroke()},f.__private__.lines=f.lines=function(e,t,a,n,s,r){var i,l,o,c,d,u,h,p,f,m,x,g;if("number"==typeof e&&(g=a,a=t,t=e,e=g),n=n||[1,1],r=r||!1,isNaN(t)||isNaN(a)||!Array.isArray(e)||!Array.isArray(n)||!St(s)||"boolean"!=typeof r)throw new Error("Invalid arguments passed to jsPDF.lines");for(Dt(t,a),i=n[0],l=n[1],c=e.length,m=t,x=a,o=0;o<c;o++)2===(d=e[o]).length?(m=d[0]*i+m,x=d[1]*l+x,Pt(m,x)):(u=d[0]*i+m,h=d[1]*l+x,p=d[2]*i+m,f=d[3]*l+x,m=d[4]*i+m,x=d[5]*l+x,Rt(u,h,p,f,m,x));return r&&At(),_t(s),this},f.path=function(e){for(var t=0;t<e.length;t++){var a=e[t],n=a.c;switch(a.op){case"m":Dt(n[0],n[1]);break;case"l":Pt(n[0],n[1]);break;case"c":Rt.apply(this,n);break;case"h":At()}}return this},f.__private__.rect=f.rect=function(e,t,a,n,s){if(isNaN(e)||isNaN(t)||isNaN(a)||isNaN(n)||!St(s))throw new Error("Invalid arguments passed to jsPDF.rect");return j===y&&(n=-n),X([k(T(e)),k(E(t)),k(T(a)),k(T(n)),"re"].join(" ")),_t(s),this},f.__private__.triangle=f.triangle=function(e,t,a,n,s,r,i){if(isNaN(e)||isNaN(t)||isNaN(a)||isNaN(n)||isNaN(s)||isNaN(r)||!St(i))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[a-e,n-t],[s-a,r-n],[e-s,t-r]],e,t,[1,1],i,!0),this},f.__private__.roundedRect=f.roundedRect=function(e,t,a,n,s,r,i){if(isNaN(e)||isNaN(t)||isNaN(a)||isNaN(n)||isNaN(s)||isNaN(r)||!St(i))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var l=4/3*(Math.SQRT2-1);return s=Math.min(s,.5*a),r=Math.min(r,.5*n),this.lines([[a-2*s,0],[s*l,0,s,r-r*l,s,r],[0,n-2*r],[0,r*l,-s*l,r,-s,r],[2*s-a,0],[-s*l,0,-s,-r*l,-s,-r],[0,2*r-n],[0,-r*l,s*l,-r,s,-r]],e+s,t,[1,1],i,!0),this},f.__private__.ellipse=f.ellipse=function(e,t,a,n,s){if(isNaN(e)||isNaN(t)||isNaN(a)||isNaN(n)||!St(s))throw new Error("Invalid arguments passed to jsPDF.ellipse");var r=4/3*(Math.SQRT2-1)*a,i=4/3*(Math.SQRT2-1)*n;return Dt(e+a,t),Rt(e+a,t-i,e+r,t-n,e,t-n),Rt(e-r,t-n,e-a,t-i,e-a,t),Rt(e-a,t+i,e-r,t+n,e,t+n),Rt(e+r,t+n,e+a,t+i,e+a,t),_t(s),this},f.__private__.circle=f.circle=function(e,t,a,n){if(isNaN(e)||isNaN(t)||isNaN(a)||!St(n))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(e,t,a,a,n)},f.setFont=function(e,t,a){return a&&(t=S(t,a)),he=ct(e,t,{disableWarning:!1}),this};var It=f.__private__.getFont=f.getFont=function(){return ge[ct.apply(f,arguments)]};f.__private__.getFontList=f.getFontList=function(){var e,t,a={};for(e in ve)if(ve.hasOwnProperty(e))for(t in a[e]=[],ve[e])ve[e].hasOwnProperty(t)&&a[e].push(t);return a},f.addFont=function(e,t,a,n,s){var r=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&-1!==r.indexOf(arguments[3])?s=arguments[3]:arguments[3]&&-1==r.indexOf(arguments[3])&&(a=S(a,n)),at.call(this,e,t,a,s=s||"Identity-H")};var Bt,Ft=e.lineWidth||.200025,Ot=f.__private__.getLineWidth=f.getLineWidth=function(){return Ft},qt=f.__private__.setLineWidth=f.setLineWidth=function(e){return Ft=e,X(k(T(e))+" w"),this};f.__private__.setLineDash=Ks.API.setLineDash=Ks.API.setLineDashPattern=function(e,t){if(e=e||[],t=t||0,isNaN(t)||!Array.isArray(e))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return e=e.map(function(e){return k(T(e))}).join(" "),t=k(T(t)),X("["+e+"] "+t+" d"),this};var zt=f.__private__.getLineHeight=f.getLineHeight=function(){return ae*Bt};f.__private__.getLineHeight=f.getLineHeight=function(){return ae*Bt};var Mt=f.__private__.setLineHeightFactor=f.setLineHeightFactor=function(e){return"number"==typeof(e=e||1.15)&&(Bt=e),this},Ut=f.__private__.getLineHeightFactor=f.getLineHeightFactor=function(){return Bt};Mt(e.lineHeight);var Wt=f.__private__.getHorizontalCoordinate=function(e){return T(e)},Ht=f.__private__.getVerticalCoordinate=function(e){return j===b?e:Ae[z].mediaBox.topRightY-Ae[z].mediaBox.bottomLeftY-T(e)},Vt=f.__private__.getHorizontalCoordinateString=f.getHorizontalCoordinateString=function(e){return k(Wt(e))},Gt=f.__private__.getVerticalCoordinateString=f.getVerticalCoordinateString=function(e){return k(Ht(e))},Jt=e.strokeColor||"0 G";f.__private__.getStrokeColor=f.getDrawColor=function(){return We(Jt)},f.__private__.setStrokeColor=f.setDrawColor=function(e,t,a,n){return Jt=He({ch1:e,ch2:t,ch3:a,ch4:n,pdfColorType:"draw",precision:2}),X(Jt),this};var Yt=e.fillColor||"0 g";f.__private__.getFillColor=f.getFillColor=function(){return We(Yt)},f.__private__.setFillColor=f.setFillColor=function(e,t,a,n){return Yt=He({ch1:e,ch2:t,ch3:a,ch4:n,pdfColorType:"fill",precision:2}),X(Yt),this};var Kt=e.textColor||"0 g",Qt=f.__private__.getTextColor=f.getTextColor=function(){return We(Kt)};f.__private__.setTextColor=f.setTextColor=function(e,t,a,n){return Kt=He({ch1:e,ch2:t,ch3:a,ch4:n,pdfColorType:"text",precision:3}),this};var $t=e.charSpace,Xt=f.__private__.getCharSpace=f.getCharSpace=function(){return parseFloat($t||0)};f.__private__.setCharSpace=f.setCharSpace=function(e){if(isNaN(e))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return $t=e,this};var Zt=0;f.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},f.__private__.setLineCap=f.setLineCap=function(e){var t=f.CapJoinStyles[e];if(void 0===t)throw new Error("Line cap style of '"+e+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Zt=t,X(t+" J"),this};var ea=0;f.__private__.setLineJoin=f.setLineJoin=function(e){var t=f.CapJoinStyles[e];if(void 0===t)throw new Error("Line join style of '"+e+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return ea=t,X(t+" j"),this},f.__private__.setLineMiterLimit=f.__private__.setMiterLimit=f.setLineMiterLimit=f.setMiterLimit=function(e){if(e=e||0,isNaN(e))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return X(k(T(e))+" M"),this},f.GState=Vs,f.setGState=function(e){(e="string"==typeof e?we[Ne[e]]:ta(null,e)).equals(Se)||(X("/"+e.id+" gs"),Se=e)};var ta=function(e,t){if(!e||!Ne[e]){var a=!1;for(var n in we)if(we.hasOwnProperty(n)&&we[n].equals(t)){a=!0;break}if(a)t=we[n];else{var s="GS"+(Object.keys(we).length+1).toString(10);we[s]=t,t.id=s}return e&&(Ne[e]=t.id),Ce.publish("addGState",t),t}};f.addGState=function(e,t){return ta(e,t),this},f.saveGraphicsState=function(){return X("q"),ye.push({key:he,size:ae,color:Kt}),this},f.restoreGraphicsState=function(){X("Q");var e=ye.pop();return he=e.key,ae=e.size,Kt=e.color,Se=null,this},f.setCurrentTransformationMatrix=function(e){return X(e.toString()+" cm"),this},f.comment=function(e){return X("#"+e),this};var aa=function(e,t){var a=e||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return a},set:function(e){isNaN(e)||(a=parseFloat(e))}});var n=t||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return n},set:function(e){isNaN(e)||(n=parseFloat(e))}});var s="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return s},set:function(e){s=e.toString()}}),this},na=function(e,t,a,n){aa.call(this,e,t),this.type="rect";var s=a||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return s},set:function(e){isNaN(e)||(s=parseFloat(e))}});var r=n||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return r},set:function(e){isNaN(e)||(r=parseFloat(e))}}),this},sa=function(){this.page=ke,this.currentPage=z,this.pages=Y.slice(0),this.pagesContext=Ae.slice(0),this.x=fe,this.y=me,this.matrix=xe,this.width=la(z),this.height=ca(z),this.outputDestination=Q,this.id="",this.objectNumber=-1};sa.prototype.restore=function(){ke=this.page,z=this.currentPage,Ae=this.pagesContext,Y=this.pages,fe=this.x,me=this.y,xe=this.matrix,oa(z,this.width),da(z,this.height),Q=this.outputDestination};var ra=function(e,t,a,n,s){Ee.push(new sa),ke=z=0,Y=[],fe=e,me=t,xe=s,st([a,n])};for(var ia in f.beginFormObject=function(e,t,a,n,s){return ra(e,t,a,n,s),this},f.endFormObject=function(e){return function(e){if(Te[e])Ee.pop().restore();else{var t=new sa,a="Xo"+(Object.keys(Le).length+1).toString(10);t.id=a,Te[e]=a,Le[a]=t,Ce.publish("addFormObject",t),Ee.pop().restore()}}(e),this},f.doFormObject=function(e,t){var a=Le[Te[e]];return X("q"),X(t.toString()+" cm"),X("/"+a.id+" Do"),X("Q"),this},f.getFormObject=function(e){var t=Le[Te[e]];return{x:t.x,y:t.y,width:t.width,height:t.height,matrix:t.matrix}},f.save=function(e,t){return e=e||"generated.pdf",(t=t||{}).returnPromise=t.returnPromise||!1,!1===t.returnPromise?(ws(xt(mt()),e),"function"==typeof ws.unload&&xs.setTimeout&&setTimeout(ws.unload,911),this):new Promise(function(t,a){try{var n=ws(xt(mt()),e);"function"==typeof ws.unload&&xs.setTimeout&&setTimeout(ws.unload,911),t(n)}catch(s){a(s.message)}})},Ks.API)Ks.API.hasOwnProperty(ia)&&("events"===ia&&Ks.API.events.length?function(e,t){var a,n,s;for(s=t.length-1;-1!==s;s--)a=t[s][0],n=t[s][1],e.subscribe.apply(e,[a].concat("function"==typeof n?[n]:n))}(Ce,Ks.API.events):f[ia]=Ks.API[ia]);function la(e){return Ae[e].mediaBox.topRightX-Ae[e].mediaBox.bottomLeftX}function oa(e,t){Ae[e].mediaBox.topRightX=t+Ae[e].mediaBox.bottomLeftX}function ca(e){return Ae[e].mediaBox.topRightY-Ae[e].mediaBox.bottomLeftY}function da(e,t){Ae[e].mediaBox.topRightY=t+Ae[e].mediaBox.bottomLeftY}var ua=f.getPageWidth=function(e){return la(e=e||z)/pe},ha=f.setPageWidth=function(e,t){oa(e,t*pe)},pa=f.getPageHeight=function(e){return ca(e=e||z)/pe},fa=f.setPageHeight=function(e,t){da(e,t*pe)};return f.internal={pdfEscape:nt,getStyle:kt,getFont:It,getFontSize:se,getCharSpace:Xt,getTextColor:Qt,getLineHeight:zt,getLineHeightFactor:Ut,getLineWidth:Ot,write:Z,getHorizontalCoordinate:Wt,getVerticalCoordinate:Ht,getCoordinateString:Vt,getVerticalCoordinateString:Gt,collections:{},newObject:Fe,newAdditionalObject:ze,newObjectDeferred:Oe,newObjectDeferredBegin:qe,getFilters:Ve,putStream:Ge,events:Ce,scaleFactor:pe,pageSize:{getWidth:function(){return ua(z)},setWidth:function(e){ha(z,e)},getHeight:function(){return pa(z)},setHeight:function(e){fa(z,e)}},encryptionOptions:u,encryption:yt,getEncryptor:function(e){return null!==u?yt.encryptor(e,0):function(e){return e}},output:gt,getNumberOfPages:ot,pages:Y,out:X,f2:_,f3:L,getPageInfo:bt,getPageInfoByObjId:jt,getCurrentPageInfo:wt,getPDFVersion:x,Point:aa,Rectangle:na,Matrix:De,hasHotfix:vt},Object.defineProperty(f.internal.pageSize,"width",{get:function(){return ua(z)},set:function(e){ha(z,e)},enumerable:!0,configurable:!0}),Object.defineProperty(f.internal.pageSize,"height",{get:function(){return pa(z)},set:function(e){fa(z,e)},enumerable:!0,configurable:!0}),function(e){for(var t=0,a=te.length;t<a;t++){var n=at.call(this,e[t][0],e[t][1],e[t][2],te[t][3],!0);!1===h&&(p[n]=!0);var s=e[t][0].split("-");tt({id:n,fontName:s[0],fontStyle:s[1]||""})}Ce.publish("addFonts",{fonts:ge,dictionary:ve})}.call(f,te),he="F1",rt(r,a),Ce.publish("initialized"),f}Us.prototype.lsbFirstWord=function(e){return String.fromCharCode(255&e,e>>8&255,e>>16&255,e>>24&255)},Us.prototype.toHexString=function(e){return e.split("").map(function(e){return("0"+(255&e.charCodeAt(0)).toString(16)).slice(-2)}).join("")},Us.prototype.hexToBytes=function(e){for(var t=[],a=0;a<e.length;a+=2)t.push(String.fromCharCode(parseInt(e.substr(a,2),16)));return t.join("")},Us.prototype.processOwnerPassword=function(e,t){return zs(Fs(t).substr(0,5),e)},Us.prototype.encryptor=function(e,t){var a=Fs(this.encryptionKey+String.fromCharCode(255&e,e>>8&255,e>>16&255,255&t,t>>8&255)).substr(0,10);return function(e){return zs(a,e)}},Vs.prototype.equals=function(e){var t,a="id,objectNumber,equals";if(!e||(0,n.A)(e)!==(0,n.A)(this))return!1;var s=0;for(t in this)if(!(a.indexOf(t)>=0)){if(this.hasOwnProperty(t)&&!e.hasOwnProperty(t))return!1;if(this[t]!==e[t])return!1;s++}for(t in e)e.hasOwnProperty(t)&&a.indexOf(t)<0&&s--;return 0===s},Ks.API={events:[]},Ks.version="3.0.3";var Qs=Ks.API,$s=1,Xs=function(e){return e.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Zs=function(e){return e.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},er=function(e){return e.toFixed(2)},tr=function(e){return e.toFixed(5)};Qs.__acroform__={};var ar=function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e},nr=function(e){return e*$s},sr=function(e){var t=new br,a=Rr.internal.getHeight(e)||0,n=Rr.internal.getWidth(e)||0;return t.BBox=[0,0,Number(er(n)),Number(er(a))],t},rr=Qs.__acroform__.setBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return e|1<<t},ir=Qs.__acroform__.clearBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return e&~(1<<t)},lr=Qs.__acroform__.getBit=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return e&1<<t?1:0},or=Qs.__acroform__.getBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return lr(e,t-1)},cr=Qs.__acroform__.setBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return rr(e,t-1)},dr=Qs.__acroform__.clearBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return ir(e,t-1)},ur=Qs.__acroform__.calculateCoordinates=function(e,t){var a=t.internal.getHorizontalCoordinate,n=t.internal.getVerticalCoordinate,s=e[0],r=e[1],i=e[2],l=e[3],o={};return o.lowerLeft_X=a(s)||0,o.lowerLeft_Y=n(r+l)||0,o.upperRight_X=a(s+i)||0,o.upperRight_Y=n(r)||0,[Number(er(o.lowerLeft_X)),Number(er(o.lowerLeft_Y)),Number(er(o.upperRight_X)),Number(er(o.upperRight_Y))]},hr=function(e){if(e.appearanceStreamContent)return e.appearanceStreamContent;if(e.V||e.DV){var t=[],a=e._V||e.DV,n=pr(e,a),s=e.scope.internal.getFont(e.fontName,e.fontStyle).id;t.push("/Tx BMC"),t.push("q"),t.push("BT"),t.push(e.scope.__private__.encodeColorString(e.color)),t.push("/"+s+" "+er(n.fontSize)+" Tf"),t.push("1 0 0 1 0 0 Tm"),t.push(n.text),t.push("ET"),t.push("Q"),t.push("EMC");var r=sr(e);return r.scope=e.scope,r.stream=t.join("\n"),r}},pr=function(e,t){var a=0===e.fontSize?e.maxFontSize:e.fontSize,n={text:"",fontSize:""},s=(t=")"==(t="("==t.substr(0,1)?t.substr(1):t).substr(t.length-1)?t.substr(0,t.length-1):t).split(" ");s=e.multiline?s.map(function(e){return e.split("\n")}):s.map(function(e){return[e]});var r=a,i=Rr.internal.getHeight(e)||0;i=i<0?-i:i;var l=Rr.internal.getWidth(e)||0;l=l<0?-l:l;var o=function(t,a,n){if(t+1<s.length){var r=a+" "+s[t+1][0];return fr(r,e,n).width<=l-4}return!1};r++;e:for(;r>0;){t="",r--;var c,d,u=fr("3",e,r).height,h=e.multiline?i-r:(i-u)/2,p=h+=2,f=0,m=0,x=0;if(r<=0){t="(...) Tj\n",t+="% Width of Text: "+fr(t,e,r=12).width+", FieldWidth:"+l+"\n";break}for(var g="",v=0,y=0;y<s.length;y++)if(s.hasOwnProperty(y)){var b=!1;if(1!==s[y].length&&x!==s[y].length-1){if((u+2)*(v+2)+2>i)continue e;g+=s[y][x],b=!0,m=y,y--}else{g=" "==(g+=s[y][x]+" ").substr(g.length-1)?g.substr(0,g.length-1):g;var j=parseInt(y),w=o(j,g,r),N=y>=s.length-1;if(w&&!N){g+=" ",x=0;continue}if(w||N){if(N)m=j;else if(e.multiline&&(u+2)*(v+2)+2>i)continue e}else{if(!e.multiline)continue e;if((u+2)*(v+2)+2>i)continue e;m=j}}for(var S="",k=f;k<=m;k++){var A=s[k];if(e.multiline){if(k===m){S+=A[x]+" ",x=(x+1)%A.length;continue}if(k===f){S+=A[A.length-1]+" ";continue}}S+=A[0]+" "}switch(S=" "==S.substr(S.length-1)?S.substr(0,S.length-1):S,d=fr(S,e,r).width,e.textAlign){case"right":c=l-d-2;break;case"center":c=(l-d)/2;break;default:c=2}t+=er(c)+" "+er(p)+" Td\n",t+="("+Xs(S)+") Tj\n",t+=-er(c)+" 0 Td\n",p=-(r+2),d=0,f=b?m:m+1,v++,g=""}break}return n.text=t,n.fontSize=r,n},fr=function(e,t,a){var n=t.scope.internal.getFont(t.fontName,t.fontStyle),s=t.scope.getStringUnitWidth(e,{font:n,fontSize:parseFloat(a),charSpace:0})*parseFloat(a);return{height:t.scope.getStringUnitWidth("3",{font:n,fontSize:parseFloat(a),charSpace:0})*parseFloat(a)*1.5,width:s}},mr={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},xr=function(e,t){var a={type:"reference",object:e};void 0===t.internal.getPageInfo(e.page).pageContext.annotations.find(function(e){return e.type===a.type&&e.object===a.object})&&t.internal.getPageInfo(e.page).pageContext.annotations.push(a)},gr=Qs.__acroform__.arrayToPdfArray=function(e,t,a){var s=function(e){return e};if(Array.isArray(e)){for(var r="[",i=0;i<e.length;i++)switch(0!==i&&(r+=" "),(0,n.A)(e[i])){case"boolean":case"number":case"object":r+=e[i].toString();break;case"string":"/"!==e[i].substr(0,1)?(void 0!==t&&a&&(s=a.internal.getEncryptor(t)),r+="("+Xs(s(e[i].toString()))+")"):r+=e[i].toString()}return r+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},vr=function(e,t,a){var n=function(e){return e};return void 0!==t&&a&&(n=a.internal.getEncryptor(t)),(e=e||"").toString(),"("+Xs(n(e))+")"},yr=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(void 0===this._objId){if(void 0===this.scope)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(e){this._objId=e}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};yr.prototype.toString=function(){return this.objId+" 0 R"},yr.prototype.putStream=function(){var e=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:e,objectId:this.objId}),this.scope.internal.out("endobj")},yr.prototype.getKeyValueListForStream=function(){var e=[],t=Object.getOwnPropertyNames(this).filter(function(e){return"content"!=e&&"appearanceStreamContent"!=e&&"scope"!=e&&"objId"!=e&&"_"!=e.substring(0,1)});for(var a in t)if(!1===Object.getOwnPropertyDescriptor(this,t[a]).configurable){var n=t[a],s=this[n];s&&(Array.isArray(s)?e.push({key:n,value:gr(s,this.objId,this.scope)}):s instanceof yr?(s.scope=this.scope,e.push({key:n,value:s.objId+" 0 R"})):"function"!=typeof s&&e.push({key:n,value:s}))}return e};var br=function(){yr.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var e,t=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(t){e=t.trim()},get:function(){return e||null}})};ar(br,yr);var jr=function(){yr.call(this);var e,t=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return t.length>0?t:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return t}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(e){var t=function(e){return e};return this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),"("+Xs(t(e))+")"}},set:function(t){e=t}})};ar(jr,yr);var wr=function e(){yr.call(this);var t=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return t},set:function(e){if(isNaN(e))throw new Error('Invalid value "'+e+'" for attribute F supplied.');t=e}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return Boolean(or(t,3))},set:function(e){!0===Boolean(e)?this.F=cr(t,3):this.F=dr(t,3)}});var a=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return a},set:function(e){if(isNaN(e))throw new Error('Invalid value "'+e+'" for attribute Ff supplied.');a=e}});var n=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(0!==n.length)return n},set:function(e){n=void 0!==e?e:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[0])?0:n[0]},set:function(e){n[0]=e}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[1])?0:n[1]},set:function(e){n[1]=e}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[2])?0:n[2]},set:function(e){n[2]=e}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[3])?0:n[3]},set:function(e){n[3]=e}});var s="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return s},set:function(e){switch(e){case"/Btn":case"/Tx":case"/Ch":case"/Sig":s=e;break;default:throw new Error('Invalid value "'+e+'" for attribute FT supplied.')}}});var r=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!r||r.length<1){if(this instanceof Tr)return;r="FieldObject"+e.FieldNum++}var t=function(e){return e};return this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),"("+Xs(t(r))+")"},set:function(e){r=e.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return r},set:function(e){r=e}});var i="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return i},set:function(e){i=e}});var l="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return l},set:function(e){l=e}});var o=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return o},set:function(e){o=e}});var c=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return void 0===c?50/$s:c},set:function(e){c=e}});var d="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return d},set:function(e){d=e}});var u="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!u||this instanceof Tr||this instanceof Dr))return vr(u,this.objId,this.scope)},set:function(e){e=e.toString(),u=e}});var h=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(h)return this instanceof Cr==0?vr(h,this.objId,this.scope):h},set:function(e){e=e.toString(),h=this instanceof Cr==0?"("===e.substr(0,1)?Zs(e.substr(1,e.length-2)):Zs(e):e}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof Cr==1?Zs(h.substr(1,h.length-1)):h},set:function(e){e=e.toString(),h=this instanceof Cr==1?"/"+e:e}});var p=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(p)return p},set:function(e){this.V=e}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(p)return this instanceof Cr==0?vr(p,this.objId,this.scope):p},set:function(e){e=e.toString(),p=this instanceof Cr==0?"("===e.substr(0,1)?Zs(e.substr(1,e.length-2)):Zs(e):e}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof Cr==1?Zs(p.substr(1,p.length-1)):p},set:function(e){e=e.toString(),p=this instanceof Cr==1?"/"+e:e}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var f,m=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return m},set:function(e){e=Boolean(e),m=e}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(f)return f},set:function(e){f=e}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return Boolean(or(this.Ff,1))},set:function(e){!0===Boolean(e)?this.Ff=cr(this.Ff,1):this.Ff=dr(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return Boolean(or(this.Ff,2))},set:function(e){!0===Boolean(e)?this.Ff=cr(this.Ff,2):this.Ff=dr(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return Boolean(or(this.Ff,3))},set:function(e){!0===Boolean(e)?this.Ff=cr(this.Ff,3):this.Ff=dr(this.Ff,3)}});var x=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(null!==x)return x},set:function(e){if(-1===[0,1,2].indexOf(e))throw new Error('Invalid value "'+e+'" for attribute Q supplied.');x=e}}),Object.defineProperty(this,"textAlign",{get:function(){var e;switch(x){case 0:default:e="left";break;case 1:e="center";break;case 2:e="right"}return e},configurable:!0,enumerable:!0,set:function(e){switch(e){case"right":case 2:x=2;break;case"center":case 1:x=1;break;default:x=0}}})};ar(wr,yr);var Nr=function(){wr.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var e=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return e},set:function(t){e=t}});var t=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return gr(t,this.objId,this.scope)},set:function(e){var a,n;n=[],"string"==typeof(a=e)&&(n=function(e,t,a){a||(a=1);for(var n,s=[];n=t.exec(e);)s.push(n[a]);return s}(a,/\((.*?)\)/g)),t=n}}),this.getOptions=function(){return t},this.setOptions=function(e){t=e,this.sort&&t.sort()},this.addOption=function(e){e=(e=e||"").toString(),t.push(e),this.sort&&t.sort()},this.removeOption=function(e,a){for(a=a||!1,e=(e=e||"").toString();-1!==t.indexOf(e)&&(t.splice(t.indexOf(e),1),!1!==a););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return Boolean(or(this.Ff,18))},set:function(e){!0===Boolean(e)?this.Ff=cr(this.Ff,18):this.Ff=dr(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return Boolean(or(this.Ff,19))},set:function(e){!0===this.combo&&(!0===Boolean(e)?this.Ff=cr(this.Ff,19):this.Ff=dr(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return Boolean(or(this.Ff,20))},set:function(e){!0===Boolean(e)?(this.Ff=cr(this.Ff,20),t.sort()):this.Ff=dr(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return Boolean(or(this.Ff,22))},set:function(e){!0===Boolean(e)?this.Ff=cr(this.Ff,22):this.Ff=dr(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return Boolean(or(this.Ff,23))},set:function(e){!0===Boolean(e)?this.Ff=cr(this.Ff,23):this.Ff=dr(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return Boolean(or(this.Ff,27))},set:function(e){!0===Boolean(e)?this.Ff=cr(this.Ff,27):this.Ff=dr(this.Ff,27)}}),this.hasAppearanceStream=!1};ar(Nr,wr);var Sr=function(){Nr.call(this),this.fontName="helvetica",this.combo=!1};ar(Sr,Nr);var kr=function(){Sr.call(this),this.combo=!0};ar(kr,Sr);var Ar=function(){kr.call(this),this.edit=!0};ar(Ar,kr);var Cr=function(){wr.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return Boolean(or(this.Ff,15))},set:function(e){!0===Boolean(e)?this.Ff=cr(this.Ff,15):this.Ff=dr(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return Boolean(or(this.Ff,16))},set:function(e){!0===Boolean(e)?this.Ff=cr(this.Ff,16):this.Ff=dr(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return Boolean(or(this.Ff,17))},set:function(e){!0===Boolean(e)?this.Ff=cr(this.Ff,17):this.Ff=dr(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return Boolean(or(this.Ff,26))},set:function(e){!0===Boolean(e)?this.Ff=cr(this.Ff,26):this.Ff=dr(this.Ff,26)}});var e,t={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var e=function(e){return e};if(this.scope&&(e=this.scope.internal.getEncryptor(this.objId)),0!==Object.keys(t).length){var a,n=[];for(a in n.push("<<"),t)n.push("/"+a+" ("+Xs(e(t[a]))+")");return n.push(">>"),n.join("\n")}},set:function(e){"object"===(0,n.A)(e)&&(t=e)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return t.CA||""},set:function(e){"string"==typeof e&&(t.CA=e)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return e.substr(1,e.length-1)},set:function(t){e="/"+t}})};ar(Cr,wr);var _r=function(){Cr.call(this),this.pushButton=!0};ar(_r,Cr);var Lr=function(){Cr.call(this),this.radio=!0,this.pushButton=!1;var e=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=void 0!==t?t:[]}})};ar(Lr,Cr);var Tr=function(){var e,t;wr.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return t},set:function(e){t=e}});var a,s={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var e=function(e){return e};this.scope&&(e=this.scope.internal.getEncryptor(this.objId));var t,a=[];for(t in a.push("<<"),s)a.push("/"+t+" ("+Xs(e(s[t]))+")");return a.push(">>"),a.join("\n")},set:function(e){"object"===(0,n.A)(e)&&(s=e)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return s.CA||""},set:function(e){"string"==typeof e&&(s.CA=e)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return a},set:function(e){a=e}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return a.substr(1,a.length-1)},set:function(e){a="/"+e}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=Rr.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};ar(Tr,wr),Lr.prototype.setAppearance=function(e){if(!("createAppearanceStream"in e)||!("getCA"in e))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var t in this.Kids)if(this.Kids.hasOwnProperty(t)){var a=this.Kids[t];a.appearanceStreamContent=e.createAppearanceStream(a.optionName),a.caption=e.getCA()}},Lr.prototype.createOption=function(e){var t=new Tr;return t.Parent=this,t.optionName=e,this.Kids.push(t),Ir.call(this.scope,t),t};var Er=function(){Cr.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=Rr.CheckBox.createAppearanceStream()};ar(Er,Cr);var Dr=function(){wr.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return Boolean(or(this.Ff,13))},set:function(e){!0===Boolean(e)?this.Ff=cr(this.Ff,13):this.Ff=dr(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return Boolean(or(this.Ff,21))},set:function(e){!0===Boolean(e)?this.Ff=cr(this.Ff,21):this.Ff=dr(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return Boolean(or(this.Ff,23))},set:function(e){!0===Boolean(e)?this.Ff=cr(this.Ff,23):this.Ff=dr(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return Boolean(or(this.Ff,24))},set:function(e){!0===Boolean(e)?this.Ff=cr(this.Ff,24):this.Ff=dr(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return Boolean(or(this.Ff,25))},set:function(e){!0===Boolean(e)?this.Ff=cr(this.Ff,25):this.Ff=dr(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return Boolean(or(this.Ff,26))},set:function(e){!0===Boolean(e)?this.Ff=cr(this.Ff,26):this.Ff=dr(this.Ff,26)}});var e=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return e},set:function(t){Number.isInteger(t)&&(e=t)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};ar(Dr,wr);var Pr=function(){Dr.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return Boolean(or(this.Ff,14))},set:function(e){!0===Boolean(e)?this.Ff=cr(this.Ff,14):this.Ff=dr(this.Ff,14)}}),this.password=!0};ar(Pr,Dr);var Rr={CheckBox:{createAppearanceStream:function(){return{N:{On:Rr.CheckBox.YesNormal},D:{On:Rr.CheckBox.YesPushDown,Off:Rr.CheckBox.OffPushDown}}},YesPushDown:function(e){var t=sr(e);t.scope=e.scope;var a=[],n=e.scope.internal.getFont(e.fontName,e.fontStyle).id,s=e.scope.__private__.encodeColorString(e.color),r=pr(e,e.caption);return a.push("0.749023 g"),a.push("0 0 "+er(Rr.internal.getWidth(e))+" "+er(Rr.internal.getHeight(e))+" re"),a.push("f"),a.push("BMC"),a.push("q"),a.push("0 0 1 rg"),a.push("/"+n+" "+er(r.fontSize)+" Tf "+s),a.push("BT"),a.push(r.text),a.push("ET"),a.push("Q"),a.push("EMC"),t.stream=a.join("\n"),t},YesNormal:function(e){var t=sr(e);t.scope=e.scope;var a=e.scope.internal.getFont(e.fontName,e.fontStyle).id,n=e.scope.__private__.encodeColorString(e.color),s=[],r=Rr.internal.getHeight(e),i=Rr.internal.getWidth(e),l=pr(e,e.caption);return s.push("1 g"),s.push("0 0 "+er(i)+" "+er(r)+" re"),s.push("f"),s.push("q"),s.push("0 0 1 rg"),s.push("0 0 "+er(i-1)+" "+er(r-1)+" re"),s.push("W"),s.push("n"),s.push("0 g"),s.push("BT"),s.push("/"+a+" "+er(l.fontSize)+" Tf "+n),s.push(l.text),s.push("ET"),s.push("Q"),t.stream=s.join("\n"),t},OffPushDown:function(e){var t=sr(e);t.scope=e.scope;var a=[];return a.push("0.749023 g"),a.push("0 0 "+er(Rr.internal.getWidth(e))+" "+er(Rr.internal.getHeight(e))+" re"),a.push("f"),t.stream=a.join("\n"),t}},RadioButton:{Circle:{createAppearanceStream:function(e){var t={D:{Off:Rr.RadioButton.Circle.OffPushDown},N:{}};return t.N[e]=Rr.RadioButton.Circle.YesNormal,t.D[e]=Rr.RadioButton.Circle.YesPushDown,t},getCA:function(){return"l"},YesNormal:function(e){var t=sr(e);t.scope=e.scope;var a=[],n=Rr.internal.getWidth(e)<=Rr.internal.getHeight(e)?Rr.internal.getWidth(e)/4:Rr.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var s=Rr.internal.Bezier_C,r=Number((n*s).toFixed(5));return a.push("q"),a.push("1 0 0 1 "+tr(Rr.internal.getWidth(e)/2)+" "+tr(Rr.internal.getHeight(e)/2)+" cm"),a.push(n+" 0 m"),a.push(n+" "+r+" "+r+" "+n+" 0 "+n+" c"),a.push("-"+r+" "+n+" -"+n+" "+r+" -"+n+" 0 c"),a.push("-"+n+" -"+r+" -"+r+" -"+n+" 0 -"+n+" c"),a.push(r+" -"+n+" "+n+" -"+r+" "+n+" 0 c"),a.push("f"),a.push("Q"),t.stream=a.join("\n"),t},YesPushDown:function(e){var t=sr(e);t.scope=e.scope;var a=[],n=Rr.internal.getWidth(e)<=Rr.internal.getHeight(e)?Rr.internal.getWidth(e)/4:Rr.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var s=Number((2*n).toFixed(5)),r=Number((s*Rr.internal.Bezier_C).toFixed(5)),i=Number((n*Rr.internal.Bezier_C).toFixed(5));return a.push("0.749023 g"),a.push("q"),a.push("1 0 0 1 "+tr(Rr.internal.getWidth(e)/2)+" "+tr(Rr.internal.getHeight(e)/2)+" cm"),a.push(s+" 0 m"),a.push(s+" "+r+" "+r+" "+s+" 0 "+s+" c"),a.push("-"+r+" "+s+" -"+s+" "+r+" -"+s+" 0 c"),a.push("-"+s+" -"+r+" -"+r+" -"+s+" 0 -"+s+" c"),a.push(r+" -"+s+" "+s+" -"+r+" "+s+" 0 c"),a.push("f"),a.push("Q"),a.push("0 g"),a.push("q"),a.push("1 0 0 1 "+tr(Rr.internal.getWidth(e)/2)+" "+tr(Rr.internal.getHeight(e)/2)+" cm"),a.push(n+" 0 m"),a.push(n+" "+i+" "+i+" "+n+" 0 "+n+" c"),a.push("-"+i+" "+n+" -"+n+" "+i+" -"+n+" 0 c"),a.push("-"+n+" -"+i+" -"+i+" -"+n+" 0 -"+n+" c"),a.push(i+" -"+n+" "+n+" -"+i+" "+n+" 0 c"),a.push("f"),a.push("Q"),t.stream=a.join("\n"),t},OffPushDown:function(e){var t=sr(e);t.scope=e.scope;var a=[],n=Rr.internal.getWidth(e)<=Rr.internal.getHeight(e)?Rr.internal.getWidth(e)/4:Rr.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var s=Number((2*n).toFixed(5)),r=Number((s*Rr.internal.Bezier_C).toFixed(5));return a.push("0.749023 g"),a.push("q"),a.push("1 0 0 1 "+tr(Rr.internal.getWidth(e)/2)+" "+tr(Rr.internal.getHeight(e)/2)+" cm"),a.push(s+" 0 m"),a.push(s+" "+r+" "+r+" "+s+" 0 "+s+" c"),a.push("-"+r+" "+s+" -"+s+" "+r+" -"+s+" 0 c"),a.push("-"+s+" -"+r+" -"+r+" -"+s+" 0 -"+s+" c"),a.push(r+" -"+s+" "+s+" -"+r+" "+s+" 0 c"),a.push("f"),a.push("Q"),t.stream=a.join("\n"),t}},Cross:{createAppearanceStream:function(e){var t={D:{Off:Rr.RadioButton.Cross.OffPushDown},N:{}};return t.N[e]=Rr.RadioButton.Cross.YesNormal,t.D[e]=Rr.RadioButton.Cross.YesPushDown,t},getCA:function(){return"8"},YesNormal:function(e){var t=sr(e);t.scope=e.scope;var a=[],n=Rr.internal.calculateCross(e);return a.push("q"),a.push("1 1 "+er(Rr.internal.getWidth(e)-2)+" "+er(Rr.internal.getHeight(e)-2)+" re"),a.push("W"),a.push("n"),a.push(er(n.x1.x)+" "+er(n.x1.y)+" m"),a.push(er(n.x2.x)+" "+er(n.x2.y)+" l"),a.push(er(n.x4.x)+" "+er(n.x4.y)+" m"),a.push(er(n.x3.x)+" "+er(n.x3.y)+" l"),a.push("s"),a.push("Q"),t.stream=a.join("\n"),t},YesPushDown:function(e){var t=sr(e);t.scope=e.scope;var a=Rr.internal.calculateCross(e),n=[];return n.push("0.749023 g"),n.push("0 0 "+er(Rr.internal.getWidth(e))+" "+er(Rr.internal.getHeight(e))+" re"),n.push("f"),n.push("q"),n.push("1 1 "+er(Rr.internal.getWidth(e)-2)+" "+er(Rr.internal.getHeight(e)-2)+" re"),n.push("W"),n.push("n"),n.push(er(a.x1.x)+" "+er(a.x1.y)+" m"),n.push(er(a.x2.x)+" "+er(a.x2.y)+" l"),n.push(er(a.x4.x)+" "+er(a.x4.y)+" m"),n.push(er(a.x3.x)+" "+er(a.x3.y)+" l"),n.push("s"),n.push("Q"),t.stream=n.join("\n"),t},OffPushDown:function(e){var t=sr(e);t.scope=e.scope;var a=[];return a.push("0.749023 g"),a.push("0 0 "+er(Rr.internal.getWidth(e))+" "+er(Rr.internal.getHeight(e))+" re"),a.push("f"),t.stream=a.join("\n"),t}}},createDefaultAppearanceStream:function(e){var t=e.scope.internal.getFont(e.fontName,e.fontStyle).id,a=e.scope.__private__.encodeColorString(e.color);return"/"+t+" "+e.fontSize+" Tf "+a}};Rr.internal={Bezier_C:.551915024494,calculateCross:function(e){var t=Rr.internal.getWidth(e),a=Rr.internal.getHeight(e),n=Math.min(t,a);return{x1:{x:(t-n)/2,y:(a-n)/2+n},x2:{x:(t-n)/2+n,y:(a-n)/2},x3:{x:(t-n)/2,y:(a-n)/2},x4:{x:(t-n)/2+n,y:(a-n)/2+n}}}},Rr.internal.getWidth=function(e){var t=0;return"object"===(0,n.A)(e)&&(t=nr(e.Rect[2])),t},Rr.internal.getHeight=function(e){var t=0;return"object"===(0,n.A)(e)&&(t=nr(e.Rect[3])),t};var Ir=Qs.addField=function(e){if(function(e,t){if(t.scope=e,void 0!==e.internal&&(void 0===e.internal.acroformPlugin||!1===e.internal.acroformPlugin.isInitialized)){if(wr.FieldNum=0,e.internal.acroformPlugin=JSON.parse(JSON.stringify(mr)),e.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");$s=e.internal.scaleFactor,e.internal.acroformPlugin.acroFormDictionaryRoot=new jr,e.internal.acroformPlugin.acroFormDictionaryRoot.scope=e,e.internal.acroformPlugin.acroFormDictionaryRoot._eventID=e.internal.events.subscribe("postPutResources",function(){var t;(t=e).internal.events.unsubscribe(t.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete t.internal.acroformPlugin.acroFormDictionaryRoot._eventID,t.internal.acroformPlugin.printedOut=!0}),e.internal.events.subscribe("buildDocument",function(){!function(e){e.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var t=e.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var a in t)if(t.hasOwnProperty(a)){var n=t[a];n.objId=void 0,n.hasAnnotation&&xr(n,e)}}(e)}),e.internal.events.subscribe("putCatalog",function(){!function(e){if(void 0===e.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("putCatalogCallback: Root missing.");e.internal.write("/AcroForm "+e.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")}(e)}),e.internal.events.subscribe("postPutPages",function(t){!function(e,t){var a=!e;for(var s in e||(t.internal.newObjectDeferredBegin(t.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),t.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),e=e||t.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(e.hasOwnProperty(s)){var r=e[s],i=[],l=r.Rect;if(r.Rect&&(r.Rect=ur(r.Rect,t)),t.internal.newObjectDeferredBegin(r.objId,!0),r.DA=Rr.createDefaultAppearanceStream(r),"object"===(0,n.A)(r)&&"function"==typeof r.getKeyValueListForStream&&(i=r.getKeyValueListForStream()),r.Rect=l,r.hasAppearanceStream&&!r.appearanceStreamContent){var o=hr(r);i.push({key:"AP",value:"<</N "+o+">>"}),t.internal.acroformPlugin.xForms.push(o)}if(r.appearanceStreamContent){var c="";for(var d in r.appearanceStreamContent)if(r.appearanceStreamContent.hasOwnProperty(d)){var u=r.appearanceStreamContent[d];if(c+="/"+d+" ",c+="<<",Object.keys(u).length>=1||Array.isArray(u)){for(var s in u)if(u.hasOwnProperty(s)){var h=u[s];"function"==typeof h&&(h=h.call(t,r)),c+="/"+s+" "+h+" ",t.internal.acroformPlugin.xForms.indexOf(h)>=0||t.internal.acroformPlugin.xForms.push(h)}}else"function"==typeof(h=u)&&(h=h.call(t,r)),c+="/"+s+" "+h,t.internal.acroformPlugin.xForms.indexOf(h)>=0||t.internal.acroformPlugin.xForms.push(h);c+=">>"}i.push({key:"AP",value:"<<\n"+c+">>"})}t.internal.putStream({additionalKeyValues:i,objectId:r.objId}),t.internal.out("endobj")}a&&function(e,t){for(var a in e)if(e.hasOwnProperty(a)){var s=a,r=e[a];t.internal.newObjectDeferredBegin(r.objId,!0),"object"===(0,n.A)(r)&&"function"==typeof r.putStream&&r.putStream(),delete e[s]}}(t.internal.acroformPlugin.xForms,t)}(t,e)}),e.internal.acroformPlugin.isInitialized=!0}}(this,e),!(e instanceof wr))throw new Error("Invalid argument passed to jsPDF.addField.");var t;return(t=e).scope.internal.acroformPlugin.printedOut&&(t.scope.internal.acroformPlugin.printedOut=!1,t.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),t.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(t),e.page=e.scope.internal.getCurrentPageInfo().pageNumber,this};Qs.AcroFormChoiceField=Nr,Qs.AcroFormListBox=Sr,Qs.AcroFormComboBox=kr,Qs.AcroFormEditBox=Ar,Qs.AcroFormButton=Cr,Qs.AcroFormPushButton=_r,Qs.AcroFormRadioButton=Lr,Qs.AcroFormCheckBox=Er,Qs.AcroFormTextField=Dr,Qs.AcroFormPasswordField=Pr,Qs.AcroFormAppearance=Rr,Qs.AcroForm={ChoiceField:Nr,ListBox:Sr,ComboBox:kr,EditBox:Ar,Button:Cr,PushButton:_r,RadioButton:Lr,CheckBox:Er,TextField:Dr,PasswordField:Pr,Appearance:Rr},Ks.AcroForm={ChoiceField:Nr,ListBox:Sr,ComboBox:kr,EditBox:Ar,Button:Cr,PushButton:_r,RadioButton:Lr,CheckBox:Er,TextField:Dr,PasswordField:Pr,Appearance:Rr};Ks.AcroForm;function Br(e){return e.reduce(function(e,t,a){return e[t]=a,e},{})}!function(e){var t="addImage_";e.__addimage__={};var a="UNKNOWN",s={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},r=e.__addimage__.getImageFileTypeByImageData=function(e,t){var n,r,i,l,o,c=a;if("RGBA"===(t=t||a)||void 0!==e.data&&e.data instanceof Uint8ClampedArray&&"height"in e&&"width"in e)return"RGBA";if(N(e))for(o in s)for(i=s[o],n=0;n<i.length;n+=1){for(l=!0,r=0;r<i[n].length;r+=1)if(void 0!==i[n][r]&&i[n][r]!==e[r]){l=!1;break}if(!0===l){c=o;break}}else for(o in s)for(i=s[o],n=0;n<i.length;n+=1){for(l=!0,r=0;r<i[n].length;r+=1)if(void 0!==i[n][r]&&i[n][r]!==e.charCodeAt(r)){l=!1;break}if(!0===l){c=o;break}}return c===a&&t!==a&&(c=t),c},i=function e(t){for(var a=this.internal.write,n=this.internal.putStream,s=(0,this.internal.getFilters)();-1!==s.indexOf("FlateEncode");)s.splice(s.indexOf("FlateEncode"),1);t.objectId=this.internal.newObject();var r=[];if(r.push({key:"Type",value:"/XObject"}),r.push({key:"Subtype",value:"/Image"}),r.push({key:"Width",value:t.width}),r.push({key:"Height",value:t.height}),t.colorSpace===v.INDEXED?r.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(t.palette.length/3-1)+" "+("sMask"in t&&void 0!==t.sMask?t.objectId+2:t.objectId+1)+" 0 R]"}):(r.push({key:"ColorSpace",value:"/"+t.colorSpace}),t.colorSpace===v.DEVICE_CMYK&&r.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),r.push({key:"BitsPerComponent",value:t.bitsPerComponent}),"decodeParameters"in t&&void 0!==t.decodeParameters&&r.push({key:"DecodeParms",value:"<<"+t.decodeParameters+">>"}),"transparency"in t&&Array.isArray(t.transparency)&&t.transparency.length>0){for(var i="",l=0,o=t.transparency.length;l<o;l++)i+=t.transparency[l]+" "+t.transparency[l]+" ";r.push({key:"Mask",value:"["+i+"]"})}void 0!==t.sMask&&r.push({key:"SMask",value:t.objectId+1+" 0 R"});var c=void 0!==t.filter?["/"+t.filter]:void 0;if(n({data:t.data,additionalKeyValues:r,alreadyAppliedFilters:c,objectId:t.objectId}),a("endobj"),"sMask"in t&&void 0!==t.sMask){var d,u=null!==(d=t.sMaskBitsPerComponent)&&void 0!==d?d:t.bitsPerComponent,h={width:t.width,height:t.height,colorSpace:"DeviceGray",bitsPerComponent:u,data:t.sMask};"filter"in t&&(h.decodeParameters="/Predictor ".concat(t.predictor," /Colors 1 /BitsPerComponent ").concat(u," /Columns ").concat(t.width),h.filter=t.filter),e.call(this,h)}if(t.colorSpace===v.INDEXED){var p=this.internal.newObject();n({data:k(new Uint8Array(t.palette)),objectId:p}),a("endobj")}},l=function(){var e=this.internal.collections[t+"images"];for(var a in e)i.call(this,e[a])},o=function(){var e,a=this.internal.collections[t+"images"],n=this.internal.write;for(var s in a)n("/I"+(e=a[s]).index,e.objectId,"0","R")},c=function(){this.internal.collections[t+"images"]||(this.internal.collections[t+"images"]={},this.internal.events.subscribe("putResources",l),this.internal.events.subscribe("putXobjectDict",o))},d=function(){var e=this.internal.collections[t+"images"];return c.call(this),e},u=function(){return Object.keys(this.internal.collections[t+"images"]).length},h=function(t){return"function"==typeof e["process"+t.toUpperCase()]},p=function(e){return"object"===(0,n.A)(e)&&1===e.nodeType},f=function(t,a){if("IMG"===t.nodeName&&t.hasAttribute("src")){var n=""+t.getAttribute("src");if(0===n.indexOf("data:image/"))return Ss(unescape(n).split("base64,").pop());var s=e.loadFile(n,!0);if(void 0!==s)return s}if("CANVAS"===t.nodeName){if(0===t.width||0===t.height)throw new Error("Given canvas must have data. Canvas width: "+t.width+", height: "+t.height);var r;switch(a){case"PNG":r="image/png";break;case"WEBP":r="image/webp";break;default:r="image/jpeg"}return Ss(t.toDataURL(r,1).split("base64,").pop())}},m=function(e){var a=this.internal.collections[t+"images"];if(a)for(var n in a)if(e===a[n].alias)return a[n]},x=function(e,t,a){return e||t||(e=-96,t=-96),e<0&&(e=-1*a.width*72/e/this.internal.scaleFactor),t<0&&(t=-1*a.height*72/t/this.internal.scaleFactor),0===e&&(e=t*a.width/a.height),0===t&&(t=e*a.height/a.width),[e,t]},g=function(e,t,a,n,s,r){var i=x.call(this,a,n,s),l=this.internal.getCoordinateString,o=this.internal.getVerticalCoordinateString,c=d.call(this);if(a=i[0],n=i[1],c[s.index]=s,r){r*=Math.PI/180;var u=Math.cos(r),h=Math.sin(r),p=function(e){return e.toFixed(4)},f=[p(u),p(h),p(-1*h),p(u),0,0,"cm"]}this.internal.write("q"),r?(this.internal.write([1,"0","0",1,l(e),o(t+n),"cm"].join(" ")),this.internal.write(f.join(" ")),this.internal.write([l(a),"0","0",l(n),"0","0","cm"].join(" "))):this.internal.write([l(a),"0","0",l(n),l(e),o(t+n),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+s.index+" Do"),this.internal.write("Q")},v=e.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};e.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var y=e.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},b=e.__addimage__.sHashCode=function(e){var t,a,n=0;if("string"==typeof e)for(a=e.length,t=0;t<a;t++)n=(n<<5)-n+e.charCodeAt(t),n|=0;else if(N(e))for(a=e.byteLength/2,t=0;t<a;t++)n=(n<<5)-n+e[t],n|=0;return n},j=e.__addimage__.validateStringAsBase64=function(e){(e=e||"").toString().trim();var t=!0;return 0===e.length&&(t=!1),e.length%4!=0&&(t=!1),!1===/^[A-Za-z0-9+/]+$/.test(e.substr(0,e.length-2))&&(t=!1),!1===/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(e.substr(-2))&&(t=!1),t},w=e.__addimage__.extractImageFromDataUrl=function(e){if(null==e)return null;if(!(e=e.trim()).startsWith("data:"))return null;var t=e.indexOf(",");return t<0?null:e.substring(0,t).trim().endsWith("base64")?e.substring(t+1):null};e.__addimage__.isArrayBuffer=function(e){return e instanceof ArrayBuffer};var N=e.__addimage__.isArrayBufferView=function(e){return e instanceof Int8Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array||e instanceof Float64Array},S=e.__addimage__.binaryStringToUint8Array=function(e){for(var t=e.length,a=new Uint8Array(t),n=0;n<t;n++)a[n]=e.charCodeAt(n);return a},k=e.__addimage__.arrayBufferToBinaryString=function(e){for(var t="",a=N(e)?e:new Uint8Array(e),n=0;n<a.length;n+=8192)t+=String.fromCharCode.apply(null,a.subarray(n,n+8192));return t};e.addImage=function(){var e,t,s,r,i,l,o,d,u;if("number"==typeof arguments[1]?(t=a,s=arguments[1],r=arguments[2],i=arguments[3],l=arguments[4],o=arguments[5],d=arguments[6],u=arguments[7]):(t=arguments[1],s=arguments[2],r=arguments[3],i=arguments[4],l=arguments[5],o=arguments[6],d=arguments[7],u=arguments[8]),"object"===(0,n.A)(e=arguments[0])&&!p(e)&&"imageData"in e){var h=e;e=h.imageData,t=h.format||t||a,s=h.x||s||0,r=h.y||r||0,i=h.w||h.width||i,l=h.h||h.height||l,o=h.alias||o,d=h.compression||d,u=h.rotation||h.angle||u}var f=this.internal.getFilters();if(void 0===d&&-1!==f.indexOf("FlateEncode")&&(d="SLOW"),isNaN(s)||isNaN(r))throw new Error("Invalid coordinates passed to jsPDF.addImage");c.call(this);var m=A.call(this,e,t,o,d);return g.call(this,s,r,i,l,m,u),this};var A=function(t,n,s,i){var l,o,c;if("string"==typeof t&&r(t)===a){t=unescape(t);var d=C(t,!1);(""!==d||void 0!==(d=e.loadFile(t,!0)))&&(t=d)}if(p(t)&&(t=f(t,n)),n=r(t,n),!h(n))throw new Error("addImage does not support files of type '"+n+"', please ensure that a plugin for '"+n+"' support is added.");if((null==(c=s)||0===c.length)&&(s=function(e){return"string"==typeof e||N(e)?b(e):N(e.data)?b(e.data):null}(t)),(l=m.call(this,s))||(t instanceof Uint8Array||"RGBA"===n||(o=t,t=S(t)),l=this["process"+n.toUpperCase()](t,u.call(this),s,function(t){return t&&"string"==typeof t&&(t=t.toUpperCase()),t in e.image_compression?t:y.NONE}(i),o)),!l)throw new Error("An unknown error occurred whilst processing the image.");return l},C=e.__addimage__.convertBase64ToBinaryString=function(e,t){t="boolean"!=typeof t||t;var a,n="";if("string"==typeof e){var s;a=null!==(s=w(e))&&void 0!==s?s:e;try{n=Ss(a)}catch(r){if(t)throw j(a)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+r.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return n};e.getImageProperties=function(t){var n,s,i="";if(p(t)&&(t=f(t)),"string"==typeof t&&r(t)===a&&(""===(i=C(t,!1))&&(i=e.loadFile(t)||""),t=i),s=r(t),!h(s))throw new Error("addImage does not support files of type '"+s+"', please ensure that a plugin for '"+s+"' support is added.");if(t instanceof Uint8Array||(t=S(t)),!(n=this["process"+s.toUpperCase()](t)))throw new Error("An unknown error occurred whilst processing the image");return n.fileType=s,n}}(Ks.API),function(e){var t=function(e){if(void 0!==e&&""!=e)return!0};Ks.API.events.push(["addPage",function(e){this.internal.getPageInfo(e.pageNumber).pageContext.annotations=[]}]),e.events.push(["putPage",function(e){for(var a,n,s,r=this.internal.getCoordinateString,i=this.internal.getVerticalCoordinateString,l=this.internal.getPageInfoByObjId(e.objId),o=e.pageContext.annotations,c=!1,d=0;d<o.length&&!c;d++)switch((a=o[d]).type){case"link":(t(a.options.url)||t(a.options.pageNumber))&&(c=!0);break;case"reference":case"text":case"freetext":c=!0}if(0!=c){this.internal.write("/Annots [");for(var u=0;u<o.length;u++){a=o[u];var h=this.internal.pdfEscape,p=this.internal.getEncryptor(e.objId);switch(a.type){case"reference":this.internal.write(" "+a.object.objId+" 0 R ");break;case"text":var f=this.internal.newAdditionalObject(),m=this.internal.newAdditionalObject(),x=this.internal.getEncryptor(f.objId),g=a.title||"Note";s="<</Type /Annot /Subtype /Text "+(n="/Rect ["+r(a.bounds.x)+" "+i(a.bounds.y+a.bounds.h)+" "+r(a.bounds.x+a.bounds.w)+" "+i(a.bounds.y)+"] ")+"/Contents ("+h(x(a.contents))+")",s+=" /Popup "+m.objId+" 0 R",s+=" /P "+l.objId+" 0 R",s+=" /T ("+h(x(g))+") >>",f.content=s;var v=f.objId+" 0 R";s="<</Type /Annot /Subtype /Popup "+(n="/Rect ["+r(a.bounds.x+30)+" "+i(a.bounds.y+a.bounds.h)+" "+r(a.bounds.x+a.bounds.w+30)+" "+i(a.bounds.y)+"] ")+" /Parent "+v,a.open&&(s+=" /Open true"),s+=" >>",m.content=s,this.internal.write(f.objId,"0 R",m.objId,"0 R");break;case"freetext":n="/Rect ["+r(a.bounds.x)+" "+i(a.bounds.y)+" "+r(a.bounds.x+a.bounds.w)+" "+i(a.bounds.y+a.bounds.h)+"] ";var y=a.color||"#000000";s="<</Type /Annot /Subtype /FreeText "+n+"/Contents ("+h(p(a.contents))+")",s+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+y+")",s+=" /Border [0 0 0]",s+=" >>",this.internal.write(s);break;case"link":if(a.options.name){var b=this.annotations._nameMap[a.options.name];a.options.pageNumber=b.page,a.options.top=b.y}else a.options.top||(a.options.top=0);if(n="/Rect ["+a.finalBounds.x+" "+a.finalBounds.y+" "+a.finalBounds.w+" "+a.finalBounds.h+"] ",s="",a.options.url)s="<</Type /Annot /Subtype /Link "+n+"/Border [0 0 0] /A <</S /URI /URI ("+h(p(a.options.url))+") >>";else if(a.options.pageNumber)switch(s="<</Type /Annot /Subtype /Link "+n+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(a.options.pageNumber).objId+" 0 R",a.options.magFactor=a.options.magFactor||"XYZ",a.options.magFactor){case"Fit":s+=" /Fit]";break;case"FitH":s+=" /FitH "+a.options.top+"]";break;case"FitV":a.options.left=a.options.left||0,s+=" /FitV "+a.options.left+"]";break;default:var j=i(a.options.top);a.options.left=a.options.left||0,void 0===a.options.zoom&&(a.options.zoom=0),s+=" /XYZ "+a.options.left+" "+j+" "+a.options.zoom+"]"}""!=s&&(s+=" >>",this.internal.write(s))}}this.internal.write("]")}}]),e.createAnnotation=function(e){var t=this.internal.getCurrentPageInfo();switch(e.type){case"link":this.link(e.bounds.x,e.bounds.y,e.bounds.w,e.bounds.h,e);break;case"text":case"freetext":t.pageContext.annotations.push(e)}},e.link=function(e,t,a,n,s){var r=this.internal.getCurrentPageInfo(),i=this.internal.getCoordinateString,l=this.internal.getVerticalCoordinateString;r.pageContext.annotations.push({finalBounds:{x:i(e),y:l(t),w:i(e+a),h:l(t+n)},options:s,type:"link"})},e.textWithLink=function(e,t,a,n){var s,r,i=this.getTextWidth(e),l=this.internal.getLineHeight()/this.internal.scaleFactor;if(void 0!==n.maxWidth){r=n.maxWidth;var o=this.splitTextToSize(e,r).length;s=Math.ceil(l*o)}else r=i,s=l;return this.text(e,t,a,n),a+=.2*l,"center"===n.align&&(t-=i/2),"right"===n.align&&(t-=i),this.link(t,a-l,r,s,n),i},e.getTextWidth=function(e){var t=this.internal.getFontSize();return this.getStringUnitWidth(e)*t/this.internal.scaleFactor}}(Ks.API),function(e){var t={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},a={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},n={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},s=[1570,1571,1573,1575];e.__arabicParser__={};var r=e.__arabicParser__.isInArabicSubstitutionA=function(e){return void 0!==t[e.charCodeAt(0)]},i=e.__arabicParser__.isArabicLetter=function(e){return"string"==typeof e&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(e)},l=e.__arabicParser__.isArabicEndLetter=function(e){return i(e)&&r(e)&&t[e.charCodeAt(0)].length<=2},o=e.__arabicParser__.isArabicAlfLetter=function(e){return i(e)&&s.indexOf(e.charCodeAt(0))>=0};e.__arabicParser__.arabicLetterHasIsolatedForm=function(e){return i(e)&&r(e)&&t[e.charCodeAt(0)].length>=1};var c=e.__arabicParser__.arabicLetterHasFinalForm=function(e){return i(e)&&r(e)&&t[e.charCodeAt(0)].length>=2};e.__arabicParser__.arabicLetterHasInitialForm=function(e){return i(e)&&r(e)&&t[e.charCodeAt(0)].length>=3};var d=e.__arabicParser__.arabicLetterHasMedialForm=function(e){return i(e)&&r(e)&&4==t[e.charCodeAt(0)].length},u=e.__arabicParser__.resolveLigatures=function(e){var t=0,n=a,s="",r=0;for(t=0;t<e.length;t+=1)void 0!==n[e.charCodeAt(t)]?(r++,"number"==typeof(n=n[e.charCodeAt(t)])&&(s+=String.fromCharCode(n),n=a,r=0),t===e.length-1&&(n=a,s+=e.charAt(t-(r-1)),t-=r-1,r=0)):(n=a,s+=e.charAt(t-r),t-=r,r=0);return s};e.__arabicParser__.isArabicDiacritic=function(e){return void 0!==e&&void 0!==n[e.charCodeAt(0)]};var h=e.__arabicParser__.getCorrectForm=function(e,t,a){return i(e)?!1===r(e)?-1:!c(e)||!i(t)&&!i(a)||!i(a)&&l(t)||l(e)&&!i(t)||l(e)&&o(t)||l(e)&&l(t)?0:d(e)&&i(t)&&!l(t)&&i(a)&&c(a)?3:l(e)||!i(a)?1:2:-1},p=function(e){var a=0,n=0,s=0,r="",l="",o="",c=(e=e||"").split("\\s+"),d=[];for(a=0;a<c.length;a+=1){for(d.push(""),n=0;n<c[a].length;n+=1)r=c[a][n],l=c[a][n-1],o=c[a][n+1],i(r)?(s=h(r,l,o),d[a]+=-1!==s?String.fromCharCode(t[r.charCodeAt(0)][s]):r):d[a]+=r;d[a]=u(d[a])}return d.join(" ")},f=e.__arabicParser__.processArabic=e.processArabic=function(){var e,t="string"==typeof arguments[0]?arguments[0]:arguments[0].text,a=[];if(Array.isArray(t)){var n=0;for(a=[],n=0;n<t.length;n+=1)Array.isArray(t[n])?a.push([p(t[n][0]),t[n][1],t[n][2]]):a.push([p(t[n])]);e=a}else e=p(t);return"string"==typeof arguments[0]?e:(arguments[0].text=e,arguments[0])};e.events.push(["preProcessText",f])}(Ks.API),Ks.API.autoPrint=function(e){var t;return(e=e||{}).variant=e.variant||"non-conform","javascript"===e.variant?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){t=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+t+" 0 R")})),this},function(e){var t=function(){var e=void 0;Object.defineProperty(this,"pdf",{get:function(){return e},set:function(t){e=t}});var t=150;Object.defineProperty(this,"width",{get:function(){return t},set:function(e){t=isNaN(e)||!1===Number.isInteger(e)||e<0?150:e,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=t+1)}});var a=300;Object.defineProperty(this,"height",{get:function(){return a},set:function(e){a=isNaN(e)||!1===Number.isInteger(e)||e<0?300:e,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=a+1)}});var n=[];Object.defineProperty(this,"childNodes",{get:function(){return n},set:function(e){n=e}});var s={};Object.defineProperty(this,"style",{get:function(){return s},set:function(e){s=e}}),Object.defineProperty(this,"parentNode",{})};t.prototype.getContext=function(e,t){var a;if("2d"!==(e=e||"2d"))return null;for(a in t)this.pdf.context2d.hasOwnProperty(a)&&(this.pdf.context2d[a]=t[a]);return this.pdf.context2d._canvas=this,this.pdf.context2d},t.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},e.events.push(["initialized",function(){this.canvas=new t,this.canvas.pdf=this}])}(Ks.API),function(e){var t={left:0,top:0,bottom:0,right:0},a=!1,s=function(){void 0===this.internal.__cell__&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},t),this.internal.__cell__.margins.width=this.getPageWidth(),r.call(this))},r=function(){this.internal.__cell__.lastCell=new i,this.internal.__cell__.pages=1},i=function(){var e=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return e},set:function(t){e=t}});var t=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return t},set:function(e){t=e}});var a=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return a},set:function(e){a=e}});var n=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return n},set:function(e){n=e}});var s=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return s},set:function(e){s=e}});var r=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return r},set:function(e){r=e}});var i=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return i},set:function(e){i=e}}),this};i.prototype.clone=function(){return new i(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},i.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},e.setHeaderFunction=function(e){return s.call(this),this.internal.__cell__.headerFunction="function"==typeof e?e:void 0,this},e.getTextDimensions=function(e,t){s.call(this);var a=(t=t||{}).fontSize||this.getFontSize(),n=t.font||this.getFont(),r=t.scaleFactor||this.internal.scaleFactor,i=0,l=0,o=0,c=this;if(!Array.isArray(e)&&"string"!=typeof e){if("number"!=typeof e)throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");e=String(e)}var d=t.maxWidth;d>0?"string"==typeof e?e=this.splitTextToSize(e,d):"[object Array]"===Object.prototype.toString.call(e)&&(e=e.reduce(function(e,t){return e.concat(c.splitTextToSize(t,d))},[])):e=Array.isArray(e)?e:[e];for(var u=0;u<e.length;u++)i<(o=this.getStringUnitWidth(e[u],{font:n})*a)&&(i=o);return 0!==i&&(l=e.length),{w:i/=r,h:Math.max((l*a*this.getLineHeightFactor()-a*(this.getLineHeightFactor()-1))/r,0)}},e.cellAddPage=function(){s.call(this),this.addPage();var e=this.internal.__cell__.margins||t;return this.internal.__cell__.lastCell=new i(e.left,e.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var l=e.cell=function(){var e;e=arguments[0]instanceof i?arguments[0]:new i(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),s.call(this);var n=this.internal.__cell__.lastCell,r=this.internal.__cell__.padding,l=this.internal.__cell__.margins||t,o=this.internal.__cell__.tableHeaderRow,c=this.internal.__cell__.printHeaders;return void 0!==n.lineNumber&&(n.lineNumber===e.lineNumber?(e.x=(n.x||0)+(n.width||0),e.y=n.y||0):n.y+n.height+e.height+l.bottom>this.getPageHeight()?(this.cellAddPage(),e.y=l.top,c&&o&&(this.printHeaderRow(e.lineNumber,!0),e.y+=o[0].height)):e.y=n.y+n.height||e.y),void 0!==e.text[0]&&(this.rect(e.x,e.y,e.width,e.height,!0===a?"FD":void 0),"right"===e.align?this.text(e.text,e.x+e.width-r,e.y+r,{align:"right",baseline:"top"}):"center"===e.align?this.text(e.text,e.x+e.width/2,e.y+r,{align:"center",baseline:"top",maxWidth:e.width-r-r}):this.text(e.text,e.x+r,e.y+r,{align:"left",baseline:"top",maxWidth:e.width-r-r})),this.internal.__cell__.lastCell=e,this};e.table=function(e,a,c,d,u){if(s.call(this),!c)throw new Error("No data for PDF table.");var h,p,f,m,x=[],g=[],v=[],y={},b={},j=[],w=[],N=(u=u||{}).autoSize||!1,S=!1!==u.printHeaders,k=u.css&&void 0!==u.css["font-size"]?16*u.css["font-size"]:u.fontSize||12,A=u.margins||Object.assign({width:this.getPageWidth()},t),C="number"==typeof u.padding?u.padding:3,_=u.headerBackgroundColor||"#c8c8c8",L=u.headerTextColor||"#000";if(r.call(this),this.internal.__cell__.printHeaders=S,this.internal.__cell__.margins=A,this.internal.__cell__.table_font_size=k,this.internal.__cell__.padding=C,this.internal.__cell__.headerBackgroundColor=_,this.internal.__cell__.headerTextColor=L,this.setFontSize(k),null==d)g=x=Object.keys(c[0]),v=x.map(function(){return"left"});else if(Array.isArray(d)&&"object"===(0,n.A)(d[0]))for(x=d.map(function(e){return e.name}),g=d.map(function(e){return e.prompt||e.name||""}),v=d.map(function(e){return e.align||"left"}),h=0;h<d.length;h+=1)b[d[h].name]=.7499990551181103*d[h].width;else Array.isArray(d)&&"string"==typeof d[0]&&(g=x=d,v=x.map(function(){return"left"}));if(N||Array.isArray(d)&&"string"==typeof d[0])for(h=0;h<x.length;h+=1){for(y[m=x[h]]=c.map(function(e){return e[m]}),this.setFont(void 0,"bold"),j.push(this.getTextDimensions(g[h],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),p=y[m],this.setFont(void 0,"normal"),f=0;f<p.length;f+=1)j.push(this.getTextDimensions(p[f],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);b[m]=Math.max.apply(null,j)+C+C,j=[]}if(S){var T={};for(h=0;h<x.length;h+=1)T[x[h]]={},T[x[h]].text=g[h],T[x[h]].align=v[h];var E=o.call(this,T,b);w=x.map(function(t){return new i(e,a,b[t],E,T[t].text,void 0,T[t].align)}),this.setTableHeaderRow(w),this.printHeaderRow(1,!1)}var D=d.reduce(function(e,t){return e[t.name]=t.align,e},{});for(h=0;h<c.length;h+=1){"rowStart"in u&&u.rowStart instanceof Function&&u.rowStart({row:h,data:c[h]},this);var P=o.call(this,c[h],b);for(f=0;f<x.length;f+=1){var R=c[h][x[f]];"cellStart"in u&&u.cellStart instanceof Function&&u.cellStart({row:h,col:f,data:R},this),l.call(this,new i(e,a,b[x[f]],P,R,h+2,D[x[f]]))}}return this.internal.__cell__.table_x=e,this.internal.__cell__.table_y=a,this};var o=function(e,t){var a=this.internal.__cell__.padding,n=this.internal.__cell__.table_font_size,s=this.internal.scaleFactor;return Object.keys(e).map(function(n){var s=e[n];return this.splitTextToSize(s.hasOwnProperty("text")?s.text:s,t[n]-a-a)},this).map(function(e){return this.getLineHeightFactor()*e.length*n/s+a+a},this).reduce(function(e,t){return Math.max(e,t)},0)};e.setTableHeaderRow=function(e){s.call(this),this.internal.__cell__.tableHeaderRow=e},e.printHeaderRow=function(e,t){if(s.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var n;if(a=!0,"function"==typeof this.internal.__cell__.headerFunction){var r=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new i(r[0],r[1],r[2],r[3],void 0,-1)}this.setFont(void 0,"bold");for(var o=[],c=0;c<this.internal.__cell__.tableHeaderRow.length;c+=1){n=this.internal.__cell__.tableHeaderRow[c].clone(),t&&(n.y=this.internal.__cell__.margins.top||0,o.push(n)),n.lineNumber=e;var d=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),l.call(this,n),this.setTextColor(d)}o.length>0&&this.setTableHeaderRow(o),this.setFont(void 0,"normal"),a=!1}}(Ks.API);var Fr={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},Or=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],qr=Br(Or),zr=[100,200,300,400,500,600,700,800,900],Mr=Br(zr);function Ur(e){var t=e.family.replace(/"|'/g,"").toLowerCase(),a=function(e){return Fr[e=e||"normal"]?e:"normal"}(e.style),n=function(e){return e?"number"==typeof e?e>=100&&e<=900&&e%100==0?e:400:/^\d00$/.test(e)?parseInt(e):"bold"===e?700:400:400}(e.weight),s=function(e){return"number"==typeof qr[e=e||"normal"]?e:"normal"}(e.stretch);return{family:t,style:a,weight:n,stretch:s,src:e.src||[],ref:e.ref||{name:t,style:[s,a,n].join(" ")}}}function Wr(e,t,a,n){var s;for(s=a;s>=0&&s<t.length;s+=n)if(e[t[s]])return e[t[s]];for(s=a;s>=0&&s<t.length;s-=n)if(e[t[s]])return e[t[s]]}var Hr={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},Vr={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function Gr(e){return[e.stretch,e.style,e.weight,e.family].join(" ")}function Jr(e){return e.trimLeft()}function Yr(e,t){for(var a=0;a<e.length;){if(e.charAt(a)===t)return[e.substring(0,a),e.substring(a+1)];a+=1}return null}function Kr(e){var t=e.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return null===t?null:[t[0],e.substring(t[0].length)]}var Qr,$r,Xr,Zr,ei,ti,ai,ni,si,ri=["times"];function ii(e,t,a,n,s){var r=4,i=ci;switch(s){case Ks.API.image_compression.FAST:r=1,i=oi;break;case Ks.API.image_compression.MEDIUM:r=6,i=di;break;case Ks.API.image_compression.SLOW:r=9,i=ui}e=function(e,t,a,n){for(var s,r=e.length/t,i=new Uint8Array(e.length+r),l=[li,oi,ci,di,ui],o=0;o<r;o+=1){var c=o*t,d=e.subarray(c,c+t);if(n)i.set(n(d,a,s),c+o);else{for(var u=l.length,h=[],p=0;p<u;p+=1)h[p]=l[p](d,a,s);var f=pi(h.concat());i.set(h[f],c+o)}s=d}return i}(e,t,Math.ceil(a*n/8),i);var l=M(e,{level:r});return Ks.API.__addimage__.arrayBufferToBinaryString(l)}function li(e){var t=Array.apply([],e);return t.unshift(0),t}function oi(e,t){var a=e.length,n=[];n[0]=1;for(var s=0;s<a;s+=1){var r=e[s-t]||0;n[s+1]=e[s]-r+256&255}return n}function ci(e,t,a){var n=e.length,s=[];s[0]=2;for(var r=0;r<n;r+=1){var i=a&&a[r]||0;s[r+1]=e[r]-i+256&255}return s}function di(e,t,a){var n=e.length,s=[];s[0]=3;for(var r=0;r<n;r+=1){var i=e[r-t]||0,l=a&&a[r]||0;s[r+1]=e[r]+256-(i+l>>>1)&255}return s}function ui(e,t,a){var n=e.length,s=[];s[0]=4;for(var r=0;r<n;r+=1){var i=hi(e[r-t]||0,a&&a[r]||0,a&&a[r-t]||0);s[r+1]=e[r]-i+256&255}return s}function hi(e,t,a){if(e===t&&t===a)return e;var n=Math.abs(t-a),s=Math.abs(e-a),r=Math.abs(e+t-a-a);return n<=s&&n<=r?e:s<=r?t:a}function pi(e){var t=e.map(function(e){return e.reduce(function(e,t){return e+Math.abs(t)},0)});return t.indexOf(Math.min.apply(null,t))}function fi(e,t,a){var n=t*a,s=Math.floor(n/8),r=16-(n-8*s+a),i=(1<<a)-1;return xi(e,s)>>r&i}function mi(e,t,a,n){var s=a*n,r=Math.floor(s/8),i=16-(s-8*r+n),l=(1<<n)-1,o=(t&l)<<i;!function(e,t,a){if(t+1<e.byteLength)e.setUint16(t,a,!1);else{var n=a>>8&255;e.setUint8(t,n)}}(e,r,xi(e,r)&~(l<<i)&65535|o)}function xi(e,t){return t+1<e.byteLength?e.getUint16(t,!1):e.getUint8(t)<<8}function gi(e){var t=0;if(71!==e[t++]||73!==e[t++]||70!==e[t++]||56!==e[t++]||56!=(e[t++]+1&253)||97!==e[t++])throw new Error("Invalid GIF 87a/89a header.");var a=e[t++]|e[t++]<<8,n=e[t++]|e[t++]<<8,s=e[t++],r=s>>7,i=1<<1+(7&s);e[t++],e[t++];var l=null,o=null;r&&(l=t,o=i,t+=3*i);var c=!0,d=[],u=0,h=null,p=0,f=null;for(this.width=a,this.height=n;c&&t<e.length;)switch(e[t++]){case 33:switch(e[t++]){case 255:if(11!==e[t]||78==e[t+1]&&69==e[t+2]&&84==e[t+3]&&83==e[t+4]&&67==e[t+5]&&65==e[t+6]&&80==e[t+7]&&69==e[t+8]&&50==e[t+9]&&46==e[t+10]&&48==e[t+11]&&3==e[t+12]&&1==e[t+13]&&0==e[t+16])t+=14,f=e[t++]|e[t++]<<8,t++;else for(t+=12;;){if(!((C=e[t++])>=0))throw Error("Invalid block size");if(0===C)break;t+=C}break;case 249:if(4!==e[t++]||0!==e[t+4])throw new Error("Invalid graphics extension block.");var m=e[t++];u=e[t++]|e[t++]<<8,h=e[t++],1&m||(h=null),p=m>>2&7,t++;break;case 254:for(;;){if(!((C=e[t++])>=0))throw Error("Invalid block size");if(0===C)break;t+=C}break;default:throw new Error("Unknown graphic control label: 0x"+e[t-1].toString(16))}break;case 44:var x=e[t++]|e[t++]<<8,g=e[t++]|e[t++]<<8,v=e[t++]|e[t++]<<8,y=e[t++]|e[t++]<<8,b=e[t++],j=b>>6&1,w=1<<1+(7&b),N=l,S=o,k=!1;b>>7&&(k=!0,N=t,S=w,t+=3*w);var A=t;for(t++;;){var C;if(!((C=e[t++])>=0))throw Error("Invalid block size");if(0===C)break;t+=C}d.push({x:x,y:g,width:v,height:y,has_local_palette:k,palette_offset:N,palette_size:S,data_offset:A,data_length:t-A,transparent_index:h,interlaced:!!j,delay:u,disposal:p});break;case 59:c=!1;break;default:throw new Error("Unknown gif block: 0x"+e[t-1].toString(16))}this.numFrames=function(){return d.length},this.loopCount=function(){return f},this.frameInfo=function(e){if(e<0||e>=d.length)throw new Error("Frame index out of range.");return d[e]},this.decodeAndBlitFrameBGRA=function(t,n){var s=this.frameInfo(t),r=s.width*s.height,i=new Uint8Array(r);vi(e,s.data_offset,i,r);var l=s.palette_offset,o=s.transparent_index;null===o&&(o=256);var c=s.width,d=a-c,u=c,h=4*(s.y*a+s.x),p=4*((s.y+s.height)*a+s.x),f=h,m=4*d;!0===s.interlaced&&(m+=4*a*7);for(var x=8,g=0,v=i.length;g<v;++g){var y=i[g];if(0===u&&(u=c,(f+=m)>=p&&(m=4*d+4*a*(x-1),f=h+(c+d)*(x<<1),x>>=1)),y===o)f+=4;else{var b=e[l+3*y],j=e[l+3*y+1],w=e[l+3*y+2];n[f++]=w,n[f++]=j,n[f++]=b,n[f++]=255}--u}},this.decodeAndBlitFrameRGBA=function(t,n){var s=this.frameInfo(t),r=s.width*s.height,i=new Uint8Array(r);vi(e,s.data_offset,i,r);var l=s.palette_offset,o=s.transparent_index;null===o&&(o=256);var c=s.width,d=a-c,u=c,h=4*(s.y*a+s.x),p=4*((s.y+s.height)*a+s.x),f=h,m=4*d;!0===s.interlaced&&(m+=4*a*7);for(var x=8,g=0,v=i.length;g<v;++g){var y=i[g];if(0===u&&(u=c,(f+=m)>=p&&(m=4*d+4*a*(x-1),f=h+(c+d)*(x<<1),x>>=1)),y===o)f+=4;else{var b=e[l+3*y],j=e[l+3*y+1],w=e[l+3*y+2];n[f++]=b,n[f++]=j,n[f++]=w,n[f++]=255}--u}}}function vi(e,t,a,n){for(var s=e[t++],r=1<<s,i=r+1,l=i+1,o=s+1,c=(1<<o)-1,d=0,u=0,h=0,p=e[t++],f=new Int32Array(4096),m=null;;){for(;d<16&&0!==p;)u|=e[t++]<<d,d+=8,1===p?p=e[t++]:--p;if(d<o)break;var x=u&c;if(u>>=o,d-=o,x!==r){if(x===i)break;for(var g=x<l?x:m,v=0,y=g;y>r;)y=f[y]>>8,++v;var b=y;if(h+v+(g!==x?1:0)>n)return void vs.log("Warning, gif stream longer than expected.");a[h++]=b;var j=h+=v;for(g!==x&&(a[h++]=b),y=g;v--;)y=f[y],a[--j]=255&y,y>>=8;null!==m&&l<4096&&(f[l++]=m<<8|b,l>=c+1&&o<12&&(++o,c=c<<1|1)),m=x}else l=i+1,c=(1<<(o=s+1))-1,m=null}return h!==n&&vs.log("Warning, gif stream shorter than expected."),a}function yi(e){var t,a,n,s,r,i=Math.floor,l=new Array(64),o=new Array(64),c=new Array(64),d=new Array(64),u=new Array(65535),h=new Array(65535),p=new Array(64),f=new Array(64),m=[],x=0,g=7,v=new Array(64),y=new Array(64),b=new Array(64),j=new Array(256),w=new Array(2048),N=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],S=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],k=[0,1,2,3,4,5,6,7,8,9,10,11],A=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],C=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],_=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],L=[0,1,2,3,4,5,6,7,8,9,10,11],T=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],E=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function D(e,t){for(var a=0,n=0,s=new Array,r=1;r<=16;r++){for(var i=1;i<=e[r];i++)s[t[n]]=[],s[t[n]][0]=a,s[t[n]][1]=r,n++,a++;a*=2}return s}function P(e){for(var t=e[0],a=e[1]-1;a>=0;)t&1<<a&&(x|=1<<g),a--,--g<0&&(255==x?(R(255),R(0)):R(x),g=7,x=0)}function R(e){m.push(e)}function I(e){R(e>>8&255),R(255&e)}function B(e,t,a,n,s){for(var r,i=s[0],l=s[240],o=function(e,t){var a,n,s,r,i,l,o,c,d,u,h=0;for(d=0;d<8;++d){a=e[h],n=e[h+1],s=e[h+2],r=e[h+3],i=e[h+4],l=e[h+5],o=e[h+6];var f=a+(c=e[h+7]),m=a-c,x=n+o,g=n-o,v=s+l,y=s-l,b=r+i,j=r-i,w=f+b,N=f-b,S=x+v,k=x-v;e[h]=w+S,e[h+4]=w-S;var A=.707106781*(k+N);e[h+2]=N+A,e[h+6]=N-A;var C=.382683433*((w=j+y)-(k=g+m)),_=.5411961*w+C,L=1.306562965*k+C,T=.707106781*(S=y+g),E=m+T,D=m-T;e[h+5]=D+_,e[h+3]=D-_,e[h+1]=E+L,e[h+7]=E-L,h+=8}for(h=0,d=0;d<8;++d){a=e[h],n=e[h+8],s=e[h+16],r=e[h+24],i=e[h+32],l=e[h+40],o=e[h+48];var P=a+(c=e[h+56]),R=a-c,I=n+o,B=n-o,F=s+l,O=s-l,q=r+i,z=r-i,M=P+q,U=P-q,W=I+F,H=I-F;e[h]=M+W,e[h+32]=M-W;var V=.707106781*(H+U);e[h+16]=U+V,e[h+48]=U-V;var G=.382683433*((M=z+O)-(H=B+R)),J=.5411961*M+G,Y=1.306562965*H+G,K=.707106781*(W=O+B),Q=R+K,$=R-K;e[h+40]=$+J,e[h+24]=$-J,e[h+8]=Q+Y,e[h+56]=Q-Y,h++}for(d=0;d<64;++d)u=e[d]*t[d],p[d]=u>0?u+.5|0:u-.5|0;return p}(e,t),c=0;c<64;++c)f[N[c]]=o[c];var d=f[0]-a;a=f[0],0==d?P(n[0]):(P(n[h[r=32767+d]]),P(u[r]));for(var m=63;m>0&&0==f[m];)m--;if(0==m)return P(i),a;for(var x,g=1;g<=m;){for(var v=g;0==f[g]&&g<=m;)++g;var y=g-v;if(y>=16){x=y>>4;for(var b=1;b<=x;++b)P(l);y&=15}r=32767+f[g],P(s[(y<<4)+h[r]]),P(u[r]),g++}return 63!=m&&P(i),a}function F(e){e=Math.min(Math.max(e,1),100),r!=e&&(function(e){for(var t=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],a=0;a<64;a++){var n=i((t[a]*e+50)/100);n=Math.min(Math.max(n,1),255),l[N[a]]=n}for(var s=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],r=0;r<64;r++){var u=i((s[r]*e+50)/100);u=Math.min(Math.max(u,1),255),o[N[r]]=u}for(var h=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],p=0,f=0;f<8;f++)for(var m=0;m<8;m++)c[p]=1/(l[N[p]]*h[f]*h[m]*8),d[p]=1/(o[N[p]]*h[f]*h[m]*8),p++}(e<50?Math.floor(5e3/e):Math.floor(200-2*e)),r=e)}this.encode=function(e,r){r&&F(r),m=new Array,x=0,g=7,I(65496),I(65504),I(16),R(74),R(70),R(73),R(70),R(0),R(1),R(1),R(0),I(1),I(1),R(0),R(0),function(){I(65499),I(132),R(0);for(var e=0;e<64;e++)R(l[e]);R(1);for(var t=0;t<64;t++)R(o[t])}(),function(e,t){I(65472),I(17),R(8),I(t),I(e),R(3),R(1),R(17),R(0),R(2),R(17),R(1),R(3),R(17),R(1)}(e.width,e.height),function(){I(65476),I(418),R(0);for(var e=0;e<16;e++)R(S[e+1]);for(var t=0;t<=11;t++)R(k[t]);R(16);for(var a=0;a<16;a++)R(A[a+1]);for(var n=0;n<=161;n++)R(C[n]);R(1);for(var s=0;s<16;s++)R(_[s+1]);for(var r=0;r<=11;r++)R(L[r]);R(17);for(var i=0;i<16;i++)R(T[i+1]);for(var l=0;l<=161;l++)R(E[l])}(),I(65498),I(12),R(3),R(1),R(0),R(2),R(17),R(3),R(17),R(0),R(63),R(0);var i=0,u=0,h=0;x=0,g=7,this.encode.displayName="_encode_";for(var p,f,j,N,D,O,q,z,M,U=e.data,W=e.width,H=e.height,V=4*W,G=0;G<H;){for(p=0;p<V;){for(D=V*G+p,q=-1,z=0,M=0;M<64;M++)O=D+(z=M>>3)*V+(q=4*(7&M)),G+z>=H&&(O-=V*(G+1+z-H)),p+q>=V&&(O-=p+q-V+4),f=U[O++],j=U[O++],N=U[O++],v[M]=(w[f]+w[j+256|0]+w[N+512|0]>>16)-128,y[M]=(w[f+768|0]+w[j+1024|0]+w[N+1280|0]>>16)-128,b[M]=(w[f+1280|0]+w[j+1536|0]+w[N+1792|0]>>16)-128;i=B(v,c,i,t,n),u=B(y,d,u,a,s),h=B(b,d,h,a,s),p+=32}G+=8}if(g>=0){var J=[];J[1]=g+1,J[0]=(1<<g+1)-1,P(J)}return I(65497),new Uint8Array(m)},e=e||50,function(){for(var e=String.fromCharCode,t=0;t<256;t++)j[t]=e(t)}(),t=D(S,k),a=D(_,L),n=D(A,C),s=D(T,E),function(){for(var e=1,t=2,a=1;a<=15;a++){for(var n=e;n<t;n++)h[32767+n]=a,u[32767+n]=[],u[32767+n][1]=a,u[32767+n][0]=n;for(var s=-(t-1);s<=-e;s++)h[32767+s]=a,u[32767+s]=[],u[32767+s][1]=a,u[32767+s][0]=t-1+s;e<<=1,t<<=1}}(),function(){for(var e=0;e<256;e++)w[e]=19595*e,w[e+256|0]=38470*e,w[e+512|0]=7471*e+32768,w[e+768|0]=-11059*e,w[e+1024|0]=-21709*e,w[e+1280|0]=32768*e+8421375,w[e+1536|0]=-27439*e,w[e+1792|0]=-5329*e}(),F(e)}function bi(e,t){if(this.pos=0,this.buffer=e,this.datav=new DataView(e.buffer),this.is_with_alpha=!!t,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,-1===["BM","BA","CI","CP","IC","PT"].indexOf(this.flag))throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function ji(e){function t(e){if(!e)throw Error("assert :P")}function a(e,t,a){for(var n=0;4>n;n++)if(e[t+n]!=a.charCodeAt(n))return!0;return!1}function n(e,t,a,n,s){for(var r=0;r<s;r++)e[t+r]=a[n+r]}function s(e,t,a,n){for(var s=0;s<n;s++)e[t+s]=a}function r(e){return new Int32Array(e)}function i(e,t){for(var a=[],n=0;n<e;n++)a.push(new t);return a}function l(e,t){var a=[];return function e(a,n,s){for(var r=s[n],i=0;i<r&&(a.push(s.length>n+1?[]:new t),!(s.length<n+1));i++)e(a[i],n+1,s)}(a,0,e),a}var o=function(){var e=this;function o(e,t){for(var a=1<<t-1>>>0;e&a;)a>>>=1;return a?(e&a-1)+a:e}function c(e,a,n,s,r){t(!(s%n));do{e[a+(s-=n)]=r}while(0<s)}function d(e,a,n,s,i){if(t(2328>=i),512>=i)var l=r(512);else if(null==(l=r(i)))return 0;return function(e,a,n,s,i,l){var d,h,p=a,f=1<<n,m=r(16),x=r(16);for(t(0!=i),t(null!=s),t(null!=e),t(0<n),h=0;h<i;++h){if(15<s[h])return 0;++m[s[h]]}if(m[0]==i)return 0;for(x[1]=0,d=1;15>d;++d){if(m[d]>1<<d)return 0;x[d+1]=x[d]+m[d]}for(h=0;h<i;++h)d=s[h],0<s[h]&&(l[x[d]++]=h);if(1==x[15])return(s=new u).g=0,s.value=l[0],c(e,p,1,f,s),f;var g,v=-1,y=f-1,b=0,j=1,w=1,N=1<<n;for(h=0,d=1,i=2;d<=n;++d,i<<=1){if(j+=w<<=1,0>(w-=m[d]))return 0;for(;0<m[d];--m[d])(s=new u).g=d,s.value=l[h++],c(e,p+b,i,N,s),b=o(b,d)}for(d=n+1,i=2;15>=d;++d,i<<=1){if(j+=w<<=1,0>(w-=m[d]))return 0;for(;0<m[d];--m[d]){if(s=new u,(b&y)!=v){for(p+=N,g=1<<(v=d)-n;15>v&&!(0>=(g-=m[v]));)++v,g<<=1;f+=N=1<<(g=v-n),e[a+(v=b&y)].g=g+n,e[a+v].value=p-a-v}s.g=d-n,s.value=l[h++],c(e,p+(b>>n),i,N,s),b=o(b,d)}}return j!=2*x[15]-1?0:f}(e,a,n,s,i,l)}function u(){this.value=this.g=0}function h(){this.value=this.g=0}function p(){this.G=i(5,u),this.H=r(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=i(Fa,h)}function f(e,a,n,s){t(null!=e),t(null!=a),t(2147483648>s),e.Ca=254,e.I=0,e.b=-8,e.Ka=0,e.oa=a,e.pa=n,e.Jd=a,e.Yc=n+s,e.Zc=4<=s?n+s-4+1:n,A(e)}function m(e,t){for(var a=0;0<t--;)a|=_(e,128)<<t;return a}function x(e,t){var a=m(e,t);return C(e)?-a:a}function g(e,a,n,s){var r,i=0;for(t(null!=e),t(null!=a),t(4294967288>s),e.Sb=s,e.Ra=0,e.u=0,e.h=0,4<s&&(s=4),r=0;r<s;++r)i+=a[n+r]<<8*r;e.Ra=i,e.bb=s,e.oa=a,e.pa=n}function v(e){for(;8<=e.u&&e.bb<e.Sb;)e.Ra>>>=8,e.Ra+=e.oa[e.pa+e.bb]<<za-8>>>0,++e.bb,e.u-=8;N(e)&&(e.h=1,e.u=0)}function y(e,a){if(t(0<=a),!e.h&&a<=qa){var n=w(e)&Oa[a];return e.u+=a,v(e),n}return e.h=1,e.u=0}function b(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function j(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function w(e){return e.Ra>>>(e.u&za-1)>>>0}function N(e){return t(e.bb<=e.Sb),e.h||e.bb==e.Sb&&e.u>za}function S(e,t){e.u=t,e.h=N(e)}function k(e){e.u>=Ma&&(t(e.u>=Ma),v(e))}function A(e){t(null!=e&&null!=e.oa),e.pa<e.Zc?(e.I=(e.oa[e.pa++]|e.I<<8)>>>0,e.b+=8):(t(null!=e&&null!=e.oa),e.pa<e.Yc?(e.b+=8,e.I=e.oa[e.pa++]|e.I<<8):e.Ka?e.b=0:(e.I<<=8,e.b+=8,e.Ka=1))}function C(e){return m(e,1)}function _(e,t){var a=e.Ca;0>e.b&&A(e);var n=e.b,s=a*t>>>8,r=(e.I>>>n>s)+0;for(r?(a-=s,e.I-=s+1<<n>>>0):a=s+1,n=a,s=0;256<=n;)s+=8,n>>=8;return n=7^s+Ua[n],e.b-=n,e.Ca=(a<<n)-1,r}function L(e,t,a){e[t+0]=a>>24&255,e[t+1]=a>>16&255,e[t+2]=a>>8&255,e[t+3]=255&a}function T(e,t){return e[t+0]|e[t+1]<<8}function E(e,t){return T(e,t)|e[t+2]<<16}function D(e,t){return T(e,t)|T(e,t+2)<<16}function P(e,a){var n=1<<a;return t(null!=e),t(0<a),e.X=r(n),null==e.X?0:(e.Mb=32-a,e.Xa=a,1)}function R(e,a){t(null!=e),t(null!=a),t(e.Xa==a.Xa),n(a.X,0,e.X,0,1<<a.Xa)}function I(){this.X=[],this.Xa=this.Mb=0}function B(e,a,n,s){t(null!=n),t(null!=s);var r=n[0],i=s[0];return 0==r&&(r=(e*i+a/2)/a),0==i&&(i=(a*r+e/2)/e),0>=r||0>=i?0:(n[0]=r,s[0]=i,1)}function F(e,t){return e+(1<<t)-1>>>t}function O(e,t){return((4278255360&e)+(4278255360&t)>>>0&4278255360)+((16711935&e)+(16711935&t)>>>0&16711935)>>>0}function q(t,a){e[a]=function(a,n,s,r,i,l,o){var c;for(c=0;c<i;++c){var d=e[t](l[o+c-1],s,r+c);l[o+c]=O(a[n+c],d)}}}function z(){this.ud=this.hd=this.jd=0}function M(e,t){return((4278124286&(e^t))>>>1)+(e&t)>>>0}function U(e){return 0<=e&&256>e?e:0>e?0:255<e?255:void 0}function W(e,t){return U(e+(e-t+.5>>1))}function H(e,t,a){return Math.abs(t-a)-Math.abs(e-a)}function V(e,t,a,n,s,r,i){for(n=r[i-1],a=0;a<s;++a)r[i+a]=n=O(e[t+a],n)}function G(e,t,a,n,s){var r;for(r=0;r<a;++r){var i=e[t+r],l=i>>8&255,o=16711935&(o=(o=16711935&i)+((l<<16)+l));n[s+r]=(4278255360&i)+o>>>0}}function J(e,t){t.jd=255&e,t.hd=e>>8&255,t.ud=e>>16&255}function Y(e,t,a,n,s,r){var i;for(i=0;i<n;++i){var l=t[a+i],o=l>>>8,c=l,d=255&(d=(d=l>>>16)+((e.jd<<24>>24)*(o<<24>>24)>>>5));c=255&(c=(c+=(e.hd<<24>>24)*(o<<24>>24)>>>5)+((e.ud<<24>>24)*(d<<24>>24)>>>5)),s[r+i]=(4278255360&l)+(d<<16)+c}}function K(t,a,n,s,r){e[a]=function(e,t,a,n,i,l,o,c,d){for(n=o;n<c;++n)for(o=0;o<d;++o)i[l++]=r(a[s(e[t++])])},e[t]=function(t,a,i,l,o,c,d){var u=8>>t.b,h=t.Ea,p=t.K[0],f=t.w;if(8>u)for(t=(1<<t.b)-1,f=(1<<u)-1;a<i;++a){var m,x=0;for(m=0;m<h;++m)m&t||(x=s(l[o++])),c[d++]=r(p[x&f]),x>>=u}else e["VP8LMapColor"+n](l,o,p,f,c,d,a,i,h)}}function Q(e,t,a,n,s){for(a=t+a;t<a;){var r=e[t++];n[s++]=r>>16&255,n[s++]=r>>8&255,n[s++]=255&r}}function $(e,t,a,n,s){for(a=t+a;t<a;){var r=e[t++];n[s++]=r>>16&255,n[s++]=r>>8&255,n[s++]=255&r,n[s++]=r>>24&255}}function X(e,t,a,n,s){for(a=t+a;t<a;){var r=(i=e[t++])>>16&240|i>>12&15,i=240&i|i>>28&15;n[s++]=r,n[s++]=i}}function Z(e,t,a,n,s){for(a=t+a;t<a;){var r=(i=e[t++])>>16&248|i>>13&7,i=i>>5&224|i>>3&31;n[s++]=r,n[s++]=i}}function ee(e,t,a,n,s){for(a=t+a;t<a;){var r=e[t++];n[s++]=255&r,n[s++]=r>>8&255,n[s++]=r>>16&255}}function te(e,t,a,s,r,i){if(0==i)for(a=t+a;t<a;)L(s,((i=e[t++])[0]>>24|i[1]>>8&65280|i[2]<<8&16711680|i[3]<<24)>>>0),r+=32;else n(s,r,e,t,a)}function ae(t,a){e[a][0]=e[t+"0"],e[a][1]=e[t+"1"],e[a][2]=e[t+"2"],e[a][3]=e[t+"3"],e[a][4]=e[t+"4"],e[a][5]=e[t+"5"],e[a][6]=e[t+"6"],e[a][7]=e[t+"7"],e[a][8]=e[t+"8"],e[a][9]=e[t+"9"],e[a][10]=e[t+"10"],e[a][11]=e[t+"11"],e[a][12]=e[t+"12"],e[a][13]=e[t+"13"],e[a][14]=e[t+"0"],e[a][15]=e[t+"0"]}function ne(e){return e==Un||e==Wn||e==Hn||e==Vn}function se(){this.eb=[],this.size=this.A=this.fb=0}function re(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function ie(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new se,this.f.kb=new re,this.sd=null}function le(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function oe(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function ce(e){return alert("todo:WebPSamplerProcessPlane"),e.T}function de(e,t){var a=e.T,s=t.ba.f.RGBA,r=s.eb,i=s.fb+e.ka*s.A,l=xs[t.ba.S],o=e.y,c=e.O,d=e.f,u=e.N,h=e.ea,p=e.W,f=t.cc,m=t.dc,x=t.Mc,g=t.Nc,v=e.ka,y=e.ka+e.T,b=e.U,j=b+1>>1;for(0==v?l(o,c,null,null,d,u,h,p,d,u,h,p,r,i,null,null,b):(l(t.ec,t.fc,o,c,f,m,x,g,d,u,h,p,r,i-s.A,r,i,b),++a);v+2<y;v+=2)f=d,m=u,x=h,g=p,u+=e.Rc,p+=e.Rc,i+=2*s.A,l(o,(c+=2*e.fa)-e.fa,o,c,f,m,x,g,d,u,h,p,r,i-s.A,r,i,b);return c+=e.fa,e.j+y<e.o?(n(t.ec,t.fc,o,c,b),n(t.cc,t.dc,d,u,j),n(t.Mc,t.Nc,h,p,j),a--):1&y||l(o,c,null,null,d,u,h,p,d,u,h,p,r,i+s.A,null,null,b),a}function ue(e,a,n){var s=e.F,r=[e.J];if(null!=s){var i=e.U,l=a.ba.S,o=l==qn||l==Hn;a=a.ba.f.RGBA;var c=[0],d=e.ka;c[0]=e.T,e.Kb&&(0==d?--c[0]:(--d,r[0]-=e.width),e.j+e.ka+e.T==e.o&&(c[0]=e.o-e.j-d));var u=a.eb;d=a.fb+d*a.A,e=Sn(s,r[0],e.width,i,c,u,d+(o?0:3),a.A),t(n==c),e&&ne(l)&&wn(u,d,o,i,c,a.A)}return 0}function he(e){var t=e.ma,a=t.ba.S,n=11>a,s=a==Bn||a==On||a==qn||a==zn||12==a||ne(a);if(t.memory=null,t.Ib=null,t.Jb=null,t.Nd=null,!Ra(t.Oa,e,s?11:12))return 0;if(s&&ne(a)&&ga(),e.da)alert("todo:use_scaling");else{if(n){if(t.Ib=ce,e.Kb){if(a=e.U+1>>1,t.memory=r(e.U+2*a),null==t.memory)return 0;t.ec=t.memory,t.fc=0,t.cc=t.ec,t.dc=t.fc+e.U,t.Mc=t.cc,t.Nc=t.dc+a,t.Ib=de,ga()}}else alert("todo:EmitYUV");s&&(t.Jb=ue,n&&ma())}if(n&&!Ts){for(e=0;256>e;++e)Es[e]=89858*(e-128)+ks>>Ss,Rs[e]=-22014*(e-128)+ks,Ps[e]=-45773*(e-128),Ds[e]=113618*(e-128)+ks>>Ss;for(e=As;e<Cs;++e)t=76283*(e-16)+ks>>Ss,Is[e-As]=Ve(t,255),Bs[e-As]=Ve(t+8>>4,15);Ts=1}return 1}function pe(e){var a=e.ma,n=e.U,s=e.T;return t(!(1&e.ka)),0>=n||0>=s?0:(n=a.Ib(e,a),null!=a.Jb&&a.Jb(e,a,n),a.Dc+=n,1)}function fe(e){e.ma.memory=null}function me(e,t,a,n){return 47!=y(e,8)?0:(t[0]=y(e,14)+1,a[0]=y(e,14)+1,n[0]=y(e,1),0!=y(e,3)?0:!e.h)}function xe(e,t){if(4>e)return e+1;var a=e-2>>1;return(2+(1&e)<<a)+y(t,a)+1}function ge(e,t){return 120<t?t-120:1<=(a=((a=$n[t-1])>>4)*e+(8-(15&a)))?a:1;var a}function ve(e,t,a){var n=w(a),s=e[t+=255&n].g-8;return 0<s&&(S(a,a.u+8),n=w(a),t+=e[t].value,t+=n&(1<<s)-1),S(a,a.u+e[t].g),e[t].value}function ye(e,a,n){return n.g+=e.g,n.value+=e.value<<a>>>0,t(8>=n.g),e.g}function be(e,a,n){var s=e.xc;return t((a=0==s?0:e.vc[e.md*(n>>s)+(a>>s)])<e.Wb),e.Ya[a]}function je(e,a,s,r){var i=e.ab,l=e.c*a,o=e.C;a=o+a;var c=s,d=r;for(r=e.Ta,s=e.Ua;0<i--;){var u=e.gc[i],h=o,p=a,f=c,m=d,x=(d=r,c=s,u.Ea);switch(t(h<p),t(p<=u.nc),u.hc){case 2:Va(f,m,(p-h)*x,d,c);break;case 0:var g=h,v=p,y=d,b=c,j=(A=u).Ea;0==g&&(Wa(f,m,null,null,1,y,b),V(f,m+1,0,0,j-1,y,b+1),m+=j,b+=j,++g);for(var w=1<<A.b,N=w-1,S=F(j,A.b),k=A.K,A=A.w+(g>>A.b)*S;g<v;){var C=k,_=A,L=1;for(Ha(f,m,y,b-j,1,y,b);L<j;){var T=(L&~N)+w;T>j&&(T=j),(0,Qa[C[_++]>>8&15])(f,m+ +L,y,b+L-j,T-L,y,b+L),L=T}m+=j,b+=j,++g&N||(A+=S)}p!=u.nc&&n(d,c-x,d,c+(p-h-1)*x,x);break;case 1:for(x=f,v=m,j=(f=u.Ea)-(b=f&~(y=(m=1<<u.b)-1)),g=F(f,u.b),w=u.K,u=u.w+(h>>u.b)*g;h<p;){for(N=w,S=u,k=new z,A=v+b,C=v+f;v<A;)J(N[S++],k),$a(k,x,v,m,d,c),v+=m,c+=m;v<C&&(J(N[S++],k),$a(k,x,v,j,d,c),v+=j,c+=j),++h&y||(u+=g)}break;case 3:if(f==d&&m==c&&0<u.b){for(v=d,f=x=c+(p-h)*x-(b=(p-h)*F(u.Ea,u.b)),m=d,y=c,g=[],b=(j=b)-1;0<=b;--b)g[b]=m[y+b];for(b=j-1;0<=b;--b)v[f+b]=g[b];Ga(u,h,p,d,x,d,c)}else Ga(u,h,p,f,m,d,c)}c=r,d=s}d!=s&&n(r,s,c,d,l)}function we(e,a){var n=e.V,s=e.Ba+e.c*e.C,r=a-e.C;if(t(a<=e.l.o),t(16>=r),0<r){var i=e.l,l=e.Ta,o=e.Ua,c=i.width;if(je(e,r,n,s),r=o=[o],t((n=e.C)<(s=a)),t(i.v<i.va),s>i.o&&(s=i.o),n<i.j){var d=i.j-n;n=i.j,r[0]+=d*c}if(n>=s?n=0:(r[0]+=4*i.v,i.ka=n-i.j,i.U=i.va-i.v,i.T=s-n,n=1),n){if(o=o[0],11>(n=e.ca).S){var u=n.f.RGBA,h=(s=n.S,r=i.U,i=i.T,d=u.eb,u.A),p=i;for(u=u.fb+e.Ma*u.A;0<p--;){var f=l,m=o,x=r,g=d,v=u;switch(s){case In:Xa(f,m,x,g,v);break;case Bn:Za(f,m,x,g,v);break;case Un:Za(f,m,x,g,v),wn(g,v,0,x,1,0);break;case Fn:an(f,m,x,g,v);break;case On:te(f,m,x,g,v,1);break;case Wn:te(f,m,x,g,v,1),wn(g,v,0,x,1,0);break;case qn:te(f,m,x,g,v,0);break;case Hn:te(f,m,x,g,v,0),wn(g,v,1,x,1,0);break;case zn:en(f,m,x,g,v);break;case Vn:en(f,m,x,g,v),Nn(g,v,x,1,0);break;case Mn:tn(f,m,x,g,v);break;default:t(0)}o+=c,u+=h}e.Ma+=i}else alert("todo:EmitRescaledRowsYUVA");t(e.Ma<=n.height)}}e.C=a,t(e.C<=e.i)}function Ne(e){var t;if(0<e.ua)return 0;for(t=0;t<e.Wb;++t){var a=e.Ya[t].G,n=e.Ya[t].H;if(0<a[1][n[1]+0].g||0<a[2][n[2]+0].g||0<a[3][n[3]+0].g)return 0}return 1}function Se(e,a,n,s,r,i){if(0!=e.Z){var l=e.qd,o=e.rd;for(t(null!=ms[e.Z]);a<n;++a)ms[e.Z](l,o,s,r,s,r,i),l=s,o=r,r+=i;e.qd=l,e.rd=o}}function ke(e,a){var n=e.l.ma,s=0==n.Z||1==n.Z?e.l.j:e.C;if(s=e.C<s?s:e.C,t(a<=e.l.o),a>s){var r=e.l.width,i=n.ca,l=n.tb+r*s,o=e.V,c=e.Ba+e.c*s,d=e.gc;t(1==e.ab),t(3==d[0].hc),Ya(d[0],s,a,o,c,i,l),Se(n,s,a,i,l,r)}e.C=e.Ma=a}function Ae(e,a,n,s,r,i,l){var o=e.$/s,c=e.$%s,d=e.m,u=e.s,h=n+e.$,p=h;r=n+s*r;var f=n+s*i,m=280+u.ua,x=e.Pb?o:16777216,g=0<u.ua?u.Wa:null,v=u.wc,y=h<f?be(u,c,o):null;t(e.C<i),t(f<=r);var b=!1;e:for(;;){for(;b||h<f;){var j=0;if(o>=x){var A=h-n;t((x=e).Pb),x.wd=x.m,x.xd=A,0<x.s.ua&&R(x.s.Wa,x.s.vb),x=o+Zn}if(c&v||(y=be(u,c,o)),t(null!=y),y.Qb&&(a[h]=y.qb,b=!0),!b)if(k(d),y.jc){j=d,A=a;var C=h,_=y.pd[w(j)&Fa-1];t(y.jc),256>_.g?(S(j,j.u+_.g),A[C]=_.value,j=0):(S(j,j.u+_.g-256),t(256<=_.value),j=_.value),0==j&&(b=!0)}else j=ve(y.G[0],y.H[0],d);if(d.h)break;if(b||256>j){if(!b)if(y.nd)a[h]=(y.qb|j<<8)>>>0;else{if(k(d),b=ve(y.G[1],y.H[1],d),k(d),A=ve(y.G[2],y.H[2],d),C=ve(y.G[3],y.H[3],d),d.h)break;a[h]=(C<<24|b<<16|j<<8|A)>>>0}if(b=!1,++h,++c>=s&&(c=0,++o,null!=l&&o<=i&&!(o%16)&&l(e,o),null!=g))for(;p<h;)j=a[p++],g.X[(506832829*j&4294967295)>>>g.Mb]=j}else if(280>j){if(j=xe(j-256,d),A=ve(y.G[4],y.H[4],d),k(d),A=ge(s,A=xe(A,d)),d.h)break;if(h-n<A||r-h<j)break e;for(C=0;C<j;++C)a[h+C]=a[h+C-A];for(h+=j,c+=j;c>=s;)c-=s,++o,null!=l&&o<=i&&!(o%16)&&l(e,o);if(t(h<=r),c&v&&(y=be(u,c,o)),null!=g)for(;p<h;)j=a[p++],g.X[(506832829*j&4294967295)>>>g.Mb]=j}else{if(!(j<m))break e;for(b=j-280,t(null!=g);p<h;)j=a[p++],g.X[(506832829*j&4294967295)>>>g.Mb]=j;j=h,t(!(b>>>(A=g).Xa)),a[j]=A.X[b],b=!0}b||t(d.h==N(d))}if(e.Pb&&d.h&&h<r)t(e.m.h),e.a=5,e.m=e.wd,e.$=e.xd,0<e.s.ua&&R(e.s.vb,e.s.Wa);else{if(d.h)break e;null!=l&&l(e,o>i?i:o),e.a=0,e.$=h-n}return 1}return e.a=3,0}function Ce(e){t(null!=e),e.vc=null,e.yc=null,e.Ya=null;var a=e.Wa;null!=a&&(a.X=null),e.vb=null,t(null!=e)}function _e(){var t=new ra;return null==t?null:(t.a=0,t.xb=fs,ae("Predictor","VP8LPredictors"),ae("Predictor","VP8LPredictors_C"),ae("PredictorAdd","VP8LPredictorsAdd"),ae("PredictorAdd","VP8LPredictorsAdd_C"),Va=G,$a=Y,Xa=Q,Za=$,en=X,tn=Z,an=ee,e.VP8LMapColor32b=Ja,e.VP8LMapColor8b=Ka,t)}function Le(e,a,n,l,o){var c=1,h=[e],f=[a],m=l.m,x=l.s,g=null,v=0;e:for(;;){if(n)for(;c&&y(m,1);){var b=h,j=f,N=l,A=1,C=N.m,_=N.gc[N.ab],L=y(C,2);if(N.Oc&1<<L)c=0;else{switch(N.Oc|=1<<L,_.hc=L,_.Ea=b[0],_.nc=j[0],_.K=[null],++N.ab,t(4>=N.ab),L){case 0:case 1:_.b=y(C,3)+2,A=Le(F(_.Ea,_.b),F(_.nc,_.b),0,N,_.K),_.K=_.K[0];break;case 3:var T,E=y(C,8)+1,D=16<E?0:4<E?1:2<E?2:3;if(b[0]=F(_.Ea,D),_.b=D,T=A=Le(E,1,0,N,_.K)){var R,I=E,B=_,q=1<<(8>>B.b),z=r(q);if(null==z)T=0;else{var M=B.K[0],U=B.w;for(z[0]=B.K[0][0],R=1;R<1*I;++R)z[R]=O(M[U+R],z[R-1]);for(;R<4*q;++R)z[R]=0;B.K[0]=null,B.K[0]=z,T=1}}A=T;break;case 2:break;default:t(0)}c=A}}if(h=h[0],f=f[0],c&&y(m,1)&&!(c=1<=(v=y(m,4))&&11>=v)){l.a=3;break e}var W;if(W=c)t:{var H,V,G,J=l,Y=h,K=f,Q=v,$=n,X=J.m,Z=J.s,ee=[null],te=1,ae=0,ne=Xn[Q];a:for(;;){if($&&y(X,1)){var se=y(X,3)+2,re=F(Y,se),ie=F(K,se),le=re*ie;if(!Le(re,ie,0,J,ee))break a;for(ee=ee[0],Z.xc=se,H=0;H<le;++H){var oe=ee[H]>>8&65535;ee[H]=oe,oe>=te&&(te=oe+1)}}if(X.h)break a;for(V=0;5>V;++V){var ce=Yn[V];!V&&0<Q&&(ce+=1<<Q),ae<ce&&(ae=ce)}var de=i(te*ne,u),ue=te,he=i(ue,p);if(null==he)var pe=null;else t(65536>=ue),pe=he;var fe=r(ae);if(null==pe||null==fe||null==de){J.a=1;break a}var me=de;for(H=G=0;H<te;++H){var xe=pe[H],ge=xe.G,ve=xe.H,be=0,je=1,we=0;for(V=0;5>V;++V){ce=Yn[V],ge[V]=me,ve[V]=G,!V&&0<Q&&(ce+=1<<Q);n:{var Ne,Se=ce,ke=J,_e=fe,Te=me,Ee=G,De=0,Pe=ke.m,Re=y(Pe,1);if(s(_e,0,0,Se),Re){var Ie=y(Pe,1)+1,Be=y(Pe,1),Fe=y(Pe,0==Be?1:8);_e[Fe]=1,2==Ie&&(_e[Fe=y(Pe,8)]=1);var Oe=1}else{var qe=r(19),ze=y(Pe,4)+4;if(19<ze){ke.a=3;var Me=0;break n}for(Ne=0;Ne<ze;++Ne)qe[Qn[Ne]]=y(Pe,3);var Ue=void 0,We=void 0,He=ke,Ve=qe,Ge=Se,Je=_e,Ye=0,Ke=He.m,Qe=8,$e=i(128,u);s:for(;d($e,0,7,Ve,19);){if(y(Ke,1)){var Xe=2+2*y(Ke,3);if((Ue=2+y(Ke,Xe))>Ge)break s}else Ue=Ge;for(We=0;We<Ge&&Ue--;){k(Ke);var Ze=$e[0+(127&w(Ke))];S(Ke,Ke.u+Ze.g);var et=Ze.value;if(16>et)Je[We++]=et,0!=et&&(Qe=et);else{var tt=16==et,at=et-16,nt=Jn[at],st=y(Ke,Gn[at])+nt;if(We+st>Ge)break s;for(var rt=tt?Qe:0;0<st--;)Je[We++]=rt}}Ye=1;break s}Ye||(He.a=3),Oe=Ye}(Oe=Oe&&!Pe.h)&&(De=d(Te,Ee,8,_e,Se)),Oe&&0!=De?Me=De:(ke.a=3,Me=0)}if(0==Me)break a;if(je&&1==Kn[V]&&(je=0==me[G].g),be+=me[G].g,G+=Me,3>=V){var it,lt=fe[0];for(it=1;it<ce;++it)fe[it]>lt&&(lt=fe[it]);we+=lt}}if(xe.nd=je,xe.Qb=0,je&&(xe.qb=(ge[3][ve[3]+0].value<<24|ge[1][ve[1]+0].value<<16|ge[2][ve[2]+0].value)>>>0,0==be&&256>ge[0][ve[0]+0].value&&(xe.Qb=1,xe.qb+=ge[0][ve[0]+0].value<<8)),xe.jc=!xe.Qb&&6>we,xe.jc){var ot,ct=xe;for(ot=0;ot<Fa;++ot){var dt=ot,ut=ct.pd[dt],ht=ct.G[0][ct.H[0]+dt];256<=ht.value?(ut.g=ht.g+256,ut.value=ht.value):(ut.g=0,ut.value=0,dt>>=ye(ht,8,ut),dt>>=ye(ct.G[1][ct.H[1]+dt],16,ut),dt>>=ye(ct.G[2][ct.H[2]+dt],0,ut),ye(ct.G[3][ct.H[3]+dt],24,ut))}}}Z.vc=ee,Z.Wb=te,Z.Ya=pe,Z.yc=de,W=1;break t}W=0}if(!(c=W)){l.a=3;break e}if(0<v){if(x.ua=1<<v,!P(x.Wa,v)){l.a=1,c=0;break e}}else x.ua=0;var pt=l,ft=h,mt=f,xt=pt.s,gt=xt.xc;if(pt.c=ft,pt.i=mt,xt.md=F(ft,gt),xt.wc=0==gt?-1:(1<<gt)-1,n){l.xb=ps;break e}if(null==(g=r(h*f))){l.a=1,c=0;break e}c=(c=Ae(l,g,0,h,f,f,null))&&!m.h;break e}return c?(null!=o?o[0]=g:(t(null==g),t(n)),l.$=0,n||Ce(x)):Ce(x),c}function Te(e,a){var n=e.c*e.i,s=n+a+16*a;return t(e.c<=a),e.V=r(s),null==e.V?(e.Ta=null,e.Ua=0,e.a=1,0):(e.Ta=e.V,e.Ua=e.Ba+n+a,1)}function Ee(e,a){var n=e.C,s=a-n,r=e.V,i=e.Ba+e.c*n;for(t(a<=e.l.o);0<s;){var l=16<s?16:s,o=e.l.ma,c=e.l.width,d=c*l,u=o.ca,h=o.tb+c*n,p=e.Ta,f=e.Ua;je(e,l,r,i),kn(p,f,u,h,d),Se(o,n,n+l,u,h,c),s-=l,r+=l*e.c,n+=l}t(n==a),e.C=e.Ma=a}function De(){this.ub=this.yd=this.td=this.Rb=0}function Pe(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function Re(){this.Fb=this.Bb=this.Cb=0,this.Zb=r(4),this.Lb=r(4)}function Ie(){this.Yb=function(){var e=[];return function e(t,a,n){for(var s=n[a],r=0;r<s&&(t.push(n.length>a+1?[]:0),!(n.length<a+1));r++)e(t[r],a+1,n)}(e,0,[3,11]),e}()}function Be(){this.jb=r(3),this.Wc=l([4,8],Ie),this.Xc=l([4,17],Ie)}function Fe(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new r(4),this.od=new r(4)}function Oe(){this.ld=this.La=this.dd=this.tc=0}function qe(){this.Na=this.la=0}function ze(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function Me(){this.ad=r(384),this.Za=0,this.Ob=r(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function Ue(){this.uc=this.M=this.Nb=0,this.wa=Array(new Oe),this.Y=0,this.ya=Array(new Me),this.aa=0,this.l=new Ge}function We(){this.y=r(16),this.f=r(8),this.ea=r(8)}function He(){this.cb=this.a=0,this.sc="",this.m=new b,this.Od=new De,this.Kc=new Pe,this.ed=new Fe,this.Qa=new Re,this.Ic=this.$c=this.Aa=0,this.D=new Ue,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=i(8,b),this.ia=0,this.pb=i(4,ze),this.Pa=new Be,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new We),this.Hd=0,this.rb=Array(new qe),this.sb=0,this.wa=Array(new Oe),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new Me),this.L=this.aa=0,this.gd=l([4,2],Oe),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function Ve(e,t){return 0>e?0:e>t?t:e}function Ge(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function Je(){var e=new He;return null!=e&&(e.a=0,e.sc="OK",e.cb=0,e.Xb=0,as||(as=$e)),e}function Ye(e,t,a){return 0==e.a&&(e.a=t,e.sc=a,e.cb=0),0}function Ke(e,t,a){return 3<=a&&157==e[t+0]&&1==e[t+1]&&42==e[t+2]}function Qe(e,a){if(null==e)return 0;if(e.a=0,e.sc="OK",null==a)return Ye(e,2,"null VP8Io passed to VP8GetHeaders()");var n=a.data,r=a.w,i=a.ha;if(4>i)return Ye(e,7,"Truncated header.");var l=n[r+0]|n[r+1]<<8|n[r+2]<<16,o=e.Od;if(o.Rb=!(1&l),o.td=l>>1&7,o.yd=l>>4&1,o.ub=l>>5,3<o.td)return Ye(e,3,"Incorrect keyframe parameters.");if(!o.yd)return Ye(e,4,"Frame not displayable.");r+=3,i-=3;var c=e.Kc;if(o.Rb){if(7>i)return Ye(e,7,"cannot parse picture header");if(!Ke(n,r,i))return Ye(e,3,"Bad code word");c.c=16383&(n[r+4]<<8|n[r+3]),c.Td=n[r+4]>>6,c.i=16383&(n[r+6]<<8|n[r+5]),c.Ud=n[r+6]>>6,r+=7,i-=7,e.za=c.c+15>>4,e.Ub=c.i+15>>4,a.width=c.c,a.height=c.i,a.Da=0,a.j=0,a.v=0,a.va=a.width,a.o=a.height,a.da=0,a.ib=a.width,a.hb=a.height,a.U=a.width,a.T=a.height,s((l=e.Pa).jb,0,255,l.jb.length),t(null!=(l=e.Qa)),l.Cb=0,l.Bb=0,l.Fb=1,s(l.Zb,0,0,l.Zb.length),s(l.Lb,0,0,l.Lb)}if(o.ub>i)return Ye(e,7,"bad partition length");f(l=e.m,n,r,o.ub),r+=o.ub,i-=o.ub,o.Rb&&(c.Ld=C(l),c.Kd=C(l)),c=e.Qa;var d,u=e.Pa;if(t(null!=l),t(null!=c),c.Cb=C(l),c.Cb){if(c.Bb=C(l),C(l)){for(c.Fb=C(l),d=0;4>d;++d)c.Zb[d]=C(l)?x(l,7):0;for(d=0;4>d;++d)c.Lb[d]=C(l)?x(l,6):0}if(c.Bb)for(d=0;3>d;++d)u.jb[d]=C(l)?m(l,8):255}else c.Bb=0;if(l.Ka)return Ye(e,3,"cannot parse segment header");if((c=e.ed).zd=C(l),c.Tb=m(l,6),c.wb=m(l,3),c.Pc=C(l),c.Pc&&C(l)){for(u=0;4>u;++u)C(l)&&(c.vd[u]=x(l,6));for(u=0;4>u;++u)C(l)&&(c.od[u]=x(l,6))}if(e.L=0==c.Tb?0:c.zd?1:2,l.Ka)return Ye(e,3,"cannot parse filter header");var h=i;if(i=d=r,r=d+h,c=h,e.Xb=(1<<m(e.m,2))-1,h<3*(u=e.Xb))n=7;else{for(d+=3*u,c-=3*u,h=0;h<u;++h){var p=n[i+0]|n[i+1]<<8|n[i+2]<<16;p>c&&(p=c),f(e.Jc[+h],n,d,p),d+=p,c-=p,i+=3}f(e.Jc[+u],n,d,c),n=d<r?0:5}if(0!=n)return Ye(e,n,"cannot parse partitions");for(n=m(d=e.m,7),i=C(d)?x(d,4):0,r=C(d)?x(d,4):0,c=C(d)?x(d,4):0,u=C(d)?x(d,4):0,d=C(d)?x(d,4):0,h=e.Qa,p=0;4>p;++p){if(h.Cb){var g=h.Zb[p];h.Fb||(g+=n)}else{if(0<p){e.pb[p]=e.pb[0];continue}g=n}var v=e.pb[p];v.Sc[0]=es[Ve(g+i,127)],v.Sc[1]=ts[Ve(g+0,127)],v.Eb[0]=2*es[Ve(g+r,127)],v.Eb[1]=101581*ts[Ve(g+c,127)]>>16,8>v.Eb[1]&&(v.Eb[1]=8),v.Qc[0]=es[Ve(g+u,117)],v.Qc[1]=ts[Ve(g+d,127)],v.lc=g+d}if(!o.Rb)return Ye(e,4,"Not a key frame.");for(C(l),o=e.Pa,n=0;4>n;++n){for(i=0;8>i;++i)for(r=0;3>r;++r)for(c=0;11>c;++c)u=_(l,os[n][i][r][c])?m(l,8):is[n][i][r][c],o.Wc[n][i].Yb[r][c]=u;for(i=0;17>i;++i)o.Xc[n][i]=o.Wc[n][cs[i]]}return e.kc=C(l),e.kc&&(e.Bd=m(l,8)),e.cb=1}function $e(e,t,a,n,s,r,i){var l=t[s].Yb[a];for(a=0;16>s;++s){if(!_(e,l[a+0]))return s;for(;!_(e,l[a+1]);)if(l=t[++s].Yb[0],a=0,16==s)return 16;var o=t[s+1].Yb;if(_(e,l[a+2])){var c=e,d=0;if(_(c,(h=l)[(u=a)+3]))if(_(c,h[u+6])){for(l=0,u=2*(d=_(c,h[u+8]))+(h=_(c,h[u+9+d])),d=0,h=ns[u];h[l];++l)d+=d+_(c,h[l]);d+=3+(8<<u)}else _(c,h[u+7])?(d=7+2*_(c,165),d+=_(c,145)):d=5+_(c,159);else d=_(c,h[u+4])?3+_(c,h[u+5]):2;l=o[2]}else d=1,l=o[1];o=i+ss[s],0>(c=e).b&&A(c);var u,h=c.b,p=(u=c.Ca>>1)-(c.I>>h)>>31;--c.b,c.Ca+=p,c.Ca|=1,c.I-=(u+1&p)<<h,r[o]=((d^p)-p)*n[(0<s)+0]}return 16}function Xe(e){var t=e.rb[e.sb-1];t.la=0,t.Na=0,s(e.zc,0,0,e.zc.length),e.ja=0}function Ze(e,t,a,n,s){s=e[t+a+32*n]+(s>>3),e[t+a+32*n]=-256&s?0>s?0:255:s}function et(e,t,a,n,s,r){Ze(e,t,0,a,n+s),Ze(e,t,1,a,n+r),Ze(e,t,2,a,n-r),Ze(e,t,3,a,n-s)}function tt(e){return(20091*e>>16)+e}function at(e,t,a,n){var s,i=0,l=r(16);for(s=0;4>s;++s){var o=e[t+0]+e[t+8],c=e[t+0]-e[t+8],d=(35468*e[t+4]>>16)-tt(e[t+12]),u=tt(e[t+4])+(35468*e[t+12]>>16);l[i+0]=o+u,l[i+1]=c+d,l[i+2]=c-d,l[i+3]=o-u,i+=4,t++}for(s=i=0;4>s;++s)o=(e=l[i+0]+4)+l[i+8],c=e-l[i+8],d=(35468*l[i+4]>>16)-tt(l[i+12]),Ze(a,n,0,0,o+(u=tt(l[i+4])+(35468*l[i+12]>>16))),Ze(a,n,1,0,c+d),Ze(a,n,2,0,c-d),Ze(a,n,3,0,o-u),i++,n+=32}function nt(e,t,a,n){var s=e[t+0]+4,r=35468*e[t+4]>>16,i=tt(e[t+4]),l=35468*e[t+1]>>16;et(a,n,0,s+i,e=tt(e[t+1]),l),et(a,n,1,s+r,e,l),et(a,n,2,s-r,e,l),et(a,n,3,s-i,e,l)}function st(e,t,a,n,s){at(e,t,a,n),s&&at(e,t+16,a,n+4)}function rt(e,t,a,n){sn(e,t+0,a,n,1),sn(e,t+32,a,n+128,1)}function it(e,t,a,n){var s;for(e=e[t+0]+4,s=0;4>s;++s)for(t=0;4>t;++t)Ze(a,n,t,s,e)}function lt(e,t,a,n){e[t+0]&&on(e,t+0,a,n),e[t+16]&&on(e,t+16,a,n+4),e[t+32]&&on(e,t+32,a,n+128),e[t+48]&&on(e,t+48,a,n+128+4)}function ot(e,t,a,n){var s,i=r(16);for(s=0;4>s;++s){var l=e[t+0+s]+e[t+12+s],o=e[t+4+s]+e[t+8+s],c=e[t+4+s]-e[t+8+s],d=e[t+0+s]-e[t+12+s];i[0+s]=l+o,i[8+s]=l-o,i[4+s]=d+c,i[12+s]=d-c}for(s=0;4>s;++s)l=(e=i[0+4*s]+3)+i[3+4*s],o=i[1+4*s]+i[2+4*s],c=i[1+4*s]-i[2+4*s],d=e-i[3+4*s],a[n+0]=l+o>>3,a[n+16]=d+c>>3,a[n+32]=l-o>>3,a[n+48]=d-c>>3,n+=64}function ct(e,t,a){var n,s=t-32,r=Pn,i=255-e[s-1];for(n=0;n<a;++n){var l,o=r,c=i+e[t-1];for(l=0;l<a;++l)e[t+l]=o[c+e[s+l]];t+=32}}function dt(e,t){ct(e,t,4)}function ut(e,t){ct(e,t,8)}function ht(e,t){ct(e,t,16)}function pt(e,t){var a;for(a=0;16>a;++a)n(e,t+32*a,e,t-32,16)}function ft(e,t){var a;for(a=16;0<a;--a)s(e,t,e[t-1],16),t+=32}function mt(e,t,a){var n;for(n=0;16>n;++n)s(t,a+32*n,e,16)}function xt(e,t){var a,n=16;for(a=0;16>a;++a)n+=e[t-1+32*a]+e[t+a-32];mt(n>>5,e,t)}function gt(e,t){var a,n=8;for(a=0;16>a;++a)n+=e[t-1+32*a];mt(n>>4,e,t)}function vt(e,t){var a,n=8;for(a=0;16>a;++a)n+=e[t+a-32];mt(n>>4,e,t)}function yt(e,t){mt(128,e,t)}function bt(e,t,a){return e+2*t+a+2>>2}function jt(e,t){var a,s=t-32;for(s=new Uint8Array([bt(e[s-1],e[s+0],e[s+1]),bt(e[s+0],e[s+1],e[s+2]),bt(e[s+1],e[s+2],e[s+3]),bt(e[s+2],e[s+3],e[s+4])]),a=0;4>a;++a)n(e,t+32*a,s,0,s.length)}function wt(e,t){var a=e[t-1],n=e[t-1+32],s=e[t-1+64],r=e[t-1+96];L(e,t+0,16843009*bt(e[t-1-32],a,n)),L(e,t+32,16843009*bt(a,n,s)),L(e,t+64,16843009*bt(n,s,r)),L(e,t+96,16843009*bt(s,r,r))}function Nt(e,t){var a,n=4;for(a=0;4>a;++a)n+=e[t+a-32]+e[t-1+32*a];for(n>>=3,a=0;4>a;++a)s(e,t+32*a,n,4)}function St(e,t){var a=e[t-1+0],n=e[t-1+32],s=e[t-1+64],r=e[t-1-32],i=e[t+0-32],l=e[t+1-32],o=e[t+2-32],c=e[t+3-32];e[t+0+96]=bt(n,s,e[t-1+96]),e[t+1+96]=e[t+0+64]=bt(a,n,s),e[t+2+96]=e[t+1+64]=e[t+0+32]=bt(r,a,n),e[t+3+96]=e[t+2+64]=e[t+1+32]=e[t+0+0]=bt(i,r,a),e[t+3+64]=e[t+2+32]=e[t+1+0]=bt(l,i,r),e[t+3+32]=e[t+2+0]=bt(o,l,i),e[t+3+0]=bt(c,o,l)}function kt(e,t){var a=e[t+1-32],n=e[t+2-32],s=e[t+3-32],r=e[t+4-32],i=e[t+5-32],l=e[t+6-32],o=e[t+7-32];e[t+0+0]=bt(e[t+0-32],a,n),e[t+1+0]=e[t+0+32]=bt(a,n,s),e[t+2+0]=e[t+1+32]=e[t+0+64]=bt(n,s,r),e[t+3+0]=e[t+2+32]=e[t+1+64]=e[t+0+96]=bt(s,r,i),e[t+3+32]=e[t+2+64]=e[t+1+96]=bt(r,i,l),e[t+3+64]=e[t+2+96]=bt(i,l,o),e[t+3+96]=bt(l,o,o)}function At(e,t){var a=e[t-1+0],n=e[t-1+32],s=e[t-1+64],r=e[t-1-32],i=e[t+0-32],l=e[t+1-32],o=e[t+2-32],c=e[t+3-32];e[t+0+0]=e[t+1+64]=r+i+1>>1,e[t+1+0]=e[t+2+64]=i+l+1>>1,e[t+2+0]=e[t+3+64]=l+o+1>>1,e[t+3+0]=o+c+1>>1,e[t+0+96]=bt(s,n,a),e[t+0+64]=bt(n,a,r),e[t+0+32]=e[t+1+96]=bt(a,r,i),e[t+1+32]=e[t+2+96]=bt(r,i,l),e[t+2+32]=e[t+3+96]=bt(i,l,o),e[t+3+32]=bt(l,o,c)}function Ct(e,t){var a=e[t+0-32],n=e[t+1-32],s=e[t+2-32],r=e[t+3-32],i=e[t+4-32],l=e[t+5-32],o=e[t+6-32],c=e[t+7-32];e[t+0+0]=a+n+1>>1,e[t+1+0]=e[t+0+64]=n+s+1>>1,e[t+2+0]=e[t+1+64]=s+r+1>>1,e[t+3+0]=e[t+2+64]=r+i+1>>1,e[t+0+32]=bt(a,n,s),e[t+1+32]=e[t+0+96]=bt(n,s,r),e[t+2+32]=e[t+1+96]=bt(s,r,i),e[t+3+32]=e[t+2+96]=bt(r,i,l),e[t+3+64]=bt(i,l,o),e[t+3+96]=bt(l,o,c)}function _t(e,t){var a=e[t-1+0],n=e[t-1+32],s=e[t-1+64],r=e[t-1+96];e[t+0+0]=a+n+1>>1,e[t+2+0]=e[t+0+32]=n+s+1>>1,e[t+2+32]=e[t+0+64]=s+r+1>>1,e[t+1+0]=bt(a,n,s),e[t+3+0]=e[t+1+32]=bt(n,s,r),e[t+3+32]=e[t+1+64]=bt(s,r,r),e[t+3+64]=e[t+2+64]=e[t+0+96]=e[t+1+96]=e[t+2+96]=e[t+3+96]=r}function Lt(e,t){var a=e[t-1+0],n=e[t-1+32],s=e[t-1+64],r=e[t-1+96],i=e[t-1-32],l=e[t+0-32],o=e[t+1-32],c=e[t+2-32];e[t+0+0]=e[t+2+32]=a+i+1>>1,e[t+0+32]=e[t+2+64]=n+a+1>>1,e[t+0+64]=e[t+2+96]=s+n+1>>1,e[t+0+96]=r+s+1>>1,e[t+3+0]=bt(l,o,c),e[t+2+0]=bt(i,l,o),e[t+1+0]=e[t+3+32]=bt(a,i,l),e[t+1+32]=e[t+3+64]=bt(n,a,i),e[t+1+64]=e[t+3+96]=bt(s,n,a),e[t+1+96]=bt(r,s,n)}function Tt(e,t){var a;for(a=0;8>a;++a)n(e,t+32*a,e,t-32,8)}function Et(e,t){var a;for(a=0;8>a;++a)s(e,t,e[t-1],8),t+=32}function Dt(e,t,a){var n;for(n=0;8>n;++n)s(t,a+32*n,e,8)}function Pt(e,t){var a,n=8;for(a=0;8>a;++a)n+=e[t+a-32]+e[t-1+32*a];Dt(n>>4,e,t)}function Rt(e,t){var a,n=4;for(a=0;8>a;++a)n+=e[t+a-32];Dt(n>>3,e,t)}function It(e,t){var a,n=4;for(a=0;8>a;++a)n+=e[t-1+32*a];Dt(n>>3,e,t)}function Bt(e,t){Dt(128,e,t)}function Ft(e,t,a){var n=e[t-a],s=e[t+0],r=3*(s-n)+En[1020+e[t-2*a]-e[t+a]],i=Dn[112+(r+4>>3)];e[t-a]=Pn[255+n+Dn[112+(r+3>>3)]],e[t+0]=Pn[255+s-i]}function Ot(e,t,a,n){var s=e[t+0],r=e[t+a];return Rn[255+e[t-2*a]-e[t-a]]>n||Rn[255+r-s]>n}function qt(e,t,a,n){return 4*Rn[255+e[t-a]-e[t+0]]+Rn[255+e[t-2*a]-e[t+a]]<=n}function zt(e,t,a,n,s){var r=e[t-3*a],i=e[t-2*a],l=e[t-a],o=e[t+0],c=e[t+a],d=e[t+2*a],u=e[t+3*a];return 4*Rn[255+l-o]+Rn[255+i-c]>n?0:Rn[255+e[t-4*a]-r]<=s&&Rn[255+r-i]<=s&&Rn[255+i-l]<=s&&Rn[255+u-d]<=s&&Rn[255+d-c]<=s&&Rn[255+c-o]<=s}function Mt(e,t,a,n){var s=2*n+1;for(n=0;16>n;++n)qt(e,t+n,a,s)&&Ft(e,t+n,a)}function Ut(e,t,a,n){var s=2*n+1;for(n=0;16>n;++n)qt(e,t+n*a,1,s)&&Ft(e,t+n*a,1)}function Wt(e,t,a,n){var s;for(s=3;0<s;--s)Mt(e,t+=4*a,a,n)}function Ht(e,t,a,n){var s;for(s=3;0<s;--s)Ut(e,t+=4,a,n)}function Vt(e,t,a,n,s,r,i,l){for(r=2*r+1;0<s--;){if(zt(e,t,a,r,i))if(Ot(e,t,a,l))Ft(e,t,a);else{var o=e,c=t,d=a,u=o[c-2*d],h=o[c-d],p=o[c+0],f=o[c+d],m=o[c+2*d],x=27*(v=En[1020+3*(p-h)+En[1020+u-f]])+63>>7,g=18*v+63>>7,v=9*v+63>>7;o[c-3*d]=Pn[255+o[c-3*d]+v],o[c-2*d]=Pn[255+u+g],o[c-d]=Pn[255+h+x],o[c+0]=Pn[255+p-x],o[c+d]=Pn[255+f-g],o[c+2*d]=Pn[255+m-v]}t+=n}}function Gt(e,t,a,n,s,r,i,l){for(r=2*r+1;0<s--;){if(zt(e,t,a,r,i))if(Ot(e,t,a,l))Ft(e,t,a);else{var o=e,c=t,d=a,u=o[c-d],h=o[c+0],p=o[c+d],f=Dn[112+(4+(m=3*(h-u))>>3)],m=Dn[112+(m+3>>3)],x=f+1>>1;o[c-2*d]=Pn[255+o[c-2*d]+x],o[c-d]=Pn[255+u+m],o[c+0]=Pn[255+h-f],o[c+d]=Pn[255+p-x]}t+=n}}function Jt(e,t,a,n,s,r){Vt(e,t,a,1,16,n,s,r)}function Yt(e,t,a,n,s,r){Vt(e,t,1,a,16,n,s,r)}function Kt(e,t,a,n,s,r){var i;for(i=3;0<i;--i)Gt(e,t+=4*a,a,1,16,n,s,r)}function Qt(e,t,a,n,s,r){var i;for(i=3;0<i;--i)Gt(e,t+=4,1,a,16,n,s,r)}function $t(e,t,a,n,s,r,i,l){Vt(e,t,s,1,8,r,i,l),Vt(a,n,s,1,8,r,i,l)}function Xt(e,t,a,n,s,r,i,l){Vt(e,t,1,s,8,r,i,l),Vt(a,n,1,s,8,r,i,l)}function Zt(e,t,a,n,s,r,i,l){Gt(e,t+4*s,s,1,8,r,i,l),Gt(a,n+4*s,s,1,8,r,i,l)}function ea(e,t,a,n,s,r,i,l){Gt(e,t+4,1,s,8,r,i,l),Gt(a,n+4,1,s,8,r,i,l)}function ta(){this.ba=new ie,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new oe,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function aa(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function na(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function sa(){this.ua=0,this.Wa=new I,this.vb=new I,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new p,this.yc=new u}function ra(){this.xb=this.a=0,this.l=new Ge,this.ca=new ie,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new j,this.Pb=0,this.wd=new j,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new sa,this.ab=0,this.gc=i(4,na),this.Oc=0}function ia(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new Ge,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function la(e,t,a,n,s,r,i){for(e=null==e?0:e[t+0],t=0;t<i;++t)s[r+t]=e+a[n+t]&255,e=s[r+t]}function oa(e,t,a,n,s,r,i){var l;if(null==e)la(null,null,a,n,s,r,i);else for(l=0;l<i;++l)s[r+l]=e[t+l]+a[n+l]&255}function ca(e,t,a,n,s,r,i){if(null==e)la(null,null,a,n,s,r,i);else{var l,o=e[t+0],c=o,d=o;for(l=0;l<i;++l)c=d+(o=e[t+l])-c,d=a[n+l]+(-256&c?0>c?0:255:c)&255,c=o,s[r+l]=d}}function da(e,a,s,i){var l=a.width,o=a.o;if(t(null!=e&&null!=a),0>s||0>=i||s+i>o)return null;if(!e.Cc){if(null==e.ga){var c;if(e.ga=new ia,(c=null==e.ga)||(c=a.width*a.o,t(0==e.Gb.length),e.Gb=r(c),e.Uc=0,null==e.Gb?c=0:(e.mb=e.Gb,e.nb=e.Uc,e.rc=null,c=1),c=!c),!c){c=e.ga;var d=e.Fa,u=e.P,h=e.qc,p=e.mb,f=e.nb,m=u+1,x=h-1,v=c.l;if(t(null!=d&&null!=p&&null!=a),ms[0]=null,ms[1]=la,ms[2]=oa,ms[3]=ca,c.ca=p,c.tb=f,c.c=a.width,c.i=a.height,t(0<c.c&&0<c.i),1>=h)a=0;else if(c.$a=3&d[u+0],c.Z=d[u+0]>>2&3,c.Lc=d[u+0]>>4&3,u=d[u+0]>>6&3,0>c.$a||1<c.$a||4<=c.Z||1<c.Lc||u)a=0;else if(v.put=pe,v.ac=he,v.bc=fe,v.ma=c,v.width=a.width,v.height=a.height,v.Da=a.Da,v.v=a.v,v.va=a.va,v.j=a.j,v.o=a.o,c.$a)e:{t(1==c.$a),a=_e();t:for(;;){if(null==a){a=0;break e}if(t(null!=c),c.mc=a,a.c=c.c,a.i=c.i,a.l=c.l,a.l.ma=c,a.l.width=c.c,a.l.height=c.i,a.a=0,g(a.m,d,m,x),!Le(c.c,c.i,1,a,null))break t;if(1==a.ab&&3==a.gc[0].hc&&Ne(a.s)?(c.ic=1,d=a.c*a.i,a.Ta=null,a.Ua=0,a.V=r(d),a.Ba=0,null==a.V?(a.a=1,a=0):a=1):(c.ic=0,a=Te(a,c.c)),!a)break t;a=1;break e}c.mc=null,a=0}else a=x>=c.c*c.i;c=!a}if(c)return null;1!=e.ga.Lc?e.Ga=0:i=o-s}t(null!=e.ga),t(s+i<=o);e:{if(a=(d=e.ga).c,o=d.l.o,0==d.$a){if(m=e.rc,x=e.Vc,v=e.Fa,u=e.P+1+s*a,h=e.mb,p=e.nb+s*a,t(u<=e.P+e.qc),0!=d.Z)for(t(null!=ms[d.Z]),c=0;c<i;++c)ms[d.Z](m,x,v,u,h,p,a),m=h,x=p,p+=a,u+=a;else for(c=0;c<i;++c)n(h,p,v,u,a),m=h,x=p,p+=a,u+=a;e.rc=m,e.Vc=x}else{if(t(null!=d.mc),a=s+i,t(null!=(c=d.mc)),t(a<=c.i),c.C>=a)a=1;else if(d.ic||ma(),d.ic){d=c.V,m=c.Ba,x=c.c;var y=c.i,b=(v=1,u=c.$/x,h=c.$%x,p=c.m,f=c.s,c.$),j=x*y,w=x*a,S=f.wc,A=b<w?be(f,h,u):null;t(b<=j),t(a<=y),t(Ne(f));t:for(;;){for(;!p.h&&b<w;){if(h&S||(A=be(f,h,u)),t(null!=A),k(p),256>(y=ve(A.G[0],A.H[0],p)))d[m+b]=y,++b,++h>=x&&(h=0,++u<=a&&!(u%16)&&ke(c,u));else{if(!(280>y)){v=0;break t}y=xe(y-256,p);var C,_=ve(A.G[4],A.H[4],p);if(k(p),!(b>=(_=ge(x,_=xe(_,p)))&&j-b>=y)){v=0;break t}for(C=0;C<y;++C)d[m+b+C]=d[m+b+C-_];for(b+=y,h+=y;h>=x;)h-=x,++u<=a&&!(u%16)&&ke(c,u);b<w&&h&S&&(A=be(f,h,u))}t(p.h==N(p))}ke(c,u>a?a:u);break t}!v||p.h&&b<j?(v=0,c.a=p.h?5:3):c.$=b,a=v}else a=Ae(c,c.V,c.Ba,c.c,c.i,a,Ee);if(!a){i=0;break e}}s+i>=o&&(e.Cc=1),i=1}if(!i)return null;if(e.Cc&&(null!=(i=e.ga)&&(i.mc=null),e.ga=null,0<e.Ga))return alert("todo:WebPDequantizeLevels"),null}return e.nb+s*l}function ua(e,t,a,n,s,r){for(;0<s--;){var i,l=e,o=t+(a?1:0),c=e,d=t+(a?0:3);for(i=0;i<n;++i){var u=c[d+4*i];255!=u&&(u*=32897,l[o+4*i+0]=l[o+4*i+0]*u>>23,l[o+4*i+1]=l[o+4*i+1]*u>>23,l[o+4*i+2]=l[o+4*i+2]*u>>23)}t+=r}}function ha(e,t,a,n,s){for(;0<n--;){var r;for(r=0;r<a;++r){var i=e[t+2*r+0],l=15&(c=e[t+2*r+1]),o=4369*l,c=(240&c|c>>4)*o>>16;e[t+2*r+0]=(240&i|i>>4)*o>>16&240|(15&i|i<<4)*o>>16>>4&15,e[t+2*r+1]=240&c|l}t+=s}}function pa(e,t,a,n,s,r,i,l){var o,c,d=255;for(c=0;c<s;++c){for(o=0;o<n;++o){var u=e[t+o];r[i+4*o]=u,d&=u}t+=a,i+=l}return 255!=d}function fa(e,t,a,n,s){var r;for(r=0;r<s;++r)a[n+r]=e[t+r]>>8}function ma(){wn=ua,Nn=ha,Sn=pa,kn=fa}function xa(a,n,s){e[a]=function(e,a,r,i,l,o,c,d,u,h,p,f,m,x,g,v,y){var b,j=y-1>>1,w=l[o+0]|c[d+0]<<16,N=u[h+0]|p[f+0]<<16;t(null!=e);var S=3*w+N+131074>>2;for(n(e[a+0],255&S,S>>16,m,x),null!=r&&(S=3*N+w+131074>>2,n(r[i+0],255&S,S>>16,g,v)),b=1;b<=j;++b){var k=l[o+b]|c[d+b]<<16,A=u[h+b]|p[f+b]<<16,C=w+k+N+A+524296,_=C+2*(k+N)>>3;S=_+w>>1,w=(C=C+2*(w+A)>>3)+k>>1,n(e[a+2*b-1],255&S,S>>16,m,x+(2*b-1)*s),n(e[a+2*b-0],255&w,w>>16,m,x+(2*b-0)*s),null!=r&&(S=C+N>>1,w=_+A>>1,n(r[i+2*b-1],255&S,S>>16,g,v+(2*b-1)*s),n(r[i+2*b+0],255&w,w>>16,g,v+(2*b+0)*s)),w=k,N=A}1&y||(S=3*w+N+131074>>2,n(e[a+y-1],255&S,S>>16,m,x+(y-1)*s),null!=r&&(S=3*N+w+131074>>2,n(r[i+y-1],255&S,S>>16,g,v+(y-1)*s)))}}function ga(){xs[In]=gs,xs[Bn]=ys,xs[Fn]=vs,xs[On]=bs,xs[qn]=js,xs[zn]=ws,xs[Mn]=Ns,xs[Un]=ys,xs[Wn]=bs,xs[Hn]=js,xs[Vn]=ws}function va(e){return e&~Ls?0>e?0:255:e>>_s}function ya(e,t){return va((19077*e>>8)+(26149*t>>8)-14234)}function ba(e,t,a){return va((19077*e>>8)-(6419*t>>8)-(13320*a>>8)+8708)}function ja(e,t){return va((19077*e>>8)+(33050*t>>8)-17685)}function wa(e,t,a,n,s){n[s+0]=ya(e,a),n[s+1]=ba(e,t,a),n[s+2]=ja(e,t)}function Na(e,t,a,n,s){n[s+0]=ja(e,t),n[s+1]=ba(e,t,a),n[s+2]=ya(e,a)}function Sa(e,t,a,n,s){var r=ba(e,t,a);t=r<<3&224|ja(e,t)>>3,n[s+0]=248&ya(e,a)|r>>5,n[s+1]=t}function ka(e,t,a,n,s){var r=240&ja(e,t)|15;n[s+0]=240&ya(e,a)|ba(e,t,a)>>4,n[s+1]=r}function Aa(e,t,a,n,s){n[s+0]=255,wa(e,t,a,n,s+1)}function Ca(e,t,a,n,s){Na(e,t,a,n,s),n[s+3]=255}function _a(e,t,a,n,s){wa(e,t,a,n,s),n[s+3]=255}function Ve(e,t){return 0>e?0:e>t?t:e}function La(t,a,n){e[t]=function(e,t,s,r,i,l,o,c,d){for(var u=c+(-2&d)*n;c!=u;)a(e[t+0],s[r+0],i[l+0],o,c),a(e[t+1],s[r+0],i[l+0],o,c+n),t+=2,++r,++l,c+=2*n;1&d&&a(e[t+0],s[r+0],i[l+0],o,c)}}function Ta(e,t,a){return 0==a?0==e?0==t?6:5:0==t?4:0:a}function Ea(e,t,a,n,s){switch(e>>>30){case 3:sn(t,a,n,s,0);break;case 2:rn(t,a,n,s);break;case 1:on(t,a,n,s)}}function Da(e,t){var a,r,i=t.M,l=t.Nb,o=e.oc,c=e.pc+40,d=e.oc,u=e.pc+584,h=e.oc,p=e.pc+600;for(a=0;16>a;++a)o[c+32*a-1]=129;for(a=0;8>a;++a)d[u+32*a-1]=129,h[p+32*a-1]=129;for(0<i?o[c-1-32]=d[u-1-32]=h[p-1-32]=129:(s(o,c-32-1,127,21),s(d,u-32-1,127,9),s(h,p-32-1,127,9)),r=0;r<e.za;++r){var f=t.ya[t.aa+r];if(0<r){for(a=-1;16>a;++a)n(o,c+32*a-4,o,c+32*a+12,4);for(a=-1;8>a;++a)n(d,u+32*a-4,d,u+32*a+4,4),n(h,p+32*a-4,h,p+32*a+4,4)}var m=e.Gd,x=e.Hd+r,g=f.ad,v=f.Hc;if(0<i&&(n(o,c-32,m[x].y,0,16),n(d,u-32,m[x].f,0,8),n(h,p-32,m[x].ea,0,8)),f.Za){var y=o,b=c-32+16;for(0<i&&(r>=e.za-1?s(y,b,m[x].y[15],4):n(y,b,m[x+1].y,0,4)),a=0;4>a;a++)y[b+128+a]=y[b+256+a]=y[b+384+a]=y[b+0+a];for(a=0;16>a;++a,v<<=2)y=o,b=c+Fs[a],us[f.Ob[a]](y,b),Ea(v,g,16*+a,y,b)}else if(y=Ta(r,i,f.Ob[0]),ds[y](o,c),0!=v)for(a=0;16>a;++a,v<<=2)Ea(v,g,16*+a,o,c+Fs[a]);for(a=f.Gc,y=Ta(r,i,f.Dd),hs[y](d,u),hs[y](h,p),v=g,y=d,b=u,255&(f=0|a)&&(170&f?ln(v,256,y,b):cn(v,256,y,b)),f=h,v=p,255&(a>>=8)&&(170&a?ln(g,320,f,v):cn(g,320,f,v)),i<e.Ub-1&&(n(m[x].y,0,o,c+480,16),n(m[x].f,0,d,u+224,8),n(m[x].ea,0,h,p+224,8)),a=8*l*e.B,m=e.sa,x=e.ta+16*r+16*l*e.R,g=e.qa,f=e.ra+8*r+a,v=e.Ha,y=e.Ia+8*r+a,a=0;16>a;++a)n(m,x+a*e.R,o,c+32*a,16);for(a=0;8>a;++a)n(g,f+a*e.B,d,u+32*a,8),n(v,y+a*e.B,h,p+32*a,8)}}function Pa(e,n,s,r,i,l,o,c,d){var u=[0],h=[0],p=0,f=null!=d?d.kd:0,m=null!=d?d:new aa;if(null==e||12>s)return 7;m.data=e,m.w=n,m.ha=s,n=[n],s=[s],m.gb=[m.gb];e:{var x=n,v=s,y=m.gb;if(t(null!=e),t(null!=v),t(null!=y),y[0]=0,12<=v[0]&&!a(e,x[0],"RIFF")){if(a(e,x[0]+8,"WEBP")){y=3;break e}var b=D(e,x[0]+4);if(12>b||4294967286<b){y=3;break e}if(f&&b>v[0]-8){y=7;break e}y[0]=b,x[0]+=12,v[0]-=12}y=0}if(0!=y)return y;for(b=0<m.gb[0],s=s[0];;){e:{var w=e;v=n,y=s;var N=u,S=h,k=x=[0];if((_=p=[p])[0]=0,8>y[0])y=7;else{if(!a(w,v[0],"VP8X")){if(10!=D(w,v[0]+4)){y=3;break e}if(18>y[0]){y=7;break e}var A=D(w,v[0]+8),C=1+E(w,v[0]+12);if(2147483648<=C*(w=1+E(w,v[0]+15))){y=3;break e}null!=k&&(k[0]=A),null!=N&&(N[0]=C),null!=S&&(S[0]=w),v[0]+=18,y[0]-=18,_[0]=1}y=0}}if(p=p[0],x=x[0],0!=y)return y;if(v=!!(2&x),!b&&p)return 3;if(null!=l&&(l[0]=!!(16&x)),null!=o&&(o[0]=v),null!=c&&(c[0]=0),o=u[0],x=h[0],p&&v&&null==d){y=0;break}if(4>s){y=7;break}if(b&&p||!b&&!p&&!a(e,n[0],"ALPH")){s=[s],m.na=[m.na],m.P=[m.P],m.Sa=[m.Sa];e:{A=e,y=n,b=s;var _=m.gb;N=m.na,S=m.P,k=m.Sa,C=22,t(null!=A),t(null!=b),w=y[0];var L=b[0];for(t(null!=N),t(null!=k),N[0]=null,S[0]=null,k[0]=0;;){if(y[0]=w,b[0]=L,8>L){y=7;break e}var T=D(A,w+4);if(4294967286<T){y=3;break e}var P=8+T+1&-2;if(C+=P,0<_&&C>_){y=3;break e}if(!a(A,w,"VP8 ")||!a(A,w,"VP8L")){y=0;break e}if(L[0]<P){y=7;break e}a(A,w,"ALPH")||(N[0]=A,S[0]=w+8,k[0]=T),w+=P,L-=P}}if(s=s[0],m.na=m.na[0],m.P=m.P[0],m.Sa=m.Sa[0],0!=y)break}s=[s],m.Ja=[m.Ja],m.xa=[m.xa];e:if(_=e,y=n,b=s,N=m.gb[0],S=m.Ja,k=m.xa,A=y[0],w=!a(_,A,"VP8 "),C=!a(_,A,"VP8L"),t(null!=_),t(null!=b),t(null!=S),t(null!=k),8>b[0])y=7;else{if(w||C){if(_=D(_,A+4),12<=N&&_>N-12){y=3;break e}if(f&&_>b[0]-8){y=7;break e}S[0]=_,y[0]+=8,b[0]-=8,k[0]=C}else k[0]=5<=b[0]&&47==_[A+0]&&!(_[A+4]>>5),S[0]=b[0];y=0}if(s=s[0],m.Ja=m.Ja[0],m.xa=m.xa[0],n=n[0],0!=y)break;if(4294967286<m.Ja)return 3;if(null==c||v||(c[0]=m.xa?2:1),o=[o],x=[x],m.xa){if(5>s){y=7;break}c=o,f=x,v=l,null==e||5>s?e=0:5<=s&&47==e[n+0]&&!(e[n+4]>>5)?(b=[0],_=[0],N=[0],g(S=new j,e,n,s),me(S,b,_,N)?(null!=c&&(c[0]=b[0]),null!=f&&(f[0]=_[0]),null!=v&&(v[0]=N[0]),e=1):e=0):e=0}else{if(10>s){y=7;break}c=x,null==e||10>s||!Ke(e,n+3,s-3)?e=0:(f=e[n+0]|e[n+1]<<8|e[n+2]<<16,v=16383&(e[n+7]<<8|e[n+6]),e=16383&(e[n+9]<<8|e[n+8]),1&f||3<(f>>1&7)||!(f>>4&1)||f>>5>=m.Ja||!v||!e?e=0:(o&&(o[0]=v),c&&(c[0]=e),e=1))}if(!e)return 3;if(o=o[0],x=x[0],p&&(u[0]!=o||h[0]!=x))return 3;null!=d&&(d[0]=m,d.offset=n-d.w,t(4294967286>n-d.w),t(d.offset==d.ha-s));break}return 0==y||7==y&&p&&null==d?(null!=l&&(l[0]|=null!=m.na&&0<m.na.length),null!=r&&(r[0]=o),null!=i&&(i[0]=x),0):y}function Ra(e,t,a){var n=t.width,s=t.height,r=0,i=0,l=n,o=s;if(t.Da=null!=e&&0<e.Da,t.Da&&(l=e.cd,o=e.bd,r=e.v,i=e.j,11>a||(r&=-2,i&=-2),0>r||0>i||0>=l||0>=o||r+l>n||i+o>s))return 0;if(t.v=r,t.j=i,t.va=r+l,t.o=i+o,t.U=l,t.T=o,t.da=null!=e&&0<e.da,t.da){if(!B(l,o,a=[e.ib],r=[e.hb]))return 0;t.ib=a[0],t.hb=r[0]}return t.ob=null!=e&&e.ob,t.Kb=null==e||!e.Sd,t.da&&(t.ob=t.ib<3*n/4&&t.hb<3*s/4,t.Kb=0),1}function Ia(e){if(null==e)return 2;if(11>e.S){var t=e.f.RGBA;t.fb+=(e.height-1)*t.A,t.A=-t.A}else t=e.f.kb,e=e.height,t.O+=(e-1)*t.fa,t.fa=-t.fa,t.N+=(e-1>>1)*t.Ab,t.Ab=-t.Ab,t.W+=(e-1>>1)*t.Db,t.Db=-t.Db,null!=t.F&&(t.J+=(e-1)*t.lb,t.lb=-t.lb);return 0}function Ba(e,t,a,n){if(null==n||0>=e||0>=t)return 2;if(null!=a){if(a.Da){var s=a.cd,i=a.bd,l=-2&a.v,o=-2&a.j;if(0>l||0>o||0>=s||0>=i||l+s>e||o+i>t)return 2;e=s,t=i}if(a.da){if(!B(e,t,s=[a.ib],i=[a.hb]))return 2;e=s[0],t=i[0]}}n.width=e,n.height=t;e:{var c=n.width,d=n.height;if(e=n.S,0>=c||0>=d||!(e>=In&&13>e))e=2;else{if(0>=n.Rd&&null==n.sd){l=i=s=t=0;var u=(o=c*zs[e])*d;if(11>e||(i=(d+1)/2*(t=(c+1)/2),12==e&&(l=(s=c)*d)),null==(d=r(u+2*i+l))){e=1;break e}n.sd=d,11>e?((c=n.f.RGBA).eb=d,c.fb=0,c.A=o,c.size=u):((c=n.f.kb).y=d,c.O=0,c.fa=o,c.Fd=u,c.f=d,c.N=0+u,c.Ab=t,c.Cd=i,c.ea=d,c.W=0+u+i,c.Db=t,c.Ed=i,12==e&&(c.F=d,c.J=0+u+2*i),c.Tc=l,c.lb=s)}if(t=1,s=n.S,i=n.width,l=n.height,s>=In&&13>s)if(11>s)e=n.f.RGBA,t&=(o=Math.abs(e.A))*(l-1)+i<=e.size,t&=o>=i*zs[s],t&=null!=e.eb;else{e=n.f.kb,o=(i+1)/2,u=(l+1)/2,c=Math.abs(e.fa),d=Math.abs(e.Ab);var h=Math.abs(e.Db),p=Math.abs(e.lb),f=p*(l-1)+i;t&=c*(l-1)+i<=e.Fd,t&=d*(u-1)+o<=e.Cd,t=(t&=h*(u-1)+o<=e.Ed)&c>=i&d>=o&h>=o,t&=null!=e.y,t&=null!=e.f,t&=null!=e.ea,12==s&&(t&=p>=i,t&=f<=e.Tc,t&=null!=e.F)}else t=0;e=t?0:2}}return 0!=e||null!=a&&a.fd&&(e=Ia(n)),e}var Fa=64,Oa=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],qa=24,za=32,Ma=8,Ua=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];q("Predictor0","PredictorAdd0"),e.Predictor0=function(){return 4278190080},e.Predictor1=function(e){return e},e.Predictor2=function(e,t,a){return t[a+0]},e.Predictor3=function(e,t,a){return t[a+1]},e.Predictor4=function(e,t,a){return t[a-1]},e.Predictor5=function(e,t,a){return M(M(e,t[a+1]),t[a+0])},e.Predictor6=function(e,t,a){return M(e,t[a-1])},e.Predictor7=function(e,t,a){return M(e,t[a+0])},e.Predictor8=function(e,t,a){return M(t[a-1],t[a+0])},e.Predictor9=function(e,t,a){return M(t[a+0],t[a+1])},e.Predictor10=function(e,t,a){return M(M(e,t[a-1]),M(t[a+0],t[a+1]))},e.Predictor11=function(e,t,a){var n=t[a+0];return 0>=H(n>>24&255,e>>24&255,(t=t[a-1])>>24&255)+H(n>>16&255,e>>16&255,t>>16&255)+H(n>>8&255,e>>8&255,t>>8&255)+H(255&n,255&e,255&t)?n:e},e.Predictor12=function(e,t,a){var n=t[a+0];return(U((e>>24&255)+(n>>24&255)-((t=t[a-1])>>24&255))<<24|U((e>>16&255)+(n>>16&255)-(t>>16&255))<<16|U((e>>8&255)+(n>>8&255)-(t>>8&255))<<8|U((255&e)+(255&n)-(255&t)))>>>0},e.Predictor13=function(e,t,a){var n=t[a-1];return(W((e=M(e,t[a+0]))>>24&255,n>>24&255)<<24|W(e>>16&255,n>>16&255)<<16|W(e>>8&255,n>>8&255)<<8|W(255&e,255&n))>>>0};var Wa=e.PredictorAdd0;e.PredictorAdd1=V,q("Predictor2","PredictorAdd2"),q("Predictor3","PredictorAdd3"),q("Predictor4","PredictorAdd4"),q("Predictor5","PredictorAdd5"),q("Predictor6","PredictorAdd6"),q("Predictor7","PredictorAdd7"),q("Predictor8","PredictorAdd8"),q("Predictor9","PredictorAdd9"),q("Predictor10","PredictorAdd10"),q("Predictor11","PredictorAdd11"),q("Predictor12","PredictorAdd12"),q("Predictor13","PredictorAdd13");var Ha=e.PredictorAdd2;K("ColorIndexInverseTransform","MapARGB","32b",function(e){return e>>8&255},function(e){return e}),K("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(e){return e},function(e){return e>>8&255});var Va,Ga=e.ColorIndexInverseTransform,Ja=e.MapARGB,Ya=e.VP8LColorIndexInverseTransformAlpha,Ka=e.MapAlpha,Qa=e.VP8LPredictorsAdd=[];Qa.length=16,(e.VP8LPredictors=[]).length=16,(e.VP8LPredictorsAdd_C=[]).length=16,(e.VP8LPredictors_C=[]).length=16;var $a,Xa,Za,en,tn,an,nn,sn,rn,ln,on,cn,dn,un,hn,pn,fn,mn,xn,gn,vn,yn,bn,jn,wn,Nn,Sn,kn,An=r(511),Cn=r(2041),_n=r(225),Ln=r(767),Tn=0,En=Cn,Dn=_n,Pn=Ln,Rn=An,In=0,Bn=1,Fn=2,On=3,qn=4,zn=5,Mn=6,Un=7,Wn=8,Hn=9,Vn=10,Gn=[2,3,7],Jn=[3,3,11],Yn=[280,256,256,256,40],Kn=[0,1,1,1,0],Qn=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],$n=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],Xn=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],Zn=8,es=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],ts=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],as=null,ns=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],ss=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],rs=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],is=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],ls=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],os=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],cs=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],ds=[],us=[],hs=[],ps=1,fs=2,ms=[],xs=[];xa("UpsampleRgbLinePair",wa,3),xa("UpsampleBgrLinePair",Na,3),xa("UpsampleRgbaLinePair",_a,4),xa("UpsampleBgraLinePair",Ca,4),xa("UpsampleArgbLinePair",Aa,4),xa("UpsampleRgba4444LinePair",ka,2),xa("UpsampleRgb565LinePair",Sa,2);var gs=e.UpsampleRgbLinePair,vs=e.UpsampleBgrLinePair,ys=e.UpsampleRgbaLinePair,bs=e.UpsampleBgraLinePair,js=e.UpsampleArgbLinePair,ws=e.UpsampleRgba4444LinePair,Ns=e.UpsampleRgb565LinePair,Ss=16,ks=1<<Ss-1,As=-227,Cs=482,_s=6,Ls=(256<<_s)-1,Ts=0,Es=r(256),Ds=r(256),Ps=r(256),Rs=r(256),Is=r(Cs-As),Bs=r(Cs-As);La("YuvToRgbRow",wa,3),La("YuvToBgrRow",Na,3),La("YuvToRgbaRow",_a,4),La("YuvToBgraRow",Ca,4),La("YuvToArgbRow",Aa,4),La("YuvToRgba4444Row",ka,2),La("YuvToRgb565Row",Sa,2);var Fs=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],Os=[0,2,8],qs=[8,7,6,4,4,2,2,2,1,1,1,1];this.WebPDecodeRGBA=function(e,a,l,o,c){var d=Bn,u=new ta,h=new ie;u.ba=h,h.S=d,h.width=[h.width],h.height=[h.height];var p=h.width,f=h.height,m=new le;if(null==m||null==e)var x=2;else t(null!=m),x=Pa(e,a,l,m.width,m.height,m.Pd,m.Qd,m.format,null);if(0!=x?p=0:(null!=p&&(p[0]=m.width[0]),null!=f&&(f[0]=m.height[0]),p=1),p){h.width=h.width[0],h.height=h.height[0],null!=o&&(o[0]=h.width),null!=c&&(c[0]=h.height);e:{if(o=new Ge,(c=new aa).data=e,c.w=a,c.ha=l,c.kd=1,a=[0],t(null!=c),(0==(e=Pa(c.data,c.w,c.ha,null,null,null,a,null,c))||7==e)&&a[0]&&(e=4),0==(a=e)){if(t(null!=u),o.data=c.data,o.w=c.w+c.offset,o.ha=c.ha-c.offset,o.put=pe,o.ac=he,o.bc=fe,o.ma=u,c.xa){if(null==(e=_e())){u=1;break e}if(function(e,a){var n=[0],s=[0],r=[0];t:for(;;){if(null==e)return 0;if(null==a)return e.a=2,0;if(e.l=a,e.a=0,g(e.m,a.data,a.w,a.ha),!me(e.m,n,s,r)){e.a=3;break t}if(e.xb=fs,a.width=n[0],a.height=s[0],!Le(n[0],s[0],1,e,null))break t;return 1}return t(0!=e.a),0}(e,o)){if(o=0==(a=Ba(o.width,o.height,u.Oa,u.ba))){t:{o=e;a:for(;;){if(null==o){o=0;break t}if(t(null!=o.s.yc),t(null!=o.s.Ya),t(0<o.s.Wb),t(null!=(l=o.l)),t(null!=(c=l.ma)),0!=o.xb){if(o.ca=c.ba,o.tb=c.tb,t(null!=o.ca),!Ra(c.Oa,l,On)){o.a=2;break a}if(!Te(o,l.width))break a;if(l.da)break a;if((l.da||ne(o.ca.S))&&ma(),11>o.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),null!=o.ca.f.kb.F&&ma()),o.Pb&&0<o.s.ua&&null==o.s.vb.X&&!P(o.s.vb,o.s.Wa.Xa)){o.a=1;break a}o.xb=0}if(!Ae(o,o.V,o.Ba,o.c,o.i,l.o,we))break a;c.Dc=o.Ma,o=1;break t}t(0!=o.a),o=0}o=!o}o&&(a=e.a)}else a=e.a}else{if(null==(e=new Je)){u=1;break e}if(e.Fa=c.na,e.P=c.P,e.qc=c.Sa,Qe(e,o)){if(0==(a=Ba(o.width,o.height,u.Oa,u.ba))){if(e.Aa=0,l=u.Oa,t(null!=(c=e)),null!=l){if(0<(p=0>(p=l.Md)?0:100<p?255:255*p/100)){for(f=m=0;4>f;++f)12>(x=c.pb[f]).lc&&(x.ia=p*qs[0>x.lc?0:x.lc]>>3),m|=x.ia;m&&(alert("todo:VP8InitRandom"),c.ia=1)}c.Ga=l.Id,100<c.Ga?c.Ga=100:0>c.Ga&&(c.Ga=0)}(function(e,a){if(null==e)return 0;if(null==a)return Ye(e,2,"NULL VP8Io parameter in VP8Decode().");if(!e.cb&&!Qe(e,a))return 0;if(t(e.cb),null==a.ac||a.ac(a)){a.ob&&(e.L=0);var l=Os[e.L];if(2==e.L?(e.yb=0,e.zb=0):(e.yb=a.v-l>>4,e.zb=a.j-l>>4,0>e.yb&&(e.yb=0),0>e.zb&&(e.zb=0)),e.Va=a.o+15+l>>4,e.Hb=a.va+15+l>>4,e.Hb>e.za&&(e.Hb=e.za),e.Va>e.Ub&&(e.Va=e.Ub),0<e.L){var o=e.ed;for(l=0;4>l;++l){var c;if(e.Qa.Cb){var d=e.Qa.Lb[l];e.Qa.Fb||(d+=o.Tb)}else d=o.Tb;for(c=0;1>=c;++c){var u=e.gd[l][c],h=d;if(o.Pc&&(h+=o.vd[0],c&&(h+=o.od[0])),0<(h=0>h?0:63<h?63:h)){var p=h;0<o.wb&&(p=4<o.wb?p>>2:p>>1)>9-o.wb&&(p=9-o.wb),1>p&&(p=1),u.dd=p,u.tc=2*h+p,u.ld=40<=h?2:15<=h?1:0}else u.tc=0;u.La=c}}}l=0}else Ye(e,6,"Frame setup failed"),l=e.a;if(l=0==l){if(l){e.$c=0,0<e.Aa||(e.Ic=1);t:{l=e.Ic,o=4*(p=e.za);var f=32*p,m=p+1,x=0<e.L?p*(0<e.Aa?2:1):0,g=(2==e.Aa?2:1)*p;if((u=o+832+(c=3*(16*l+Os[e.L])/2*f)+(d=null!=e.Fa&&0<e.Fa.length?e.Kc.c*e.Kc.i:0))!=u)l=0;else{if(u>e.Vb){if(e.Vb=0,e.Ec=r(u),e.Fc=0,null==e.Ec){l=Ye(e,1,"no memory during frame initialization.");break t}e.Vb=u}u=e.Ec,h=e.Fc,e.Ac=u,e.Bc=h,h+=o,e.Gd=i(f,We),e.Hd=0,e.rb=i(m+1,qe),e.sb=1,e.wa=x?i(x,Oe):null,e.Y=0,e.D.Nb=0,e.D.wa=e.wa,e.D.Y=e.Y,0<e.Aa&&(e.D.Y+=p),t(!0),e.oc=u,e.pc=h,h+=832,e.ya=i(g,Me),e.aa=0,e.D.ya=e.ya,e.D.aa=e.aa,2==e.Aa&&(e.D.aa+=p),e.R=16*p,e.B=8*p,p=(f=Os[e.L])*e.R,f=f/2*e.B,e.sa=u,e.ta=h+p,e.qa=e.sa,e.ra=e.ta+16*l*e.R+f,e.Ha=e.qa,e.Ia=e.ra+8*l*e.B+f,e.$c=0,h+=c,e.mb=d?u:null,e.nb=d?h:null,t(h+d<=e.Fc+e.Vb),Xe(e),s(e.Ac,e.Bc,0,o),l=1}}if(l){if(a.ka=0,a.y=e.sa,a.O=e.ta,a.f=e.qa,a.N=e.ra,a.ea=e.Ha,a.Vd=e.Ia,a.fa=e.R,a.Rc=e.B,a.F=null,a.J=0,!Tn){for(l=-255;255>=l;++l)An[255+l]=0>l?-l:l;for(l=-1020;1020>=l;++l)Cn[1020+l]=-128>l?-128:127<l?127:l;for(l=-112;112>=l;++l)_n[112+l]=-16>l?-16:15<l?15:l;for(l=-255;510>=l;++l)Ln[255+l]=0>l?0:255<l?255:l;Tn=1}nn=ot,sn=st,ln=rt,on=it,cn=lt,rn=nt,dn=Jt,un=Yt,hn=$t,pn=Xt,fn=Kt,mn=Qt,xn=Zt,gn=ea,vn=Mt,yn=Ut,bn=Wt,jn=Ht,us[0]=Nt,us[1]=dt,us[2]=jt,us[3]=wt,us[4]=St,us[5]=At,us[6]=kt,us[7]=Ct,us[8]=Lt,us[9]=_t,ds[0]=xt,ds[1]=ht,ds[2]=pt,ds[3]=ft,ds[4]=gt,ds[5]=vt,ds[6]=yt,hs[0]=Pt,hs[1]=ut,hs[2]=Tt,hs[3]=Et,hs[4]=It,hs[5]=Rt,hs[6]=Bt,l=1}else l=0}l&&(l=function(e,a){for(e.M=0;e.M<e.Va;++e.M){var i,l=e.Jc[e.M&e.Xb],o=e.m,c=e;for(i=0;i<c.za;++i){var d=o,u=c,h=u.Ac,p=u.Bc+4*i,f=u.zc,m=u.ya[u.aa+i];if(u.Qa.Bb?m.$b=_(d,u.Pa.jb[0])?2+_(d,u.Pa.jb[2]):_(d,u.Pa.jb[1]):m.$b=0,u.kc&&(m.Ad=_(d,u.Bd)),m.Za=!_(d,145)+0,m.Za){var x=m.Ob,g=0;for(u=0;4>u;++u){var v,y=f[0+u];for(v=0;4>v;++v){y=ls[h[p+v]][y];for(var b=rs[_(d,y[0])];0<b;)b=rs[2*b+_(d,y[b])];y=-b,h[p+v]=y}n(x,g,h,p,4),g+=4,f[0+u]=y}}else y=_(d,156)?_(d,128)?1:3:_(d,163)?2:0,m.Ob[0]=y,s(h,p,y,4),s(f,0,y,4);m.Dd=_(d,142)?_(d,114)?_(d,183)?1:3:2:0}if(c.m.Ka)return Ye(e,7,"Premature end-of-partition0 encountered.");for(;e.ja<e.za;++e.ja){if(c=l,d=(o=e).rb[o.sb-1],h=o.rb[o.sb+o.ja],i=o.ya[o.aa+o.ja],p=o.kc?i.Ad:0)d.la=h.la=0,i.Za||(d.Na=h.Na=0),i.Hc=0,i.Gc=0,i.ia=0;else{var j,w;if(d=h,h=c,p=o.Pa.Xc,f=o.ya[o.aa+o.ja],m=o.pb[f.$b],u=f.ad,x=0,g=o.rb[o.sb-1],y=v=0,s(u,x,0,384),f.Za)var N=0,S=p[3];else{b=r(16);var k=d.Na+g.Na;if(k=as(h,p[1],k,m.Eb,0,b,0),d.Na=g.Na=(0<k)+0,1<k)nn(b,0,u,x);else{var A=b[0]+3>>3;for(b=0;256>b;b+=16)u[x+b]=A}N=1,S=p[0]}var C=15&d.la,L=15&g.la;for(b=0;4>b;++b){var T=1&L;for(A=w=0;4>A;++A)C=C>>1|(T=(k=as(h,S,k=T+(1&C),m.Sc,N,u,x))>N)<<7,w=w<<2|(3<k?3:1<k?2:0!=u[x+0]),x+=16;C>>=4,L=L>>1|T<<7,v=(v<<8|w)>>>0}for(S=C,N=L>>4,j=0;4>j;j+=2){for(w=0,C=d.la>>4+j,L=g.la>>4+j,b=0;2>b;++b){for(T=1&L,A=0;2>A;++A)k=T+(1&C),C=C>>1|(T=0<(k=as(h,p[2],k,m.Qc,0,u,x)))<<3,w=w<<2|(3<k?3:1<k?2:0!=u[x+0]),x+=16;C>>=2,L=L>>1|T<<5}y|=w<<4*j,S|=C<<4<<j,N|=(240&L)<<j}d.la=S,g.la=N,f.Hc=v,f.Gc=y,f.ia=43690&y?0:m.ia,p=!(v|y)}if(0<o.L&&(o.wa[o.Y+o.ja]=o.gd[i.$b][i.Za],o.wa[o.Y+o.ja].La|=!p),c.Ka)return Ye(e,7,"Premature end-of-file encountered.")}if(Xe(e),o=a,c=1,i=(l=e).D,d=0<l.L&&l.M>=l.zb&&l.M<=l.Va,0==l.Aa)t:{if(i.M=l.M,i.uc=d,Da(l,i),c=1,i=(w=l.D).Nb,d=(y=Os[l.L])*l.R,h=y/2*l.B,b=16*i*l.R,A=8*i*l.B,p=l.sa,f=l.ta-d+b,m=l.qa,u=l.ra-h+A,x=l.Ha,g=l.Ia-h+A,L=0==(C=w.M),v=C>=l.Va-1,2==l.Aa&&Da(l,w),w.uc)for(T=(k=l).D.M,t(k.D.uc),w=k.yb;w<k.Hb;++w){N=w,S=T;var E=(D=(M=k).D).Nb;j=M.R;var D=D.wa[D.Y+N],P=M.sa,R=M.ta+16*E*j+16*N,I=D.dd,B=D.tc;if(0!=B)if(t(3<=B),1==M.L)0<N&&yn(P,R,j,B+4),D.La&&jn(P,R,j,B),0<S&&vn(P,R,j,B+4),D.La&&bn(P,R,j,B);else{var F=M.B,O=M.qa,q=M.ra+8*E*F+8*N,z=M.Ha,M=M.Ia+8*E*F+8*N;E=D.ld,0<N&&(un(P,R,j,B+4,I,E),pn(O,q,z,M,F,B+4,I,E)),D.La&&(mn(P,R,j,B,I,E),gn(O,q,z,M,F,B,I,E)),0<S&&(dn(P,R,j,B+4,I,E),hn(O,q,z,M,F,B+4,I,E)),D.La&&(fn(P,R,j,B,I,E),xn(O,q,z,M,F,B,I,E))}}if(l.ia&&alert("todo:DitherRow"),null!=o.put){if(w=16*C,C=16*(C+1),L?(o.y=l.sa,o.O=l.ta+b,o.f=l.qa,o.N=l.ra+A,o.ea=l.Ha,o.W=l.Ia+A):(w-=y,o.y=p,o.O=f,o.f=m,o.N=u,o.ea=x,o.W=g),v||(C-=y),C>o.o&&(C=o.o),o.F=null,o.J=null,null!=l.Fa&&0<l.Fa.length&&w<C&&(o.J=da(l,o,w,C-w),o.F=l.mb,null==o.F&&0==o.F.length)){c=Ye(l,3,"Could not decode alpha data.");break t}w<o.j&&(y=o.j-w,w=o.j,t(!(1&y)),o.O+=l.R*y,o.N+=l.B*(y>>1),o.W+=l.B*(y>>1),null!=o.F&&(o.J+=o.width*y)),w<C&&(o.O+=o.v,o.N+=o.v>>1,o.W+=o.v>>1,null!=o.F&&(o.J+=o.v),o.ka=w-o.j,o.U=o.va-o.v,o.T=C-w,c=o.put(o))}i+1!=l.Ic||v||(n(l.sa,l.ta-d,p,f+16*l.R,d),n(l.qa,l.ra-h,m,u+8*l.B,h),n(l.Ha,l.Ia-h,x,g+8*l.B,h))}if(!c)return Ye(e,6,"Output aborted.")}return 1}(e,a)),null!=a.bc&&a.bc(a),l&=1}return l?(e.cb=0,l):0})(e,o)||(a=e.a)}}else a=e.a}0==a&&null!=u.Oa&&u.Oa.fd&&(a=Ia(u.ba))}u=a}d=0!=u?null:11>d?h.f.RGBA.eb:h.f.kb.y}else d=null;return d};var zs=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function c(e,t){for(var a="",n=0;n<4;n++)a+=String.fromCharCode(e[t++]);return a}function d(e,t){return e[t+0]|e[t+1]<<8}function u(e,t){return(e[t+0]|e[t+1]<<8|e[t+2]<<16)>>>0}function h(e,t){return(e[t+0]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}new o;var p=[0],f=[0],m=[],x=new o,g=e,v=function(e,t){var a={},n=0,s=!1,r=0,i=0;if(a.frames=[],!function(e,t){for(var a=0;a<4;a++)if(e[t+a]!="RIFF".charCodeAt(a))return!0;return!1}(e,t)){for(h(e,t+=4),t+=8;t<e.length;){var l=c(e,t),o=h(e,t+=4);t+=4;var p=o+(1&o);switch(l){case"VP8 ":case"VP8L":void 0===a.frames[n]&&(a.frames[n]={}),(x=a.frames[n]).src_off=s?i:t-8,x.src_size=r+o+8,n++,s&&(s=!1,r=0,i=0);break;case"VP8X":(x=a.header={}).feature_flags=e[t];var f=t+4;x.canvas_width=1+u(e,f),f+=3,x.canvas_height=1+u(e,f),f+=3;break;case"ALPH":s=!0,r=p+8,i=t-8;break;case"ANIM":(x=a.header).bgcolor=h(e,t),f=t+4,x.loop_count=d(e,f),f+=2;break;case"ANMF":var m,x;(x=a.frames[n]={}).offset_x=2*u(e,t),t+=3,x.offset_y=2*u(e,t),t+=3,x.width=1+u(e,t),t+=3,x.height=1+u(e,t),t+=3,x.duration=u(e,t),t+=3,m=e[t++],x.dispose=1&m,x.blend=m>>1&1}"ANMF"!=l&&(t+=p)}return a}}(g,0);v.response=g,v.rgbaoutput=!0,v.dataurl=!1;var y=v.header?v.header:null,b=v.frames?v.frames:null;if(y){y.loop_counter=y.loop_count,p=[y.canvas_height],f=[y.canvas_width];for(var j=0;j<b.length&&0!=b[j].blend;j++);}var w=b[0],N=x.WebPDecodeRGBA(g,w.src_off,w.src_size,f,p);w.rgba=N,w.imgwidth=f[0],w.imgheight=p[0];for(var S=0;S<f[0]*p[0]*4;S++)m[S]=N[S];return this.width=f,this.height=p,this.data=m,this}!function(e){var t,a,s,r,i,l,o,c,d,u=function(e){return e=e||{},this.isStrokeTransparent=e.isStrokeTransparent||!1,this.strokeOpacity=e.strokeOpacity||1,this.strokeStyle=e.strokeStyle||"#000000",this.fillStyle=e.fillStyle||"#000000",this.isFillTransparent=e.isFillTransparent||!1,this.fillOpacity=e.fillOpacity||1,this.font=e.font||"10px sans-serif",this.textBaseline=e.textBaseline||"alphabetic",this.textAlign=e.textAlign||"left",this.lineWidth=e.lineWidth||1,this.lineJoin=e.lineJoin||"miter",this.lineCap=e.lineCap||"butt",this.path=e.path||[],this.transform=void 0!==e.transform?e.transform.clone():new c,this.globalCompositeOperation=e.globalCompositeOperation||"normal",this.globalAlpha=e.globalAlpha||1,this.clip_path=e.clip_path||[],this.currentPoint=e.currentPoint||new l,this.miterLimit=e.miterLimit||10,this.lastPoint=e.lastPoint||new l,this.lineDashOffset=e.lineDashOffset||0,this.lineDash=e.lineDash||[],this.margin=e.margin||[0,0,0,0],this.prevPageLastElemOffset=e.prevPageLastElemOffset||0,this.ignoreClearRect="boolean"!=typeof e.ignoreClearRect||e.ignoreClearRect,this};e.events.push(["initialized",function(){this.context2d=new h(this),t=this.internal.f2,a=this.internal.getCoordinateString,s=this.internal.getVerticalCoordinateString,r=this.internal.getHorizontalCoordinate,i=this.internal.getVerticalCoordinate,l=this.internal.Point,o=this.internal.Rectangle,c=this.internal.Matrix,d=new u}]);var h=function(e){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var t=e;Object.defineProperty(this,"pdf",{get:function(){return t}});var a=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return a},set:function(e){a=Boolean(e)}});var n=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return n},set:function(e){n=Boolean(e)}});var s=0;Object.defineProperty(this,"posX",{get:function(){return s},set:function(e){isNaN(e)||(s=e)}});var r=0;Object.defineProperty(this,"posY",{get:function(){return r},set:function(e){isNaN(e)||(r=e)}}),Object.defineProperty(this,"margin",{get:function(){return d.margin},set:function(e){var t;"number"==typeof e?t=[e,e,e,e]:((t=new Array(4))[0]=e[0],t[1]=e.length>=2?e[1]:t[0],t[2]=e.length>=3?e[2]:t[0],t[3]=e.length>=4?e[3]:t[1]),d.margin=t}});var i=!1;Object.defineProperty(this,"autoPaging",{get:function(){return i},set:function(e){i=e}});var l=0;Object.defineProperty(this,"lastBreak",{get:function(){return l},set:function(e){l=e}});var o=[];Object.defineProperty(this,"pageBreaks",{get:function(){return o},set:function(e){o=e}}),Object.defineProperty(this,"ctx",{get:function(){return d},set:function(e){e instanceof u&&(d=e)}}),Object.defineProperty(this,"path",{get:function(){return d.path},set:function(e){d.path=e}});var c=[];Object.defineProperty(this,"ctxStack",{get:function(){return c},set:function(e){c=e}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(e){var t;t=p(e),this.ctx.fillStyle=t.style,this.ctx.isFillTransparent=0===t.a,this.ctx.fillOpacity=t.a,this.pdf.setFillColor(t.r,t.g,t.b,{a:t.a}),this.pdf.setTextColor(t.r,t.g,t.b,{a:t.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(e){var t=p(e);this.ctx.strokeStyle=t.style,this.ctx.isStrokeTransparent=0===t.a,this.ctx.strokeOpacity=t.a,0===t.a?this.pdf.setDrawColor(255,255,255):(t.a,this.pdf.setDrawColor(t.r,t.g,t.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(e){-1!==["butt","round","square"].indexOf(e)&&(this.ctx.lineCap=e,this.pdf.setLineCap(e))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(e){isNaN(e)||(this.ctx.lineWidth=e,this.pdf.setLineWidth(e))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(e){-1!==["bevel","round","miter"].indexOf(e)&&(this.ctx.lineJoin=e,this.pdf.setLineJoin(e))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(e){isNaN(e)||(this.ctx.miterLimit=e,this.pdf.setMiterLimit(e))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(e){this.ctx.textBaseline=e}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(e){-1!==["right","end","center","left","start"].indexOf(e)&&(this.ctx.textAlign=e)}});var h=null,f=null;Object.defineProperty(this,"fontFaces",{get:function(){return f},set:function(e){h=null,f=e}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(e){var t;if(this.ctx.font=e,null!==(t=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(e))){var a=t[1];t[2];var n=t[3],s=t[4];t[5];var r=t[6],i=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(s)[2];s="px"===i?Math.floor(parseFloat(s)*this.pdf.internal.scaleFactor):"em"===i?Math.floor(parseFloat(s)*this.pdf.getFontSize()):Math.floor(parseFloat(s)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(s);var l=function(e){var t,a,n=[],s=e.trim();if(""===s)return ri;if(s in Vr)return[Vr[s]];for(;""!==s;){switch(a=null,t=(s=Jr(s)).charAt(0)){case'"':case"'":a=Yr(s.substring(1),t);break;default:a=Kr(s)}if(null===a)return ri;if(n.push(a[0]),""!==(s=Jr(a[1]))&&","!==s.charAt(0))return ri;s=s.replace(/^,/,"")}return n}(r);if(this.fontFaces){var o=function(e,t){if(null===h){var a=function(e){var t=[];return Object.keys(e).forEach(function(a){e[a].forEach(function(e){var n=null;switch(e){case"bold":n={family:a,weight:"bold"};break;case"italic":n={family:a,style:"italic"};break;case"bolditalic":n={family:a,weight:"bold",style:"italic"};break;case"":case"normal":n={family:a}}null!==n&&(n.ref={name:a,style:e},t.push(n))})}),t}(e.getFontList());h=function(e){for(var t={},a=0;a<e.length;++a){var n=Ur(e[a]),s=n.family,r=n.stretch,i=n.style,l=n.weight;t[s]=t[s]||{},t[s][r]=t[s][r]||{},t[s][r][i]=t[s][r][i]||{},t[s][r][i][l]=n}return t}(a.concat(t))}return h}(this.pdf,this.fontFaces),c=l.map(function(e){return{family:e,stretch:"normal",weight:n,style:a}}),d=function(e,t,a){for(var n=(a=a||{}).defaultFontFamily||"times",s=Object.assign({},Hr,a.genericFontFamilies||{}),r=null,i=null,l=0;l<t.length;++l)if(s[(r=Ur(t[l])).family]&&(r.family=s[r.family]),e.hasOwnProperty(r.family)){i=e[r.family];break}if(!(i=i||e[n]))throw new Error("Could not find a font-family for the rule '"+Gr(r)+"' and default family '"+n+"'.");if(i=function(e,t){if(t[e])return t[e];var a=qr[e],n=a<=qr.normal?-1:1,s=Wr(t,Or,a,n);if(!s)throw new Error("Could not find a matching font-stretch value for "+e);return s}(r.stretch,i),i=function(e,t){if(t[e])return t[e];for(var a=Fr[e],n=0;n<a.length;++n)if(t[a[n]])return t[a[n]];throw new Error("Could not find a matching font-style for "+e)}(r.style,i),!(i=function(e,t){if(t[e])return t[e];if(400===e&&t[500])return t[500];if(500===e&&t[400])return t[400];var a=Mr[e],n=Wr(t,zr,a,e<400?-1:1);if(!n)throw new Error("Could not find a matching font-weight for value "+e);return n}(r.weight,i)))throw new Error("Failed to resolve a font for the rule '"+Gr(r)+"'.");return i}(o,c);this.pdf.setFont(d.ref.name,d.ref.style)}else{var u="";("bold"===n||parseInt(n,10)>=700||"bold"===a)&&(u="bold"),"italic"===a&&(u+="italic"),0===u.length&&(u="normal");for(var p="",f={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},m=0;m<l.length;m++){if(void 0!==this.pdf.internal.getFont(l[m],u,{noFallback:!0,disableWarning:!0})){p=l[m];break}if("bolditalic"===u&&void 0!==this.pdf.internal.getFont(l[m],"bold",{noFallback:!0,disableWarning:!0}))p=l[m],u="bold";else if(void 0!==this.pdf.internal.getFont(l[m],"normal",{noFallback:!0,disableWarning:!0})){p=l[m],u="normal";break}}if(""===p)for(var x=0;x<l.length;x++)if(f[l[x]]){p=f[l[x]];break}p=""===p?"Times":p,this.pdf.setFont(p,u)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(e){this.ctx.globalCompositeOperation=e}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(e){this.ctx.globalAlpha=e}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(e){this.ctx.lineDashOffset=e,O.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(e){this.ctx.lineDash=e,O.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(e){this.ctx.ignoreClearRect=Boolean(e)}})};h.prototype.setLineDash=function(e){this.lineDash=e},h.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},h.prototype.fill=function(){j.call(this,"fill",!1)},h.prototype.stroke=function(){j.call(this,"stroke",!1)},h.prototype.beginPath=function(){this.path=[{type:"begin"}]},h.prototype.moveTo=function(e,t){if(isNaN(e)||isNaN(t))throw vs.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var a=this.ctx.transform.applyToPoint(new l(e,t));this.path.push({type:"mt",x:a.x,y:a.y}),this.ctx.lastPoint=new l(e,t)},h.prototype.closePath=function(){var e=new l(0,0),t=0;for(t=this.path.length-1;-1!==t;t--)if("begin"===this.path[t].type&&"object"===(0,n.A)(this.path[t+1])&&"number"==typeof this.path[t+1].x){e=new l(this.path[t+1].x,this.path[t+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new l(e.x,e.y)},h.prototype.lineTo=function(e,t){if(isNaN(e)||isNaN(t))throw vs.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var a=this.ctx.transform.applyToPoint(new l(e,t));this.path.push({type:"lt",x:a.x,y:a.y}),this.ctx.lastPoint=new l(a.x,a.y)},h.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),j.call(this,null,!0)},h.prototype.quadraticCurveTo=function(e,t,a,n){if(isNaN(a)||isNaN(n)||isNaN(e)||isNaN(t))throw vs.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var s=this.ctx.transform.applyToPoint(new l(a,n)),r=this.ctx.transform.applyToPoint(new l(e,t));this.path.push({type:"qct",x1:r.x,y1:r.y,x:s.x,y:s.y}),this.ctx.lastPoint=new l(s.x,s.y)},h.prototype.bezierCurveTo=function(e,t,a,n,s,r){if(isNaN(s)||isNaN(r)||isNaN(e)||isNaN(t)||isNaN(a)||isNaN(n))throw vs.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var i=this.ctx.transform.applyToPoint(new l(s,r)),o=this.ctx.transform.applyToPoint(new l(e,t)),c=this.ctx.transform.applyToPoint(new l(a,n));this.path.push({type:"bct",x1:o.x,y1:o.y,x2:c.x,y2:c.y,x:i.x,y:i.y}),this.ctx.lastPoint=new l(i.x,i.y)},h.prototype.arc=function(e,t,a,n,s,r){if(isNaN(e)||isNaN(t)||isNaN(a)||isNaN(n)||isNaN(s))throw vs.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(r=Boolean(r),!this.ctx.transform.isIdentity){var i=this.ctx.transform.applyToPoint(new l(e,t));e=i.x,t=i.y;var o=this.ctx.transform.applyToPoint(new l(0,a)),c=this.ctx.transform.applyToPoint(new l(0,0));a=Math.sqrt(Math.pow(o.x-c.x,2)+Math.pow(o.y-c.y,2))}Math.abs(s-n)>=2*Math.PI&&(n=0,s=2*Math.PI),this.path.push({type:"arc",x:e,y:t,radius:a,startAngle:n,endAngle:s,counterclockwise:r})},h.prototype.arcTo=function(e,t,a,n,s){throw new Error("arcTo not implemented.")},h.prototype.rect=function(e,t,a,n){if(isNaN(e)||isNaN(t)||isNaN(a)||isNaN(n))throw vs.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(e,t),this.lineTo(e+a,t),this.lineTo(e+a,t+n),this.lineTo(e,t+n),this.lineTo(e,t),this.lineTo(e+a,t),this.lineTo(e,t)},h.prototype.fillRect=function(e,t,a,n){if(isNaN(e)||isNaN(t)||isNaN(a)||isNaN(n))throw vs.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!f.call(this)){var s={};"butt"!==this.lineCap&&(s.lineCap=this.lineCap,this.lineCap="butt"),"miter"!==this.lineJoin&&(s.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(e,t,a,n),this.fill(),s.hasOwnProperty("lineCap")&&(this.lineCap=s.lineCap),s.hasOwnProperty("lineJoin")&&(this.lineJoin=s.lineJoin)}},h.prototype.strokeRect=function(e,t,a,n){if(isNaN(e)||isNaN(t)||isNaN(a)||isNaN(n))throw vs.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");m.call(this)||(this.beginPath(),this.rect(e,t,a,n),this.stroke())},h.prototype.clearRect=function(e,t,a,n){if(isNaN(e)||isNaN(t)||isNaN(a)||isNaN(n))throw vs.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(e,t,a,n))},h.prototype.save=function(e){e="boolean"!=typeof e||e;for(var t=this.pdf.internal.getCurrentPageInfo().pageNumber,a=0;a<this.pdf.internal.getNumberOfPages();a++)this.pdf.setPage(a+1),this.pdf.internal.out("q");if(this.pdf.setPage(t),e){this.ctx.fontSize=this.pdf.internal.getFontSize();var n=new u(this.ctx);this.ctxStack.push(this.ctx),this.ctx=n}},h.prototype.restore=function(e){e="boolean"!=typeof e||e;for(var t=this.pdf.internal.getCurrentPageInfo().pageNumber,a=0;a<this.pdf.internal.getNumberOfPages();a++)this.pdf.setPage(a+1),this.pdf.internal.out("Q");this.pdf.setPage(t),e&&0!==this.ctxStack.length&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},h.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var p=function(e){var t,a,n,s;if(!0===e.isCanvasGradient&&(e=e.getColor()),!e)return{r:0,g:0,b:0,a:0,style:e};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(e))t=0,a=0,n=0,s=0;else{var r=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(e);if(null!==r)t=parseInt(r[1]),a=parseInt(r[2]),n=parseInt(r[3]),s=1;else if(null!==(r=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(e)))t=parseInt(r[1]),a=parseInt(r[2]),n=parseInt(r[3]),s=parseFloat(r[4]);else{if(s=1,"string"==typeof e&&"#"!==e.charAt(0)){var i=new Ns(e);e=i.ok?i.toHex():"#000000"}4===e.length?(t=e.substring(1,2),t+=t,a=e.substring(2,3),a+=a,n=e.substring(3,4),n+=n):(t=e.substring(1,3),a=e.substring(3,5),n=e.substring(5,7)),t=parseInt(t,16),a=parseInt(a,16),n=parseInt(n,16)}}return{r:t,g:a,b:n,a:s,style:e}},f=function(){return this.ctx.isFillTransparent||0==this.globalAlpha},m=function(){return Boolean(this.ctx.isStrokeTransparent||0==this.globalAlpha)};h.prototype.fillText=function(e,t,a,n){if(isNaN(t)||isNaN(a)||"string"!=typeof e)throw vs.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(n=isNaN(n)?void 0:n,!f.call(this)){var s=I(this.ctx.transform.rotation),r=this.ctx.transform.scaleX;L.call(this,{text:e,x:t,y:a,scale:r,angle:s,align:this.textAlign,maxWidth:n})}},h.prototype.strokeText=function(e,t,a,n){if(isNaN(t)||isNaN(a)||"string"!=typeof e)throw vs.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!m.call(this)){n=isNaN(n)?void 0:n;var s=I(this.ctx.transform.rotation),r=this.ctx.transform.scaleX;L.call(this,{text:e,x:t,y:a,scale:r,renderingMode:"stroke",angle:s,align:this.textAlign,maxWidth:n})}},h.prototype.measureText=function(e){if("string"!=typeof e)throw vs.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var t=this.pdf,a=this.pdf.internal.scaleFactor,n=t.internal.getFontSize(),s=t.getStringUnitWidth(e)*n/t.internal.scaleFactor;return new function(e){var t=(e=e||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return t}}),this}({width:s*=Math.round(96*a/72*1e4)/1e4})},h.prototype.scale=function(e,t){if(isNaN(e)||isNaN(t))throw vs.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var a=new c(e,0,0,t,0,0);this.ctx.transform=this.ctx.transform.multiply(a)},h.prototype.rotate=function(e){if(isNaN(e))throw vs.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var t=new c(Math.cos(e),Math.sin(e),-Math.sin(e),Math.cos(e),0,0);this.ctx.transform=this.ctx.transform.multiply(t)},h.prototype.translate=function(e,t){if(isNaN(e)||isNaN(t))throw vs.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var a=new c(1,0,0,1,e,t);this.ctx.transform=this.ctx.transform.multiply(a)},h.prototype.transform=function(e,t,a,n,s,r){if(isNaN(e)||isNaN(t)||isNaN(a)||isNaN(n)||isNaN(s)||isNaN(r))throw vs.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var i=new c(e,t,a,n,s,r);this.ctx.transform=this.ctx.transform.multiply(i)},h.prototype.setTransform=function(e,t,a,n,s,r){e=isNaN(e)?1:e,t=isNaN(t)?0:t,a=isNaN(a)?0:a,n=isNaN(n)?1:n,s=isNaN(s)?0:s,r=isNaN(r)?0:r,this.ctx.transform=new c(e,t,a,n,s,r)};var x=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};h.prototype.drawImage=function(e,t,a,n,s,r,i,l,d){var u=this.pdf.getImageProperties(e),h=1,p=1,f=1,m=1;void 0!==n&&void 0!==l&&(f=l/n,m=d/s,h=u.width/n*l/n,p=u.height/s*d/s),void 0===r&&(r=t,i=a,t=0,a=0),void 0!==n&&void 0===l&&(l=n,d=s),void 0===n&&void 0===l&&(l=u.width,d=u.height);for(var v,j=this.ctx.transform.decompose(),N=I(j.rotate.shx),S=new c,k=(S=(S=(S=S.multiply(j.translate)).multiply(j.skew)).multiply(j.scale)).applyToRectangle(new o(r-t*f,i-a*m,n*h,s*p)),A=g.call(this,k),C=[],_=0;_<A.length;_+=1)-1===C.indexOf(A[_])&&C.push(A[_]);if(b(C),this.autoPaging)for(var L=C[0],T=C[C.length-1],E=L;E<T+1;E++){this.pdf.setPage(E);var D=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],P=1===E?this.posY+this.margin[0]:this.margin[0],R=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],B=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],F=1===E?0:R+(E-2)*B;if(0!==this.ctx.clip_path.length){var O=this.path;v=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=y(v,this.posX+this.margin[3],-F+P+this.ctx.prevPageLastElemOffset),w.call(this,"fill",!0),this.path=O}var q=JSON.parse(JSON.stringify(k));q=y([q],this.posX+this.margin[3],-F+P+this.ctx.prevPageLastElemOffset)[0];var z=(E>L||E<T)&&x.call(this);z&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],D,B,null).clip().discardPath()),this.pdf.addImage(e,"JPEG",q.x,q.y,q.w,q.h,null,null,N),z&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(e,"JPEG",k.x,k.y,k.w,k.h,null,null,N)};var g=function(e,t,a){var n=[];t=t||this.pdf.internal.pageSize.width,a=a||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var s=this.posY+this.ctx.prevPageLastElemOffset;switch(e.type){default:case"mt":case"lt":n.push(Math.floor((e.y+s)/a)+1);break;case"arc":n.push(Math.floor((e.y+s-e.radius)/a)+1),n.push(Math.floor((e.y+s+e.radius)/a)+1);break;case"qct":var r=B(this.ctx.lastPoint.x,this.ctx.lastPoint.y,e.x1,e.y1,e.x,e.y);n.push(Math.floor((r.y+s)/a)+1),n.push(Math.floor((r.y+r.h+s)/a)+1);break;case"bct":var i=F(this.ctx.lastPoint.x,this.ctx.lastPoint.y,e.x1,e.y1,e.x2,e.y2,e.x,e.y);n.push(Math.floor((i.y+s)/a)+1),n.push(Math.floor((i.y+i.h+s)/a)+1);break;case"rect":n.push(Math.floor((e.y+s)/a)+1),n.push(Math.floor((e.y+e.h+s)/a)+1)}for(var l=0;l<n.length;l+=1)for(;this.pdf.internal.getNumberOfPages()<n[l];)v.call(this);return n},v=function(){var e=this.fillStyle,t=this.strokeStyle,a=this.font,n=this.lineCap,s=this.lineWidth,r=this.lineJoin;this.pdf.addPage(),this.fillStyle=e,this.strokeStyle=t,this.font=a,this.lineCap=n,this.lineWidth=s,this.lineJoin=r},y=function(e,t,a){for(var n=0;n<e.length;n++)switch(e[n].type){case"bct":e[n].x2+=t,e[n].y2+=a;case"qct":e[n].x1+=t,e[n].y1+=a;default:e[n].x+=t,e[n].y+=a}return e},b=function(e){return e.sort(function(e,t){return e-t})},j=function(e,t){for(var a,n,s=this.fillStyle,r=this.strokeStyle,i=this.lineCap,l=this.lineWidth,o=Math.abs(l*this.ctx.transform.scaleX),c=this.lineJoin,d=JSON.parse(JSON.stringify(this.path)),u=JSON.parse(JSON.stringify(this.path)),h=[],p=0;p<u.length;p++)if(void 0!==u[p].x)for(var f=g.call(this,u[p]),m=0;m<f.length;m+=1)-1===h.indexOf(f[m])&&h.push(f[m]);for(var j=0;j<h.length;j++)for(;this.pdf.internal.getNumberOfPages()<h[j];)v.call(this);if(b(h),this.autoPaging)for(var N=h[0],S=h[h.length-1],k=N;k<S+1;k++){this.pdf.setPage(k),this.fillStyle=s,this.strokeStyle=r,this.lineCap=i,this.lineWidth=o,this.lineJoin=c;var A=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],C=1===k?this.posY+this.margin[0]:this.margin[0],_=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],L=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],T=1===k?0:_+(k-2)*L;if(0!==this.ctx.clip_path.length){var E=this.path;a=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=y(a,this.posX+this.margin[3],-T+C+this.ctx.prevPageLastElemOffset),w.call(this,e,!0),this.path=E}if(n=JSON.parse(JSON.stringify(d)),this.path=y(n,this.posX+this.margin[3],-T+C+this.ctx.prevPageLastElemOffset),!1===t||0===k){var D=(k>N||k<S)&&x.call(this);D&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],A,L,null).clip().discardPath()),w.call(this,e,t),D&&this.pdf.restoreGraphicsState()}this.lineWidth=l}else this.lineWidth=o,w.call(this,e,t),this.lineWidth=l;this.path=d},w=function(e,t){if(("stroke"!==e||t||!m.call(this))&&("stroke"===e||t||!f.call(this))){for(var a,n,s=[],r=this.path,i=0;i<r.length;i++){var l=r[i];switch(l.type){case"begin":s.push({begin:!0});break;case"close":s.push({close:!0});break;case"mt":s.push({start:l,deltas:[],abs:[]});break;case"lt":var o=s.length;if(r[i-1]&&!isNaN(r[i-1].x)&&(a=[l.x-r[i-1].x,l.y-r[i-1].y],o>0))for(;o>=0;o--)if(!0!==s[o-1].close&&!0!==s[o-1].begin){s[o-1].deltas.push(a),s[o-1].abs.push(l);break}break;case"bct":a=[l.x1-r[i-1].x,l.y1-r[i-1].y,l.x2-r[i-1].x,l.y2-r[i-1].y,l.x-r[i-1].x,l.y-r[i-1].y],s[s.length-1].deltas.push(a);break;case"qct":var c=r[i-1].x+2/3*(l.x1-r[i-1].x),d=r[i-1].y+2/3*(l.y1-r[i-1].y),u=l.x+2/3*(l.x1-l.x),h=l.y+2/3*(l.y1-l.y),p=l.x,x=l.y;a=[c-r[i-1].x,d-r[i-1].y,u-r[i-1].x,h-r[i-1].y,p-r[i-1].x,x-r[i-1].y],s[s.length-1].deltas.push(a);break;case"arc":s.push({deltas:[],abs:[],arc:!0}),Array.isArray(s[s.length-1].abs)&&s[s.length-1].abs.push(l)}}n=t?null:"stroke"===e?"stroke":"fill";for(var g=!1,v=0;v<s.length;v++)if(s[v].arc)for(var y=s[v].abs,b=0;b<y.length;b++){var j=y[b];"arc"===j.type?k.call(this,j.x,j.y,j.radius,j.startAngle,j.endAngle,j.counterclockwise,void 0,t,!g):T.call(this,j.x,j.y),g=!0}else if(!0===s[v].close)this.pdf.internal.out("h"),g=!1;else if(!0!==s[v].begin){var w=s[v].start.x,N=s[v].start.y;E.call(this,s[v].deltas,w,N),g=!0}n&&A.call(this,n),t&&C.call(this)}},N=function(e){var t=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,a=t*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return e-a;case"top":return e+t-a;case"hanging":return e+t-2*a;case"middle":return e+t/2-a;default:return e}},S=function(e){return e+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};h.prototype.createLinearGradient=function(){var e=function(){};return e.colorStops=[],e.addColorStop=function(e,t){this.colorStops.push([e,t])},e.getColor=function(){return 0===this.colorStops.length?"#000000":this.colorStops[0][1]},e.isCanvasGradient=!0,e},h.prototype.createPattern=function(){return this.createLinearGradient()},h.prototype.createRadialGradient=function(){return this.createLinearGradient()};var k=function(e,t,a,n,s,r,i,l,o){for(var c=P.call(this,a,n,s,r),d=0;d<c.length;d++){var u=c[d];0===d&&(o?_.call(this,u.x1+e,u.y1+t):T.call(this,u.x1+e,u.y1+t)),D.call(this,e,t,u.x2,u.y2,u.x3,u.y3,u.x4,u.y4)}l?C.call(this):A.call(this,i)},A=function(e){switch(e){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},C=function(){this.pdf.clip(),this.pdf.discardPath()},_=function(e,t){this.pdf.internal.out(a(e)+" "+s(t)+" m")},L=function(e){var t;switch(e.align){case"right":case"end":t="right";break;case"center":t="center";break;default:t="left"}var a=this.pdf.getTextDimensions(e.text),n=N.call(this,e.y),s=S.call(this,n)-a.h,r=this.ctx.transform.applyToPoint(new l(e.x,n)),i=this.ctx.transform.decompose(),d=new c;d=(d=(d=d.multiply(i.translate)).multiply(i.skew)).multiply(i.scale);for(var u,h,p,f=this.ctx.transform.applyToRectangle(new o(e.x,n,a.w,a.h)),m=d.applyToRectangle(new o(e.x,s,a.w,a.h)),v=g.call(this,m),j=[],k=0;k<v.length;k+=1)-1===j.indexOf(v[k])&&j.push(v[k]);if(b(j),this.autoPaging)for(var A=j[0],C=j[j.length-1],_=A;_<C+1;_++){this.pdf.setPage(_);var L=1===_?this.posY+this.margin[0]:this.margin[0],T=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],E=this.pdf.internal.pageSize.height-this.margin[2],D=E-this.margin[0],P=this.pdf.internal.pageSize.width-this.margin[1],R=P-this.margin[3],I=1===_?0:T+(_-2)*D;if(0!==this.ctx.clip_path.length){var B=this.path;u=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=y(u,this.posX+this.margin[3],-1*I+L),w.call(this,"fill",!0),this.path=B}var F=y([JSON.parse(JSON.stringify(m))],this.posX+this.margin[3],-I+L+this.ctx.prevPageLastElemOffset)[0];e.scale>=.01&&(h=this.pdf.internal.getFontSize(),this.pdf.setFontSize(h*e.scale),p=this.lineWidth,this.lineWidth=p*e.scale);var O="text"!==this.autoPaging;if(O||F.y+F.h<=E){if(O||F.y>=L&&F.x<=P){var q=O?e.text:this.pdf.splitTextToSize(e.text,e.maxWidth||P-F.x)[0],z=y([JSON.parse(JSON.stringify(f))],this.posX+this.margin[3],-I+L+this.ctx.prevPageLastElemOffset)[0],M=O&&(_>A||_<C)&&x.call(this);M&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],R,D,null).clip().discardPath()),this.pdf.text(q,z.x,z.y,{angle:e.angle,align:t,renderingMode:e.renderingMode}),M&&this.pdf.restoreGraphicsState()}}else F.y<E&&(this.ctx.prevPageLastElemOffset+=E-F.y);e.scale>=.01&&(this.pdf.setFontSize(h),this.lineWidth=p)}else e.scale>=.01&&(h=this.pdf.internal.getFontSize(),this.pdf.setFontSize(h*e.scale),p=this.lineWidth,this.lineWidth=p*e.scale),this.pdf.text(e.text,r.x+this.posX,r.y+this.posY,{angle:e.angle,align:t,renderingMode:e.renderingMode,maxWidth:e.maxWidth}),e.scale>=.01&&(this.pdf.setFontSize(h),this.lineWidth=p)},T=function(e,t,n,r){n=n||0,r=r||0,this.pdf.internal.out(a(e+n)+" "+s(t+r)+" l")},E=function(e,t,a){return this.pdf.lines(e,t,a,null,null)},D=function(e,a,n,s,l,o,c,d){this.pdf.internal.out([t(r(n+e)),t(i(s+a)),t(r(l+e)),t(i(o+a)),t(r(c+e)),t(i(d+a)),"c"].join(" "))},P=function(e,t,a,n){for(var s=2*Math.PI,r=Math.PI/2;t>a;)t-=s;var i=Math.abs(a-t);i<s&&n&&(i=s-i);for(var l=[],o=n?-1:1,c=t;i>1e-5;){var d=c+o*Math.min(i,r);l.push(R.call(this,e,c,d)),i-=Math.abs(d-c),c=d}return l},R=function(e,t,a){var n=(a-t)/2,s=e*Math.cos(n),r=e*Math.sin(n),i=s,l=-r,o=i*i+l*l,c=o+i*s+l*r,d=4/3*(Math.sqrt(2*o*c)-c)/(i*r-l*s),u=i-d*l,h=l+d*i,p=u,f=-h,m=n+t,x=Math.cos(m),g=Math.sin(m);return{x1:e*Math.cos(t),y1:e*Math.sin(t),x2:u*x-h*g,y2:u*g+h*x,x3:p*x-f*g,y3:p*g+f*x,x4:e*Math.cos(a),y4:e*Math.sin(a)}},I=function(e){return 180*e/Math.PI},B=function(e,t,a,n,s,r){var i=e+.5*(a-e),l=t+.5*(n-t),c=s+.5*(a-s),d=r+.5*(n-r),u=Math.min(e,s,i,c),h=Math.max(e,s,i,c),p=Math.min(t,r,l,d),f=Math.max(t,r,l,d);return new o(u,p,h-u,f-p)},F=function(e,t,a,n,s,r,i,l){var c,d,u,h,p,f,m,x,g,v,y,b,j,w,N=a-e,S=n-t,k=s-a,A=r-n,C=i-s,_=l-r;for(d=0;d<41;d++)g=(m=(u=e+(c=d/40)*N)+c*((p=a+c*k)-u))+c*(p+c*(s+c*C-p)-m),v=(x=(h=t+c*S)+c*((f=n+c*A)-h))+c*(f+c*(r+c*_-f)-x),0==d?(y=g,b=v,j=g,w=v):(y=Math.min(y,g),b=Math.min(b,v),j=Math.max(j,g),w=Math.max(w,v));return new o(Math.round(y),Math.round(b),Math.round(j-y),Math.round(w-b))},O=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var e,t,a=(e=this.ctx.lineDash,t=this.ctx.lineDashOffset,JSON.stringify({lineDash:e,lineDashOffset:t}));this.prevLineDash!==a&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=a)}}}(Ks.API),function(e){var t=function(e){var t,a,n,s,r,i,l,o,c,d;for(/[^\x00-\xFF]/.test(e),a=[],n=0,s=(e+=t="\0\0\0\0".slice(e.length%4||4)).length;s>n;n+=4)0!==(r=(e.charCodeAt(n)<<24)+(e.charCodeAt(n+1)<<16)+(e.charCodeAt(n+2)<<8)+e.charCodeAt(n+3))?(i=(r=((r=((r=((r=(r-(d=r%85))/85)-(c=r%85))/85)-(o=r%85))/85)-(l=r%85))/85)%85,a.push(i+33,l+33,o+33,c+33,d+33)):a.push(122);return function(e,t){for(var a=t;a>0;a--)e.pop()}(a,t.length),String.fromCharCode.apply(String,a)+"~>"},a=function(e){var t,a,n,s,r,i=String,l="length",o=255,c="charCodeAt",d="slice",u="replace";for(e[d](-2),e=e[d](0,-2)[u](/\s/g,"")[u]("z","!!!!!"),n=[],s=0,r=(e+=t="uuuuu"[d](e[l]%5||5))[l];r>s;s+=5)a=52200625*(e[c](s)-33)+614125*(e[c](s+1)-33)+7225*(e[c](s+2)-33)+85*(e[c](s+3)-33)+(e[c](s+4)-33),n.push(o&a>>24,o&a>>16,o&a>>8,o&a);return function(e,t){for(var a=t;a>0;a--)e.pop()}(n,t[l]),i.fromCharCode.apply(i,n)},n=function(e){return e.split("").map(function(e){return("0"+e.charCodeAt().toString(16)).slice(-2)}).join("")+">"},s=function(e){var t=new RegExp(/^([0-9A-Fa-f]{2})+$/);if(-1!==(e=e.replace(/\s/g,"")).indexOf(">")&&(e=e.substr(0,e.indexOf(">"))),e.length%2&&(e+="0"),!1===t.test(e))return"";for(var a="",n=0;n<e.length;n+=2)a+=String.fromCharCode("0x"+(e[n]+e[n+1]));return a},r=function(e){for(var t=new Uint8Array(e.length),a=e.length;a--;)t[a]=e.charCodeAt(a);return(t=M(t)).reduce(function(e,t){return e+String.fromCharCode(t)},"")};e.processDataByFilters=function(e,i){var l=0,o=e||"",c=[];for("string"==typeof(i=i||[])&&(i=[i]),l=0;l<i.length;l+=1)switch(i[l]){case"ASCII85Decode":case"/ASCII85Decode":o=a(o),c.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":o=t(o),c.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":o=s(o),c.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":o=n(o),c.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":o=r(o),c.push("/FlateDecode");break;default:throw new Error('The filter: "'+i[l]+'" is not implemented')}return{data:o,reverseChain:c.reverse().join(" ")}}}(Ks.API),(si=Ks.API).loadFile=function(e,t,a){return function(e,t,a){t=!1!==t,a="function"==typeof a?a:function(){};var n=void 0;try{n=function(e,t,a){var n=new XMLHttpRequest,s=0,r=function(e){var t=e.length,a=[],n=String.fromCharCode;for(s=0;s<t;s+=1)a.push(n(255&e.charCodeAt(s)));return a.join("")};if(n.open("GET",e,!t),n.overrideMimeType("text/plain; charset=x-user-defined"),!1===t&&(n.onload=function(){200===n.status?a(r(this.responseText)):a(void 0)}),n.send(null),t&&200===n.status)return r(n.responseText)}(e,t,a)}catch(g){}return n}(e,t,a)},si.loadImageFile=si.loadFile,function(e){function t(){return(xs.html2canvas?Promise.resolve(xs.html2canvas):a.e(239).then(a.t.bind(a,5239,23))).catch(function(e){return Promise.reject(new Error("Could not load html2canvas: "+e))}).then(function(e){return e.default?e.default:e})}function s(){return(xs.DOMPurify?Promise.resolve(xs.DOMPurify):a.e(977).then(a.bind(a,7977))).catch(function(e){return Promise.reject(new Error("Could not load dompurify: "+e))}).then(function(e){return e.default?e.default:e})}var r=function(e){var t=(0,n.A)(e);return"undefined"===t?"undefined":"string"===t||e instanceof String?"string":"number"===t||e instanceof Number?"number":"function"===t||e instanceof Function?"function":e&&e.constructor===Array?"array":e&&1===e.nodeType?"element":"object"===t?"object":"unknown"},i=function(e,t){var a=document.createElement(e);for(var n in t.className&&(a.className=t.className),t.innerHTML&&t.dompurify&&(a.innerHTML=t.dompurify.sanitize(t.innerHTML)),t.style)a.style[n]=t.style[n];return a},l=function e(t,a){for(var n=3===t.nodeType?document.createTextNode(t.nodeValue):t.cloneNode(!1),s=t.firstChild;s;s=s.nextSibling)!0!==a&&1===s.nodeType&&"SCRIPT"===s.nodeName||n.appendChild(e(s,a));return 1===t.nodeType&&("CANVAS"===t.nodeName?(n.width=t.width,n.height=t.height,n.getContext("2d").drawImage(t,0,0)):"TEXTAREA"!==t.nodeName&&"SELECT"!==t.nodeName||(n.value=t.value),n.addEventListener("load",function(){n.scrollTop=t.scrollTop,n.scrollLeft=t.scrollLeft},!0)),n},o=function e(t){var a=Object.assign(e.convert(Promise.resolve()),JSON.parse(JSON.stringify(e.template))),n=e.convert(Promise.resolve(),a);return(n=n.setProgress(1,e,1,[e])).set(t)};(o.prototype=Object.create(Promise.prototype)).constructor=o,o.convert=function(e,t){return e.__proto__=t||o.prototype,e},o.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},o.prototype.from=function(e,t){return this.then(function(){switch(t=t||function(e){switch(r(e)){case"string":return"string";case"element":return"canvas"===e.nodeName.toLowerCase()?"canvas":"element";default:return"unknown"}}(e),t){case"string":return this.then(s).then(function(t){return this.set({src:i("div",{innerHTML:e,dompurify:t})})});case"element":return this.set({src:e});case"canvas":return this.set({canvas:e});case"img":return this.set({img:e});default:return this.error("Unknown source type.")}})},o.prototype.to=function(e){switch(e){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},o.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var e={position:"relative",display:"inline-block",width:("number"!=typeof this.opt.width||isNaN(this.opt.width)||"number"!=typeof this.opt.windowWidth||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},t=l(this.prop.src,this.opt.html2canvas.javascriptEnabled);"BODY"===t.tagName&&(e.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=i("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=i("div",{className:"html2pdf__container",style:e}),this.prop.container.appendChild(t),this.prop.container.firstChild.appendChild(i("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},o.prototype.toCanvas=function(){var e=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(e).then(t).then(function(e){var t=Object.assign({},this.opt.html2canvas);return delete t.onrendered,e(this.prop.container,t)}).then(function(e){(this.opt.html2canvas.onrendered||function(){})(e),this.prop.canvas=e,document.body.removeChild(this.prop.overlay)})},o.prototype.toContext2d=function(){var e=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(e).then(t).then(function(e){var t=this.opt.jsPDF,a=this.opt.fontFaces,n="number"!=typeof this.opt.width||isNaN(this.opt.width)||"number"!=typeof this.opt.windowWidth||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,s=Object.assign({async:!0,allowTaint:!0,scale:n,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete s.onrendered,t.context2d.autoPaging=void 0===this.opt.autoPaging||this.opt.autoPaging,t.context2d.posX=this.opt.x,t.context2d.posY=this.opt.y,t.context2d.margin=this.opt.margin,t.context2d.fontFaces=a,a)for(var r=0;r<a.length;++r){var i=a[r],l=i.src.find(function(e){return"truetype"===e.format});l&&t.addFont(l.url,i.ref.name,i.ref.style)}return s.windowHeight=s.windowHeight||0,s.windowHeight=0==s.windowHeight?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):s.windowHeight,t.context2d.save(!0),e(this.prop.container,s)}).then(function(e){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(e),this.prop.canvas=e,document.body.removeChild(this.prop.overlay)})},o.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var e=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=e})},o.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},o.prototype.output=function(e,t,a){return"img"===(a=a||"pdf").toLowerCase()||"image"===a.toLowerCase()?this.outputImg(e,t):this.outputPdf(e,t)},o.prototype.outputPdf=function(e,t){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(e,t)})},o.prototype.outputImg=function(e){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(e){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+e+'" is not supported.'}})},o.prototype.save=function(e){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(e?{filename:e}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},o.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},o.prototype.set=function(e){if("object"!==r(e))return this;var t=Object.keys(e||{}).map(function(t){if(t in o.template.prop)return function(){this.prop[t]=e[t]};switch(t){case"margin":return this.setMargin.bind(this,e.margin);case"jsPDF":return function(){return this.opt.jsPDF=e.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,e.pageSize);default:return function(){this.opt[t]=e[t]}}},this);return this.then(function(){return this.thenList(t)})},o.prototype.get=function(e,t){return this.then(function(){var a=e in o.template.prop?this.prop[e]:this.opt[e];return t?t(a):a})},o.prototype.setMargin=function(e){return this.then(function(){switch(r(e)){case"number":e=[e,e,e,e];case"array":if(2===e.length&&(e=[e[0],e[1],e[0],e[1]]),4===e.length)break;default:return this.error("Invalid margin array.")}this.opt.margin=e}).then(this.setPageSize)},o.prototype.setPageSize=function(e){function t(e,t){return Math.floor(e*t/72*96)}return this.then(function(){(e=e||Ks.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(e.inner={width:e.width-this.opt.margin[1]-this.opt.margin[3],height:e.height-this.opt.margin[0]-this.opt.margin[2]},e.inner.px={width:t(e.inner.width,e.k),height:t(e.inner.height,e.k)},e.inner.ratio=e.inner.height/e.inner.width),this.prop.pageSize=e})},o.prototype.setProgress=function(e,t,a,n){return null!=e&&(this.progress.val=e),null!=t&&(this.progress.state=t),null!=a&&(this.progress.n=a),null!=n&&(this.progress.stack=n),this.progress.ratio=this.progress.val/this.progress.state,this},o.prototype.updateProgress=function(e,t,a,n){return this.setProgress(e?this.progress.val+e:null,t||null,a?this.progress.n+a:null,n?this.progress.stack.concat(n):null)},o.prototype.then=function(e,t){var a=this;return this.thenCore(e,t,function(e,t){return a.updateProgress(null,null,1,[e]),Promise.prototype.then.call(this,function(t){return a.updateProgress(null,e),t}).then(e,t).then(function(e){return a.updateProgress(1),e})})},o.prototype.thenCore=function(e,t,a){a=a||Promise.prototype.then;var n=this;e&&(e=e.bind(n)),t&&(t=t.bind(n));var s=-1!==Promise.toString().indexOf("[native code]")&&"Promise"===Promise.name?n:o.convert(Object.assign({},n),Promise.prototype),r=a.call(s,e,t);return o.convert(r,n.__proto__)},o.prototype.thenExternal=function(e,t){return Promise.prototype.then.call(this,e,t)},o.prototype.thenList=function(e){var t=this;return e.forEach(function(e){t=t.thenCore(e)}),t},o.prototype.catch=function(e){e&&(e=e.bind(this));var t=Promise.prototype.catch.call(this,e);return o.convert(t,this)},o.prototype.catchExternal=function(e){return Promise.prototype.catch.call(this,e)},o.prototype.error=function(e){return this.then(function(){throw new Error(e)})},o.prototype.using=o.prototype.set,o.prototype.saveAs=o.prototype.save,o.prototype.export=o.prototype.output,o.prototype.run=o.prototype.then,Ks.getPageSize=function(e,t,a){if("object"===(0,n.A)(e)){var s=e;e=s.orientation,t=s.unit||t,a=s.format||a}t=t||"mm",a=a||"a4",e=(""+(e||"P")).toLowerCase();var r,i=(""+a).toLowerCase(),l={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(t){case"pt":r=1;break;case"mm":r=72/25.4;break;case"cm":r=72/2.54;break;case"in":r=72;break;case"px":r=.75;break;case"pc":case"em":r=12;break;case"ex":r=6;break;default:throw"Invalid unit: "+t}var o,c=0,d=0;if(l.hasOwnProperty(i))c=l[i][1]/r,d=l[i][0]/r;else try{c=a[1],d=a[0]}catch(Ns){throw new Error("Invalid format: "+a)}if("p"===e||"portrait"===e)e="p",d>c&&(o=d,d=c,c=o);else{if("l"!==e&&"landscape"!==e)throw"Invalid orientation: "+e;e="l",c>d&&(o=d,d=c,c=o)}return{width:d,height:c,unit:t,k:r,orientation:e}},e.html=function(e,t){(t=t||{}).callback=t.callback||function(){},t.html2canvas=t.html2canvas||{},t.html2canvas.canvas=t.html2canvas.canvas||this.canvas,t.jsPDF=t.jsPDF||this,t.fontFaces=t.fontFaces?t.fontFaces.map(Ur):null;var a=new o(t);return t.worker?a:a.from(e).doCallback()}}(Ks.API),Ks.API.addJS=function(e){return Xr=e,this.internal.events.subscribe("postPutResources",function(){Qr=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(Qr+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),$r=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+Xr+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){void 0!==Qr&&void 0!==$r&&this.internal.out("/Names <</JavaScript "+Qr+" 0 R>>")}),this},function(e){var t;e.events.push(["postPutResources",function(){var e=this,a=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var n=e.outline.render().split(/\r\n/),s=0;s<n.length;s++){var r=n[s],i=a.exec(r);if(null!=i){var l=i[1];e.internal.newObjectDeferredBegin(l,!1)}e.internal.write(r)}if(this.outline.createNamedDestinations){var o=this.internal.pages.length,c=[];for(s=0;s<o;s++){var d=e.internal.newObject();c.push(d);var u=e.internal.getPageInfo(s+1);e.internal.write("<< /D["+u.objId+" 0 R /XYZ null null null]>> endobj")}var h=e.internal.newObject();for(e.internal.write("<< /Names [ "),s=0;s<c.length;s++)e.internal.write("(page_"+(s+1)+")"+c[s]+" 0 R");e.internal.write(" ] >>","endobj"),t=e.internal.newObject(),e.internal.write("<< /Dests "+h+" 0 R"),e.internal.write(">>","endobj")}}]),e.events.push(["putCatalog",function(){var e=this;e.outline.root.children.length>0&&(e.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&e.internal.write("/Names "+t+" 0 R"))}]),e.events.push(["initialized",function(){var e=this;e.outline={createNamedDestinations:!1,root:{children:[]}},e.outline.add=function(e,t,a){var n={title:t,options:a,children:[]};return null==e&&(e=this.root),e.children.push(n),n},e.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=e,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},e.outline.genIds_r=function(t){t.id=e.internal.newObjectDeferred();for(var a=0;a<t.children.length;a++)this.genIds_r(t.children[a])},e.outline.renderRoot=function(e){this.objStart(e),this.line("/Type /Outlines"),e.children.length>0&&(this.line("/First "+this.makeRef(e.children[0])),this.line("/Last "+this.makeRef(e.children[e.children.length-1]))),this.line("/Count "+this.count_r({count:0},e)),this.objEnd()},e.outline.renderItems=function(t){for(var a=this.ctx.pdf.internal.getVerticalCoordinateString,n=0;n<t.children.length;n++){var s=t.children[n];this.objStart(s),this.line("/Title "+this.makeString(s.title)),this.line("/Parent "+this.makeRef(t)),n>0&&this.line("/Prev "+this.makeRef(t.children[n-1])),n<t.children.length-1&&this.line("/Next "+this.makeRef(t.children[n+1])),s.children.length>0&&(this.line("/First "+this.makeRef(s.children[0])),this.line("/Last "+this.makeRef(s.children[s.children.length-1])));var r=this.count=this.count_r({count:0},s);if(r>0&&this.line("/Count "+r),s.options&&s.options.pageNumber){var i=e.internal.getPageInfo(s.options.pageNumber);this.line("/Dest ["+i.objId+" 0 R /XYZ 0 "+a(0)+" 0]")}this.objEnd()}for(var l=0;l<t.children.length;l++)this.renderItems(t.children[l])},e.outline.line=function(e){this.ctx.val+=e+"\r\n"},e.outline.makeRef=function(e){return e.id+" 0 R"},e.outline.makeString=function(t){return"("+e.internal.pdfEscape(t)+")"},e.outline.objStart=function(e){this.ctx.val+="\r\n"+e.id+" 0 obj\r\n<<\r\n"},e.outline.objEnd=function(){this.ctx.val+=">> \r\nendobj\r\n"},e.outline.count_r=function(e,t){for(var a=0;a<t.children.length;a++)e.count++,this.count_r(e,t.children[a]);return e.count}}])}(Ks.API),function(e){var t=[192,193,194,195,196,197,198,199];e.processJPEG=function(e,a,n,s,r,i){var l,o=this.decode.DCT_DECODE,c=null;if("string"==typeof e||this.__addimage__.isArrayBuffer(e)||this.__addimage__.isArrayBufferView(e)){switch(e=r||e,e=this.__addimage__.isArrayBuffer(e)?new Uint8Array(e):e,l=function(e){for(var a,n=256*e.charCodeAt(4)+e.charCodeAt(5),s=e.length,r={width:0,height:0,numcomponents:1},i=4;i<s;i+=2){if(i+=n,-1!==t.indexOf(e.charCodeAt(i+1))){a=256*e.charCodeAt(i+5)+e.charCodeAt(i+6),r={width:256*e.charCodeAt(i+7)+e.charCodeAt(i+8),height:a,numcomponents:e.charCodeAt(i+9)};break}n=256*e.charCodeAt(i+2)+e.charCodeAt(i+3)}return r}(e=this.__addimage__.isArrayBufferView(e)?this.__addimage__.arrayBufferToBinaryString(e):e),l.numcomponents){case 1:i=this.color_spaces.DEVICE_GRAY;break;case 4:i=this.color_spaces.DEVICE_CMYK;break;case 3:i=this.color_spaces.DEVICE_RGB}c={data:e,width:l.width,height:l.height,colorSpace:i,bitsPerComponent:8,filter:o,index:a,alias:n}}return c}}(Ks.API),Ks.API.processPNG=function(e,t,a,n){if(this.__addimage__.isArrayBuffer(e)&&(e=new Uint8Array(e)),this.__addimage__.isArrayBufferView(e)){var s,r=new fs(e,{checkCrc:!0}).decode(),i=r.width,l=r.height,o=r.channels,c=r.palette,d=r.depth;s=c&&1===o?function(e){for(var t=e.width,a=e.height,n=e.data,s=e.palette,r=e.depth,i=!1,l=[],o=[],c=void 0,d=!1,u=0,h=0;h<s.length;h++){var p=H(s[h],4),f=p[0],m=p[1],x=p[2],g=p[3];l.push(f,m,x),null!=g&&(0===g?(u++,o.length<1&&o.push(h)):g<255&&(d=!0))}if(d||u>1){i=!0,o=void 0;var v=t*a;c=new Uint8Array(v);for(var y=new DataView(n.buffer),b=0;b<v;b++){var j=H(s[fi(y,b,r)],4)[3];c[b]=j}}else 0===u&&(o=void 0);return{colorSpace:"Indexed",colorsPerPixel:1,sMaskBitsPerComponent:i?8:void 0,colorBytes:n,alphaBytes:c,needSMask:i,palette:l,mask:o}}(r):2===o||4===o?function(e){for(var t=e.data,a=e.width,n=e.height,s=e.channels,r=e.depth,i=2===s?"DeviceGray":"DeviceRGB",l=s-1,o=a*n,c=l,d=o*c,u=1*o,h=Math.ceil(d*r/8),p=Math.ceil(u*r/8),f=new Uint8Array(h),m=new Uint8Array(p),x=new DataView(t.buffer),g=new DataView(f.buffer),v=new DataView(m.buffer),y=!1,b=0;b<o;b++){for(var j=b*s,w=0;w<c;w++)mi(g,fi(x,j+w,r),b*c+w,r);var N=fi(x,j+c,r);N<(1<<r)-1&&(y=!0),mi(v,N,1*b,r)}return{colorSpace:i,colorsPerPixel:l,sMaskBitsPerComponent:y?r:void 0,colorBytes:f,alphaBytes:m,needSMask:y}}(r):function(e){var t=e.data,a=1===e.channels?"DeviceGray":"DeviceRGB";return{colorSpace:a,colorsPerPixel:"DeviceGray"===a?1:3,colorBytes:t instanceof Uint16Array?function(e){for(var t=e.length,a=new Uint8Array(2*t),n=new DataView(a.buffer,a.byteOffset,a.byteLength),s=0;s<t;s++)n.setUint16(2*s,e[s],!1);return a}(t):t,needSMask:!1}}(r);var u,h,p,f=s,m=f.colorSpace,x=f.colorsPerPixel,g=f.sMaskBitsPerComponent,v=f.colorBytes,y=f.alphaBytes,b=f.needSMask,j=f.palette,w=f.mask,N=null;return n!==Ks.API.image_compression.NONE?(N=function(e){var t;switch(e){case Ks.API.image_compression.FAST:t=11;break;case Ks.API.image_compression.MEDIUM:t=13;break;case Ks.API.image_compression.SLOW:t=14;break;default:t=12}return t}(n),u=this.decode.FLATE_DECODE,h="/Predictor ".concat(N," /Colors ").concat(x," /BitsPerComponent ").concat(d," /Columns ").concat(i),e=ii(v,Math.ceil(i*x*d/8),x,d,n),b&&(p=ii(y,Math.ceil(i*g/8),1,g,n))):(u=void 0,h=void 0,e=v,b&&(p=y)),(this.__addimage__.isArrayBuffer(e)||this.__addimage__.isArrayBufferView(e))&&(e=this.__addimage__.arrayBufferToBinaryString(e)),(p&&this.__addimage__.isArrayBuffer(p)||this.__addimage__.isArrayBufferView(p))&&(p=this.__addimage__.arrayBufferToBinaryString(p)),{alias:a,data:e,index:t,filter:u,decodeParameters:h,transparency:w,palette:j,sMask:p,predictor:N,width:i,height:l,bitsPerComponent:d,sMaskBitsPerComponent:g,colorSpace:m}}},function(e){e.processGIF89A=function(t,a,n,s){var r=new gi(t),i=r.width,l=r.height,o=[];r.decodeAndBlitFrameRGBA(0,o);var c={data:o,width:i,height:l},d=new yi(100).encode(c,100);return e.processJPEG.call(this,d,a,n,s)},e.processGIF87A=e.processGIF89A}(Ks.API),bi.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,16===this.bitPP&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var e=0===this.colors?1<<this.bitPP:this.colors;this.palette=new Array(e);for(var t=0;t<e;t++){var a=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0);this.palette[t]={red:s,green:n,blue:a,quad:r}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},bi.prototype.parseBGR=function(){this.pos=this.offset;try{var e="bit"+this.bitPP,t=this.width*this.height*4;this.data=new Uint8Array(t),this[e]()}catch(a){vs.log("bit decode error:"+a)}},bi.prototype.bit1=function(){var e,t=Math.ceil(this.width/8),a=t%4;for(e=this.height-1;e>=0;e--){for(var n=this.bottom_up?e:this.height-1-e,s=0;s<t;s++)for(var r=this.datav.getUint8(this.pos++,!0),i=n*this.width*4+8*s*4,l=0;l<8&&8*s+l<this.width;l++){var o=this.palette[r>>7-l&1];this.data[i+4*l]=o.blue,this.data[i+4*l+1]=o.green,this.data[i+4*l+2]=o.red,this.data[i+4*l+3]=255}0!==a&&(this.pos+=4-a)}},bi.prototype.bit4=function(){for(var e=Math.ceil(this.width/2),t=e%4,a=this.height-1;a>=0;a--){for(var n=this.bottom_up?a:this.height-1-a,s=0;s<e;s++){var r=this.datav.getUint8(this.pos++,!0),i=n*this.width*4+2*s*4,l=r>>4,o=15&r,c=this.palette[l];if(this.data[i]=c.blue,this.data[i+1]=c.green,this.data[i+2]=c.red,this.data[i+3]=255,2*s+1>=this.width)break;c=this.palette[o],this.data[i+4]=c.blue,this.data[i+4+1]=c.green,this.data[i+4+2]=c.red,this.data[i+4+3]=255}0!==t&&(this.pos+=4-t)}},bi.prototype.bit8=function(){for(var e=this.width%4,t=this.height-1;t>=0;t--){for(var a=this.bottom_up?t:this.height-1-t,n=0;n<this.width;n++){var s=this.datav.getUint8(this.pos++,!0),r=a*this.width*4+4*n;if(s<this.palette.length){var i=this.palette[s];this.data[r]=i.red,this.data[r+1]=i.green,this.data[r+2]=i.blue,this.data[r+3]=255}else this.data[r]=255,this.data[r+1]=255,this.data[r+2]=255,this.data[r+3]=255}0!==e&&(this.pos+=4-e)}},bi.prototype.bit15=function(){for(var e=this.width%3,t=parseInt("11111",2),a=this.height-1;a>=0;a--){for(var n=this.bottom_up?a:this.height-1-a,s=0;s<this.width;s++){var r=this.datav.getUint16(this.pos,!0);this.pos+=2;var i=(r&t)/t*255|0,l=(r>>5&t)/t*255|0,o=(r>>10&t)/t*255|0,c=r>>15?255:0,d=n*this.width*4+4*s;this.data[d]=o,this.data[d+1]=l,this.data[d+2]=i,this.data[d+3]=c}this.pos+=e}},bi.prototype.bit16=function(){for(var e=this.width%3,t=parseInt("11111",2),a=parseInt("111111",2),n=this.height-1;n>=0;n--){for(var s=this.bottom_up?n:this.height-1-n,r=0;r<this.width;r++){var i=this.datav.getUint16(this.pos,!0);this.pos+=2;var l=(i&t)/t*255|0,o=(i>>5&a)/a*255|0,c=(i>>11)/t*255|0,d=s*this.width*4+4*r;this.data[d]=c,this.data[d+1]=o,this.data[d+2]=l,this.data[d+3]=255}this.pos+=e}},bi.prototype.bit24=function(){for(var e=this.height-1;e>=0;e--){for(var t=this.bottom_up?e:this.height-1-e,a=0;a<this.width;a++){var n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),i=t*this.width*4+4*a;this.data[i]=r,this.data[i+1]=s,this.data[i+2]=n,this.data[i+3]=255}this.pos+=this.width%4}},bi.prototype.bit32=function(){for(var e=this.height-1;e>=0;e--)for(var t=this.bottom_up?e:this.height-1-e,a=0;a<this.width;a++){var n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),l=t*this.width*4+4*a;this.data[l]=r,this.data[l+1]=s,this.data[l+2]=n,this.data[l+3]=i}},bi.prototype.getData=function(){return this.data},function(e){e.processBMP=function(t,a,n,s){var r=new bi(t,!1),i=r.width,l=r.height,o={data:r.getData(),width:i,height:l},c=new yi(100).encode(o,100);return e.processJPEG.call(this,c,a,n,s)}}(Ks.API),ji.prototype.getData=function(){return this.data},function(e){e.processWEBP=function(t,a,n,s){var r=new ji(t),i=r.width,l=r.height,o={data:r.getData(),width:i,height:l},c=new yi(100).encode(o,100);return e.processJPEG.call(this,c,a,n,s)}}(Ks.API),Ks.API.processRGBA=function(e,t,a){for(var n=e.data,s=n.length,r=new Uint8Array(s/4*3),i=new Uint8Array(s/4),l=0,o=0,c=0;c<s;c+=4){var d=n[c],u=n[c+1],h=n[c+2],p=n[c+3];r[l++]=d,r[l++]=u,r[l++]=h,i[o++]=p}var f=this.__addimage__.arrayBufferToBinaryString(r);return{alpha:this.__addimage__.arrayBufferToBinaryString(i),data:f,index:t,alias:a,colorSpace:"DeviceRGB",bitsPerComponent:8,width:e.width,height:e.height}},Ks.API.setLanguage=function(e){return void 0===this.internal.languageSettings&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),void 0!=={af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[e]&&(this.internal.languageSettings.languageCode=e,!1===this.internal.languageSettings.isSubscribed&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},Zr=Ks.API,ei=Zr.getCharWidthsArray=function(e,t){var a,s,r=(t=t||{}).font||this.internal.getFont(),i=t.fontSize||this.internal.getFontSize(),l=t.charSpace||this.internal.getCharSpace(),o=t.widths?t.widths:r.metadata.Unicode.widths,c=o.fof?o.fof:1,d=t.kerning?t.kerning:r.metadata.Unicode.kerning,u=d.fof?d.fof:1,h=!1!==t.doKerning,p=0,f=e.length,m=0,x=o[0]||c,g=[];for(a=0;a<f;a++)s=e.charCodeAt(a),"function"==typeof r.metadata.widthOfString?g.push((r.metadata.widthOfGlyph(r.metadata.characterToGlyph(s))+l*(1e3/i)||0)/1e3):(p=h&&"object"===(0,n.A)(d[s])&&!isNaN(parseInt(d[s][m],10))?d[s][m]/u:0,g.push((o[s]||x)/c+p)),m=s;return g},ti=Zr.getStringUnitWidth=function(e,t){var a=(t=t||{}).fontSize||this.internal.getFontSize(),n=t.font||this.internal.getFont(),s=t.charSpace||this.internal.getCharSpace();return Zr.processArabic&&(e=Zr.processArabic(e)),"function"==typeof n.metadata.widthOfString?n.metadata.widthOfString(e,a,s)/a:ei.apply(this,arguments).reduce(function(e,t){return e+t},0)},ai=function(e,t,a,n){for(var s=[],r=0,i=e.length,l=0;r!==i&&l+t[r]<a;)l+=t[r],r++;s.push(e.slice(0,r));var o=r;for(l=0;r!==i;)l+t[r]>n&&(s.push(e.slice(o,r)),l=0,o=r),l+=t[r],r++;return o!==r&&s.push(e.slice(o,r)),s},ni=function(e,t,a){a||(a={});var n,s,r,i,l,o,c,d=[],u=[d],h=a.textIndent||0,p=0,f=0,m=e.split(" "),x=ei.apply(this,[" ",a])[0];if(o=-1===a.lineIndent?m[0].length+2:a.lineIndent||0){var g=Array(o).join(" "),v=[];m.map(function(e){(e=e.split(/\s*\n/)).length>1?v=v.concat(e.map(function(e,t){return(t&&e.length?"\n":"")+e})):v.push(e[0])}),m=v,o=ti.apply(this,[g,a])}for(r=0,i=m.length;r<i;r++){var y=0;if(n=m[r],o&&"\n"==n[0]&&(n=n.substr(1),y=1),h+p+(f=(s=ei.apply(this,[n,a])).reduce(function(e,t){return e+t},0))>t||y){if(f>t){for(l=ai.apply(this,[n,s,t-(h+p),t]),d.push(l.shift()),d=[l.pop()];l.length;)u.push([l.shift()]);f=s.slice(n.length-(d[0]?d[0].length:0)).reduce(function(e,t){return e+t},0)}else d=[n];u.push(d),h=f+o,p=x}else d.push(n),h+=p+f,p=x}return c=o?function(e,t){return(t?g:"")+e.join(" ")}:function(e){return e.join(" ")},u.map(c)},Zr.splitTextToSize=function(e,t,a){var n,s=(a=a||{}).fontSize||this.internal.getFontSize(),r=function(e){if(e.widths&&e.kerning)return{widths:e.widths,kerning:e.kerning};var t=this.internal.getFont(e.fontName,e.fontStyle),a="Unicode";return t.metadata[a]?{widths:t.metadata[a].widths||{0:1},kerning:t.metadata[a].kerning||{}}:{font:t.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}.call(this,a);n=Array.isArray(e)?e:String(e).split(/\r?\n/);var i=1*this.internal.scaleFactor*t/s;r.textIndent=a.textIndent?1*a.textIndent*this.internal.scaleFactor/s:0,r.lineIndent=a.lineIndent;var l,o,c=[];for(l=0,o=n.length;l<o;l++)c=c.concat(ni.apply(this,[n[l],i,r]));return c},function(e){e.__fontmetrics__=e.__fontmetrics__||{};for(var t="0123456789abcdef",a="klmnopqrstuvwxyz",s={},r={},i=0;i<16;i++)s[a[i]]=t[i],r[t[i]]=a[i];var l=function(e){return"0x"+parseInt(e,10).toString(16)},o=e.__fontmetrics__.compress=function(e){var t,a,s,i,c=["{"];for(var d in e){if(t=e[d],isNaN(parseInt(d,10))?a="'"+d+"'":(d=parseInt(d,10),a=(a=l(d).slice(2)).slice(0,-1)+r[a.slice(-1)]),"number"==typeof t)t<0?(s=l(t).slice(3),i="-"):(s=l(t).slice(2),i=""),s=i+s.slice(0,-1)+r[s.slice(-1)];else{if("object"!==(0,n.A)(t))throw new Error("Don't know what to do with value type "+(0,n.A)(t)+".");s=o(t)}c.push(a+s)}return c.push("}"),c.join("")},c=e.__fontmetrics__.uncompress=function(e){if("string"!=typeof e)throw new Error("Invalid argument passed to uncompress.");for(var t,a,n,r,i={},l=1,o=i,c=[],d="",u="",h=e.length-1,p=1;p<h;p+=1)"'"==(r=e[p])?t?(n=t.join(""),t=void 0):t=[]:t?t.push(r):"{"==r?(c.push([o,n]),o={},n=void 0):"}"==r?((a=c.pop())[0][a[1]]=o,n=void 0,o=a[0]):"-"==r?l=-1:void 0===n?s.hasOwnProperty(r)?(d+=s[r],n=parseInt(d,16)*l,l=1,d=""):d+=r:s.hasOwnProperty(r)?(u+=s[r],o[n]=parseInt(u,16)*l,l=1,n=void 0,u=""):u+=r;return i},d={codePages:["WinAnsiEncoding"],WinAnsiEncoding:c("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},u={Unicode:{Courier:d,"Courier-Bold":d,"Courier-BoldOblique":d,"Courier-Oblique":d,Helvetica:d,"Helvetica-Bold":d,"Helvetica-BoldOblique":d,"Helvetica-Oblique":d,"Times-Roman":d,"Times-Bold":d,"Times-BoldItalic":d,"Times-Italic":d}},h={Unicode:{"Courier-Oblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":c("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":c("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:c("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:c("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":c("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":c("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};e.events.push(["addFont",function(e){var t=e.font,a=h.Unicode[t.postScriptName];a&&(t.metadata.Unicode={},t.metadata.Unicode.widths=a.widths,t.metadata.Unicode.kerning=a.kerning);var n=u.Unicode[t.postScriptName];n&&(t.metadata.Unicode.encoding=n,t.encoding=n.codePages[0])}])}(Ks.API),function(e){var t=function(e){for(var t=e.length,a=new Uint8Array(t),n=0;n<t;n++)a[n]=e.charCodeAt(n);return a};e.API.events.push(["addFont",function(a){var n=void 0,s=a.font,r=a.instance;if(!s.isStandardFont){if(void 0===r)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+s.postScriptName+"').");if("string"!=typeof(n=!1===r.existsFileInVFS(s.postScriptName)?r.loadFile(s.postScriptName):r.getFileFromVFS(s.postScriptName)))throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+s.postScriptName+"').");!function(a,n){n=/^\x00\x01\x00\x00/.test(n)?t(n):t(Ss(n)),a.metadata=e.API.TTFFont.open(n),a.metadata.Unicode=a.metadata.Unicode||{encoding:{},kerning:{},widths:[]},a.metadata.glyIdsUsed=[0]}(s,n)}}])}(Ks),Ks.API.addSvgAsImage=function(e,t,n,s,r,i,l,o){if(isNaN(t)||isNaN(n))throw vs.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(s)||isNaN(r))throw vs.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var c=document.createElement("canvas");c.width=s,c.height=r;var d=c.getContext("2d");d.fillStyle="#fff",d.fillRect(0,0,c.width,c.height);var u={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},h=this;return(xs.canvg?Promise.resolve(xs.canvg):a.e(455).then(a.bind(a,8455))).catch(function(e){return Promise.reject(new Error("Could not load canvg: "+e))}).then(function(e){return e.default?e.default:e}).then(function(t){return t.fromString(d,e,u)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(e){return e.render(u)}).then(function(){h.addImage(c.toDataURL("image/jpeg",1),t,n,s,r,l,o)})},Ks.API.putTotalPages=function(e){var t,a=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(t=new RegExp(e,"g"),a=this.internal.getNumberOfPages()):(t=new RegExp(this.pdfEscape16(e,this.internal.getFont()),"g"),a=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var n=1;n<=this.internal.getNumberOfPages();n++)for(var s=0;s<this.internal.pages[n].length;s++)this.internal.pages[n][s]=this.internal.pages[n][s].replace(t,a);return this},Ks.API.viewerPreferences=function(e,t){var a;e=e||{},t=t||!1;var s,r,i,l={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},o=Object.keys(l),c=[],d=0,u=0,h=0;function p(e,t){var a,n=!1;for(a=0;a<e.length;a+=1)e[a]===t&&(n=!0);return n}if(void 0===this.internal.viewerpreferences&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(l)),this.internal.viewerpreferences.isSubscribed=!1),a=this.internal.viewerpreferences.configuration,"reset"===e||!0===t){var f=o.length;for(h=0;h<f;h+=1)a[o[h]].value=a[o[h]].defaultValue,a[o[h]].explicitSet=!1}if("object"===(0,n.A)(e))for(r in e)if(i=e[r],p(o,r)&&void 0!==i){if("boolean"===a[r].type&&"boolean"==typeof i)a[r].value=i;else if("name"===a[r].type&&p(a[r].valueSet,i))a[r].value=i;else if("integer"===a[r].type&&Number.isInteger(i))a[r].value=i;else if("array"===a[r].type){for(d=0;d<i.length;d+=1)if(s=!0,1===i[d].length&&"number"==typeof i[d][0])c.push(String(i[d]-1));else if(i[d].length>1){for(u=0;u<i[d].length;u+=1)"number"!=typeof i[d][u]&&(s=!1);!0===s&&c.push([i[d][0]-1,i[d][1]-1].join(" "))}a[r].value="["+c.join(" ")+"]"}else a[r].value=a[r].defaultValue;a[r].explicitSet=!0}return!1===this.internal.viewerpreferences.isSubscribed&&(this.internal.events.subscribe("putCatalog",function(){var e,t=[];for(e in a)!0===a[e].explicitSet&&("name"===a[e].type?t.push("/"+e+" /"+a[e].value):t.push("/"+e+" "+a[e].value));0!==t.length&&this.internal.write("/ViewerPreferences\n<<\n"+t.join("\n")+"\n>>")}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=a,this},function(e){var t=function(){var e='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',t=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),a=unescape(encodeURIComponent(e)),n=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),s=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),r=unescape(encodeURIComponent("</x:xmpmeta>")),i=a.length+n.length+s.length+t.length+r.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+i+" >>"),this.internal.write("stream"),this.internal.write(t+a+n+s+r),this.internal.write("endstream"),this.internal.write("endobj")},a=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};e.addMetadata=function(e,n){return void 0===this.internal.__metadata__&&(this.internal.__metadata__={metadata:e,namespaceuri:n||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",a),this.internal.events.subscribe("postPutResources",t)),this}}(Ks.API),function(e){var t=e.API,a=t.pdfEscape16=function(e,t){for(var a,n=t.metadata.Unicode.widths,s=["","0","00","000","0000"],r=[""],i=0,l=e.length;i<l;++i){if(a=t.metadata.characterToGlyph(e.charCodeAt(i)),t.metadata.glyIdsUsed.push(a),t.metadata.toUnicode[a]=e.charCodeAt(i),-1==n.indexOf(a)&&(n.push(a),n.push([parseInt(t.metadata.widthOfGlyph(a),10)])),"0"==a)return r.join("");a=a.toString(16),r.push(s[4-a.length],a)}return r.join("")},n=function(e){var t,a,n,s,r,i,l;for(r="/CIDInit /ProcSet findresource begin\n12 dict begin\nbegincmap\n/CIDSystemInfo <<\n  /Registry (Adobe)\n  /Ordering (UCS)\n  /Supplement 0\n>> def\n/CMapName /Adobe-Identity-UCS def\n/CMapType 2 def\n1 begincodespacerange\n<0000><ffff>\nendcodespacerange",n=[],i=0,l=(a=Object.keys(e).sort(function(e,t){return e-t})).length;i<l;i++)t=a[i],n.length>=100&&(r+="\n"+n.length+" beginbfchar\n"+n.join("\n")+"\nendbfchar",n=[]),void 0!==e[t]&&null!==e[t]&&"function"==typeof e[t].toString&&(s=("0000"+e[t].toString(16)).slice(-4),t=("0000"+(+t).toString(16)).slice(-4),n.push("<"+t+"><"+s+">"));return n.length&&(r+="\n"+n.length+" beginbfchar\n"+n.join("\n")+"\nendbfchar\n"),r+"endcmap\nCMapName currentdict /CMap defineresource pop\nend\nend"};t.events.push(["putFont",function(t){!function(t){var a=t.font,s=t.out,r=t.newObject,i=t.putStream;if(a.metadata instanceof e.API.TTFFont&&"Identity-H"===a.encoding){for(var l=a.metadata.Unicode.widths,o=a.metadata.subset.encode(a.metadata.glyIdsUsed,1),c="",d=0;d<o.length;d++)c+=String.fromCharCode(o[d]);var u=r();i({data:c,addLength1:!0,objectId:u}),s("endobj");var h=r();i({data:n(a.metadata.toUnicode),addLength1:!0,objectId:h}),s("endobj");var p=r();s("<<"),s("/Type /FontDescriptor"),s("/FontName /"+Ws(a.fontName)),s("/FontFile2 "+u+" 0 R"),s("/FontBBox "+e.API.PDFObject.convert(a.metadata.bbox)),s("/Flags "+a.metadata.flags),s("/StemV "+a.metadata.stemV),s("/ItalicAngle "+a.metadata.italicAngle),s("/Ascent "+a.metadata.ascender),s("/Descent "+a.metadata.decender),s("/CapHeight "+a.metadata.capHeight),s(">>"),s("endobj");var f=r();s("<<"),s("/Type /Font"),s("/BaseFont /"+Ws(a.fontName)),s("/FontDescriptor "+p+" 0 R"),s("/W "+e.API.PDFObject.convert(l)),s("/CIDToGIDMap /Identity"),s("/DW 1000"),s("/Subtype /CIDFontType2"),s("/CIDSystemInfo"),s("<<"),s("/Supplement 0"),s("/Registry (Adobe)"),s("/Ordering ("+a.encoding+")"),s(">>"),s(">>"),s("endobj"),a.objectNumber=r(),s("<<"),s("/Type /Font"),s("/Subtype /Type0"),s("/ToUnicode "+h+" 0 R"),s("/BaseFont /"+Ws(a.fontName)),s("/Encoding /"+a.encoding),s("/DescendantFonts ["+f+" 0 R]"),s(">>"),s("endobj"),a.isAlreadyPutted=!0}}(t)}]),t.events.push(["putFont",function(t){!function(t){var a=t.font,s=t.out,r=t.newObject,i=t.putStream;if(a.metadata instanceof e.API.TTFFont&&"WinAnsiEncoding"===a.encoding){for(var l=a.metadata.rawData,o="",c=0;c<l.length;c++)o+=String.fromCharCode(l[c]);var d=r();i({data:o,addLength1:!0,objectId:d}),s("endobj");var u=r();i({data:n(a.metadata.toUnicode),addLength1:!0,objectId:u}),s("endobj");var h=r();s("<<"),s("/Descent "+a.metadata.decender),s("/CapHeight "+a.metadata.capHeight),s("/StemV "+a.metadata.stemV),s("/Type /FontDescriptor"),s("/FontFile2 "+d+" 0 R"),s("/Flags 96"),s("/FontBBox "+e.API.PDFObject.convert(a.metadata.bbox)),s("/FontName /"+Ws(a.fontName)),s("/ItalicAngle "+a.metadata.italicAngle),s("/Ascent "+a.metadata.ascender),s(">>"),s("endobj"),a.objectNumber=r();for(var p=0;p<a.metadata.hmtx.widths.length;p++)a.metadata.hmtx.widths[p]=parseInt(a.metadata.hmtx.widths[p]*(1e3/a.metadata.head.unitsPerEm));s("<</Subtype/TrueType/Type/Font/ToUnicode "+u+" 0 R/BaseFont/"+Ws(a.fontName)+"/FontDescriptor "+h+" 0 R/Encoding/"+a.encoding+" /FirstChar 29 /LastChar 255 /Widths "+e.API.PDFObject.convert(a.metadata.hmtx.widths)+">>"),s("endobj"),a.isAlreadyPutted=!0}}(t)}]);var s=function(e){var t,n=e.text||"",s=e.x,r=e.y,i=e.options||{},l=e.mutex||{},o=l.pdfEscape,c=l.activeFontKey,d=l.fonts,u=c,h="",p=0,f="",m=d[u].encoding;if("Identity-H"!==d[u].encoding)return{text:n,x:s,y:r,options:i,mutex:l};for(f=n,u=c,Array.isArray(n)&&(f=n[0]),p=0;p<f.length;p+=1)d[u].metadata.hasOwnProperty("cmap")&&(t=d[u].metadata.cmap.unicode.codeMap[f[p].charCodeAt(0)]),t||f[p].charCodeAt(0)<256&&d[u].metadata.hasOwnProperty("Unicode")?h+=f[p]:h+="";var x="";return parseInt(u.slice(1))<14||"WinAnsiEncoding"===m?x=o(h,u).split("").map(function(e){return e.charCodeAt(0).toString(16)}).join(""):"Identity-H"===m&&(x=a(h,d[u])),l.isHex=!0,{text:x,x:s,y:r,options:i,mutex:l}};t.events.push(["postProcessText",function(e){var t=e.text||"",a=[],n={text:t,x:e.x,y:e.y,options:e.options,mutex:e.mutex};if(Array.isArray(t)){var r=0;for(r=0;r<t.length;r+=1)Array.isArray(t[r])&&3===t[r].length?a.push([s(Object.assign({},n,{text:t[r][0]})).text,t[r][1],t[r][2]]):a.push(s(Object.assign({},n,{text:t[r]})).text);e.text=a}else e.text=s(Object.assign({},n,{text:t})).text}])}(Ks),function(e){var t=function(){return void 0===this.internal.vFS&&(this.internal.vFS={}),!0};e.existsFileInVFS=function(e){return t.call(this),void 0!==this.internal.vFS[e]},e.addFileToVFS=function(e,a){return t.call(this),this.internal.vFS[e]=a,this},e.getFileFromVFS=function(e){return t.call(this),void 0!==this.internal.vFS[e]?this.internal.vFS[e]:null}}(Ks.API),function(e){e.__bidiEngine__=e.prototype.__bidiEngine__=function(e){var a,n,s,r,i,l,o,c=t,d=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],u=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],h={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},p={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},f=["(",")","(","<",">","<","[","]","[","{","}","{","\xab","\xbb","\xab","\u2039","\u203a","\u2039","\u2045","\u2046","\u2045","\u207d","\u207e","\u207d","\u208d","\u208e","\u208d","\u2264","\u2265","\u2264","\u2329","\u232a","\u2329","\ufe59","\ufe5a","\ufe59","\ufe5b","\ufe5c","\ufe5b","\ufe5d","\ufe5e","\ufe5d","\ufe64","\ufe65","\ufe64"],m=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),x=!1,g=0;this.__bidiEngine__={};var v=function(e){var t=e.charCodeAt(),a=t>>8,n=p[a];return void 0!==n?c[256*n+(255&t)]:252===a||253===a?"AL":m.test(a)?"L":8===a?"R":"N"},y=function(e){for(var t,a=0;a<e.length;a++){if("L"===(t=v(e.charAt(a))))return!1;if("R"===t)return!0}return!1},b=function(e,t,i,l){var o,c,d,u,h=t[l];switch(h){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":x=!1;break;case"N":case"AN":break;case"EN":x&&(h="AN");break;case"AL":x=!0,h="R";break;case"WS":case"BN":h="N";break;case"CS":l<1||l+1>=t.length||"EN"!==(o=i[l-1])&&"AN"!==o||"EN"!==(c=t[l+1])&&"AN"!==c?h="N":x&&(c="AN"),h=c===o?c:"N";break;case"ES":h="EN"===(o=l>0?i[l-1]:"B")&&l+1<t.length&&"EN"===t[l+1]?"EN":"N";break;case"ET":if(l>0&&"EN"===i[l-1]){h="EN";break}if(x){h="N";break}for(d=l+1,u=t.length;d<u&&"ET"===t[d];)d++;h=d<u&&"EN"===t[d]?"EN":"N";break;case"NSM":if(s&&!r){for(u=t.length,d=l+1;d<u&&"NSM"===t[d];)d++;if(d<u){var p=e[l],f=p>=1425&&p<=2303||64286===p;if(o=t[d],f&&("R"===o||"AL"===o)){h="R";break}}}h=l<1||"B"===(o=t[l-1])?"N":i[l-1];break;case"B":x=!1,a=!0,h=g;break;case"S":n=!0,h="N"}return h},j=function(e,t,a){var n=e.split("");return a&&w(n,a,{hiLevel:g}),n.reverse(),t&&t.reverse(),n.join("")},w=function(e,t,s){var r,i,l,o,c,p=-1,f=e.length,m=0,y=[],j=g?u:d,w=[];for(x=!1,a=!1,n=!1,i=0;i<f;i++)w[i]=v(e[i]);for(l=0;l<f;l++){if(c=m,y[l]=b(e,w,y,l),r=240&(m=j[c][h[y[l]]]),m&=15,t[l]=o=j[m][5],r>0)if(16===r){for(i=p;i<l;i++)t[i]=1;p=-1}else p=-1;if(j[m][6])-1===p&&(p=l);else if(p>-1){for(i=p;i<l;i++)t[i]=o;p=-1}"B"===w[l]&&(t[l]=0),s.hiLevel|=o}n&&function(e,t,a){for(var n=0;n<a;n++)if("S"===e[n]){t[n]=g;for(var s=n-1;s>=0&&"WS"===e[s];s--)t[s]=g}}(w,t,f)},N=function(e,t,n,s,r){if(!(r.hiLevel<e)){if(1===e&&1===g&&!a)return t.reverse(),void(n&&n.reverse());for(var i,l,o,c,d=t.length,u=0;u<d;){if(s[u]>=e){for(o=u+1;o<d&&s[o]>=e;)o++;for(c=u,l=o-1;c<l;c++,l--)i=t[c],t[c]=t[l],t[l]=i,n&&(i=n[c],n[c]=n[l],n[l]=i);u=o}u++}}},S=function(e,t,a){var n=e.split(""),s={hiLevel:g};return a||(a=[]),w(n,a,s),function(e,t,a){if(0!==a.hiLevel&&o)for(var n,s=0;s<e.length;s++)1===t[s]&&(n=f.indexOf(e[s]))>=0&&(e[s]=f[n+1])}(n,a,s),N(2,n,t,a,s),N(1,n,t,a,s),n.join("")};return this.__bidiEngine__.doBidiReorder=function(e,t,a){if(function(e,t){if(t)for(var a=0;a<e.length;a++)t[a]=a;void 0===r&&(r=y(e)),void 0===l&&(l=y(e))}(e,t),s||!i||l)if(s&&i&&r^l)g=r?1:0,e=j(e,t,a);else if(!s&&i&&l)g=r?1:0,e=S(e,t,a),e=j(e,t);else if(!s||r||i||l){if(s&&!i&&r^l)e=j(e,t),r?(g=0,e=S(e,t,a)):(g=1,e=S(e,t,a),e=j(e,t));else if(s&&r&&!i&&l)g=1,e=S(e,t,a),e=j(e,t);else if(!s&&!i&&r^l){var n=o;r?(g=1,e=S(e,t,a),g=0,o=!1,e=S(e,t,a),o=n):(g=0,e=S(e,t,a),e=j(e,t),g=1,o=!1,e=S(e,t,a),o=n,e=j(e,t))}}else g=0,e=S(e,t,a);else g=r?1:0,e=S(e,t,a);return e},this.__bidiEngine__.setOptions=function(e){e&&(s=e.isInputVisual,i=e.isOutputVisual,r=e.isInputRtl,l=e.isOutputRtl,o=e.isSymmetricSwapping)},this.__bidiEngine__.setOptions(e),this.__bidiEngine__};var t=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],a=new e.__bidiEngine__({isInputVisual:!0});e.API.events.push(["postProcessText",function(e){var t=e.text;e.x,e.y;var n=e.options||{};e.mutex,n.lang;var s=[];if(n.isInputVisual="boolean"!=typeof n.isInputVisual||n.isInputVisual,a.setOptions(n),"[object Array]"===Object.prototype.toString.call(t)){var r=0;for(s=[],r=0;r<t.length;r+=1)"[object Array]"===Object.prototype.toString.call(t[r])?s.push([a.doBidiReorder(t[r][0]),t[r][1],t[r][2]]):s.push([a.doBidiReorder(t[r])]);e.text=s}else e.text=a.doBidiReorder(t);a.setOptions({isInputVisual:!0})}])}(Ks),Ks.API.TTFFont=function(){function e(e){var t;if(this.rawData=e,t=this.contents=new Ni(e),this.contents.pos=4,"ttcf"===t.readString(4))throw new Error("TTCF not supported.");t.pos=0,this.parse(),this.subset=new Ui(this),this.registerTTF()}return e.open=function(t){return new e(t)},e.prototype.parse=function(){return this.directory=new Si(this.contents),this.head=new Ci(this),this.name=new Ri(this),this.cmap=new Li(this),this.toUnicode={},this.hhea=new Ti(this),this.maxp=new Ii(this),this.hmtx=new Bi(this),this.post=new Di(this),this.os2=new Ei(this),this.loca=new Mi(this),this.glyf=new Oi(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},e.prototype.registerTTF=function(){var e,t,a,n,s;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=function(){var t,a,n,s;for(s=[],t=0,a=(n=this.bbox).length;t<a;t++)e=n[t],s.push(Math.round(e*this.scaleFactor));return s}.call(this),this.stemV=0,this.post.exists?(a=255&(n=this.post.italic_angle),32768&(t=n>>16)&&(t=-(1+(65535^t))),this.italicAngle=+(t+"."+a)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=1===(s=this.familyClass)||2===s||3===s||4===s||5===s||7===s,this.isScript=10===this.familyClass,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),0!==this.italicAngle&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},e.prototype.characterToGlyph=function(e){var t;return(null!=(t=this.cmap.unicode)?t.codeMap[e]:void 0)||0},e.prototype.widthOfGlyph=function(e){var t;return t=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(e).advance*t},e.prototype.widthOfString=function(e,t,a){var n,s,r,i;for(r=0,s=0,i=(e=""+e).length;0<=i?s<i:s>i;s=0<=i?++s:--s)n=e.charCodeAt(s),r+=this.widthOfGlyph(this.characterToGlyph(n))+a*(1e3/t)||0;return r*(t/1e3)},e.prototype.lineHeight=function(e,t){var a;return null==t&&(t=!1),a=t?this.lineGap:0,(this.ascender+a-this.decender)/1e3*e},e}();var wi,Ni=function(){function e(e){this.data=null!=e?e:[],this.pos=0,this.length=this.data.length}return e.prototype.readByte=function(){return this.data[this.pos++]},e.prototype.writeByte=function(e){return this.data[this.pos++]=e},e.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},e.prototype.writeUInt32=function(e){return this.writeByte(e>>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e)},e.prototype.readInt32=function(){var e;return(e=this.readUInt32())>=2147483648?e-4294967296:e},e.prototype.writeInt32=function(e){return e<0&&(e+=4294967296),this.writeUInt32(e)},e.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},e.prototype.writeUInt16=function(e){return this.writeByte(e>>8&255),this.writeByte(255&e)},e.prototype.readInt16=function(){var e;return(e=this.readUInt16())>=32768?e-65536:e},e.prototype.writeInt16=function(e){return e<0&&(e+=65536),this.writeUInt16(e)},e.prototype.readString=function(e){var t,a;for(a=[],t=0;0<=e?t<e:t>e;t=0<=e?++t:--t)a[t]=String.fromCharCode(this.readByte());return a.join("")},e.prototype.writeString=function(e){var t,a,n;for(n=[],t=0,a=e.length;0<=a?t<a:t>a;t=0<=a?++t:--t)n.push(this.writeByte(e.charCodeAt(t)));return n},e.prototype.readShort=function(){return this.readInt16()},e.prototype.writeShort=function(e){return this.writeInt16(e)},e.prototype.readLongLong=function(){var e,t,a,n,s,r,i,l;return e=this.readByte(),t=this.readByte(),a=this.readByte(),n=this.readByte(),s=this.readByte(),r=this.readByte(),i=this.readByte(),l=this.readByte(),128&e?-1*(72057594037927940*(255^e)+281474976710656*(255^t)+1099511627776*(255^a)+4294967296*(255^n)+16777216*(255^s)+65536*(255^r)+256*(255^i)+(255^l)+1):72057594037927940*e+281474976710656*t+1099511627776*a+4294967296*n+16777216*s+65536*r+256*i+l},e.prototype.writeLongLong=function(e){var t,a;return t=Math.floor(e/4294967296),a=4294967295&e,this.writeByte(t>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t),this.writeByte(a>>24&255),this.writeByte(a>>16&255),this.writeByte(a>>8&255),this.writeByte(255&a)},e.prototype.readInt=function(){return this.readInt32()},e.prototype.writeInt=function(e){return this.writeInt32(e)},e.prototype.read=function(e){var t,a;for(t=[],a=0;0<=e?a<e:a>e;a=0<=e?++a:--a)t.push(this.readByte());return t},e.prototype.write=function(e){var t,a,n,s;for(s=[],a=0,n=e.length;a<n;a++)t=e[a],s.push(this.writeByte(t));return s},e}(),Si=function(){var e;function t(e){var t,a,n;for(this.scalarType=e.readInt(),this.tableCount=e.readShort(),this.searchRange=e.readShort(),this.entrySelector=e.readShort(),this.rangeShift=e.readShort(),this.tables={},a=0,n=this.tableCount;0<=n?a<n:a>n;a=0<=n?++a:--a)t={tag:e.readString(4),checksum:e.readInt(),offset:e.readInt(),length:e.readInt()},this.tables[t.tag]=t}return t.prototype.encode=function(t){var a,n,s,r,i,l,o,c,d,u,h,p,f;for(f in h=Object.keys(t).length,l=Math.log(2),d=16*Math.floor(Math.log(h)/l),r=Math.floor(d/l),c=16*h-d,(n=new Ni).writeInt(this.scalarType),n.writeShort(h),n.writeShort(d),n.writeShort(r),n.writeShort(c),s=16*h,o=n.pos+s,i=null,p=[],t)for(u=t[f],n.writeString(f),n.writeInt(e(u)),n.writeInt(o),n.writeInt(u.length),p=p.concat(u),"head"===f&&(i=o),o+=u.length;o%4;)p.push(0),o++;return n.write(p),a=2981146554-e(n.data),n.pos=i+8,n.writeUInt32(a),n.data},e=function(e){var t,a,n,s;for(e=Fi.call(e);e.length%4;)e.push(0);for(n=new Ni(e),a=0,t=0,s=e.length;t<s;t=t+=4)a+=n.readUInt32();return 4294967295&a},t}(),ki={}.hasOwnProperty,Ai=function(e,t){for(var a in t)ki.call(t,a)&&(e[a]=t[a]);function n(){this.constructor=e}return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};wi=function(){function e(e){var t;this.file=e,t=this.file.directory.tables[this.tag],this.exists=!!t,t&&(this.offset=t.offset,this.length=t.length,this.parse(this.file.contents))}return e.prototype.parse=function(){},e.prototype.encode=function(){},e.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},e}();var Ci=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Ai(e,wi),e.prototype.tag="head",e.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.revision=e.readInt(),this.checkSumAdjustment=e.readInt(),this.magicNumber=e.readInt(),this.flags=e.readShort(),this.unitsPerEm=e.readShort(),this.created=e.readLongLong(),this.modified=e.readLongLong(),this.xMin=e.readShort(),this.yMin=e.readShort(),this.xMax=e.readShort(),this.yMax=e.readShort(),this.macStyle=e.readShort(),this.lowestRecPPEM=e.readShort(),this.fontDirectionHint=e.readShort(),this.indexToLocFormat=e.readShort(),this.glyphDataFormat=e.readShort()},e.prototype.encode=function(e){var t;return(t=new Ni).writeInt(this.version),t.writeInt(this.revision),t.writeInt(this.checkSumAdjustment),t.writeInt(this.magicNumber),t.writeShort(this.flags),t.writeShort(this.unitsPerEm),t.writeLongLong(this.created),t.writeLongLong(this.modified),t.writeShort(this.xMin),t.writeShort(this.yMin),t.writeShort(this.xMax),t.writeShort(this.yMax),t.writeShort(this.macStyle),t.writeShort(this.lowestRecPPEM),t.writeShort(this.fontDirectionHint),t.writeShort(e),t.writeShort(this.glyphDataFormat),t.data},e}(),_i=function(){function e(e,t){var a,n,s,r,i,l,o,c,d,u,h,p,f,m,x,g,v;switch(this.platformID=e.readUInt16(),this.encodingID=e.readShort(),this.offset=t+e.readInt(),d=e.pos,e.pos=this.offset,this.format=e.readUInt16(),this.length=e.readUInt16(),this.language=e.readUInt16(),this.isUnicode=3===this.platformID&&1===this.encodingID&&4===this.format||0===this.platformID&&4===this.format,this.codeMap={},this.format){case 0:for(l=0;l<256;++l)this.codeMap[l]=e.readByte();break;case 4:for(h=e.readUInt16(),u=h/2,e.pos+=6,s=function(){var t,a;for(a=[],l=t=0;0<=u?t<u:t>u;l=0<=u?++t:--t)a.push(e.readUInt16());return a}(),e.pos+=2,f=function(){var t,a;for(a=[],l=t=0;0<=u?t<u:t>u;l=0<=u?++t:--t)a.push(e.readUInt16());return a}(),o=function(){var t,a;for(a=[],l=t=0;0<=u?t<u:t>u;l=0<=u?++t:--t)a.push(e.readUInt16());return a}(),c=function(){var t,a;for(a=[],l=t=0;0<=u?t<u:t>u;l=0<=u?++t:--t)a.push(e.readUInt16());return a}(),n=(this.length-e.pos+this.offset)/2,i=function(){var t,a;for(a=[],l=t=0;0<=n?t<n:t>n;l=0<=n?++t:--t)a.push(e.readUInt16());return a}(),l=x=0,v=s.length;x<v;l=++x)for(m=s[l],a=g=p=f[l];p<=m?g<=m:g>=m;a=p<=m?++g:--g)0===c[l]?r=a+o[l]:0!==(r=i[c[l]/2+(a-p)-(u-l)]||0)&&(r+=o[l]),this.codeMap[a]=65535&r}e.pos=d}return e.encode=function(e,t){var a,n,s,r,i,l,o,c,d,u,h,p,f,m,x,g,v,y,b,j,w,N,S,k,A,C,_,L,T,E,D,P,R,I,B,F,O,q,z,M,U,W,H,V,G,J;switch(L=new Ni,r=Object.keys(e).sort(function(e,t){return e-t}),t){case"macroman":for(f=0,m=function(){var e=[];for(p=0;p<256;++p)e.push(0);return e}(),g={0:0},s={},T=0,R=r.length;T<R;T++)null==g[H=e[n=r[T]]]&&(g[H]=++f),s[n]={old:e[n],new:g[e[n]]},m[n]=g[e[n]];return L.writeUInt16(1),L.writeUInt16(0),L.writeUInt32(12),L.writeUInt16(0),L.writeUInt16(262),L.writeUInt16(0),L.write(m),{charMap:s,subtable:L.data,maxGlyphID:f+1};case"unicode":for(C=[],d=[],v=0,g={},a={},x=o=null,E=0,I=r.length;E<I;E++)null==g[b=e[n=r[E]]]&&(g[b]=++v),a[n]={old:b,new:g[b]},i=g[b]-n,null!=x&&i===o||(x&&d.push(x),C.push(n),o=i),x=n;for(x&&d.push(x),d.push(65535),C.push(65535),k=2*(S=C.length),N=2*Math.pow(Math.log(S)/Math.LN2,2),u=Math.log(N/2)/Math.LN2,w=2*S-N,l=[],j=[],h=[],p=D=0,B=C.length;D<B;p=++D){if(A=C[p],c=d[p],65535===A){l.push(0),j.push(0);break}if(A-(_=a[A].new)>=32768)for(l.push(0),j.push(2*(h.length+S-p)),n=P=A;A<=c?P<=c:P>=c;n=A<=c?++P:--P)h.push(a[n].new);else l.push(_-A),j.push(0)}for(L.writeUInt16(3),L.writeUInt16(1),L.writeUInt32(12),L.writeUInt16(4),L.writeUInt16(16+8*S+2*h.length),L.writeUInt16(0),L.writeUInt16(k),L.writeUInt16(N),L.writeUInt16(u),L.writeUInt16(w),U=0,F=d.length;U<F;U++)n=d[U],L.writeUInt16(n);for(L.writeUInt16(0),W=0,O=C.length;W<O;W++)n=C[W],L.writeUInt16(n);for(V=0,q=l.length;V<q;V++)i=l[V],L.writeUInt16(i);for(G=0,z=j.length;G<z;G++)y=j[G],L.writeUInt16(y);for(J=0,M=h.length;J<M;J++)f=h[J],L.writeUInt16(f);return{charMap:a,subtable:L.data,maxGlyphID:v+1}}},e}(),Li=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Ai(e,wi),e.prototype.tag="cmap",e.prototype.parse=function(e){var t,a,n;for(e.pos=this.offset,this.version=e.readUInt16(),n=e.readUInt16(),this.tables=[],this.unicode=null,a=0;0<=n?a<n:a>n;a=0<=n?++a:--a)t=new _i(e,this.offset),this.tables.push(t),t.isUnicode&&null==this.unicode&&(this.unicode=t);return!0},e.encode=function(e,t){var a,n;return null==t&&(t="macroman"),a=_i.encode(e,t),(n=new Ni).writeUInt16(0),n.writeUInt16(1),a.table=n.data.concat(a.subtable),a},e}(),Ti=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Ai(e,wi),e.prototype.tag="hhea",e.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.ascender=e.readShort(),this.decender=e.readShort(),this.lineGap=e.readShort(),this.advanceWidthMax=e.readShort(),this.minLeftSideBearing=e.readShort(),this.minRightSideBearing=e.readShort(),this.xMaxExtent=e.readShort(),this.caretSlopeRise=e.readShort(),this.caretSlopeRun=e.readShort(),this.caretOffset=e.readShort(),e.pos+=8,this.metricDataFormat=e.readShort(),this.numberOfMetrics=e.readUInt16()},e}(),Ei=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Ai(e,wi),e.prototype.tag="OS/2",e.prototype.parse=function(e){if(e.pos=this.offset,this.version=e.readUInt16(),this.averageCharWidth=e.readShort(),this.weightClass=e.readUInt16(),this.widthClass=e.readUInt16(),this.type=e.readShort(),this.ySubscriptXSize=e.readShort(),this.ySubscriptYSize=e.readShort(),this.ySubscriptXOffset=e.readShort(),this.ySubscriptYOffset=e.readShort(),this.ySuperscriptXSize=e.readShort(),this.ySuperscriptYSize=e.readShort(),this.ySuperscriptXOffset=e.readShort(),this.ySuperscriptYOffset=e.readShort(),this.yStrikeoutSize=e.readShort(),this.yStrikeoutPosition=e.readShort(),this.familyClass=e.readShort(),this.panose=function(){var t,a;for(a=[],t=0;t<10;++t)a.push(e.readByte());return a}(),this.charRange=function(){var t,a;for(a=[],t=0;t<4;++t)a.push(e.readInt());return a}(),this.vendorID=e.readString(4),this.selection=e.readShort(),this.firstCharIndex=e.readShort(),this.lastCharIndex=e.readShort(),this.version>0&&(this.ascent=e.readShort(),this.descent=e.readShort(),this.lineGap=e.readShort(),this.winAscent=e.readShort(),this.winDescent=e.readShort(),this.codePageRange=function(){var t,a;for(a=[],t=0;t<2;t=++t)a.push(e.readInt());return a}(),this.version>1))return this.xHeight=e.readShort(),this.capHeight=e.readShort(),this.defaultChar=e.readShort(),this.breakChar=e.readShort(),this.maxContext=e.readShort()},e}(),Di=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Ai(e,wi),e.prototype.tag="post",e.prototype.parse=function(e){var t,a,n;switch(e.pos=this.offset,this.format=e.readInt(),this.italicAngle=e.readInt(),this.underlinePosition=e.readShort(),this.underlineThickness=e.readShort(),this.isFixedPitch=e.readInt(),this.minMemType42=e.readInt(),this.maxMemType42=e.readInt(),this.minMemType1=e.readInt(),this.maxMemType1=e.readInt(),this.format){case 65536:case 196608:break;case 131072:var s;for(a=e.readUInt16(),this.glyphNameIndex=[],s=0;0<=a?s<a:s>a;s=0<=a?++s:--s)this.glyphNameIndex.push(e.readUInt16());for(this.names=[],n=[];e.pos<this.offset+this.length;)t=e.readByte(),n.push(this.names.push(e.readString(t)));return n;case 151552:return a=e.readUInt16(),this.offsets=e.read(a);case 262144:return this.map=function(){var t,a,n;for(n=[],s=t=0,a=this.file.maxp.numGlyphs;0<=a?t<a:t>a;s=0<=a?++t:--t)n.push(e.readUInt32());return n}.call(this)}},e}(),Pi=function(e,t){this.raw=e,this.length=e.length,this.platformID=t.platformID,this.encodingID=t.encodingID,this.languageID=t.languageID},Ri=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Ai(e,wi),e.prototype.tag="name",e.prototype.parse=function(e){var t,a,n,s,r,i,l,o,c,d,u;for(e.pos=this.offset,e.readShort(),t=e.readShort(),i=e.readShort(),a=[],s=0;0<=t?s<t:s>t;s=0<=t?++s:--s)a.push({platformID:e.readShort(),encodingID:e.readShort(),languageID:e.readShort(),nameID:e.readShort(),length:e.readShort(),offset:this.offset+i+e.readShort()});for(l={},s=c=0,d=a.length;c<d;s=++c)n=a[s],e.pos=n.offset,o=e.readString(n.length),r=new Pi(o,n),null==l[u=n.nameID]&&(l[u]=[]),l[n.nameID].push(r);this.strings=l,this.copyright=l[0],this.fontFamily=l[1],this.fontSubfamily=l[2],this.uniqueSubfamily=l[3],this.fontName=l[4],this.version=l[5];try{this.postscriptName=l[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch(Ss){this.postscriptName=l[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=l[7],this.manufacturer=l[8],this.designer=l[9],this.description=l[10],this.vendorUrl=l[11],this.designerUrl=l[12],this.license=l[13],this.licenseUrl=l[14],this.preferredFamily=l[15],this.preferredSubfamily=l[17],this.compatibleFull=l[18],this.sampleText=l[19]},e}(),Ii=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Ai(e,wi),e.prototype.tag="maxp",e.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.numGlyphs=e.readUInt16(),this.maxPoints=e.readUInt16(),this.maxContours=e.readUInt16(),this.maxCompositePoints=e.readUInt16(),this.maxComponentContours=e.readUInt16(),this.maxZones=e.readUInt16(),this.maxTwilightPoints=e.readUInt16(),this.maxStorage=e.readUInt16(),this.maxFunctionDefs=e.readUInt16(),this.maxInstructionDefs=e.readUInt16(),this.maxStackElements=e.readUInt16(),this.maxSizeOfInstructions=e.readUInt16(),this.maxComponentElements=e.readUInt16(),this.maxComponentDepth=e.readUInt16()},e}(),Bi=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Ai(e,wi),e.prototype.tag="hmtx",e.prototype.parse=function(e){var t,a,n,s,r,i,l;for(e.pos=this.offset,this.metrics=[],t=0,i=this.file.hhea.numberOfMetrics;0<=i?t<i:t>i;t=0<=i?++t:--t)this.metrics.push({advance:e.readUInt16(),lsb:e.readInt16()});for(n=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var a,s;for(s=[],t=a=0;0<=n?a<n:a>n;t=0<=n?++a:--a)s.push(e.readInt16());return s}(),this.widths=function(){var e,t,a,n;for(n=[],e=0,t=(a=this.metrics).length;e<t;e++)s=a[e],n.push(s.advance);return n}.call(this),a=this.widths[this.widths.length-1],l=[],t=r=0;0<=n?r<n:r>n;t=0<=n?++r:--r)l.push(this.widths.push(a));return l},e.prototype.forGlyph=function(e){return e in this.metrics?this.metrics[e]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[e-this.metrics.length]}},e}(),Fi=[].slice,Oi=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Ai(e,wi),e.prototype.tag="glyf",e.prototype.parse=function(){return this.cache={}},e.prototype.glyphFor=function(e){var t,a,n,s,r,i,l,o,c,d;return e in this.cache?this.cache[e]:(s=this.file.loca,t=this.file.contents,a=s.indexOf(e),0===(n=s.lengthOf(e))?this.cache[e]=null:(t.pos=this.offset+a,r=(i=new Ni(t.read(n))).readShort(),o=i.readShort(),d=i.readShort(),l=i.readShort(),c=i.readShort(),this.cache[e]=-1===r?new zi(i,o,d,l,c):new qi(i,r,o,d,l,c),this.cache[e]))},e.prototype.encode=function(e,t,a){var n,s,r,i,l;for(r=[],s=[],i=0,l=t.length;i<l;i++)n=e[t[i]],s.push(r.length),n&&(r=r.concat(n.encode(a)));return s.push(r.length),{table:r,offsets:s}},e}(),qi=function(){function e(e,t,a,n,s,r){this.raw=e,this.numberOfContours=t,this.xMin=a,this.yMin=n,this.xMax=s,this.yMax=r,this.compound=!1}return e.prototype.encode=function(){return this.raw.data},e}(),zi=function(){function e(e,t,a,n,s){var r,i;for(this.raw=e,this.xMin=t,this.yMin=a,this.xMax=n,this.yMax=s,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],r=this.raw;i=r.readShort(),this.glyphOffsets.push(r.pos),this.glyphIDs.push(r.readUInt16()),32&i;)r.pos+=1&i?4:2,128&i?r.pos+=8:64&i?r.pos+=4:8&i&&(r.pos+=2)}return e.prototype.encode=function(){var e,t,a;for(t=new Ni(Fi.call(this.raw.data)),e=0,a=this.glyphIDs.length;e<a;++e)t.pos=this.glyphOffsets[e];return t.data},e}(),Mi=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Ai(e,wi),e.prototype.tag="loca",e.prototype.parse=function(e){var t,a;return e.pos=this.offset,t=this.file.head.indexToLocFormat,this.offsets=0===t?function(){var t,n;for(n=[],a=0,t=this.length;a<t;a+=2)n.push(2*e.readUInt16());return n}.call(this):function(){var t,n;for(n=[],a=0,t=this.length;a<t;a+=4)n.push(e.readUInt32());return n}.call(this)},e.prototype.indexOf=function(e){return this.offsets[e]},e.prototype.lengthOf=function(e){return this.offsets[e+1]-this.offsets[e]},e.prototype.encode=function(e,t){for(var a=new Uint32Array(this.offsets.length),n=0,s=0,r=0;r<a.length;++r)if(a[r]=n,s<t.length&&t[s]==r){++s,a[r]=n;var i=this.offsets[r],l=this.offsets[r+1]-i;l>0&&(n+=l)}for(var o=new Array(4*a.length),c=0;c<a.length;++c)o[4*c+3]=255&a[c],o[4*c+2]=(65280&a[c])>>8,o[4*c+1]=(16711680&a[c])>>16,o[4*c]=(4278190080&a[c])>>24;return o},e}(),Ui=function(){function e(e){this.font=e,this.subset={},this.unicodes={},this.next=33}return e.prototype.generateCmap=function(){var e,t,a,n,s;for(t in n=this.font.cmap.tables[0].codeMap,e={},s=this.subset)a=s[t],e[t]=n[a];return e},e.prototype.glyphsFor=function(e){var t,a,n,s,r,i,l;for(n={},r=0,i=e.length;r<i;r++)n[s=e[r]]=this.font.glyf.glyphFor(s);for(s in t=[],n)(null!=(a=n[s])?a.compound:void 0)&&t.push.apply(t,a.glyphIDs);if(t.length>0)for(s in l=this.glyphsFor(t))a=l[s],n[s]=a;return n},e.prototype.encode=function(e,t){var a,n,s,r,i,l,o,c,d,u,h,p,f,m,x;for(n in a=Li.encode(this.generateCmap(),"unicode"),r=this.glyphsFor(e),h={0:0},x=a.charMap)h[(l=x[n]).old]=l.new;for(p in u=a.maxGlyphID,r)p in h||(h[p]=u++);return c=function(e){var t,a;for(t in a={},e)a[e[t]]=t;return a}(h),d=Object.keys(c).sort(function(e,t){return e-t}),f=function(){var e,t,a;for(a=[],e=0,t=d.length;e<t;e++)i=d[e],a.push(c[i]);return a}(),s=this.font.glyf.encode(r,f,h),o=this.font.loca.encode(s.offsets,f),m={cmap:this.font.cmap.raw(),glyf:s.table,loca:o,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(t)},this.font.os2.exists&&(m["OS/2"]=this.font.os2.raw()),this.font.directory.encode(m)},e}();Ks.API.PDFObject=function(){var e;function t(){}return e=function(e,t){return(Array(t+1).join("0")+e).slice(-t)},t.convert=function(a){var n,s,r,i;if(Array.isArray(a))return"["+function(){var e,s,r;for(r=[],e=0,s=a.length;e<s;e++)n=a[e],r.push(t.convert(n));return r}().join(" ")+"]";if("string"==typeof a)return"/"+a;if(null!=a?a.isString:void 0)return"("+a+")";if(a instanceof Date)return"(D:"+e(a.getUTCFullYear(),4)+e(a.getUTCMonth(),2)+e(a.getUTCDate(),2)+e(a.getUTCHours(),2)+e(a.getUTCMinutes(),2)+e(a.getUTCSeconds(),2)+"Z)";if("[object Object]"==={}.toString.call(a)){for(s in r=["<<"],a)i=a[s],r.push("/"+s+" "+t.convert(i));return r.push(">>"),r.join("\n")}return""+a},t}()},2284:(e,t,a)=>{function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}a.d(t,{A:()=>n})},2730:(e,t,a)=>{var n=a(5043),s=a(8853);function r(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,a=1;a<arguments.length;a++)t+="&args[]="+encodeURIComponent(arguments[a]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var i=new Set,l={};function o(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(l[e]=t,e=0;e<t.length;e++)i.add(t[e])}var d=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),u=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p={},f={};function m(e,t,a,n,s,r,i){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=n,this.attributeNamespace=s,this.mustUseProperty=a,this.propertyName=e,this.type=t,this.sanitizeURL=r,this.removeEmptyString=i}var x={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){x[e]=new m(e,0,!1,e,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];x[t]=new m(t,1,!1,e[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){x[e]=new m(e,2,!1,e.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){x[e]=new m(e,2,!1,e,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){x[e]=new m(e,3,!1,e.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(e){x[e]=new m(e,3,!0,e,null,!1,!1)}),["capture","download"].forEach(function(e){x[e]=new m(e,4,!1,e,null,!1,!1)}),["cols","rows","size","span"].forEach(function(e){x[e]=new m(e,6,!1,e,null,!1,!1)}),["rowSpan","start"].forEach(function(e){x[e]=new m(e,5,!1,e.toLowerCase(),null,!1,!1)});var g=/[\-:]([a-z])/g;function v(e){return e[1].toUpperCase()}function y(e,t,a,n){var s=x.hasOwnProperty(t)?x[t]:null;(null!==s?0!==s.type:n||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,a,n){if(null===t||"undefined"===typeof t||function(e,t,a,n){if(null!==a&&0===a.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!n&&(null!==a?!a.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,a,n))return!0;if(n)return!1;if(null!==a)switch(a.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,a,s,n)&&(a=null),n||null===s?function(e){return!!u.call(f,e)||!u.call(p,e)&&(h.test(e)?f[e]=!0:(p[e]=!0,!1))}(t)&&(null===a?e.removeAttribute(t):e.setAttribute(t,""+a)):s.mustUseProperty?e[s.propertyName]=null===a?3!==s.type&&"":a:(t=s.attributeName,n=s.attributeNamespace,null===a?e.removeAttribute(t):(a=3===(s=s.type)||4===s&&!0===a?"":""+a,n?e.setAttributeNS(n,t,a):e.setAttribute(t,a))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(g,v);x[t]=new m(t,1,!1,e,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(g,v);x[t]=new m(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(g,v);x[t]=new m(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(e){x[e]=new m(e,1,!1,e.toLowerCase(),null,!1,!1)}),x.xlinkHref=new m("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(e){x[e]=new m(e,1,!1,e.toLowerCase(),null,!0,!0)});var b=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,j=Symbol.for("react.element"),w=Symbol.for("react.portal"),N=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),k=Symbol.for("react.profiler"),A=Symbol.for("react.provider"),C=Symbol.for("react.context"),_=Symbol.for("react.forward_ref"),L=Symbol.for("react.suspense"),T=Symbol.for("react.suspense_list"),E=Symbol.for("react.memo"),D=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var P=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var R=Symbol.iterator;function I(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=R&&e[R]||e["@@iterator"])?e:null}var B,F=Object.assign;function O(e){if(void 0===B)try{throw Error()}catch(a){var t=a.stack.trim().match(/\n( *(at )?)/);B=t&&t[1]||""}return"\n"+B+e}var q=!1;function z(e,t){if(!e||q)return"";q=!0;var a=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var n=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){n=c}e.call(t.prototype)}else{try{throw Error()}catch(c){n=c}e()}}catch(c){if(c&&n&&"string"===typeof c.stack){for(var s=c.stack.split("\n"),r=n.stack.split("\n"),i=s.length-1,l=r.length-1;1<=i&&0<=l&&s[i]!==r[l];)l--;for(;1<=i&&0<=l;i--,l--)if(s[i]!==r[l]){if(1!==i||1!==l)do{if(i--,0>--l||s[i]!==r[l]){var o="\n"+s[i].replace(" at new "," at ");return e.displayName&&o.includes("<anonymous>")&&(o=o.replace("<anonymous>",e.displayName)),o}}while(1<=i&&0<=l);break}}}finally{q=!1,Error.prepareStackTrace=a}return(e=e?e.displayName||e.name:"")?O(e):""}function M(e){switch(e.tag){case 5:return O(e.type);case 16:return O("Lazy");case 13:return O("Suspense");case 19:return O("SuspenseList");case 0:case 2:case 15:return e=z(e.type,!1);case 11:return e=z(e.type.render,!1);case 1:return e=z(e.type,!0);default:return""}}function U(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case N:return"Fragment";case w:return"Portal";case k:return"Profiler";case S:return"StrictMode";case L:return"Suspense";case T:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case C:return(e.displayName||"Context")+".Consumer";case A:return(e._context.displayName||"Context")+".Provider";case _:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case E:return null!==(t=e.displayName||null)?t:U(e.type)||"Memo";case D:t=e._payload,e=e._init;try{return U(e(t))}catch(a){}}return null}function W(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return U(t);case 8:return t===S?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function H(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function V(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function G(e){e._valueTracker||(e._valueTracker=function(e){var t=V(e)?"checked":"value",a=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof a&&"function"===typeof a.get&&"function"===typeof a.set){var s=a.get,r=a.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(e){n=""+e,r.call(this,e)}}),Object.defineProperty(e,t,{enumerable:a.enumerable}),{getValue:function(){return n},setValue:function(e){n=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function J(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var a=t.getValue(),n="";return e&&(n=V(e)?e.checked?"true":"false":e.value),(e=n)!==a&&(t.setValue(e),!0)}function Y(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function K(e,t){var a=t.checked;return F({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=a?a:e._wrapperState.initialChecked})}function Q(e,t){var a=null==t.defaultValue?"":t.defaultValue,n=null!=t.checked?t.checked:t.defaultChecked;a=H(null!=t.value?t.value:a),e._wrapperState={initialChecked:n,initialValue:a,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function $(e,t){null!=(t=t.checked)&&y(e,"checked",t,!1)}function X(e,t){$(e,t);var a=H(t.value),n=t.type;if(null!=a)"number"===n?(0===a&&""===e.value||e.value!=a)&&(e.value=""+a):e.value!==""+a&&(e.value=""+a);else if("submit"===n||"reset"===n)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,a):t.hasOwnProperty("defaultValue")&&ee(e,t.type,H(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Z(e,t,a){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!("submit"!==n&&"reset"!==n||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,a||t===e.value||(e.value=t),e.defaultValue=t}""!==(a=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==a&&(e.name=a)}function ee(e,t,a){"number"===t&&Y(e.ownerDocument)===e||(null==a?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+a&&(e.defaultValue=""+a))}var te=Array.isArray;function ae(e,t,a,n){if(e=e.options,t){t={};for(var s=0;s<a.length;s++)t["$"+a[s]]=!0;for(a=0;a<e.length;a++)s=t.hasOwnProperty("$"+e[a].value),e[a].selected!==s&&(e[a].selected=s),s&&n&&(e[a].defaultSelected=!0)}else{for(a=""+H(a),t=null,s=0;s<e.length;s++){if(e[s].value===a)return e[s].selected=!0,void(n&&(e[s].defaultSelected=!0));null!==t||e[s].disabled||(t=e[s])}null!==t&&(t.selected=!0)}}function ne(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(r(91));return F({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function se(e,t){var a=t.value;if(null==a){if(a=t.children,t=t.defaultValue,null!=a){if(null!=t)throw Error(r(92));if(te(a)){if(1<a.length)throw Error(r(93));a=a[0]}t=a}null==t&&(t=""),a=t}e._wrapperState={initialValue:H(a)}}function re(e,t){var a=H(t.value),n=H(t.defaultValue);null!=a&&((a=""+a)!==e.value&&(e.value=a),null==t.defaultValue&&e.defaultValue!==a&&(e.defaultValue=a)),null!=n&&(e.defaultValue=""+n)}function ie(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function le(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function oe(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?le(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,de,ue=(de=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,a,n){MSApp.execUnsafeLocalFunction(function(){return de(e,t)})}:de);function he(e,t){if(t){var a=e.firstChild;if(a&&a===e.lastChild&&3===a.nodeType)return void(a.nodeValue=t)}e.textContent=t}var pe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},fe=["Webkit","ms","Moz","O"];function me(e,t,a){return null==t||"boolean"===typeof t||""===t?"":a||"number"!==typeof t||0===t||pe.hasOwnProperty(e)&&pe[e]?(""+t).trim():t+"px"}function xe(e,t){for(var a in e=e.style,t)if(t.hasOwnProperty(a)){var n=0===a.indexOf("--"),s=me(a,t[a],n);"float"===a&&(a="cssFloat"),n?e.setProperty(a,s):e[a]=s}}Object.keys(pe).forEach(function(e){fe.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),pe[t]=pe[e]})});var ge=F({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ve(e,t){if(t){if(ge[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(r(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(r(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(r(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(r(62))}}function ye(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var be=null;function je(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var we=null,Ne=null,Se=null;function ke(e){if(e=bs(e)){if("function"!==typeof we)throw Error(r(280));var t=e.stateNode;t&&(t=ws(t),we(e.stateNode,e.type,t))}}function Ae(e){Ne?Se?Se.push(e):Se=[e]:Ne=e}function Ce(){if(Ne){var e=Ne,t=Se;if(Se=Ne=null,ke(e),t)for(e=0;e<t.length;e++)ke(t[e])}}function _e(e,t){return e(t)}function Le(){}var Te=!1;function Ee(e,t,a){if(Te)return e(t,a);Te=!0;try{return _e(e,t,a)}finally{Te=!1,(null!==Ne||null!==Se)&&(Le(),Ce())}}function De(e,t){var a=e.stateNode;if(null===a)return null;var n=ws(a);if(null===n)return null;a=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(n=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!n;break e;default:e=!1}if(e)return null;if(a&&"function"!==typeof a)throw Error(r(231,t,typeof a));return a}var Pe=!1;if(d)try{var Re={};Object.defineProperty(Re,"passive",{get:function(){Pe=!0}}),window.addEventListener("test",Re,Re),window.removeEventListener("test",Re,Re)}catch(de){Pe=!1}function Ie(e,t,a,n,s,r,i,l,o){var c=Array.prototype.slice.call(arguments,3);try{t.apply(a,c)}catch(d){this.onError(d)}}var Be=!1,Fe=null,Oe=!1,qe=null,ze={onError:function(e){Be=!0,Fe=e}};function Me(e,t,a,n,s,r,i,l,o){Be=!1,Fe=null,Ie.apply(ze,arguments)}function We(e){var t=e,a=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(a=t.return),e=t.return}while(e)}return 3===t.tag?a:null}function He(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function Ve(e){if(We(e)!==e)throw Error(r(188))}function Ge(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=We(e)))throw Error(r(188));return t!==e?null:e}for(var a=e,n=t;;){var s=a.return;if(null===s)break;var i=s.alternate;if(null===i){if(null!==(n=s.return)){a=n;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===a)return Ve(s),e;if(i===n)return Ve(s),t;i=i.sibling}throw Error(r(188))}if(a.return!==n.return)a=s,n=i;else{for(var l=!1,o=s.child;o;){if(o===a){l=!0,a=s,n=i;break}if(o===n){l=!0,n=s,a=i;break}o=o.sibling}if(!l){for(o=i.child;o;){if(o===a){l=!0,a=i,n=s;break}if(o===n){l=!0,n=i,a=s;break}o=o.sibling}if(!l)throw Error(r(189))}}if(a.alternate!==n)throw Error(r(190))}if(3!==a.tag)throw Error(r(188));return a.stateNode.current===a?e:t}(e))?Je(e):null}function Je(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=Je(e);if(null!==t)return t;e=e.sibling}return null}var Ye=s.unstable_scheduleCallback,Ke=s.unstable_cancelCallback,Qe=s.unstable_shouldYield,$e=s.unstable_requestPaint,Xe=s.unstable_now,Ze=s.unstable_getCurrentPriorityLevel,et=s.unstable_ImmediatePriority,tt=s.unstable_UserBlockingPriority,at=s.unstable_NormalPriority,nt=s.unstable_LowPriority,st=s.unstable_IdlePriority,rt=null,it=null;var lt=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(ot(e)/ct|0)|0},ot=Math.log,ct=Math.LN2;var dt=64,ut=4194304;function ht(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function pt(e,t){var a=e.pendingLanes;if(0===a)return 0;var n=0,s=e.suspendedLanes,r=e.pingedLanes,i=268435455&a;if(0!==i){var l=i&~s;0!==l?n=ht(l):0!==(r&=i)&&(n=ht(r))}else 0!==(i=a&~s)?n=ht(i):0!==r&&(n=ht(r));if(0===n)return 0;if(0!==t&&t!==n&&0===(t&s)&&((s=n&-n)>=(r=t&-t)||16===s&&0!==(4194240&r)))return t;if(0!==(4&n)&&(n|=16&a),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=n;0<t;)s=1<<(a=31-lt(t)),n|=e[a],t&=~s;return n}function ft(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function mt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function xt(){var e=dt;return 0===(4194240&(dt<<=1))&&(dt=64),e}function gt(e){for(var t=[],a=0;31>a;a++)t.push(e);return t}function vt(e,t,a){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-lt(t)]=a}function yt(e,t){var a=e.entangledLanes|=t;for(e=e.entanglements;a;){var n=31-lt(a),s=1<<n;s&t|e[n]&t&&(e[n]|=t),a&=~s}}var bt=0;function jt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var wt,Nt,St,kt,At,Ct=!1,_t=[],Lt=null,Tt=null,Et=null,Dt=new Map,Pt=new Map,Rt=[],It="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Bt(e,t){switch(e){case"focusin":case"focusout":Lt=null;break;case"dragenter":case"dragleave":Tt=null;break;case"mouseover":case"mouseout":Et=null;break;case"pointerover":case"pointerout":Dt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pt.delete(t.pointerId)}}function Ft(e,t,a,n,s,r){return null===e||e.nativeEvent!==r?(e={blockedOn:t,domEventName:a,eventSystemFlags:n,nativeEvent:r,targetContainers:[s]},null!==t&&(null!==(t=bs(t))&&Nt(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,null!==s&&-1===t.indexOf(s)&&t.push(s),e)}function Ot(e){var t=ys(e.target);if(null!==t){var a=We(t);if(null!==a)if(13===(t=a.tag)){if(null!==(t=He(a)))return e.blockedOn=t,void At(e.priority,function(){St(a)})}else if(3===t&&a.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===a.tag?a.stateNode.containerInfo:null)}e.blockedOn=null}function qt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var a=Qt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==a)return null!==(t=bs(a))&&Nt(t),e.blockedOn=a,!1;var n=new(a=e.nativeEvent).constructor(a.type,a);be=n,a.target.dispatchEvent(n),be=null,t.shift()}return!0}function zt(e,t,a){qt(e)&&a.delete(t)}function Mt(){Ct=!1,null!==Lt&&qt(Lt)&&(Lt=null),null!==Tt&&qt(Tt)&&(Tt=null),null!==Et&&qt(Et)&&(Et=null),Dt.forEach(zt),Pt.forEach(zt)}function Ut(e,t){e.blockedOn===t&&(e.blockedOn=null,Ct||(Ct=!0,s.unstable_scheduleCallback(s.unstable_NormalPriority,Mt)))}function Wt(e){function t(t){return Ut(t,e)}if(0<_t.length){Ut(_t[0],e);for(var a=1;a<_t.length;a++){var n=_t[a];n.blockedOn===e&&(n.blockedOn=null)}}for(null!==Lt&&Ut(Lt,e),null!==Tt&&Ut(Tt,e),null!==Et&&Ut(Et,e),Dt.forEach(t),Pt.forEach(t),a=0;a<Rt.length;a++)(n=Rt[a]).blockedOn===e&&(n.blockedOn=null);for(;0<Rt.length&&null===(a=Rt[0]).blockedOn;)Ot(a),null===a.blockedOn&&Rt.shift()}var Ht=b.ReactCurrentBatchConfig,Vt=!0;function Gt(e,t,a,n){var s=bt,r=Ht.transition;Ht.transition=null;try{bt=1,Yt(e,t,a,n)}finally{bt=s,Ht.transition=r}}function Jt(e,t,a,n){var s=bt,r=Ht.transition;Ht.transition=null;try{bt=4,Yt(e,t,a,n)}finally{bt=s,Ht.transition=r}}function Yt(e,t,a,n){if(Vt){var s=Qt(e,t,a,n);if(null===s)Vn(e,t,n,Kt,a),Bt(e,n);else if(function(e,t,a,n,s){switch(t){case"focusin":return Lt=Ft(Lt,e,t,a,n,s),!0;case"dragenter":return Tt=Ft(Tt,e,t,a,n,s),!0;case"mouseover":return Et=Ft(Et,e,t,a,n,s),!0;case"pointerover":var r=s.pointerId;return Dt.set(r,Ft(Dt.get(r)||null,e,t,a,n,s)),!0;case"gotpointercapture":return r=s.pointerId,Pt.set(r,Ft(Pt.get(r)||null,e,t,a,n,s)),!0}return!1}(s,e,t,a,n))n.stopPropagation();else if(Bt(e,n),4&t&&-1<It.indexOf(e)){for(;null!==s;){var r=bs(s);if(null!==r&&wt(r),null===(r=Qt(e,t,a,n))&&Vn(e,t,n,Kt,a),r===s)break;s=r}null!==s&&n.stopPropagation()}else Vn(e,t,n,null,a)}}var Kt=null;function Qt(e,t,a,n){if(Kt=null,null!==(e=ys(e=je(n))))if(null===(t=We(e)))e=null;else if(13===(a=t.tag)){if(null!==(e=He(t)))return e;e=null}else if(3===a){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Kt=e,null}function $t(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Ze()){case et:return 1;case tt:return 4;case at:case nt:return 16;case st:return 536870912;default:return 16}default:return 16}}var Xt=null,Zt=null,ea=null;function ta(){if(ea)return ea;var e,t,a=Zt,n=a.length,s="value"in Xt?Xt.value:Xt.textContent,r=s.length;for(e=0;e<n&&a[e]===s[e];e++);var i=n-e;for(t=1;t<=i&&a[n-t]===s[r-t];t++);return ea=s.slice(e,1<t?1-t:void 0)}function aa(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function na(){return!0}function sa(){return!1}function ra(e){function t(t,a,n,s,r){for(var i in this._reactName=t,this._targetInst=n,this.type=a,this.nativeEvent=s,this.target=r,this.currentTarget=null,e)e.hasOwnProperty(i)&&(t=e[i],this[i]=t?t(s):s[i]);return this.isDefaultPrevented=(null!=s.defaultPrevented?s.defaultPrevented:!1===s.returnValue)?na:sa,this.isPropagationStopped=sa,this}return F(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=na)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=na)},persist:function(){},isPersistent:na}),t}var ia,la,oa,ca={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},da=ra(ca),ua=F({},ca,{view:0,detail:0}),ha=ra(ua),pa=F({},ua,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ka,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==oa&&(oa&&"mousemove"===e.type?(ia=e.screenX-oa.screenX,la=e.screenY-oa.screenY):la=ia=0,oa=e),ia)},movementY:function(e){return"movementY"in e?e.movementY:la}}),fa=ra(pa),ma=ra(F({},pa,{dataTransfer:0})),xa=ra(F({},ua,{relatedTarget:0})),ga=ra(F({},ca,{animationName:0,elapsedTime:0,pseudoElement:0})),va=F({},ca,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),ya=ra(va),ba=ra(F({},ca,{data:0})),ja={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},wa={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Na={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Sa(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=Na[e])&&!!t[e]}function ka(){return Sa}var Aa=F({},ua,{key:function(e){if(e.key){var t=ja[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=aa(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?wa[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ka,charCode:function(e){return"keypress"===e.type?aa(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?aa(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Ca=ra(Aa),_a=ra(F({},pa,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),La=ra(F({},ua,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ka})),Ta=ra(F({},ca,{propertyName:0,elapsedTime:0,pseudoElement:0})),Ea=F({},pa,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Da=ra(Ea),Pa=[9,13,27,32],Ra=d&&"CompositionEvent"in window,Ia=null;d&&"documentMode"in document&&(Ia=document.documentMode);var Ba=d&&"TextEvent"in window&&!Ia,Fa=d&&(!Ra||Ia&&8<Ia&&11>=Ia),Oa=String.fromCharCode(32),qa=!1;function za(e,t){switch(e){case"keyup":return-1!==Pa.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ma(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Ua=!1;var Wa={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ha(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Wa[e.type]:"textarea"===t}function Va(e,t,a,n){Ae(n),0<(t=Jn(t,"onChange")).length&&(a=new da("onChange","change",null,a,n),e.push({event:a,listeners:t}))}var Ga=null,Ja=null;function Ya(e){qn(e,0)}function Ka(e){if(J(js(e)))return e}function Qa(e,t){if("change"===e)return t}var $a=!1;if(d){var Xa;if(d){var Za="oninput"in document;if(!Za){var en=document.createElement("div");en.setAttribute("oninput","return;"),Za="function"===typeof en.oninput}Xa=Za}else Xa=!1;$a=Xa&&(!document.documentMode||9<document.documentMode)}function tn(){Ga&&(Ga.detachEvent("onpropertychange",an),Ja=Ga=null)}function an(e){if("value"===e.propertyName&&Ka(Ja)){var t=[];Va(t,Ja,e,je(e)),Ee(Ya,t)}}function nn(e,t,a){"focusin"===e?(tn(),Ja=a,(Ga=t).attachEvent("onpropertychange",an)):"focusout"===e&&tn()}function sn(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Ka(Ja)}function rn(e,t){if("click"===e)return Ka(t)}function ln(e,t){if("input"===e||"change"===e)return Ka(t)}var on="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function cn(e,t){if(on(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var a=Object.keys(e),n=Object.keys(t);if(a.length!==n.length)return!1;for(n=0;n<a.length;n++){var s=a[n];if(!u.call(t,s)||!on(e[s],t[s]))return!1}return!0}function dn(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function un(e,t){var a,n=dn(e);for(e=0;n;){if(3===n.nodeType){if(a=e+n.textContent.length,e<=t&&a>=t)return{node:n,offset:t-e};e=a}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=dn(n)}}function hn(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?hn(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function pn(){for(var e=window,t=Y();t instanceof e.HTMLIFrameElement;){try{var a="string"===typeof t.contentWindow.location.href}catch(n){a=!1}if(!a)break;t=Y((e=t.contentWindow).document)}return t}function fn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function mn(e){var t=pn(),a=e.focusedElem,n=e.selectionRange;if(t!==a&&a&&a.ownerDocument&&hn(a.ownerDocument.documentElement,a)){if(null!==n&&fn(a))if(t=n.start,void 0===(e=n.end)&&(e=t),"selectionStart"in a)a.selectionStart=t,a.selectionEnd=Math.min(e,a.value.length);else if((e=(t=a.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var s=a.textContent.length,r=Math.min(n.start,s);n=void 0===n.end?r:Math.min(n.end,s),!e.extend&&r>n&&(s=n,n=r,r=s),s=un(a,r);var i=un(a,n);s&&i&&(1!==e.rangeCount||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==i.node||e.focusOffset!==i.offset)&&((t=t.createRange()).setStart(s.node,s.offset),e.removeAllRanges(),r>n?(e.addRange(t),e.extend(i.node,i.offset)):(t.setEnd(i.node,i.offset),e.addRange(t)))}for(t=[],e=a;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof a.focus&&a.focus(),a=0;a<t.length;a++)(e=t[a]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var xn=d&&"documentMode"in document&&11>=document.documentMode,gn=null,vn=null,yn=null,bn=!1;function jn(e,t,a){var n=a.window===a?a.document:9===a.nodeType?a:a.ownerDocument;bn||null==gn||gn!==Y(n)||("selectionStart"in(n=gn)&&fn(n)?n={start:n.selectionStart,end:n.selectionEnd}:n={anchorNode:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset},yn&&cn(yn,n)||(yn=n,0<(n=Jn(vn,"onSelect")).length&&(t=new da("onSelect","select",null,t,a),e.push({event:t,listeners:n}),t.target=gn)))}function wn(e,t){var a={};return a[e.toLowerCase()]=t.toLowerCase(),a["Webkit"+e]="webkit"+t,a["Moz"+e]="moz"+t,a}var Nn={animationend:wn("Animation","AnimationEnd"),animationiteration:wn("Animation","AnimationIteration"),animationstart:wn("Animation","AnimationStart"),transitionend:wn("Transition","TransitionEnd")},Sn={},kn={};function An(e){if(Sn[e])return Sn[e];if(!Nn[e])return e;var t,a=Nn[e];for(t in a)if(a.hasOwnProperty(t)&&t in kn)return Sn[e]=a[t];return e}d&&(kn=document.createElement("div").style,"AnimationEvent"in window||(delete Nn.animationend.animation,delete Nn.animationiteration.animation,delete Nn.animationstart.animation),"TransitionEvent"in window||delete Nn.transitionend.transition);var Cn=An("animationend"),_n=An("animationiteration"),Ln=An("animationstart"),Tn=An("transitionend"),En=new Map,Dn="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Pn(e,t){En.set(e,t),o(t,[e])}for(var Rn=0;Rn<Dn.length;Rn++){var In=Dn[Rn];Pn(In.toLowerCase(),"on"+(In[0].toUpperCase()+In.slice(1)))}Pn(Cn,"onAnimationEnd"),Pn(_n,"onAnimationIteration"),Pn(Ln,"onAnimationStart"),Pn("dblclick","onDoubleClick"),Pn("focusin","onFocus"),Pn("focusout","onBlur"),Pn(Tn,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),o("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),o("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),o("onBeforeInput",["compositionend","keypress","textInput","paste"]),o("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Bn="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Fn=new Set("cancel close invalid load scroll toggle".split(" ").concat(Bn));function On(e,t,a){var n=e.type||"unknown-event";e.currentTarget=a,function(e,t,a,n,s,i,l,o,c){if(Me.apply(this,arguments),Be){if(!Be)throw Error(r(198));var d=Fe;Be=!1,Fe=null,Oe||(Oe=!0,qe=d)}}(n,t,void 0,e),e.currentTarget=null}function qn(e,t){t=0!==(4&t);for(var a=0;a<e.length;a++){var n=e[a],s=n.event;n=n.listeners;e:{var r=void 0;if(t)for(var i=n.length-1;0<=i;i--){var l=n[i],o=l.instance,c=l.currentTarget;if(l=l.listener,o!==r&&s.isPropagationStopped())break e;On(s,l,c),r=o}else for(i=0;i<n.length;i++){if(o=(l=n[i]).instance,c=l.currentTarget,l=l.listener,o!==r&&s.isPropagationStopped())break e;On(s,l,c),r=o}}}if(Oe)throw e=qe,Oe=!1,qe=null,e}function zn(e,t){var a=t[xs];void 0===a&&(a=t[xs]=new Set);var n=e+"__bubble";a.has(n)||(Hn(t,e,2,!1),a.add(n))}function Mn(e,t,a){var n=0;t&&(n|=4),Hn(a,e,n,t)}var Un="_reactListening"+Math.random().toString(36).slice(2);function Wn(e){if(!e[Un]){e[Un]=!0,i.forEach(function(t){"selectionchange"!==t&&(Fn.has(t)||Mn(t,!1,e),Mn(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Un]||(t[Un]=!0,Mn("selectionchange",!1,t))}}function Hn(e,t,a,n){switch($t(t)){case 1:var s=Gt;break;case 4:s=Jt;break;default:s=Yt}a=s.bind(null,t,a,e),s=void 0,!Pe||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(s=!0),n?void 0!==s?e.addEventListener(t,a,{capture:!0,passive:s}):e.addEventListener(t,a,!0):void 0!==s?e.addEventListener(t,a,{passive:s}):e.addEventListener(t,a,!1)}function Vn(e,t,a,n,s){var r=n;if(0===(1&t)&&0===(2&t)&&null!==n)e:for(;;){if(null===n)return;var i=n.tag;if(3===i||4===i){var l=n.stateNode.containerInfo;if(l===s||8===l.nodeType&&l.parentNode===s)break;if(4===i)for(i=n.return;null!==i;){var o=i.tag;if((3===o||4===o)&&((o=i.stateNode.containerInfo)===s||8===o.nodeType&&o.parentNode===s))return;i=i.return}for(;null!==l;){if(null===(i=ys(l)))return;if(5===(o=i.tag)||6===o){n=r=i;continue e}l=l.parentNode}}n=n.return}Ee(function(){var n=r,s=je(a),i=[];e:{var l=En.get(e);if(void 0!==l){var o=da,c=e;switch(e){case"keypress":if(0===aa(a))break e;case"keydown":case"keyup":o=Ca;break;case"focusin":c="focus",o=xa;break;case"focusout":c="blur",o=xa;break;case"beforeblur":case"afterblur":o=xa;break;case"click":if(2===a.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":o=fa;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":o=ma;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":o=La;break;case Cn:case _n:case Ln:o=ga;break;case Tn:o=Ta;break;case"scroll":o=ha;break;case"wheel":o=Da;break;case"copy":case"cut":case"paste":o=ya;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":o=_a}var d=0!==(4&t),u=!d&&"scroll"===e,h=d?null!==l?l+"Capture":null:l;d=[];for(var p,f=n;null!==f;){var m=(p=f).stateNode;if(5===p.tag&&null!==m&&(p=m,null!==h&&(null!=(m=De(f,h))&&d.push(Gn(f,m,p)))),u)break;f=f.return}0<d.length&&(l=new o(l,c,null,a,s),i.push({event:l,listeners:d}))}}if(0===(7&t)){if(o="mouseout"===e||"pointerout"===e,(!(l="mouseover"===e||"pointerover"===e)||a===be||!(c=a.relatedTarget||a.fromElement)||!ys(c)&&!c[ms])&&(o||l)&&(l=s.window===s?s:(l=s.ownerDocument)?l.defaultView||l.parentWindow:window,o?(o=n,null!==(c=(c=a.relatedTarget||a.toElement)?ys(c):null)&&(c!==(u=We(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(o=null,c=n),o!==c)){if(d=fa,m="onMouseLeave",h="onMouseEnter",f="mouse","pointerout"!==e&&"pointerover"!==e||(d=_a,m="onPointerLeave",h="onPointerEnter",f="pointer"),u=null==o?l:js(o),p=null==c?l:js(c),(l=new d(m,f+"leave",o,a,s)).target=u,l.relatedTarget=p,m=null,ys(s)===n&&((d=new d(h,f+"enter",c,a,s)).target=p,d.relatedTarget=u,m=d),u=m,o&&c)e:{for(h=c,f=0,p=d=o;p;p=Yn(p))f++;for(p=0,m=h;m;m=Yn(m))p++;for(;0<f-p;)d=Yn(d),f--;for(;0<p-f;)h=Yn(h),p--;for(;f--;){if(d===h||null!==h&&d===h.alternate)break e;d=Yn(d),h=Yn(h)}d=null}else d=null;null!==o&&Kn(i,l,o,d,!1),null!==c&&null!==u&&Kn(i,u,c,d,!0)}if("select"===(o=(l=n?js(n):window).nodeName&&l.nodeName.toLowerCase())||"input"===o&&"file"===l.type)var x=Qa;else if(Ha(l))if($a)x=ln;else{x=sn;var g=nn}else(o=l.nodeName)&&"input"===o.toLowerCase()&&("checkbox"===l.type||"radio"===l.type)&&(x=rn);switch(x&&(x=x(e,n))?Va(i,x,a,s):(g&&g(e,l,n),"focusout"===e&&(g=l._wrapperState)&&g.controlled&&"number"===l.type&&ee(l,"number",l.value)),g=n?js(n):window,e){case"focusin":(Ha(g)||"true"===g.contentEditable)&&(gn=g,vn=n,yn=null);break;case"focusout":yn=vn=gn=null;break;case"mousedown":bn=!0;break;case"contextmenu":case"mouseup":case"dragend":bn=!1,jn(i,a,s);break;case"selectionchange":if(xn)break;case"keydown":case"keyup":jn(i,a,s)}var v;if(Ra)e:{switch(e){case"compositionstart":var y="onCompositionStart";break e;case"compositionend":y="onCompositionEnd";break e;case"compositionupdate":y="onCompositionUpdate";break e}y=void 0}else Ua?za(e,a)&&(y="onCompositionEnd"):"keydown"===e&&229===a.keyCode&&(y="onCompositionStart");y&&(Fa&&"ko"!==a.locale&&(Ua||"onCompositionStart"!==y?"onCompositionEnd"===y&&Ua&&(v=ta()):(Zt="value"in(Xt=s)?Xt.value:Xt.textContent,Ua=!0)),0<(g=Jn(n,y)).length&&(y=new ba(y,e,null,a,s),i.push({event:y,listeners:g}),v?y.data=v:null!==(v=Ma(a))&&(y.data=v))),(v=Ba?function(e,t){switch(e){case"compositionend":return Ma(t);case"keypress":return 32!==t.which?null:(qa=!0,Oa);case"textInput":return(e=t.data)===Oa&&qa?null:e;default:return null}}(e,a):function(e,t){if(Ua)return"compositionend"===e||!Ra&&za(e,t)?(e=ta(),ea=Zt=Xt=null,Ua=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Fa&&"ko"!==t.locale?null:t.data}}(e,a))&&(0<(n=Jn(n,"onBeforeInput")).length&&(s=new ba("onBeforeInput","beforeinput",null,a,s),i.push({event:s,listeners:n}),s.data=v))}qn(i,t)})}function Gn(e,t,a){return{instance:e,listener:t,currentTarget:a}}function Jn(e,t){for(var a=t+"Capture",n=[];null!==e;){var s=e,r=s.stateNode;5===s.tag&&null!==r&&(s=r,null!=(r=De(e,a))&&n.unshift(Gn(e,r,s)),null!=(r=De(e,t))&&n.push(Gn(e,r,s))),e=e.return}return n}function Yn(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Kn(e,t,a,n,s){for(var r=t._reactName,i=[];null!==a&&a!==n;){var l=a,o=l.alternate,c=l.stateNode;if(null!==o&&o===n)break;5===l.tag&&null!==c&&(l=c,s?null!=(o=De(a,r))&&i.unshift(Gn(a,o,l)):s||null!=(o=De(a,r))&&i.push(Gn(a,o,l))),a=a.return}0!==i.length&&e.push({event:t,listeners:i})}var Qn=/\r\n?/g,$n=/\u0000|\uFFFD/g;function Xn(e){return("string"===typeof e?e:""+e).replace(Qn,"\n").replace($n,"")}function Zn(e,t,a){if(t=Xn(t),Xn(e)!==t&&a)throw Error(r(425))}function es(){}var ts=null,as=null;function ns(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ss="function"===typeof setTimeout?setTimeout:void 0,rs="function"===typeof clearTimeout?clearTimeout:void 0,is="function"===typeof Promise?Promise:void 0,ls="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof is?function(e){return is.resolve(null).then(e).catch(os)}:ss;function os(e){setTimeout(function(){throw e})}function cs(e,t){var a=t,n=0;do{var s=a.nextSibling;if(e.removeChild(a),s&&8===s.nodeType)if("/$"===(a=s.data)){if(0===n)return e.removeChild(s),void Wt(t);n--}else"$"!==a&&"$?"!==a&&"$!"!==a||n++;a=s}while(a);Wt(t)}function ds(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function us(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var a=e.data;if("$"===a||"$!"===a||"$?"===a){if(0===t)return e;t--}else"/$"===a&&t++}e=e.previousSibling}return null}var hs=Math.random().toString(36).slice(2),ps="__reactFiber$"+hs,fs="__reactProps$"+hs,ms="__reactContainer$"+hs,xs="__reactEvents$"+hs,gs="__reactListeners$"+hs,vs="__reactHandles$"+hs;function ys(e){var t=e[ps];if(t)return t;for(var a=e.parentNode;a;){if(t=a[ms]||a[ps]){if(a=t.alternate,null!==t.child||null!==a&&null!==a.child)for(e=us(e);null!==e;){if(a=e[ps])return a;e=us(e)}return t}a=(e=a).parentNode}return null}function bs(e){return!(e=e[ps]||e[ms])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function js(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(r(33))}function ws(e){return e[fs]||null}var Ns=[],Ss=-1;function ks(e){return{current:e}}function As(e){0>Ss||(e.current=Ns[Ss],Ns[Ss]=null,Ss--)}function Cs(e,t){Ss++,Ns[Ss]=e.current,e.current=t}var _s={},Ls=ks(_s),Ts=ks(!1),Es=_s;function Ds(e,t){var a=e.type.contextTypes;if(!a)return _s;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var s,r={};for(s in a)r[s]=t[s];return n&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=r),r}function Ps(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Rs(){As(Ts),As(Ls)}function Is(e,t,a){if(Ls.current!==_s)throw Error(r(168));Cs(Ls,t),Cs(Ts,a)}function Bs(e,t,a){var n=e.stateNode;if(t=t.childContextTypes,"function"!==typeof n.getChildContext)return a;for(var s in n=n.getChildContext())if(!(s in t))throw Error(r(108,W(e)||"Unknown",s));return F({},a,n)}function Fs(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||_s,Es=Ls.current,Cs(Ls,e),Cs(Ts,Ts.current),!0}function Os(e,t,a){var n=e.stateNode;if(!n)throw Error(r(169));a?(e=Bs(e,t,Es),n.__reactInternalMemoizedMergedChildContext=e,As(Ts),As(Ls),Cs(Ls,e)):As(Ts),Cs(Ts,a)}var qs=null,zs=!1,Ms=!1;function Us(e){null===qs?qs=[e]:qs.push(e)}function Ws(){if(!Ms&&null!==qs){Ms=!0;var e=0,t=bt;try{var a=qs;for(bt=1;e<a.length;e++){var n=a[e];do{n=n(!0)}while(null!==n)}qs=null,zs=!1}catch(s){throw null!==qs&&(qs=qs.slice(e+1)),Ye(et,Ws),s}finally{bt=t,Ms=!1}}return null}var Hs=[],Vs=0,Gs=null,Js=0,Ys=[],Ks=0,Qs=null,$s=1,Xs="";function Zs(e,t){Hs[Vs++]=Js,Hs[Vs++]=Gs,Gs=e,Js=t}function er(e,t,a){Ys[Ks++]=$s,Ys[Ks++]=Xs,Ys[Ks++]=Qs,Qs=e;var n=$s;e=Xs;var s=32-lt(n)-1;n&=~(1<<s),a+=1;var r=32-lt(t)+s;if(30<r){var i=s-s%5;r=(n&(1<<i)-1).toString(32),n>>=i,s-=i,$s=1<<32-lt(t)+s|a<<s|n,Xs=r+e}else $s=1<<r|a<<s|n,Xs=e}function tr(e){null!==e.return&&(Zs(e,1),er(e,1,0))}function ar(e){for(;e===Gs;)Gs=Hs[--Vs],Hs[Vs]=null,Js=Hs[--Vs],Hs[Vs]=null;for(;e===Qs;)Qs=Ys[--Ks],Ys[Ks]=null,Xs=Ys[--Ks],Ys[Ks]=null,$s=Ys[--Ks],Ys[Ks]=null}var nr=null,sr=null,rr=!1,ir=null;function lr(e,t){var a=Dc(5,null,null,0);a.elementType="DELETED",a.stateNode=t,a.return=e,null===(t=e.deletions)?(e.deletions=[a],e.flags|=16):t.push(a)}function or(e,t){switch(e.tag){case 5:var a=e.type;return null!==(t=1!==t.nodeType||a.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,nr=e,sr=ds(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,nr=e,sr=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(a=null!==Qs?{id:$s,overflow:Xs}:null,e.memoizedState={dehydrated:t,treeContext:a,retryLane:1073741824},(a=Dc(18,null,null,0)).stateNode=t,a.return=e,e.child=a,nr=e,sr=null,!0);default:return!1}}function cr(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function dr(e){if(rr){var t=sr;if(t){var a=t;if(!or(e,t)){if(cr(e))throw Error(r(418));t=ds(a.nextSibling);var n=nr;t&&or(e,t)?lr(n,a):(e.flags=-4097&e.flags|2,rr=!1,nr=e)}}else{if(cr(e))throw Error(r(418));e.flags=-4097&e.flags|2,rr=!1,nr=e}}}function ur(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;nr=e}function hr(e){if(e!==nr)return!1;if(!rr)return ur(e),rr=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!ns(e.type,e.memoizedProps)),t&&(t=sr)){if(cr(e))throw pr(),Error(r(418));for(;t;)lr(e,t),t=ds(t.nextSibling)}if(ur(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(r(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var a=e.data;if("/$"===a){if(0===t){sr=ds(e.nextSibling);break e}t--}else"$"!==a&&"$!"!==a&&"$?"!==a||t++}e=e.nextSibling}sr=null}}else sr=nr?ds(e.stateNode.nextSibling):null;return!0}function pr(){for(var e=sr;e;)e=ds(e.nextSibling)}function fr(){sr=nr=null,rr=!1}function mr(e){null===ir?ir=[e]:ir.push(e)}var xr=b.ReactCurrentBatchConfig;function gr(e,t,a){if(null!==(e=a.ref)&&"function"!==typeof e&&"object"!==typeof e){if(a._owner){if(a=a._owner){if(1!==a.tag)throw Error(r(309));var n=a.stateNode}if(!n)throw Error(r(147,e));var s=n,i=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===i?t.ref:(t=function(e){var t=s.refs;null===e?delete t[i]:t[i]=e},t._stringRef=i,t)}if("string"!==typeof e)throw Error(r(284));if(!a._owner)throw Error(r(290,e))}return e}function vr(e,t){throw e=Object.prototype.toString.call(t),Error(r(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function yr(e){return(0,e._init)(e._payload)}function br(e){function t(t,a){if(e){var n=t.deletions;null===n?(t.deletions=[a],t.flags|=16):n.push(a)}}function a(a,n){if(!e)return null;for(;null!==n;)t(a,n),n=n.sibling;return null}function n(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function s(e,t){return(e=Rc(e,t)).index=0,e.sibling=null,e}function i(t,a,n){return t.index=n,e?null!==(n=t.alternate)?(n=n.index)<a?(t.flags|=2,a):n:(t.flags|=2,a):(t.flags|=1048576,a)}function l(t){return e&&null===t.alternate&&(t.flags|=2),t}function o(e,t,a,n){return null===t||6!==t.tag?((t=Oc(a,e.mode,n)).return=e,t):((t=s(t,a)).return=e,t)}function c(e,t,a,n){var r=a.type;return r===N?u(e,t,a.props.children,n,a.key):null!==t&&(t.elementType===r||"object"===typeof r&&null!==r&&r.$$typeof===D&&yr(r)===t.type)?((n=s(t,a.props)).ref=gr(e,t,a),n.return=e,n):((n=Ic(a.type,a.key,a.props,null,e.mode,n)).ref=gr(e,t,a),n.return=e,n)}function d(e,t,a,n){return null===t||4!==t.tag||t.stateNode.containerInfo!==a.containerInfo||t.stateNode.implementation!==a.implementation?((t=qc(a,e.mode,n)).return=e,t):((t=s(t,a.children||[])).return=e,t)}function u(e,t,a,n,r){return null===t||7!==t.tag?((t=Bc(a,e.mode,n,r)).return=e,t):((t=s(t,a)).return=e,t)}function h(e,t,a){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Oc(""+t,e.mode,a)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case j:return(a=Ic(t.type,t.key,t.props,null,e.mode,a)).ref=gr(e,null,t),a.return=e,a;case w:return(t=qc(t,e.mode,a)).return=e,t;case D:return h(e,(0,t._init)(t._payload),a)}if(te(t)||I(t))return(t=Bc(t,e.mode,a,null)).return=e,t;vr(e,t)}return null}function p(e,t,a,n){var s=null!==t?t.key:null;if("string"===typeof a&&""!==a||"number"===typeof a)return null!==s?null:o(e,t,""+a,n);if("object"===typeof a&&null!==a){switch(a.$$typeof){case j:return a.key===s?c(e,t,a,n):null;case w:return a.key===s?d(e,t,a,n):null;case D:return p(e,t,(s=a._init)(a._payload),n)}if(te(a)||I(a))return null!==s?null:u(e,t,a,n,null);vr(e,a)}return null}function f(e,t,a,n,s){if("string"===typeof n&&""!==n||"number"===typeof n)return o(t,e=e.get(a)||null,""+n,s);if("object"===typeof n&&null!==n){switch(n.$$typeof){case j:return c(t,e=e.get(null===n.key?a:n.key)||null,n,s);case w:return d(t,e=e.get(null===n.key?a:n.key)||null,n,s);case D:return f(e,t,a,(0,n._init)(n._payload),s)}if(te(n)||I(n))return u(t,e=e.get(a)||null,n,s,null);vr(t,n)}return null}function m(s,r,l,o){for(var c=null,d=null,u=r,m=r=0,x=null;null!==u&&m<l.length;m++){u.index>m?(x=u,u=null):x=u.sibling;var g=p(s,u,l[m],o);if(null===g){null===u&&(u=x);break}e&&u&&null===g.alternate&&t(s,u),r=i(g,r,m),null===d?c=g:d.sibling=g,d=g,u=x}if(m===l.length)return a(s,u),rr&&Zs(s,m),c;if(null===u){for(;m<l.length;m++)null!==(u=h(s,l[m],o))&&(r=i(u,r,m),null===d?c=u:d.sibling=u,d=u);return rr&&Zs(s,m),c}for(u=n(s,u);m<l.length;m++)null!==(x=f(u,s,m,l[m],o))&&(e&&null!==x.alternate&&u.delete(null===x.key?m:x.key),r=i(x,r,m),null===d?c=x:d.sibling=x,d=x);return e&&u.forEach(function(e){return t(s,e)}),rr&&Zs(s,m),c}function x(s,l,o,c){var d=I(o);if("function"!==typeof d)throw Error(r(150));if(null==(o=d.call(o)))throw Error(r(151));for(var u=d=null,m=l,x=l=0,g=null,v=o.next();null!==m&&!v.done;x++,v=o.next()){m.index>x?(g=m,m=null):g=m.sibling;var y=p(s,m,v.value,c);if(null===y){null===m&&(m=g);break}e&&m&&null===y.alternate&&t(s,m),l=i(y,l,x),null===u?d=y:u.sibling=y,u=y,m=g}if(v.done)return a(s,m),rr&&Zs(s,x),d;if(null===m){for(;!v.done;x++,v=o.next())null!==(v=h(s,v.value,c))&&(l=i(v,l,x),null===u?d=v:u.sibling=v,u=v);return rr&&Zs(s,x),d}for(m=n(s,m);!v.done;x++,v=o.next())null!==(v=f(m,s,x,v.value,c))&&(e&&null!==v.alternate&&m.delete(null===v.key?x:v.key),l=i(v,l,x),null===u?d=v:u.sibling=v,u=v);return e&&m.forEach(function(e){return t(s,e)}),rr&&Zs(s,x),d}return function e(n,r,i,o){if("object"===typeof i&&null!==i&&i.type===N&&null===i.key&&(i=i.props.children),"object"===typeof i&&null!==i){switch(i.$$typeof){case j:e:{for(var c=i.key,d=r;null!==d;){if(d.key===c){if((c=i.type)===N){if(7===d.tag){a(n,d.sibling),(r=s(d,i.props.children)).return=n,n=r;break e}}else if(d.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===D&&yr(c)===d.type){a(n,d.sibling),(r=s(d,i.props)).ref=gr(n,d,i),r.return=n,n=r;break e}a(n,d);break}t(n,d),d=d.sibling}i.type===N?((r=Bc(i.props.children,n.mode,o,i.key)).return=n,n=r):((o=Ic(i.type,i.key,i.props,null,n.mode,o)).ref=gr(n,r,i),o.return=n,n=o)}return l(n);case w:e:{for(d=i.key;null!==r;){if(r.key===d){if(4===r.tag&&r.stateNode.containerInfo===i.containerInfo&&r.stateNode.implementation===i.implementation){a(n,r.sibling),(r=s(r,i.children||[])).return=n,n=r;break e}a(n,r);break}t(n,r),r=r.sibling}(r=qc(i,n.mode,o)).return=n,n=r}return l(n);case D:return e(n,r,(d=i._init)(i._payload),o)}if(te(i))return m(n,r,i,o);if(I(i))return x(n,r,i,o);vr(n,i)}return"string"===typeof i&&""!==i||"number"===typeof i?(i=""+i,null!==r&&6===r.tag?(a(n,r.sibling),(r=s(r,i)).return=n,n=r):(a(n,r),(r=Oc(i,n.mode,o)).return=n,n=r),l(n)):a(n,r)}}var jr=br(!0),wr=br(!1),Nr=ks(null),Sr=null,kr=null,Ar=null;function Cr(){Ar=kr=Sr=null}function _r(e){var t=Nr.current;As(Nr),e._currentValue=t}function Lr(e,t,a){for(;null!==e;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==n&&(n.childLanes|=t)):null!==n&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===a)break;e=e.return}}function Tr(e,t){Sr=e,Ar=kr=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(yl=!0),e.firstContext=null)}function Er(e){var t=e._currentValue;if(Ar!==e)if(e={context:e,memoizedValue:t,next:null},null===kr){if(null===Sr)throw Error(r(308));kr=e,Sr.dependencies={lanes:0,firstContext:e}}else kr=kr.next=e;return t}var Dr=null;function Pr(e){null===Dr?Dr=[e]:Dr.push(e)}function Rr(e,t,a,n){var s=t.interleaved;return null===s?(a.next=a,Pr(t)):(a.next=s.next,s.next=a),t.interleaved=a,Ir(e,n)}function Ir(e,t){e.lanes|=t;var a=e.alternate;for(null!==a&&(a.lanes|=t),a=e,e=e.return;null!==e;)e.childLanes|=t,null!==(a=e.alternate)&&(a.childLanes|=t),a=e,e=e.return;return 3===a.tag?a.stateNode:null}var Br=!1;function Fr(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Or(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function qr(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function zr(e,t,a){var n=e.updateQueue;if(null===n)return null;if(n=n.shared,0!==(2&Lo)){var s=n.pending;return null===s?t.next=t:(t.next=s.next,s.next=t),n.pending=t,Ir(e,a)}return null===(s=n.interleaved)?(t.next=t,Pr(n)):(t.next=s.next,s.next=t),n.interleaved=t,Ir(e,a)}function Mr(e,t,a){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&a))){var n=t.lanes;a|=n&=e.pendingLanes,t.lanes=a,yt(e,a)}}function Ur(e,t){var a=e.updateQueue,n=e.alternate;if(null!==n&&a===(n=n.updateQueue)){var s=null,r=null;if(null!==(a=a.firstBaseUpdate)){do{var i={eventTime:a.eventTime,lane:a.lane,tag:a.tag,payload:a.payload,callback:a.callback,next:null};null===r?s=r=i:r=r.next=i,a=a.next}while(null!==a);null===r?s=r=t:r=r.next=t}else s=r=t;return a={baseState:n.baseState,firstBaseUpdate:s,lastBaseUpdate:r,shared:n.shared,effects:n.effects},void(e.updateQueue=a)}null===(e=a.lastBaseUpdate)?a.firstBaseUpdate=t:e.next=t,a.lastBaseUpdate=t}function Wr(e,t,a,n){var s=e.updateQueue;Br=!1;var r=s.firstBaseUpdate,i=s.lastBaseUpdate,l=s.shared.pending;if(null!==l){s.shared.pending=null;var o=l,c=o.next;o.next=null,null===i?r=c:i.next=c,i=o;var d=e.alternate;null!==d&&((l=(d=d.updateQueue).lastBaseUpdate)!==i&&(null===l?d.firstBaseUpdate=c:l.next=c,d.lastBaseUpdate=o))}if(null!==r){var u=s.baseState;for(i=0,d=c=o=null,l=r;;){var h=l.lane,p=l.eventTime;if((n&h)===h){null!==d&&(d=d.next={eventTime:p,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var f=e,m=l;switch(h=t,p=a,m.tag){case 1:if("function"===typeof(f=m.payload)){u=f.call(p,u,h);break e}u=f;break e;case 3:f.flags=-65537&f.flags|128;case 0:if(null===(h="function"===typeof(f=m.payload)?f.call(p,u,h):f)||void 0===h)break e;u=F({},u,h);break e;case 2:Br=!0}}null!==l.callback&&0!==l.lane&&(e.flags|=64,null===(h=s.effects)?s.effects=[l]:h.push(l))}else p={eventTime:p,lane:h,tag:l.tag,payload:l.payload,callback:l.callback,next:null},null===d?(c=d=p,o=u):d=d.next=p,i|=h;if(null===(l=l.next)){if(null===(l=s.shared.pending))break;l=(h=l).next,h.next=null,s.lastBaseUpdate=h,s.shared.pending=null}}if(null===d&&(o=u),s.baseState=o,s.firstBaseUpdate=c,s.lastBaseUpdate=d,null!==(t=s.shared.interleaved)){s=t;do{i|=s.lane,s=s.next}while(s!==t)}else null===r&&(s.shared.lanes=0);Fo|=i,e.lanes=i,e.memoizedState=u}}function Hr(e,t,a){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var n=e[t],s=n.callback;if(null!==s){if(n.callback=null,n=a,"function"!==typeof s)throw Error(r(191,s));s.call(n)}}}var Vr={},Gr=ks(Vr),Jr=ks(Vr),Yr=ks(Vr);function Kr(e){if(e===Vr)throw Error(r(174));return e}function Qr(e,t){switch(Cs(Yr,t),Cs(Jr,e),Cs(Gr,Vr),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:oe(null,"");break;default:t=oe(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}As(Gr),Cs(Gr,t)}function $r(){As(Gr),As(Jr),As(Yr)}function Xr(e){Kr(Yr.current);var t=Kr(Gr.current),a=oe(t,e.type);t!==a&&(Cs(Jr,e),Cs(Gr,a))}function Zr(e){Jr.current===e&&(As(Gr),As(Jr))}var ei=ks(0);function ti(e){for(var t=e;null!==t;){if(13===t.tag){var a=t.memoizedState;if(null!==a&&(null===(a=a.dehydrated)||"$?"===a.data||"$!"===a.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var ai=[];function ni(){for(var e=0;e<ai.length;e++)ai[e]._workInProgressVersionPrimary=null;ai.length=0}var si=b.ReactCurrentDispatcher,ri=b.ReactCurrentBatchConfig,ii=0,li=null,oi=null,ci=null,di=!1,ui=!1,hi=0,pi=0;function fi(){throw Error(r(321))}function mi(e,t){if(null===t)return!1;for(var a=0;a<t.length&&a<e.length;a++)if(!on(e[a],t[a]))return!1;return!0}function xi(e,t,a,n,s,i){if(ii=i,li=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,si.current=null===e||null===e.memoizedState?Zi:el,e=a(n,s),ui){i=0;do{if(ui=!1,hi=0,25<=i)throw Error(r(301));i+=1,ci=oi=null,t.updateQueue=null,si.current=tl,e=a(n,s)}while(ui)}if(si.current=Xi,t=null!==oi&&null!==oi.next,ii=0,ci=oi=li=null,di=!1,t)throw Error(r(300));return e}function gi(){var e=0!==hi;return hi=0,e}function vi(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===ci?li.memoizedState=ci=e:ci=ci.next=e,ci}function yi(){if(null===oi){var e=li.alternate;e=null!==e?e.memoizedState:null}else e=oi.next;var t=null===ci?li.memoizedState:ci.next;if(null!==t)ci=t,oi=e;else{if(null===e)throw Error(r(310));e={memoizedState:(oi=e).memoizedState,baseState:oi.baseState,baseQueue:oi.baseQueue,queue:oi.queue,next:null},null===ci?li.memoizedState=ci=e:ci=ci.next=e}return ci}function bi(e,t){return"function"===typeof t?t(e):t}function ji(e){var t=yi(),a=t.queue;if(null===a)throw Error(r(311));a.lastRenderedReducer=e;var n=oi,s=n.baseQueue,i=a.pending;if(null!==i){if(null!==s){var l=s.next;s.next=i.next,i.next=l}n.baseQueue=s=i,a.pending=null}if(null!==s){i=s.next,n=n.baseState;var o=l=null,c=null,d=i;do{var u=d.lane;if((ii&u)===u)null!==c&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),n=d.hasEagerState?d.eagerState:e(n,d.action);else{var h={lane:u,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};null===c?(o=c=h,l=n):c=c.next=h,li.lanes|=u,Fo|=u}d=d.next}while(null!==d&&d!==i);null===c?l=n:c.next=o,on(n,t.memoizedState)||(yl=!0),t.memoizedState=n,t.baseState=l,t.baseQueue=c,a.lastRenderedState=n}if(null!==(e=a.interleaved)){s=e;do{i=s.lane,li.lanes|=i,Fo|=i,s=s.next}while(s!==e)}else null===s&&(a.lanes=0);return[t.memoizedState,a.dispatch]}function wi(e){var t=yi(),a=t.queue;if(null===a)throw Error(r(311));a.lastRenderedReducer=e;var n=a.dispatch,s=a.pending,i=t.memoizedState;if(null!==s){a.pending=null;var l=s=s.next;do{i=e(i,l.action),l=l.next}while(l!==s);on(i,t.memoizedState)||(yl=!0),t.memoizedState=i,null===t.baseQueue&&(t.baseState=i),a.lastRenderedState=i}return[i,n]}function Ni(){}function Si(e,t){var a=li,n=yi(),s=t(),i=!on(n.memoizedState,s);if(i&&(n.memoizedState=s,yl=!0),n=n.queue,Bi(Ci.bind(null,a,n,e),[e]),n.getSnapshot!==t||i||null!==ci&&1&ci.memoizedState.tag){if(a.flags|=2048,Ei(9,Ai.bind(null,a,n,s,t),void 0,null),null===To)throw Error(r(349));0!==(30&ii)||ki(a,t,s)}return s}function ki(e,t,a){e.flags|=16384,e={getSnapshot:t,value:a},null===(t=li.updateQueue)?(t={lastEffect:null,stores:null},li.updateQueue=t,t.stores=[e]):null===(a=t.stores)?t.stores=[e]:a.push(e)}function Ai(e,t,a,n){t.value=a,t.getSnapshot=n,_i(t)&&Li(e)}function Ci(e,t,a){return a(function(){_i(t)&&Li(e)})}function _i(e){var t=e.getSnapshot;e=e.value;try{var a=t();return!on(e,a)}catch(n){return!0}}function Li(e){var t=Ir(e,1);null!==t&&nc(t,e,1,-1)}function Ti(e){var t=vi();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:bi,lastRenderedState:e},t.queue=e,e=e.dispatch=Yi.bind(null,li,e),[t.memoizedState,e]}function Ei(e,t,a,n){return e={tag:e,create:t,destroy:a,deps:n,next:null},null===(t=li.updateQueue)?(t={lastEffect:null,stores:null},li.updateQueue=t,t.lastEffect=e.next=e):null===(a=t.lastEffect)?t.lastEffect=e.next=e:(n=a.next,a.next=e,e.next=n,t.lastEffect=e),e}function Di(){return yi().memoizedState}function Pi(e,t,a,n){var s=vi();li.flags|=e,s.memoizedState=Ei(1|t,a,void 0,void 0===n?null:n)}function Ri(e,t,a,n){var s=yi();n=void 0===n?null:n;var r=void 0;if(null!==oi){var i=oi.memoizedState;if(r=i.destroy,null!==n&&mi(n,i.deps))return void(s.memoizedState=Ei(t,a,r,n))}li.flags|=e,s.memoizedState=Ei(1|t,a,r,n)}function Ii(e,t){return Pi(8390656,8,e,t)}function Bi(e,t){return Ri(2048,8,e,t)}function Fi(e,t){return Ri(4,2,e,t)}function Oi(e,t){return Ri(4,4,e,t)}function qi(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function zi(e,t,a){return a=null!==a&&void 0!==a?a.concat([e]):null,Ri(4,4,qi.bind(null,t,e),a)}function Mi(){}function Ui(e,t){var a=yi();t=void 0===t?null:t;var n=a.memoizedState;return null!==n&&null!==t&&mi(t,n[1])?n[0]:(a.memoizedState=[e,t],e)}function Wi(e,t){var a=yi();t=void 0===t?null:t;var n=a.memoizedState;return null!==n&&null!==t&&mi(t,n[1])?n[0]:(e=e(),a.memoizedState=[e,t],e)}function Hi(e,t,a){return 0===(21&ii)?(e.baseState&&(e.baseState=!1,yl=!0),e.memoizedState=a):(on(a,t)||(a=xt(),li.lanes|=a,Fo|=a,e.baseState=!0),t)}function Vi(e,t){var a=bt;bt=0!==a&&4>a?a:4,e(!0);var n=ri.transition;ri.transition={};try{e(!1),t()}finally{bt=a,ri.transition=n}}function Gi(){return yi().memoizedState}function Ji(e,t,a){var n=ac(e);if(a={lane:n,action:a,hasEagerState:!1,eagerState:null,next:null},Ki(e))Qi(t,a);else if(null!==(a=Rr(e,t,a,n))){nc(a,e,n,tc()),$i(a,t,n)}}function Yi(e,t,a){var n=ac(e),s={lane:n,action:a,hasEagerState:!1,eagerState:null,next:null};if(Ki(e))Qi(t,s);else{var r=e.alternate;if(0===e.lanes&&(null===r||0===r.lanes)&&null!==(r=t.lastRenderedReducer))try{var i=t.lastRenderedState,l=r(i,a);if(s.hasEagerState=!0,s.eagerState=l,on(l,i)){var o=t.interleaved;return null===o?(s.next=s,Pr(t)):(s.next=o.next,o.next=s),void(t.interleaved=s)}}catch(c){}null!==(a=Rr(e,t,s,n))&&(nc(a,e,n,s=tc()),$i(a,t,n))}}function Ki(e){var t=e.alternate;return e===li||null!==t&&t===li}function Qi(e,t){ui=di=!0;var a=e.pending;null===a?t.next=t:(t.next=a.next,a.next=t),e.pending=t}function $i(e,t,a){if(0!==(4194240&a)){var n=t.lanes;a|=n&=e.pendingLanes,t.lanes=a,yt(e,a)}}var Xi={readContext:Er,useCallback:fi,useContext:fi,useEffect:fi,useImperativeHandle:fi,useInsertionEffect:fi,useLayoutEffect:fi,useMemo:fi,useReducer:fi,useRef:fi,useState:fi,useDebugValue:fi,useDeferredValue:fi,useTransition:fi,useMutableSource:fi,useSyncExternalStore:fi,useId:fi,unstable_isNewReconciler:!1},Zi={readContext:Er,useCallback:function(e,t){return vi().memoizedState=[e,void 0===t?null:t],e},useContext:Er,useEffect:Ii,useImperativeHandle:function(e,t,a){return a=null!==a&&void 0!==a?a.concat([e]):null,Pi(4194308,4,qi.bind(null,t,e),a)},useLayoutEffect:function(e,t){return Pi(4194308,4,e,t)},useInsertionEffect:function(e,t){return Pi(4,2,e,t)},useMemo:function(e,t){var a=vi();return t=void 0===t?null:t,e=e(),a.memoizedState=[e,t],e},useReducer:function(e,t,a){var n=vi();return t=void 0!==a?a(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=Ji.bind(null,li,e),[n.memoizedState,e]},useRef:function(e){return e={current:e},vi().memoizedState=e},useState:Ti,useDebugValue:Mi,useDeferredValue:function(e){return vi().memoizedState=e},useTransition:function(){var e=Ti(!1),t=e[0];return e=Vi.bind(null,e[1]),vi().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,a){var n=li,s=vi();if(rr){if(void 0===a)throw Error(r(407));a=a()}else{if(a=t(),null===To)throw Error(r(349));0!==(30&ii)||ki(n,t,a)}s.memoizedState=a;var i={value:a,getSnapshot:t};return s.queue=i,Ii(Ci.bind(null,n,i,e),[e]),n.flags|=2048,Ei(9,Ai.bind(null,n,i,a,t),void 0,null),a},useId:function(){var e=vi(),t=To.identifierPrefix;if(rr){var a=Xs;t=":"+t+"R"+(a=($s&~(1<<32-lt($s)-1)).toString(32)+a),0<(a=hi++)&&(t+="H"+a.toString(32)),t+=":"}else t=":"+t+"r"+(a=pi++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},el={readContext:Er,useCallback:Ui,useContext:Er,useEffect:Bi,useImperativeHandle:zi,useInsertionEffect:Fi,useLayoutEffect:Oi,useMemo:Wi,useReducer:ji,useRef:Di,useState:function(){return ji(bi)},useDebugValue:Mi,useDeferredValue:function(e){return Hi(yi(),oi.memoizedState,e)},useTransition:function(){return[ji(bi)[0],yi().memoizedState]},useMutableSource:Ni,useSyncExternalStore:Si,useId:Gi,unstable_isNewReconciler:!1},tl={readContext:Er,useCallback:Ui,useContext:Er,useEffect:Bi,useImperativeHandle:zi,useInsertionEffect:Fi,useLayoutEffect:Oi,useMemo:Wi,useReducer:wi,useRef:Di,useState:function(){return wi(bi)},useDebugValue:Mi,useDeferredValue:function(e){var t=yi();return null===oi?t.memoizedState=e:Hi(t,oi.memoizedState,e)},useTransition:function(){return[wi(bi)[0],yi().memoizedState]},useMutableSource:Ni,useSyncExternalStore:Si,useId:Gi,unstable_isNewReconciler:!1};function al(e,t){if(e&&e.defaultProps){for(var a in t=F({},t),e=e.defaultProps)void 0===t[a]&&(t[a]=e[a]);return t}return t}function nl(e,t,a,n){a=null===(a=a(n,t=e.memoizedState))||void 0===a?t:F({},t,a),e.memoizedState=a,0===e.lanes&&(e.updateQueue.baseState=a)}var sl={isMounted:function(e){return!!(e=e._reactInternals)&&We(e)===e},enqueueSetState:function(e,t,a){e=e._reactInternals;var n=tc(),s=ac(e),r=qr(n,s);r.payload=t,void 0!==a&&null!==a&&(r.callback=a),null!==(t=zr(e,r,s))&&(nc(t,e,s,n),Mr(t,e,s))},enqueueReplaceState:function(e,t,a){e=e._reactInternals;var n=tc(),s=ac(e),r=qr(n,s);r.tag=1,r.payload=t,void 0!==a&&null!==a&&(r.callback=a),null!==(t=zr(e,r,s))&&(nc(t,e,s,n),Mr(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var a=tc(),n=ac(e),s=qr(a,n);s.tag=2,void 0!==t&&null!==t&&(s.callback=t),null!==(t=zr(e,s,n))&&(nc(t,e,n,a),Mr(t,e,n))}};function rl(e,t,a,n,s,r,i){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(n,r,i):!t.prototype||!t.prototype.isPureReactComponent||(!cn(a,n)||!cn(s,r))}function il(e,t,a){var n=!1,s=_s,r=t.contextType;return"object"===typeof r&&null!==r?r=Er(r):(s=Ps(t)?Es:Ls.current,r=(n=null!==(n=t.contextTypes)&&void 0!==n)?Ds(e,s):_s),t=new t(a,r),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=sl,e.stateNode=t,t._reactInternals=e,n&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=r),t}function ll(e,t,a,n){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(a,n),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(a,n),t.state!==e&&sl.enqueueReplaceState(t,t.state,null)}function ol(e,t,a,n){var s=e.stateNode;s.props=a,s.state=e.memoizedState,s.refs={},Fr(e);var r=t.contextType;"object"===typeof r&&null!==r?s.context=Er(r):(r=Ps(t)?Es:Ls.current,s.context=Ds(e,r)),s.state=e.memoizedState,"function"===typeof(r=t.getDerivedStateFromProps)&&(nl(e,t,r,a),s.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof s.getSnapshotBeforeUpdate||"function"!==typeof s.UNSAFE_componentWillMount&&"function"!==typeof s.componentWillMount||(t=s.state,"function"===typeof s.componentWillMount&&s.componentWillMount(),"function"===typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount(),t!==s.state&&sl.enqueueReplaceState(s,s.state,null),Wr(e,a,s,n),s.state=e.memoizedState),"function"===typeof s.componentDidMount&&(e.flags|=4194308)}function cl(e,t){try{var a="",n=t;do{a+=M(n),n=n.return}while(n);var s=a}catch(r){s="\nError generating stack: "+r.message+"\n"+r.stack}return{value:e,source:t,stack:s,digest:null}}function dl(e,t,a){return{value:e,source:null,stack:null!=a?a:null,digest:null!=t?t:null}}function ul(e,t){try{console.error(t.value)}catch(a){setTimeout(function(){throw a})}}var hl="function"===typeof WeakMap?WeakMap:Map;function pl(e,t,a){(a=qr(-1,a)).tag=3,a.payload={element:null};var n=t.value;return a.callback=function(){Vo||(Vo=!0,Go=n),ul(0,t)},a}function fl(e,t,a){(a=qr(-1,a)).tag=3;var n=e.type.getDerivedStateFromError;if("function"===typeof n){var s=t.value;a.payload=function(){return n(s)},a.callback=function(){ul(0,t)}}var r=e.stateNode;return null!==r&&"function"===typeof r.componentDidCatch&&(a.callback=function(){ul(0,t),"function"!==typeof n&&(null===Jo?Jo=new Set([this]):Jo.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),a}function ml(e,t,a){var n=e.pingCache;if(null===n){n=e.pingCache=new hl;var s=new Set;n.set(t,s)}else void 0===(s=n.get(t))&&(s=new Set,n.set(t,s));s.has(a)||(s.add(a),e=Ac.bind(null,e,t,a),t.then(e,e))}function xl(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function gl(e,t,a,n,s){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,a.flags|=131072,a.flags&=-52805,1===a.tag&&(null===a.alternate?a.tag=17:((t=qr(-1,1)).tag=2,zr(a,t,1))),a.lanes|=1),e):(e.flags|=65536,e.lanes=s,e)}var vl=b.ReactCurrentOwner,yl=!1;function bl(e,t,a,n){t.child=null===e?wr(t,null,a,n):jr(t,e.child,a,n)}function jl(e,t,a,n,s){a=a.render;var r=t.ref;return Tr(t,s),n=xi(e,t,a,n,r,s),a=gi(),null===e||yl?(rr&&a&&tr(t),t.flags|=1,bl(e,t,n,s),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,Hl(e,t,s))}function wl(e,t,a,n,s){if(null===e){var r=a.type;return"function"!==typeof r||Pc(r)||void 0!==r.defaultProps||null!==a.compare||void 0!==a.defaultProps?((e=Ic(a.type,null,n,t,t.mode,s)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=r,Nl(e,t,r,n,s))}if(r=e.child,0===(e.lanes&s)){var i=r.memoizedProps;if((a=null!==(a=a.compare)?a:cn)(i,n)&&e.ref===t.ref)return Hl(e,t,s)}return t.flags|=1,(e=Rc(r,n)).ref=t.ref,e.return=t,t.child=e}function Nl(e,t,a,n,s){if(null!==e){var r=e.memoizedProps;if(cn(r,n)&&e.ref===t.ref){if(yl=!1,t.pendingProps=n=r,0===(e.lanes&s))return t.lanes=e.lanes,Hl(e,t,s);0!==(131072&e.flags)&&(yl=!0)}}return Al(e,t,a,n,s)}function Sl(e,t,a){var n=t.pendingProps,s=n.children,r=null!==e?e.memoizedState:null;if("hidden"===n.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Cs(Ro,Po),Po|=a;else{if(0===(1073741824&a))return e=null!==r?r.baseLanes|a:a,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Cs(Ro,Po),Po|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=null!==r?r.baseLanes:a,Cs(Ro,Po),Po|=n}else null!==r?(n=r.baseLanes|a,t.memoizedState=null):n=a,Cs(Ro,Po),Po|=n;return bl(e,t,s,a),t.child}function kl(e,t){var a=t.ref;(null===e&&null!==a||null!==e&&e.ref!==a)&&(t.flags|=512,t.flags|=2097152)}function Al(e,t,a,n,s){var r=Ps(a)?Es:Ls.current;return r=Ds(t,r),Tr(t,s),a=xi(e,t,a,n,r,s),n=gi(),null===e||yl?(rr&&n&&tr(t),t.flags|=1,bl(e,t,a,s),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,Hl(e,t,s))}function Cl(e,t,a,n,s){if(Ps(a)){var r=!0;Fs(t)}else r=!1;if(Tr(t,s),null===t.stateNode)Wl(e,t),il(t,a,n),ol(t,a,n,s),n=!0;else if(null===e){var i=t.stateNode,l=t.memoizedProps;i.props=l;var o=i.context,c=a.contextType;"object"===typeof c&&null!==c?c=Er(c):c=Ds(t,c=Ps(a)?Es:Ls.current);var d=a.getDerivedStateFromProps,u="function"===typeof d||"function"===typeof i.getSnapshotBeforeUpdate;u||"function"!==typeof i.UNSAFE_componentWillReceiveProps&&"function"!==typeof i.componentWillReceiveProps||(l!==n||o!==c)&&ll(t,i,n,c),Br=!1;var h=t.memoizedState;i.state=h,Wr(t,n,i,s),o=t.memoizedState,l!==n||h!==o||Ts.current||Br?("function"===typeof d&&(nl(t,a,d,n),o=t.memoizedState),(l=Br||rl(t,a,l,n,h,o,c))?(u||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||("function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount()),"function"===typeof i.componentDidMount&&(t.flags|=4194308)):("function"===typeof i.componentDidMount&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=o),i.props=n,i.state=o,i.context=c,n=l):("function"===typeof i.componentDidMount&&(t.flags|=4194308),n=!1)}else{i=t.stateNode,Or(e,t),l=t.memoizedProps,c=t.type===t.elementType?l:al(t.type,l),i.props=c,u=t.pendingProps,h=i.context,"object"===typeof(o=a.contextType)&&null!==o?o=Er(o):o=Ds(t,o=Ps(a)?Es:Ls.current);var p=a.getDerivedStateFromProps;(d="function"===typeof p||"function"===typeof i.getSnapshotBeforeUpdate)||"function"!==typeof i.UNSAFE_componentWillReceiveProps&&"function"!==typeof i.componentWillReceiveProps||(l!==u||h!==o)&&ll(t,i,n,o),Br=!1,h=t.memoizedState,i.state=h,Wr(t,n,i,s);var f=t.memoizedState;l!==u||h!==f||Ts.current||Br?("function"===typeof p&&(nl(t,a,p,n),f=t.memoizedState),(c=Br||rl(t,a,c,n,h,f,o)||!1)?(d||"function"!==typeof i.UNSAFE_componentWillUpdate&&"function"!==typeof i.componentWillUpdate||("function"===typeof i.componentWillUpdate&&i.componentWillUpdate(n,f,o),"function"===typeof i.UNSAFE_componentWillUpdate&&i.UNSAFE_componentWillUpdate(n,f,o)),"function"===typeof i.componentDidUpdate&&(t.flags|=4),"function"===typeof i.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof i.componentDidUpdate||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof i.getSnapshotBeforeUpdate||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=f),i.props=n,i.state=f,i.context=o,n=c):("function"!==typeof i.componentDidUpdate||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof i.getSnapshotBeforeUpdate||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),n=!1)}return _l(e,t,a,n,r,s)}function _l(e,t,a,n,s,r){kl(e,t);var i=0!==(128&t.flags);if(!n&&!i)return s&&Os(t,a,!1),Hl(e,t,r);n=t.stateNode,vl.current=t;var l=i&&"function"!==typeof a.getDerivedStateFromError?null:n.render();return t.flags|=1,null!==e&&i?(t.child=jr(t,e.child,null,r),t.child=jr(t,null,l,r)):bl(e,t,l,r),t.memoizedState=n.state,s&&Os(t,a,!0),t.child}function Ll(e){var t=e.stateNode;t.pendingContext?Is(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Is(0,t.context,!1),Qr(e,t.containerInfo)}function Tl(e,t,a,n,s){return fr(),mr(s),t.flags|=256,bl(e,t,a,n),t.child}var El,Dl,Pl,Rl,Il={dehydrated:null,treeContext:null,retryLane:0};function Bl(e){return{baseLanes:e,cachePool:null,transitions:null}}function Fl(e,t,a){var n,s=t.pendingProps,i=ei.current,l=!1,o=0!==(128&t.flags);if((n=o)||(n=(null===e||null!==e.memoizedState)&&0!==(2&i)),n?(l=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(i|=1),Cs(ei,1&i),null===e)return dr(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(o=s.children,e=s.fallback,l?(s=t.mode,l=t.child,o={mode:"hidden",children:o},0===(1&s)&&null!==l?(l.childLanes=0,l.pendingProps=o):l=Fc(o,s,0,null),e=Bc(e,s,a,null),l.return=t,e.return=t,l.sibling=e,t.child=l,t.child.memoizedState=Bl(a),t.memoizedState=Il,e):Ol(t,o));if(null!==(i=e.memoizedState)&&null!==(n=i.dehydrated))return function(e,t,a,n,s,i,l){if(a)return 256&t.flags?(t.flags&=-257,ql(e,t,l,n=dl(Error(r(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(i=n.fallback,s=t.mode,n=Fc({mode:"visible",children:n.children},s,0,null),(i=Bc(i,s,l,null)).flags|=2,n.return=t,i.return=t,n.sibling=i,t.child=n,0!==(1&t.mode)&&jr(t,e.child,null,l),t.child.memoizedState=Bl(l),t.memoizedState=Il,i);if(0===(1&t.mode))return ql(e,t,l,null);if("$!"===s.data){if(n=s.nextSibling&&s.nextSibling.dataset)var o=n.dgst;return n=o,ql(e,t,l,n=dl(i=Error(r(419)),n,void 0))}if(o=0!==(l&e.childLanes),yl||o){if(null!==(n=To)){switch(l&-l){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}0!==(s=0!==(s&(n.suspendedLanes|l))?0:s)&&s!==i.retryLane&&(i.retryLane=s,Ir(e,s),nc(n,e,s,-1))}return xc(),ql(e,t,l,n=dl(Error(r(421))))}return"$?"===s.data?(t.flags|=128,t.child=e.child,t=_c.bind(null,e),s._reactRetry=t,null):(e=i.treeContext,sr=ds(s.nextSibling),nr=t,rr=!0,ir=null,null!==e&&(Ys[Ks++]=$s,Ys[Ks++]=Xs,Ys[Ks++]=Qs,$s=e.id,Xs=e.overflow,Qs=t),t=Ol(t,n.children),t.flags|=4096,t)}(e,t,o,s,n,i,a);if(l){l=s.fallback,o=t.mode,n=(i=e.child).sibling;var c={mode:"hidden",children:s.children};return 0===(1&o)&&t.child!==i?((s=t.child).childLanes=0,s.pendingProps=c,t.deletions=null):(s=Rc(i,c)).subtreeFlags=14680064&i.subtreeFlags,null!==n?l=Rc(n,l):(l=Bc(l,o,a,null)).flags|=2,l.return=t,s.return=t,s.sibling=l,t.child=s,s=l,l=t.child,o=null===(o=e.child.memoizedState)?Bl(a):{baseLanes:o.baseLanes|a,cachePool:null,transitions:o.transitions},l.memoizedState=o,l.childLanes=e.childLanes&~a,t.memoizedState=Il,s}return e=(l=e.child).sibling,s=Rc(l,{mode:"visible",children:s.children}),0===(1&t.mode)&&(s.lanes=a),s.return=t,s.sibling=null,null!==e&&(null===(a=t.deletions)?(t.deletions=[e],t.flags|=16):a.push(e)),t.child=s,t.memoizedState=null,s}function Ol(e,t){return(t=Fc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function ql(e,t,a,n){return null!==n&&mr(n),jr(t,e.child,null,a),(e=Ol(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function zl(e,t,a){e.lanes|=t;var n=e.alternate;null!==n&&(n.lanes|=t),Lr(e.return,t,a)}function Ml(e,t,a,n,s){var r=e.memoizedState;null===r?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:a,tailMode:s}:(r.isBackwards=t,r.rendering=null,r.renderingStartTime=0,r.last=n,r.tail=a,r.tailMode=s)}function Ul(e,t,a){var n=t.pendingProps,s=n.revealOrder,r=n.tail;if(bl(e,t,n.children,a),0!==(2&(n=ei.current)))n=1&n|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&zl(e,a,t);else if(19===e.tag)zl(e,a,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(Cs(ei,n),0===(1&t.mode))t.memoizedState=null;else switch(s){case"forwards":for(a=t.child,s=null;null!==a;)null!==(e=a.alternate)&&null===ti(e)&&(s=a),a=a.sibling;null===(a=s)?(s=t.child,t.child=null):(s=a.sibling,a.sibling=null),Ml(t,!1,s,a,r);break;case"backwards":for(a=null,s=t.child,t.child=null;null!==s;){if(null!==(e=s.alternate)&&null===ti(e)){t.child=s;break}e=s.sibling,s.sibling=a,a=s,s=e}Ml(t,!0,a,null,r);break;case"together":Ml(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Wl(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Hl(e,t,a){if(null!==e&&(t.dependencies=e.dependencies),Fo|=t.lanes,0===(a&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(r(153));if(null!==t.child){for(a=Rc(e=t.child,e.pendingProps),t.child=a,a.return=t;null!==e.sibling;)e=e.sibling,(a=a.sibling=Rc(e,e.pendingProps)).return=t;a.sibling=null}return t.child}function Vl(e,t){if(!rr)switch(e.tailMode){case"hidden":t=e.tail;for(var a=null;null!==t;)null!==t.alternate&&(a=t),t=t.sibling;null===a?e.tail=null:a.sibling=null;break;case"collapsed":a=e.tail;for(var n=null;null!==a;)null!==a.alternate&&(n=a),a=a.sibling;null===n?t||null===e.tail?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Gl(e){var t=null!==e.alternate&&e.alternate.child===e.child,a=0,n=0;if(t)for(var s=e.child;null!==s;)a|=s.lanes|s.childLanes,n|=14680064&s.subtreeFlags,n|=14680064&s.flags,s.return=e,s=s.sibling;else for(s=e.child;null!==s;)a|=s.lanes|s.childLanes,n|=s.subtreeFlags,n|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=n,e.childLanes=a,t}function Jl(e,t,a){var n=t.pendingProps;switch(ar(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Gl(t),null;case 1:case 17:return Ps(t.type)&&Rs(),Gl(t),null;case 3:return n=t.stateNode,$r(),As(Ts),As(Ls),ni(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),null!==e&&null!==e.child||(hr(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==ir&&(lc(ir),ir=null))),Dl(e,t),Gl(t),null;case 5:Zr(t);var s=Kr(Yr.current);if(a=t.type,null!==e&&null!=t.stateNode)Pl(e,t,a,n,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(null===t.stateNode)throw Error(r(166));return Gl(t),null}if(e=Kr(Gr.current),hr(t)){n=t.stateNode,a=t.type;var i=t.memoizedProps;switch(n[ps]=t,n[fs]=i,e=0!==(1&t.mode),a){case"dialog":zn("cancel",n),zn("close",n);break;case"iframe":case"object":case"embed":zn("load",n);break;case"video":case"audio":for(s=0;s<Bn.length;s++)zn(Bn[s],n);break;case"source":zn("error",n);break;case"img":case"image":case"link":zn("error",n),zn("load",n);break;case"details":zn("toggle",n);break;case"input":Q(n,i),zn("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!i.multiple},zn("invalid",n);break;case"textarea":se(n,i),zn("invalid",n)}for(var o in ve(a,i),s=null,i)if(i.hasOwnProperty(o)){var c=i[o];"children"===o?"string"===typeof c?n.textContent!==c&&(!0!==i.suppressHydrationWarning&&Zn(n.textContent,c,e),s=["children",c]):"number"===typeof c&&n.textContent!==""+c&&(!0!==i.suppressHydrationWarning&&Zn(n.textContent,c,e),s=["children",""+c]):l.hasOwnProperty(o)&&null!=c&&"onScroll"===o&&zn("scroll",n)}switch(a){case"input":G(n),Z(n,i,!0);break;case"textarea":G(n),ie(n);break;case"select":case"option":break;default:"function"===typeof i.onClick&&(n.onclick=es)}n=s,t.updateQueue=n,null!==n&&(t.flags|=4)}else{o=9===s.nodeType?s:s.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=le(a)),"http://www.w3.org/1999/xhtml"===e?"script"===a?((e=o.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof n.is?e=o.createElement(a,{is:n.is}):(e=o.createElement(a),"select"===a&&(o=e,n.multiple?o.multiple=!0:n.size&&(o.size=n.size))):e=o.createElementNS(e,a),e[ps]=t,e[fs]=n,El(e,t,!1,!1),t.stateNode=e;e:{switch(o=ye(a,n),a){case"dialog":zn("cancel",e),zn("close",e),s=n;break;case"iframe":case"object":case"embed":zn("load",e),s=n;break;case"video":case"audio":for(s=0;s<Bn.length;s++)zn(Bn[s],e);s=n;break;case"source":zn("error",e),s=n;break;case"img":case"image":case"link":zn("error",e),zn("load",e),s=n;break;case"details":zn("toggle",e),s=n;break;case"input":Q(e,n),s=K(e,n),zn("invalid",e);break;case"option":default:s=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},s=F({},n,{value:void 0}),zn("invalid",e);break;case"textarea":se(e,n),s=ne(e,n),zn("invalid",e)}for(i in ve(a,s),c=s)if(c.hasOwnProperty(i)){var d=c[i];"style"===i?xe(e,d):"dangerouslySetInnerHTML"===i?null!=(d=d?d.__html:void 0)&&ue(e,d):"children"===i?"string"===typeof d?("textarea"!==a||""!==d)&&he(e,d):"number"===typeof d&&he(e,""+d):"suppressContentEditableWarning"!==i&&"suppressHydrationWarning"!==i&&"autoFocus"!==i&&(l.hasOwnProperty(i)?null!=d&&"onScroll"===i&&zn("scroll",e):null!=d&&y(e,i,d,o))}switch(a){case"input":G(e),Z(e,n,!1);break;case"textarea":G(e),ie(e);break;case"option":null!=n.value&&e.setAttribute("value",""+H(n.value));break;case"select":e.multiple=!!n.multiple,null!=(i=n.value)?ae(e,!!n.multiple,i,!1):null!=n.defaultValue&&ae(e,!!n.multiple,n.defaultValue,!0);break;default:"function"===typeof s.onClick&&(e.onclick=es)}switch(a){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Gl(t),null;case 6:if(e&&null!=t.stateNode)Rl(e,t,e.memoizedProps,n);else{if("string"!==typeof n&&null===t.stateNode)throw Error(r(166));if(a=Kr(Yr.current),Kr(Gr.current),hr(t)){if(n=t.stateNode,a=t.memoizedProps,n[ps]=t,(i=n.nodeValue!==a)&&null!==(e=nr))switch(e.tag){case 3:Zn(n.nodeValue,a,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Zn(n.nodeValue,a,0!==(1&e.mode))}i&&(t.flags|=4)}else(n=(9===a.nodeType?a:a.ownerDocument).createTextNode(n))[ps]=t,t.stateNode=n}return Gl(t),null;case 13:if(As(ei),n=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(rr&&null!==sr&&0!==(1&t.mode)&&0===(128&t.flags))pr(),fr(),t.flags|=98560,i=!1;else if(i=hr(t),null!==n&&null!==n.dehydrated){if(null===e){if(!i)throw Error(r(318));if(!(i=null!==(i=t.memoizedState)?i.dehydrated:null))throw Error(r(317));i[ps]=t}else fr(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Gl(t),i=!1}else null!==ir&&(lc(ir),ir=null),i=!0;if(!i)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=a,t):((n=null!==n)!==(null!==e&&null!==e.memoizedState)&&n&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&ei.current)?0===Io&&(Io=3):xc())),null!==t.updateQueue&&(t.flags|=4),Gl(t),null);case 4:return $r(),Dl(e,t),null===e&&Wn(t.stateNode.containerInfo),Gl(t),null;case 10:return _r(t.type._context),Gl(t),null;case 19:if(As(ei),null===(i=t.memoizedState))return Gl(t),null;if(n=0!==(128&t.flags),null===(o=i.rendering))if(n)Vl(i,!1);else{if(0!==Io||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(o=ti(e))){for(t.flags|=128,Vl(i,!1),null!==(n=o.updateQueue)&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=a,a=t.child;null!==a;)e=n,(i=a).flags&=14680066,null===(o=i.alternate)?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,e=o.dependencies,i.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),a=a.sibling;return Cs(ei,1&ei.current|2),t.child}e=e.sibling}null!==i.tail&&Xe()>Wo&&(t.flags|=128,n=!0,Vl(i,!1),t.lanes=4194304)}else{if(!n)if(null!==(e=ti(o))){if(t.flags|=128,n=!0,null!==(a=e.updateQueue)&&(t.updateQueue=a,t.flags|=4),Vl(i,!0),null===i.tail&&"hidden"===i.tailMode&&!o.alternate&&!rr)return Gl(t),null}else 2*Xe()-i.renderingStartTime>Wo&&1073741824!==a&&(t.flags|=128,n=!0,Vl(i,!1),t.lanes=4194304);i.isBackwards?(o.sibling=t.child,t.child=o):(null!==(a=i.last)?a.sibling=o:t.child=o,i.last=o)}return null!==i.tail?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=Xe(),t.sibling=null,a=ei.current,Cs(ei,n?1&a|2:1&a),t):(Gl(t),null);case 22:case 23:return hc(),n=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==n&&(t.flags|=8192),n&&0!==(1&t.mode)?0!==(1073741824&Po)&&(Gl(t),6&t.subtreeFlags&&(t.flags|=8192)):Gl(t),null;case 24:case 25:return null}throw Error(r(156,t.tag))}function Yl(e,t){switch(ar(t),t.tag){case 1:return Ps(t.type)&&Rs(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return $r(),As(Ts),As(Ls),ni(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return Zr(t),null;case 13:if(As(ei),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(r(340));fr()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return As(ei),null;case 4:return $r(),null;case 10:return _r(t.type._context),null;case 22:case 23:return hc(),null;default:return null}}El=function(e,t){for(var a=t.child;null!==a;){if(5===a.tag||6===a.tag)e.appendChild(a.stateNode);else if(4!==a.tag&&null!==a.child){a.child.return=a,a=a.child;continue}if(a===t)break;for(;null===a.sibling;){if(null===a.return||a.return===t)return;a=a.return}a.sibling.return=a.return,a=a.sibling}},Dl=function(){},Pl=function(e,t,a,n){var s=e.memoizedProps;if(s!==n){e=t.stateNode,Kr(Gr.current);var r,i=null;switch(a){case"input":s=K(e,s),n=K(e,n),i=[];break;case"select":s=F({},s,{value:void 0}),n=F({},n,{value:void 0}),i=[];break;case"textarea":s=ne(e,s),n=ne(e,n),i=[];break;default:"function"!==typeof s.onClick&&"function"===typeof n.onClick&&(e.onclick=es)}for(d in ve(a,n),a=null,s)if(!n.hasOwnProperty(d)&&s.hasOwnProperty(d)&&null!=s[d])if("style"===d){var o=s[d];for(r in o)o.hasOwnProperty(r)&&(a||(a={}),a[r]="")}else"dangerouslySetInnerHTML"!==d&&"children"!==d&&"suppressContentEditableWarning"!==d&&"suppressHydrationWarning"!==d&&"autoFocus"!==d&&(l.hasOwnProperty(d)?i||(i=[]):(i=i||[]).push(d,null));for(d in n){var c=n[d];if(o=null!=s?s[d]:void 0,n.hasOwnProperty(d)&&c!==o&&(null!=c||null!=o))if("style"===d)if(o){for(r in o)!o.hasOwnProperty(r)||c&&c.hasOwnProperty(r)||(a||(a={}),a[r]="");for(r in c)c.hasOwnProperty(r)&&o[r]!==c[r]&&(a||(a={}),a[r]=c[r])}else a||(i||(i=[]),i.push(d,a)),a=c;else"dangerouslySetInnerHTML"===d?(c=c?c.__html:void 0,o=o?o.__html:void 0,null!=c&&o!==c&&(i=i||[]).push(d,c)):"children"===d?"string"!==typeof c&&"number"!==typeof c||(i=i||[]).push(d,""+c):"suppressContentEditableWarning"!==d&&"suppressHydrationWarning"!==d&&(l.hasOwnProperty(d)?(null!=c&&"onScroll"===d&&zn("scroll",e),i||o===c||(i=[])):(i=i||[]).push(d,c))}a&&(i=i||[]).push("style",a);var d=i;(t.updateQueue=d)&&(t.flags|=4)}},Rl=function(e,t,a,n){a!==n&&(t.flags|=4)};var Kl=!1,Ql=!1,$l="function"===typeof WeakSet?WeakSet:Set,Xl=null;function Zl(e,t){var a=e.ref;if(null!==a)if("function"===typeof a)try{a(null)}catch(n){kc(e,t,n)}else a.current=null}function eo(e,t,a){try{a()}catch(n){kc(e,t,n)}}var to=!1;function ao(e,t,a){var n=t.updateQueue;if(null!==(n=null!==n?n.lastEffect:null)){var s=n=n.next;do{if((s.tag&e)===e){var r=s.destroy;s.destroy=void 0,void 0!==r&&eo(t,a,r)}s=s.next}while(s!==n)}}function no(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var a=t=t.next;do{if((a.tag&e)===e){var n=a.create;a.destroy=n()}a=a.next}while(a!==t)}}function so(e){var t=e.ref;if(null!==t){var a=e.stateNode;e.tag,e=a,"function"===typeof t?t(e):t.current=e}}function ro(e){var t=e.alternate;null!==t&&(e.alternate=null,ro(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[ps],delete t[fs],delete t[xs],delete t[gs],delete t[vs])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function io(e){return 5===e.tag||3===e.tag||4===e.tag}function lo(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||io(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function oo(e,t,a){var n=e.tag;if(5===n||6===n)e=e.stateNode,t?8===a.nodeType?a.parentNode.insertBefore(e,t):a.insertBefore(e,t):(8===a.nodeType?(t=a.parentNode).insertBefore(e,a):(t=a).appendChild(e),null!==(a=a._reactRootContainer)&&void 0!==a||null!==t.onclick||(t.onclick=es));else if(4!==n&&null!==(e=e.child))for(oo(e,t,a),e=e.sibling;null!==e;)oo(e,t,a),e=e.sibling}function co(e,t,a){var n=e.tag;if(5===n||6===n)e=e.stateNode,t?a.insertBefore(e,t):a.appendChild(e);else if(4!==n&&null!==(e=e.child))for(co(e,t,a),e=e.sibling;null!==e;)co(e,t,a),e=e.sibling}var uo=null,ho=!1;function po(e,t,a){for(a=a.child;null!==a;)fo(e,t,a),a=a.sibling}function fo(e,t,a){if(it&&"function"===typeof it.onCommitFiberUnmount)try{it.onCommitFiberUnmount(rt,a)}catch(l){}switch(a.tag){case 5:Ql||Zl(a,t);case 6:var n=uo,s=ho;uo=null,po(e,t,a),ho=s,null!==(uo=n)&&(ho?(e=uo,a=a.stateNode,8===e.nodeType?e.parentNode.removeChild(a):e.removeChild(a)):uo.removeChild(a.stateNode));break;case 18:null!==uo&&(ho?(e=uo,a=a.stateNode,8===e.nodeType?cs(e.parentNode,a):1===e.nodeType&&cs(e,a),Wt(e)):cs(uo,a.stateNode));break;case 4:n=uo,s=ho,uo=a.stateNode.containerInfo,ho=!0,po(e,t,a),uo=n,ho=s;break;case 0:case 11:case 14:case 15:if(!Ql&&(null!==(n=a.updateQueue)&&null!==(n=n.lastEffect))){s=n=n.next;do{var r=s,i=r.destroy;r=r.tag,void 0!==i&&(0!==(2&r)||0!==(4&r))&&eo(a,t,i),s=s.next}while(s!==n)}po(e,t,a);break;case 1:if(!Ql&&(Zl(a,t),"function"===typeof(n=a.stateNode).componentWillUnmount))try{n.props=a.memoizedProps,n.state=a.memoizedState,n.componentWillUnmount()}catch(l){kc(a,t,l)}po(e,t,a);break;case 21:po(e,t,a);break;case 22:1&a.mode?(Ql=(n=Ql)||null!==a.memoizedState,po(e,t,a),Ql=n):po(e,t,a);break;default:po(e,t,a)}}function mo(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var a=e.stateNode;null===a&&(a=e.stateNode=new $l),t.forEach(function(t){var n=Lc.bind(null,e,t);a.has(t)||(a.add(t),t.then(n,n))})}}function xo(e,t){var a=t.deletions;if(null!==a)for(var n=0;n<a.length;n++){var s=a[n];try{var i=e,l=t,o=l;e:for(;null!==o;){switch(o.tag){case 5:uo=o.stateNode,ho=!1;break e;case 3:case 4:uo=o.stateNode.containerInfo,ho=!0;break e}o=o.return}if(null===uo)throw Error(r(160));fo(i,l,s),uo=null,ho=!1;var c=s.alternate;null!==c&&(c.return=null),s.return=null}catch(d){kc(s,t,d)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)go(t,e),t=t.sibling}function go(e,t){var a=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(xo(t,e),vo(e),4&n){try{ao(3,e,e.return),no(3,e)}catch(x){kc(e,e.return,x)}try{ao(5,e,e.return)}catch(x){kc(e,e.return,x)}}break;case 1:xo(t,e),vo(e),512&n&&null!==a&&Zl(a,a.return);break;case 5:if(xo(t,e),vo(e),512&n&&null!==a&&Zl(a,a.return),32&e.flags){var s=e.stateNode;try{he(s,"")}catch(x){kc(e,e.return,x)}}if(4&n&&null!=(s=e.stateNode)){var i=e.memoizedProps,l=null!==a?a.memoizedProps:i,o=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===o&&"radio"===i.type&&null!=i.name&&$(s,i),ye(o,l);var d=ye(o,i);for(l=0;l<c.length;l+=2){var u=c[l],h=c[l+1];"style"===u?xe(s,h):"dangerouslySetInnerHTML"===u?ue(s,h):"children"===u?he(s,h):y(s,u,h,d)}switch(o){case"input":X(s,i);break;case"textarea":re(s,i);break;case"select":var p=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var f=i.value;null!=f?ae(s,!!i.multiple,f,!1):p!==!!i.multiple&&(null!=i.defaultValue?ae(s,!!i.multiple,i.defaultValue,!0):ae(s,!!i.multiple,i.multiple?[]:"",!1))}s[fs]=i}catch(x){kc(e,e.return,x)}}break;case 6:if(xo(t,e),vo(e),4&n){if(null===e.stateNode)throw Error(r(162));s=e.stateNode,i=e.memoizedProps;try{s.nodeValue=i}catch(x){kc(e,e.return,x)}}break;case 3:if(xo(t,e),vo(e),4&n&&null!==a&&a.memoizedState.isDehydrated)try{Wt(t.containerInfo)}catch(x){kc(e,e.return,x)}break;case 4:default:xo(t,e),vo(e);break;case 13:xo(t,e),vo(e),8192&(s=e.child).flags&&(i=null!==s.memoizedState,s.stateNode.isHidden=i,!i||null!==s.alternate&&null!==s.alternate.memoizedState||(Uo=Xe())),4&n&&mo(e);break;case 22:if(u=null!==a&&null!==a.memoizedState,1&e.mode?(Ql=(d=Ql)||u,xo(t,e),Ql=d):xo(t,e),vo(e),8192&n){if(d=null!==e.memoizedState,(e.stateNode.isHidden=d)&&!u&&0!==(1&e.mode))for(Xl=e,u=e.child;null!==u;){for(h=Xl=u;null!==Xl;){switch(f=(p=Xl).child,p.tag){case 0:case 11:case 14:case 15:ao(4,p,p.return);break;case 1:Zl(p,p.return);var m=p.stateNode;if("function"===typeof m.componentWillUnmount){n=p,a=p.return;try{t=n,m.props=t.memoizedProps,m.state=t.memoizedState,m.componentWillUnmount()}catch(x){kc(n,a,x)}}break;case 5:Zl(p,p.return);break;case 22:if(null!==p.memoizedState){wo(h);continue}}null!==f?(f.return=p,Xl=f):wo(h)}u=u.sibling}e:for(u=null,h=e;;){if(5===h.tag){if(null===u){u=h;try{s=h.stateNode,d?"function"===typeof(i=s.style).setProperty?i.setProperty("display","none","important"):i.display="none":(o=h.stateNode,l=void 0!==(c=h.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,o.style.display=me("display",l))}catch(x){kc(e,e.return,x)}}}else if(6===h.tag){if(null===u)try{h.stateNode.nodeValue=d?"":h.memoizedProps}catch(x){kc(e,e.return,x)}}else if((22!==h.tag&&23!==h.tag||null===h.memoizedState||h===e)&&null!==h.child){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;null===h.sibling;){if(null===h.return||h.return===e)break e;u===h&&(u=null),h=h.return}u===h&&(u=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:xo(t,e),vo(e),4&n&&mo(e);case 21:}}function vo(e){var t=e.flags;if(2&t){try{e:{for(var a=e.return;null!==a;){if(io(a)){var n=a;break e}a=a.return}throw Error(r(160))}switch(n.tag){case 5:var s=n.stateNode;32&n.flags&&(he(s,""),n.flags&=-33),co(e,lo(e),s);break;case 3:case 4:var i=n.stateNode.containerInfo;oo(e,lo(e),i);break;default:throw Error(r(161))}}catch(l){kc(e,e.return,l)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function yo(e,t,a){Xl=e,bo(e,t,a)}function bo(e,t,a){for(var n=0!==(1&e.mode);null!==Xl;){var s=Xl,r=s.child;if(22===s.tag&&n){var i=null!==s.memoizedState||Kl;if(!i){var l=s.alternate,o=null!==l&&null!==l.memoizedState||Ql;l=Kl;var c=Ql;if(Kl=i,(Ql=o)&&!c)for(Xl=s;null!==Xl;)o=(i=Xl).child,22===i.tag&&null!==i.memoizedState?No(s):null!==o?(o.return=i,Xl=o):No(s);for(;null!==r;)Xl=r,bo(r,t,a),r=r.sibling;Xl=s,Kl=l,Ql=c}jo(e)}else 0!==(8772&s.subtreeFlags)&&null!==r?(r.return=s,Xl=r):jo(e)}}function jo(e){for(;null!==Xl;){var t=Xl;if(0!==(8772&t.flags)){var a=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Ql||no(5,t);break;case 1:var n=t.stateNode;if(4&t.flags&&!Ql)if(null===a)n.componentDidMount();else{var s=t.elementType===t.type?a.memoizedProps:al(t.type,a.memoizedProps);n.componentDidUpdate(s,a.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;null!==i&&Hr(t,i,n);break;case 3:var l=t.updateQueue;if(null!==l){if(a=null,null!==t.child)switch(t.child.tag){case 5:case 1:a=t.child.stateNode}Hr(t,l,a)}break;case 5:var o=t.stateNode;if(null===a&&4&t.flags){a=o;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&a.focus();break;case"img":c.src&&(a.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var d=t.alternate;if(null!==d){var u=d.memoizedState;if(null!==u){var h=u.dehydrated;null!==h&&Wt(h)}}}break;default:throw Error(r(163))}Ql||512&t.flags&&so(t)}catch(p){kc(t,t.return,p)}}if(t===e){Xl=null;break}if(null!==(a=t.sibling)){a.return=t.return,Xl=a;break}Xl=t.return}}function wo(e){for(;null!==Xl;){var t=Xl;if(t===e){Xl=null;break}var a=t.sibling;if(null!==a){a.return=t.return,Xl=a;break}Xl=t.return}}function No(e){for(;null!==Xl;){var t=Xl;try{switch(t.tag){case 0:case 11:case 15:var a=t.return;try{no(4,t)}catch(o){kc(t,a,o)}break;case 1:var n=t.stateNode;if("function"===typeof n.componentDidMount){var s=t.return;try{n.componentDidMount()}catch(o){kc(t,s,o)}}var r=t.return;try{so(t)}catch(o){kc(t,r,o)}break;case 5:var i=t.return;try{so(t)}catch(o){kc(t,i,o)}}}catch(o){kc(t,t.return,o)}if(t===e){Xl=null;break}var l=t.sibling;if(null!==l){l.return=t.return,Xl=l;break}Xl=t.return}}var So,ko=Math.ceil,Ao=b.ReactCurrentDispatcher,Co=b.ReactCurrentOwner,_o=b.ReactCurrentBatchConfig,Lo=0,To=null,Eo=null,Do=0,Po=0,Ro=ks(0),Io=0,Bo=null,Fo=0,Oo=0,qo=0,zo=null,Mo=null,Uo=0,Wo=1/0,Ho=null,Vo=!1,Go=null,Jo=null,Yo=!1,Ko=null,Qo=0,$o=0,Xo=null,Zo=-1,ec=0;function tc(){return 0!==(6&Lo)?Xe():-1!==Zo?Zo:Zo=Xe()}function ac(e){return 0===(1&e.mode)?1:0!==(2&Lo)&&0!==Do?Do&-Do:null!==xr.transition?(0===ec&&(ec=xt()),ec):0!==(e=bt)?e:e=void 0===(e=window.event)?16:$t(e.type)}function nc(e,t,a,n){if(50<$o)throw $o=0,Xo=null,Error(r(185));vt(e,a,n),0!==(2&Lo)&&e===To||(e===To&&(0===(2&Lo)&&(Oo|=a),4===Io&&oc(e,Do)),sc(e,n),1===a&&0===Lo&&0===(1&t.mode)&&(Wo=Xe()+500,zs&&Ws()))}function sc(e,t){var a=e.callbackNode;!function(e,t){for(var a=e.suspendedLanes,n=e.pingedLanes,s=e.expirationTimes,r=e.pendingLanes;0<r;){var i=31-lt(r),l=1<<i,o=s[i];-1===o?0!==(l&a)&&0===(l&n)||(s[i]=ft(l,t)):o<=t&&(e.expiredLanes|=l),r&=~l}}(e,t);var n=pt(e,e===To?Do:0);if(0===n)null!==a&&Ke(a),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(null!=a&&Ke(a),1===t)0===e.tag?function(e){zs=!0,Us(e)}(cc.bind(null,e)):Us(cc.bind(null,e)),ls(function(){0===(6&Lo)&&Ws()}),a=null;else{switch(jt(n)){case 1:a=et;break;case 4:a=tt;break;case 16:default:a=at;break;case 536870912:a=st}a=Tc(a,rc.bind(null,e))}e.callbackPriority=t,e.callbackNode=a}}function rc(e,t){if(Zo=-1,ec=0,0!==(6&Lo))throw Error(r(327));var a=e.callbackNode;if(Nc()&&e.callbackNode!==a)return null;var n=pt(e,e===To?Do:0);if(0===n)return null;if(0!==(30&n)||0!==(n&e.expiredLanes)||t)t=gc(e,n);else{t=n;var s=Lo;Lo|=2;var i=mc();for(To===e&&Do===t||(Ho=null,Wo=Xe()+500,pc(e,t));;)try{yc();break}catch(o){fc(e,o)}Cr(),Ao.current=i,Lo=s,null!==Eo?t=0:(To=null,Do=0,t=Io)}if(0!==t){if(2===t&&(0!==(s=mt(e))&&(n=s,t=ic(e,s))),1===t)throw a=Bo,pc(e,0),oc(e,n),sc(e,Xe()),a;if(6===t)oc(e,n);else{if(s=e.current.alternate,0===(30&n)&&!function(e){for(var t=e;;){if(16384&t.flags){var a=t.updateQueue;if(null!==a&&null!==(a=a.stores))for(var n=0;n<a.length;n++){var s=a[n],r=s.getSnapshot;s=s.value;try{if(!on(r(),s))return!1}catch(l){return!1}}}if(a=t.child,16384&t.subtreeFlags&&null!==a)a.return=t,t=a;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(s)&&(2===(t=gc(e,n))&&(0!==(i=mt(e))&&(n=i,t=ic(e,i))),1===t))throw a=Bo,pc(e,0),oc(e,n),sc(e,Xe()),a;switch(e.finishedWork=s,e.finishedLanes=n,t){case 0:case 1:throw Error(r(345));case 2:case 5:wc(e,Mo,Ho);break;case 3:if(oc(e,n),(130023424&n)===n&&10<(t=Uo+500-Xe())){if(0!==pt(e,0))break;if(((s=e.suspendedLanes)&n)!==n){tc(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=ss(wc.bind(null,e,Mo,Ho),t);break}wc(e,Mo,Ho);break;case 4:if(oc(e,n),(4194240&n)===n)break;for(t=e.eventTimes,s=-1;0<n;){var l=31-lt(n);i=1<<l,(l=t[l])>s&&(s=l),n&=~i}if(n=s,10<(n=(120>(n=Xe()-n)?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*ko(n/1960))-n)){e.timeoutHandle=ss(wc.bind(null,e,Mo,Ho),n);break}wc(e,Mo,Ho);break;default:throw Error(r(329))}}}return sc(e,Xe()),e.callbackNode===a?rc.bind(null,e):null}function ic(e,t){var a=zo;return e.current.memoizedState.isDehydrated&&(pc(e,t).flags|=256),2!==(e=gc(e,t))&&(t=Mo,Mo=a,null!==t&&lc(t)),e}function lc(e){null===Mo?Mo=e:Mo.push.apply(Mo,e)}function oc(e,t){for(t&=~qo,t&=~Oo,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var a=31-lt(t),n=1<<a;e[a]=-1,t&=~n}}function cc(e){if(0!==(6&Lo))throw Error(r(327));Nc();var t=pt(e,0);if(0===(1&t))return sc(e,Xe()),null;var a=gc(e,t);if(0!==e.tag&&2===a){var n=mt(e);0!==n&&(t=n,a=ic(e,n))}if(1===a)throw a=Bo,pc(e,0),oc(e,t),sc(e,Xe()),a;if(6===a)throw Error(r(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,wc(e,Mo,Ho),sc(e,Xe()),null}function dc(e,t){var a=Lo;Lo|=1;try{return e(t)}finally{0===(Lo=a)&&(Wo=Xe()+500,zs&&Ws())}}function uc(e){null!==Ko&&0===Ko.tag&&0===(6&Lo)&&Nc();var t=Lo;Lo|=1;var a=_o.transition,n=bt;try{if(_o.transition=null,bt=1,e)return e()}finally{bt=n,_o.transition=a,0===(6&(Lo=t))&&Ws()}}function hc(){Po=Ro.current,As(Ro)}function pc(e,t){e.finishedWork=null,e.finishedLanes=0;var a=e.timeoutHandle;if(-1!==a&&(e.timeoutHandle=-1,rs(a)),null!==Eo)for(a=Eo.return;null!==a;){var n=a;switch(ar(n),n.tag){case 1:null!==(n=n.type.childContextTypes)&&void 0!==n&&Rs();break;case 3:$r(),As(Ts),As(Ls),ni();break;case 5:Zr(n);break;case 4:$r();break;case 13:case 19:As(ei);break;case 10:_r(n.type._context);break;case 22:case 23:hc()}a=a.return}if(To=e,Eo=e=Rc(e.current,null),Do=Po=t,Io=0,Bo=null,qo=Oo=Fo=0,Mo=zo=null,null!==Dr){for(t=0;t<Dr.length;t++)if(null!==(n=(a=Dr[t]).interleaved)){a.interleaved=null;var s=n.next,r=a.pending;if(null!==r){var i=r.next;r.next=s,n.next=i}a.pending=n}Dr=null}return e}function fc(e,t){for(;;){var a=Eo;try{if(Cr(),si.current=Xi,di){for(var n=li.memoizedState;null!==n;){var s=n.queue;null!==s&&(s.pending=null),n=n.next}di=!1}if(ii=0,ci=oi=li=null,ui=!1,hi=0,Co.current=null,null===a||null===a.return){Io=1,Bo=t,Eo=null;break}e:{var i=e,l=a.return,o=a,c=t;if(t=Do,o.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var d=c,u=o,h=u.tag;if(0===(1&u.mode)&&(0===h||11===h||15===h)){var p=u.alternate;p?(u.updateQueue=p.updateQueue,u.memoizedState=p.memoizedState,u.lanes=p.lanes):(u.updateQueue=null,u.memoizedState=null)}var f=xl(l);if(null!==f){f.flags&=-257,gl(f,l,o,0,t),1&f.mode&&ml(i,d,t),c=d;var m=(t=f).updateQueue;if(null===m){var x=new Set;x.add(c),t.updateQueue=x}else m.add(c);break e}if(0===(1&t)){ml(i,d,t),xc();break e}c=Error(r(426))}else if(rr&&1&o.mode){var g=xl(l);if(null!==g){0===(65536&g.flags)&&(g.flags|=256),gl(g,l,o,0,t),mr(cl(c,o));break e}}i=c=cl(c,o),4!==Io&&(Io=2),null===zo?zo=[i]:zo.push(i),i=l;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t,Ur(i,pl(0,c,t));break e;case 1:o=c;var v=i.type,y=i.stateNode;if(0===(128&i.flags)&&("function"===typeof v.getDerivedStateFromError||null!==y&&"function"===typeof y.componentDidCatch&&(null===Jo||!Jo.has(y)))){i.flags|=65536,t&=-t,i.lanes|=t,Ur(i,fl(i,o,t));break e}}i=i.return}while(null!==i)}jc(a)}catch(b){t=b,Eo===a&&null!==a&&(Eo=a=a.return);continue}break}}function mc(){var e=Ao.current;return Ao.current=Xi,null===e?Xi:e}function xc(){0!==Io&&3!==Io&&2!==Io||(Io=4),null===To||0===(268435455&Fo)&&0===(268435455&Oo)||oc(To,Do)}function gc(e,t){var a=Lo;Lo|=2;var n=mc();for(To===e&&Do===t||(Ho=null,pc(e,t));;)try{vc();break}catch(s){fc(e,s)}if(Cr(),Lo=a,Ao.current=n,null!==Eo)throw Error(r(261));return To=null,Do=0,Io}function vc(){for(;null!==Eo;)bc(Eo)}function yc(){for(;null!==Eo&&!Qe();)bc(Eo)}function bc(e){var t=So(e.alternate,e,Po);e.memoizedProps=e.pendingProps,null===t?jc(e):Eo=t,Co.current=null}function jc(e){var t=e;do{var a=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(a=Jl(a,t,Po)))return void(Eo=a)}else{if(null!==(a=Yl(a,t)))return a.flags&=32767,void(Eo=a);if(null===e)return Io=6,void(Eo=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Eo=t);Eo=t=e}while(null!==t);0===Io&&(Io=5)}function wc(e,t,a){var n=bt,s=_o.transition;try{_o.transition=null,bt=1,function(e,t,a,n){do{Nc()}while(null!==Ko);if(0!==(6&Lo))throw Error(r(327));a=e.finishedWork;var s=e.finishedLanes;if(null===a)return null;if(e.finishedWork=null,e.finishedLanes=0,a===e.current)throw Error(r(177));e.callbackNode=null,e.callbackPriority=0;var i=a.lanes|a.childLanes;if(function(e,t){var a=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<a;){var s=31-lt(a),r=1<<s;t[s]=0,n[s]=-1,e[s]=-1,a&=~r}}(e,i),e===To&&(Eo=To=null,Do=0),0===(2064&a.subtreeFlags)&&0===(2064&a.flags)||Yo||(Yo=!0,Tc(at,function(){return Nc(),null})),i=0!==(15990&a.flags),0!==(15990&a.subtreeFlags)||i){i=_o.transition,_o.transition=null;var l=bt;bt=1;var o=Lo;Lo|=4,Co.current=null,function(e,t){if(ts=Vt,fn(e=pn())){if("selectionStart"in e)var a={start:e.selectionStart,end:e.selectionEnd};else e:{var n=(a=(a=e.ownerDocument)&&a.defaultView||window).getSelection&&a.getSelection();if(n&&0!==n.rangeCount){a=n.anchorNode;var s=n.anchorOffset,i=n.focusNode;n=n.focusOffset;try{a.nodeType,i.nodeType}catch(Ue){a=null;break e}var l=0,o=-1,c=-1,d=0,u=0,h=e,p=null;t:for(;;){for(var f;h!==a||0!==s&&3!==h.nodeType||(o=l+s),h!==i||0!==n&&3!==h.nodeType||(c=l+n),3===h.nodeType&&(l+=h.nodeValue.length),null!==(f=h.firstChild);)p=h,h=f;for(;;){if(h===e)break t;if(p===a&&++d===s&&(o=l),p===i&&++u===n&&(c=l),null!==(f=h.nextSibling))break;p=(h=p).parentNode}h=f}a=-1===o||-1===c?null:{start:o,end:c}}else a=null}a=a||{start:0,end:0}}else a=null;for(as={focusedElem:e,selectionRange:a},Vt=!1,Xl=t;null!==Xl;)if(e=(t=Xl).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Xl=e;else for(;null!==Xl;){t=Xl;try{var m=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==m){var x=m.memoizedProps,g=m.memoizedState,v=t.stateNode,y=v.getSnapshotBeforeUpdate(t.elementType===t.type?x:al(t.type,x),g);v.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var b=t.stateNode.containerInfo;1===b.nodeType?b.textContent="":9===b.nodeType&&b.documentElement&&b.removeChild(b.documentElement);break;default:throw Error(r(163))}}catch(Ue){kc(t,t.return,Ue)}if(null!==(e=t.sibling)){e.return=t.return,Xl=e;break}Xl=t.return}m=to,to=!1}(e,a),go(a,e),mn(as),Vt=!!ts,as=ts=null,e.current=a,yo(a,e,s),$e(),Lo=o,bt=l,_o.transition=i}else e.current=a;if(Yo&&(Yo=!1,Ko=e,Qo=s),i=e.pendingLanes,0===i&&(Jo=null),function(e){if(it&&"function"===typeof it.onCommitFiberRoot)try{it.onCommitFiberRoot(rt,e,void 0,128===(128&e.current.flags))}catch(t){}}(a.stateNode),sc(e,Xe()),null!==t)for(n=e.onRecoverableError,a=0;a<t.length;a++)s=t[a],n(s.value,{componentStack:s.stack,digest:s.digest});if(Vo)throw Vo=!1,e=Go,Go=null,e;0!==(1&Qo)&&0!==e.tag&&Nc(),i=e.pendingLanes,0!==(1&i)?e===Xo?$o++:($o=0,Xo=e):$o=0,Ws()}(e,t,a,n)}finally{_o.transition=s,bt=n}return null}function Nc(){if(null!==Ko){var e=jt(Qo),t=_o.transition,a=bt;try{if(_o.transition=null,bt=16>e?16:e,null===Ko)var n=!1;else{if(e=Ko,Ko=null,Qo=0,0!==(6&Lo))throw Error(r(331));var s=Lo;for(Lo|=4,Xl=e.current;null!==Xl;){var i=Xl,l=i.child;if(0!==(16&Xl.flags)){var o=i.deletions;if(null!==o){for(var c=0;c<o.length;c++){var d=o[c];for(Xl=d;null!==Xl;){var u=Xl;switch(u.tag){case 0:case 11:case 15:ao(8,u,i)}var h=u.child;if(null!==h)h.return=u,Xl=h;else for(;null!==Xl;){var p=(u=Xl).sibling,f=u.return;if(ro(u),u===d){Xl=null;break}if(null!==p){p.return=f,Xl=p;break}Xl=f}}}var m=i.alternate;if(null!==m){var x=m.child;if(null!==x){m.child=null;do{var g=x.sibling;x.sibling=null,x=g}while(null!==x)}}Xl=i}}if(0!==(2064&i.subtreeFlags)&&null!==l)l.return=i,Xl=l;else e:for(;null!==Xl;){if(0!==(2048&(i=Xl).flags))switch(i.tag){case 0:case 11:case 15:ao(9,i,i.return)}var v=i.sibling;if(null!==v){v.return=i.return,Xl=v;break e}Xl=i.return}}var y=e.current;for(Xl=y;null!==Xl;){var b=(l=Xl).child;if(0!==(2064&l.subtreeFlags)&&null!==b)b.return=l,Xl=b;else e:for(l=y;null!==Xl;){if(0!==(2048&(o=Xl).flags))try{switch(o.tag){case 0:case 11:case 15:no(9,o)}}catch(w){kc(o,o.return,w)}if(o===l){Xl=null;break e}var j=o.sibling;if(null!==j){j.return=o.return,Xl=j;break e}Xl=o.return}}if(Lo=s,Ws(),it&&"function"===typeof it.onPostCommitFiberRoot)try{it.onPostCommitFiberRoot(rt,e)}catch(w){}n=!0}return n}finally{bt=a,_o.transition=t}}return!1}function Sc(e,t,a){e=zr(e,t=pl(0,t=cl(a,t),1),1),t=tc(),null!==e&&(vt(e,1,t),sc(e,t))}function kc(e,t,a){if(3===e.tag)Sc(e,e,a);else for(;null!==t;){if(3===t.tag){Sc(t,e,a);break}if(1===t.tag){var n=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof n.componentDidCatch&&(null===Jo||!Jo.has(n))){t=zr(t,e=fl(t,e=cl(a,e),1),1),e=tc(),null!==t&&(vt(t,1,e),sc(t,e));break}}t=t.return}}function Ac(e,t,a){var n=e.pingCache;null!==n&&n.delete(t),t=tc(),e.pingedLanes|=e.suspendedLanes&a,To===e&&(Do&a)===a&&(4===Io||3===Io&&(130023424&Do)===Do&&500>Xe()-Uo?pc(e,0):qo|=a),sc(e,t)}function Cc(e,t){0===t&&(0===(1&e.mode)?t=1:(t=ut,0===(130023424&(ut<<=1))&&(ut=4194304)));var a=tc();null!==(e=Ir(e,t))&&(vt(e,t,a),sc(e,a))}function _c(e){var t=e.memoizedState,a=0;null!==t&&(a=t.retryLane),Cc(e,a)}function Lc(e,t){var a=0;switch(e.tag){case 13:var n=e.stateNode,s=e.memoizedState;null!==s&&(a=s.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(r(314))}null!==n&&n.delete(t),Cc(e,a)}function Tc(e,t){return Ye(e,t)}function Ec(e,t,a,n){this.tag=e,this.key=a,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Dc(e,t,a,n){return new Ec(e,t,a,n)}function Pc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Rc(e,t){var a=e.alternate;return null===a?((a=Dc(e.tag,t,e.key,e.mode)).elementType=e.elementType,a.type=e.type,a.stateNode=e.stateNode,a.alternate=e,e.alternate=a):(a.pendingProps=t,a.type=e.type,a.flags=0,a.subtreeFlags=0,a.deletions=null),a.flags=14680064&e.flags,a.childLanes=e.childLanes,a.lanes=e.lanes,a.child=e.child,a.memoizedProps=e.memoizedProps,a.memoizedState=e.memoizedState,a.updateQueue=e.updateQueue,t=e.dependencies,a.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},a.sibling=e.sibling,a.index=e.index,a.ref=e.ref,a}function Ic(e,t,a,n,s,i){var l=2;if(n=e,"function"===typeof e)Pc(e)&&(l=1);else if("string"===typeof e)l=5;else e:switch(e){case N:return Bc(a.children,s,i,t);case S:l=8,s|=8;break;case k:return(e=Dc(12,a,t,2|s)).elementType=k,e.lanes=i,e;case L:return(e=Dc(13,a,t,s)).elementType=L,e.lanes=i,e;case T:return(e=Dc(19,a,t,s)).elementType=T,e.lanes=i,e;case P:return Fc(a,s,i,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case A:l=10;break e;case C:l=9;break e;case _:l=11;break e;case E:l=14;break e;case D:l=16,n=null;break e}throw Error(r(130,null==e?e:typeof e,""))}return(t=Dc(l,a,t,s)).elementType=e,t.type=n,t.lanes=i,t}function Bc(e,t,a,n){return(e=Dc(7,e,n,t)).lanes=a,e}function Fc(e,t,a,n){return(e=Dc(22,e,n,t)).elementType=P,e.lanes=a,e.stateNode={isHidden:!1},e}function Oc(e,t,a){return(e=Dc(6,e,null,t)).lanes=a,e}function qc(e,t,a){return(t=Dc(4,null!==e.children?e.children:[],e.key,t)).lanes=a,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function zc(e,t,a,n,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gt(0),this.expirationTimes=gt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gt(0),this.identifierPrefix=n,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Mc(e,t,a,n,s,r,i,l,o){return e=new zc(e,t,a,l,o),1===t?(t=1,!0===r&&(t|=8)):t=0,r=Dc(3,null,null,t),e.current=r,r.stateNode=e,r.memoizedState={element:n,isDehydrated:a,cache:null,transitions:null,pendingSuspenseBoundaries:null},Fr(r),e}function Uc(e){if(!e)return _s;e:{if(We(e=e._reactInternals)!==e||1!==e.tag)throw Error(r(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Ps(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(r(171))}if(1===e.tag){var a=e.type;if(Ps(a))return Bs(e,a,t)}return t}function Wc(e,t,a,n,s,r,i,l,o){return(e=Mc(a,n,!0,e,0,r,0,l,o)).context=Uc(null),a=e.current,(r=qr(n=tc(),s=ac(a))).callback=void 0!==t&&null!==t?t:null,zr(a,r,s),e.current.lanes=s,vt(e,s,n),sc(e,n),e}function Hc(e,t,a,n){var s=t.current,r=tc(),i=ac(s);return a=Uc(a),null===t.context?t.context=a:t.pendingContext=a,(t=qr(r,i)).payload={element:e},null!==(n=void 0===n?null:n)&&(t.callback=n),null!==(e=zr(s,t,i))&&(nc(e,s,i,r),Mr(e,s,i)),i}function Vc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Gc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var a=e.retryLane;e.retryLane=0!==a&&a<t?a:t}}function Jc(e,t){Gc(e,t),(e=e.alternate)&&Gc(e,t)}So=function(e,t,a){if(null!==e)if(e.memoizedProps!==t.pendingProps||Ts.current)yl=!0;else{if(0===(e.lanes&a)&&0===(128&t.flags))return yl=!1,function(e,t,a){switch(t.tag){case 3:Ll(t),fr();break;case 5:Xr(t);break;case 1:Ps(t.type)&&Fs(t);break;case 4:Qr(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,s=t.memoizedProps.value;Cs(Nr,n._currentValue),n._currentValue=s;break;case 13:if(null!==(n=t.memoizedState))return null!==n.dehydrated?(Cs(ei,1&ei.current),t.flags|=128,null):0!==(a&t.child.childLanes)?Fl(e,t,a):(Cs(ei,1&ei.current),null!==(e=Hl(e,t,a))?e.sibling:null);Cs(ei,1&ei.current);break;case 19:if(n=0!==(a&t.childLanes),0!==(128&e.flags)){if(n)return Ul(e,t,a);t.flags|=128}if(null!==(s=t.memoizedState)&&(s.rendering=null,s.tail=null,s.lastEffect=null),Cs(ei,ei.current),n)break;return null;case 22:case 23:return t.lanes=0,Sl(e,t,a)}return Hl(e,t,a)}(e,t,a);yl=0!==(131072&e.flags)}else yl=!1,rr&&0!==(1048576&t.flags)&&er(t,Js,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;Wl(e,t),e=t.pendingProps;var s=Ds(t,Ls.current);Tr(t,a),s=xi(null,t,n,e,s,a);var i=gi();return t.flags|=1,"object"===typeof s&&null!==s&&"function"===typeof s.render&&void 0===s.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Ps(n)?(i=!0,Fs(t)):i=!1,t.memoizedState=null!==s.state&&void 0!==s.state?s.state:null,Fr(t),s.updater=sl,t.stateNode=s,s._reactInternals=t,ol(t,n,e,a),t=_l(null,t,n,!0,i,a)):(t.tag=0,rr&&i&&tr(t),bl(null,t,s,a),t=t.child),t;case 16:n=t.elementType;e:{switch(Wl(e,t),e=t.pendingProps,n=(s=n._init)(n._payload),t.type=n,s=t.tag=function(e){if("function"===typeof e)return Pc(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===_)return 11;if(e===E)return 14}return 2}(n),e=al(n,e),s){case 0:t=Al(null,t,n,e,a);break e;case 1:t=Cl(null,t,n,e,a);break e;case 11:t=jl(null,t,n,e,a);break e;case 14:t=wl(null,t,n,al(n.type,e),a);break e}throw Error(r(306,n,""))}return t;case 0:return n=t.type,s=t.pendingProps,Al(e,t,n,s=t.elementType===n?s:al(n,s),a);case 1:return n=t.type,s=t.pendingProps,Cl(e,t,n,s=t.elementType===n?s:al(n,s),a);case 3:e:{if(Ll(t),null===e)throw Error(r(387));n=t.pendingProps,s=(i=t.memoizedState).element,Or(e,t),Wr(t,n,null,a);var l=t.memoizedState;if(n=l.element,i.isDehydrated){if(i={element:n,isDehydrated:!1,cache:l.cache,pendingSuspenseBoundaries:l.pendingSuspenseBoundaries,transitions:l.transitions},t.updateQueue.baseState=i,t.memoizedState=i,256&t.flags){t=Tl(e,t,n,a,s=cl(Error(r(423)),t));break e}if(n!==s){t=Tl(e,t,n,a,s=cl(Error(r(424)),t));break e}for(sr=ds(t.stateNode.containerInfo.firstChild),nr=t,rr=!0,ir=null,a=wr(t,null,n,a),t.child=a;a;)a.flags=-3&a.flags|4096,a=a.sibling}else{if(fr(),n===s){t=Hl(e,t,a);break e}bl(e,t,n,a)}t=t.child}return t;case 5:return Xr(t),null===e&&dr(t),n=t.type,s=t.pendingProps,i=null!==e?e.memoizedProps:null,l=s.children,ns(n,s)?l=null:null!==i&&ns(n,i)&&(t.flags|=32),kl(e,t),bl(e,t,l,a),t.child;case 6:return null===e&&dr(t),null;case 13:return Fl(e,t,a);case 4:return Qr(t,t.stateNode.containerInfo),n=t.pendingProps,null===e?t.child=jr(t,null,n,a):bl(e,t,n,a),t.child;case 11:return n=t.type,s=t.pendingProps,jl(e,t,n,s=t.elementType===n?s:al(n,s),a);case 7:return bl(e,t,t.pendingProps,a),t.child;case 8:case 12:return bl(e,t,t.pendingProps.children,a),t.child;case 10:e:{if(n=t.type._context,s=t.pendingProps,i=t.memoizedProps,l=s.value,Cs(Nr,n._currentValue),n._currentValue=l,null!==i)if(on(i.value,l)){if(i.children===s.children&&!Ts.current){t=Hl(e,t,a);break e}}else for(null!==(i=t.child)&&(i.return=t);null!==i;){var o=i.dependencies;if(null!==o){l=i.child;for(var c=o.firstContext;null!==c;){if(c.context===n){if(1===i.tag){(c=qr(-1,a&-a)).tag=2;var d=i.updateQueue;if(null!==d){var u=(d=d.shared).pending;null===u?c.next=c:(c.next=u.next,u.next=c),d.pending=c}}i.lanes|=a,null!==(c=i.alternate)&&(c.lanes|=a),Lr(i.return,a,t),o.lanes|=a;break}c=c.next}}else if(10===i.tag)l=i.type===t.type?null:i.child;else if(18===i.tag){if(null===(l=i.return))throw Error(r(341));l.lanes|=a,null!==(o=l.alternate)&&(o.lanes|=a),Lr(l,a,t),l=i.sibling}else l=i.child;if(null!==l)l.return=i;else for(l=i;null!==l;){if(l===t){l=null;break}if(null!==(i=l.sibling)){i.return=l.return,l=i;break}l=l.return}i=l}bl(e,t,s.children,a),t=t.child}return t;case 9:return s=t.type,n=t.pendingProps.children,Tr(t,a),n=n(s=Er(s)),t.flags|=1,bl(e,t,n,a),t.child;case 14:return s=al(n=t.type,t.pendingProps),wl(e,t,n,s=al(n.type,s),a);case 15:return Nl(e,t,t.type,t.pendingProps,a);case 17:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:al(n,s),Wl(e,t),t.tag=1,Ps(n)?(e=!0,Fs(t)):e=!1,Tr(t,a),il(t,n,s),ol(t,n,s,a),_l(null,t,n,!0,e,a);case 19:return Ul(e,t,a);case 22:return Sl(e,t,a)}throw Error(r(156,t.tag))};var Yc="function"===typeof reportError?reportError:function(e){console.error(e)};function Kc(e){this._internalRoot=e}function Qc(e){this._internalRoot=e}function $c(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Xc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Zc(){}function ed(e,t,a,n,s){var r=a._reactRootContainer;if(r){var i=r;if("function"===typeof s){var l=s;s=function(){var e=Vc(i);l.call(e)}}Hc(t,i,e,s)}else i=function(e,t,a,n,s){if(s){if("function"===typeof n){var r=n;n=function(){var e=Vc(i);r.call(e)}}var i=Wc(t,n,e,0,null,!1,0,"",Zc);return e._reactRootContainer=i,e[ms]=i.current,Wn(8===e.nodeType?e.parentNode:e),uc(),i}for(;s=e.lastChild;)e.removeChild(s);if("function"===typeof n){var l=n;n=function(){var e=Vc(o);l.call(e)}}var o=Mc(e,0,!1,null,0,!1,0,"",Zc);return e._reactRootContainer=o,e[ms]=o.current,Wn(8===e.nodeType?e.parentNode:e),uc(function(){Hc(t,o,a,n)}),o}(a,t,e,s,n);return Vc(i)}Qc.prototype.render=Kc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(r(409));Hc(e,t,null,null)},Qc.prototype.unmount=Kc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;uc(function(){Hc(null,e,null,null)}),t[ms]=null}},Qc.prototype.unstable_scheduleHydration=function(e){if(e){var t=kt();e={blockedOn:null,target:e,priority:t};for(var a=0;a<Rt.length&&0!==t&&t<Rt[a].priority;a++);Rt.splice(a,0,e),0===a&&Ot(e)}},wt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var a=ht(t.pendingLanes);0!==a&&(yt(t,1|a),sc(t,Xe()),0===(6&Lo)&&(Wo=Xe()+500,Ws()))}break;case 13:uc(function(){var t=Ir(e,1);if(null!==t){var a=tc();nc(t,e,1,a)}}),Jc(e,1)}},Nt=function(e){if(13===e.tag){var t=Ir(e,134217728);if(null!==t)nc(t,e,134217728,tc());Jc(e,134217728)}},St=function(e){if(13===e.tag){var t=ac(e),a=Ir(e,t);if(null!==a)nc(a,e,t,tc());Jc(e,t)}},kt=function(){return bt},At=function(e,t){var a=bt;try{return bt=e,t()}finally{bt=a}},we=function(e,t,a){switch(t){case"input":if(X(e,a),t=a.name,"radio"===a.type&&null!=t){for(a=e;a.parentNode;)a=a.parentNode;for(a=a.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<a.length;t++){var n=a[t];if(n!==e&&n.form===e.form){var s=ws(n);if(!s)throw Error(r(90));J(n),X(n,s)}}}break;case"textarea":re(e,a);break;case"select":null!=(t=a.value)&&ae(e,!!a.multiple,t,!1)}},_e=dc,Le=uc;var td={usingClientEntryPoint:!1,Events:[bs,js,ws,Ae,Ce,dc]},ad={findFiberByHostInstance:ys,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},nd={bundleType:ad.bundleType,version:ad.version,rendererPackageName:ad.rendererPackageName,rendererConfig:ad.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:b.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=Ge(e))?null:e.stateNode},findFiberByHostInstance:ad.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var sd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!sd.isDisabled&&sd.supportsFiber)try{rt=sd.inject(nd),it=sd}catch(de){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=td,t.createPortal=function(e,t){var a=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!$c(t))throw Error(r(200));return function(e,t,a){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:w,key:null==n?null:""+n,children:e,containerInfo:t,implementation:a}}(e,t,null,a)},t.createRoot=function(e,t){if(!$c(e))throw Error(r(299));var a=!1,n="",s=Yc;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(a=!0),void 0!==t.identifierPrefix&&(n=t.identifierPrefix),void 0!==t.onRecoverableError&&(s=t.onRecoverableError)),t=Mc(e,1,!1,null,0,a,0,n,s),e[ms]=t.current,Wn(8===e.nodeType?e.parentNode:e),new Kc(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(r(188));throw e=Object.keys(e).join(","),Error(r(268,e))}return e=null===(e=Ge(t))?null:e.stateNode},t.flushSync=function(e){return uc(e)},t.hydrate=function(e,t,a){if(!Xc(t))throw Error(r(200));return ed(null,e,t,!0,a)},t.hydrateRoot=function(e,t,a){if(!$c(e))throw Error(r(405));var n=null!=a&&a.hydratedSources||null,s=!1,i="",l=Yc;if(null!==a&&void 0!==a&&(!0===a.unstable_strictMode&&(s=!0),void 0!==a.identifierPrefix&&(i=a.identifierPrefix),void 0!==a.onRecoverableError&&(l=a.onRecoverableError)),t=Wc(t,null,e,1,null!=a?a:null,s,0,i,l),e[ms]=t.current,Wn(e),n)for(e=0;e<n.length;e++)s=(s=(a=n[e])._getVersion)(a._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[a,s]:t.mutableSourceEagerHydrationData.push(a,s);return new Qc(t)},t.render=function(e,t,a){if(!Xc(t))throw Error(r(200));return ed(null,e,t,!1,a)},t.unmountComponentAtNode=function(e){if(!Xc(e))throw Error(r(40));return!!e._reactRootContainer&&(uc(function(){ed(null,null,e,!1,function(){e._reactRootContainer=null,e[ms]=null})}),!0)},t.unstable_batchedUpdates=dc,t.unstable_renderSubtreeIntoContainer=function(e,t,a,n){if(!Xc(a))throw Error(r(200));if(null==e||void 0===e._reactInternals)throw Error(r(38));return ed(e,t,a,!1,n)},t.version="18.3.1-next-f1338f8080-20240426"},3216:(e,t,a)=>{var n;a.d(t,{$P:()=>p,BV:()=>q,C5:()=>I,Ix:()=>O,Rq:()=>o,V8:()=>R,Zp:()=>g,g:()=>y,jb:()=>c,qh:()=>F,sp:()=>l,sv:()=>B,x$:()=>b,zy:()=>m});var s=a(5043),r=a(1387);function i(){return i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},i.apply(this,arguments)}const l=s.createContext(null);const o=s.createContext(null);const c=s.createContext(null);const d=s.createContext(null);const u=s.createContext({outlet:null,matches:[],isDataRoute:!1});const h=s.createContext(null);function p(e,t){let{relative:a}=void 0===t?{}:t;f()||(0,r.Oi)(!1);let{basename:n,navigator:i}=s.useContext(c),{hash:l,pathname:o,search:d}=b(e,{relative:a}),u=o;return"/"!==n&&(u="/"===o?n:(0,r.HS)([n,o])),i.createHref({pathname:u,search:d,hash:l})}function f(){return null!=s.useContext(d)}function m(){return f()||(0,r.Oi)(!1),s.useContext(d).location}function x(e){s.useContext(c).static||s.useLayoutEffect(e)}function g(){let{isDataRoute:e}=s.useContext(u);return e?function(){let{router:e}=L(C.UseNavigateStable),t=E(_.UseNavigateStable),a=s.useRef(!1);return x(()=>{a.current=!0}),s.useCallback(function(n,s){void 0===s&&(s={}),a.current&&("number"===typeof n?e.navigate(n):e.navigate(n,i({fromRouteId:t},s)))},[e,t])}():function(){f()||(0,r.Oi)(!1);let e=s.useContext(l),{basename:t,future:a,navigator:n}=s.useContext(c),{matches:i}=s.useContext(u),{pathname:o}=m(),d=JSON.stringify((0,r.yD)(i,a.v7_relativeSplatPath)),h=s.useRef(!1);return x(()=>{h.current=!0}),s.useCallback(function(a,s){if(void 0===s&&(s={}),!h.current)return;if("number"===typeof a)return void n.go(a);let i=(0,r.Gh)(a,JSON.parse(d),o,"path"===s.relative);null==e&&"/"!==t&&(i.pathname="/"===i.pathname?t:(0,r.HS)([t,i.pathname])),(s.replace?n.replace:n.push)(i,s.state,s)},[t,n,d,o,e])}()}const v=s.createContext(null);function y(){let{matches:e}=s.useContext(u),t=e[e.length-1];return t?t.params:{}}function b(e,t){let{relative:a}=void 0===t?{}:t,{future:n}=s.useContext(c),{matches:i}=s.useContext(u),{pathname:l}=m(),o=JSON.stringify((0,r.yD)(i,n.v7_relativeSplatPath));return s.useMemo(()=>(0,r.Gh)(e,JSON.parse(o),l,"path"===a),[e,o,l,a])}function j(e,t,a,n){f()||(0,r.Oi)(!1);let{navigator:l}=s.useContext(c),{matches:o}=s.useContext(u),h=o[o.length-1],p=h?h.params:{},x=(h&&h.pathname,h?h.pathnameBase:"/");h&&h.route;let g,v=m();if(t){var y;let e="string"===typeof t?(0,r.Rr)(t):t;"/"===x||(null==(y=e.pathname)?void 0:y.startsWith(x))||(0,r.Oi)(!1),g=e}else g=v;let b=g.pathname||"/",j=b;if("/"!==x){let e=x.replace(/^\//,"").split("/");j="/"+b.replace(/^\//,"").split("/").slice(e.length).join("/")}let w=(0,r.ue)(e,{pathname:j});let N=A(w&&w.map(e=>Object.assign({},e,{params:Object.assign({},p,e.params),pathname:(0,r.HS)([x,l.encodeLocation?l.encodeLocation(e.pathname).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?x:(0,r.HS)([x,l.encodeLocation?l.encodeLocation(e.pathnameBase).pathname:e.pathnameBase])})),o,a,n);return t&&N?s.createElement(d.Provider,{value:{location:i({pathname:"/",search:"",hash:"",state:null,key:"default"},g),navigationType:r.rc.Pop}},N):N}function w(){let e=function(){var e;let t=s.useContext(h),a=T(_.UseRouteError),n=E(_.UseRouteError);if(void 0!==t)return t;return null==(e=a.errors)?void 0:e[n]}(),t=(0,r.pX)(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),a=e instanceof Error?e.stack:null,n="rgba(200,200,200, 0.5)",i={padding:"0.5rem",backgroundColor:n};return s.createElement(s.Fragment,null,s.createElement("h2",null,"Unexpected Application Error!"),s.createElement("h3",{style:{fontStyle:"italic"}},t),a?s.createElement("pre",{style:i},a):null,null)}const N=s.createElement(w,null);class S extends s.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:void 0!==e.error?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return void 0!==this.state.error?s.createElement(u.Provider,{value:this.props.routeContext},s.createElement(h.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function k(e){let{routeContext:t,match:a,children:n}=e,r=s.useContext(l);return r&&r.static&&r.staticContext&&(a.route.errorElement||a.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=a.route.id),s.createElement(u.Provider,{value:t},n)}function A(e,t,a,n){var i;if(void 0===t&&(t=[]),void 0===a&&(a=null),void 0===n&&(n=null),null==e){var l;if(!a)return null;if(a.errors)e=a.matches;else{if(!(null!=(l=n)&&l.v7_partialHydration&&0===t.length&&!a.initialized&&a.matches.length>0))return null;e=a.matches}}let o=e,c=null==(i=a)?void 0:i.errors;if(null!=c){let e=o.findIndex(e=>e.route.id&&void 0!==(null==c?void 0:c[e.route.id]));e>=0||(0,r.Oi)(!1),o=o.slice(0,Math.min(o.length,e+1))}let d=!1,u=-1;if(a&&n&&n.v7_partialHydration)for(let s=0;s<o.length;s++){let e=o[s];if((e.route.HydrateFallback||e.route.hydrateFallbackElement)&&(u=s),e.route.id){let{loaderData:t,errors:n}=a,s=e.route.loader&&void 0===t[e.route.id]&&(!n||void 0===n[e.route.id]);if(e.route.lazy||s){d=!0,o=u>=0?o.slice(0,u+1):[o[0]];break}}}return o.reduceRight((e,n,r)=>{let i,l=!1,h=null,p=null;var f;a&&(i=c&&n.route.id?c[n.route.id]:void 0,h=n.route.errorElement||N,d&&(u<0&&0===r?(f="route-fallback",!1||D[f]||(D[f]=!0),l=!0,p=null):u===r&&(l=!0,p=n.route.hydrateFallbackElement||null)));let m=t.concat(o.slice(0,r+1)),x=()=>{let t;return t=i?h:l?p:n.route.Component?s.createElement(n.route.Component,null):n.route.element?n.route.element:e,s.createElement(k,{match:n,routeContext:{outlet:e,matches:m,isDataRoute:null!=a},children:t})};return a&&(n.route.ErrorBoundary||n.route.errorElement||0===r)?s.createElement(S,{location:a.location,revalidation:a.revalidation,component:h,error:i,children:x(),routeContext:{outlet:null,matches:m,isDataRoute:!0}}):x()},null)}var C=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(C||{}),_=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(_||{});function L(e){let t=s.useContext(l);return t||(0,r.Oi)(!1),t}function T(e){let t=s.useContext(o);return t||(0,r.Oi)(!1),t}function E(e){let t=function(){let e=s.useContext(u);return e||(0,r.Oi)(!1),e}(),a=t.matches[t.matches.length-1];return a.route.id||(0,r.Oi)(!1),a.route.id}const D={};const P=(e,t,a)=>{};function R(e,t){void 0===(null==e?void 0:e.v7_startTransition)&&P("v7_startTransition","React Router will begin wrapping state updates in `React.startTransition` in v7","https://reactrouter.com/v6/upgrading/future#v7_starttransition"),void 0!==(null==e?void 0:e.v7_relativeSplatPath)||t&&void 0!==t.v7_relativeSplatPath||P("v7_relativeSplatPath","Relative route resolution within Splat routes is changing in v7","https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath"),t&&(void 0===t.v7_fetcherPersist&&P("v7_fetcherPersist","The persistence behavior of fetchers is changing in v7","https://reactrouter.com/v6/upgrading/future#v7_fetcherpersist"),void 0===t.v7_normalizeFormMethod&&P("v7_normalizeFormMethod","Casing of `formMethod` fields is being normalized to uppercase in v7","https://reactrouter.com/v6/upgrading/future#v7_normalizeformmethod"),void 0===t.v7_partialHydration&&P("v7_partialHydration","`RouterProvider` hydration behavior is changing in v7","https://reactrouter.com/v6/upgrading/future#v7_partialhydration"),void 0===t.v7_skipActionErrorRevalidation&&P("v7_skipActionErrorRevalidation","The revalidation behavior after 4xx/5xx `action` responses is changing in v7","https://reactrouter.com/v6/upgrading/future#v7_skipactionerrorrevalidation"))}(n||(n=a.t(s,2))).startTransition;function I(e){let{to:t,replace:a,state:n,relative:i}=e;f()||(0,r.Oi)(!1);let{future:l,static:o}=s.useContext(c),{matches:d}=s.useContext(u),{pathname:h}=m(),p=g(),x=(0,r.Gh)(t,(0,r.yD)(d,l.v7_relativeSplatPath),h,"path"===i),v=JSON.stringify(x);return s.useEffect(()=>p(JSON.parse(v),{replace:a,state:n,relative:i}),[p,v,i,a,n]),null}function B(e){return function(e){let t=s.useContext(u).outlet;return t?s.createElement(v.Provider,{value:e},t):t}(e.context)}function F(e){(0,r.Oi)(!1)}function O(e){let{basename:t="/",children:a=null,location:n,navigationType:l=r.rc.Pop,navigator:o,static:u=!1,future:h}=e;f()&&(0,r.Oi)(!1);let p=t.replace(/^\/*/,"/"),m=s.useMemo(()=>({basename:p,navigator:o,static:u,future:i({v7_relativeSplatPath:!1},h)}),[p,h,o,u]);"string"===typeof n&&(n=(0,r.Rr)(n));let{pathname:x="/",search:g="",hash:v="",state:y=null,key:b="default"}=n,j=s.useMemo(()=>{let e=(0,r.pb)(x,p);return null==e?null:{location:{pathname:e,search:g,hash:v,state:y,key:b},navigationType:l}},[p,x,g,v,y,b,l]);return null==j?null:s.createElement(c.Provider,{value:m},s.createElement(d.Provider,{children:a,value:j}))}function q(e){let{children:t,location:a}=e;return j(z(t),a)}new Promise(()=>{});s.Component;function z(e,t){void 0===t&&(t=[]);let a=[];return s.Children.forEach(e,(e,n)=>{if(!s.isValidElement(e))return;let i=[...t,n];if(e.type===s.Fragment)return void a.push.apply(a,z(e.props.children,i));e.type!==F&&(0,r.Oi)(!1),e.props.index&&e.props.children&&(0,r.Oi)(!1);let l={id:e.props.id||i.join("-"),caseSensitive:e.props.caseSensitive,element:e.props.element,Component:e.props.Component,index:e.props.index,path:e.props.path,loader:e.props.loader,action:e.props.action,errorElement:e.props.errorElement,ErrorBoundary:e.props.ErrorBoundary,hasErrorBoundary:null!=e.props.ErrorBoundary||null!=e.props.errorElement,shouldRevalidate:e.props.shouldRevalidate,handle:e.props.handle,lazy:e.props.lazy};e.props.children&&(l.children=z(e.props.children,i)),a.push(l)}),a}},3945:(e,t,a)=>{a.d(t,{A:()=>s});a(5043);var n=a(579);const s=()=>(0,n.jsxs)("div",{style:{padding:"50px",textAlign:"center",background:"red",color:"white",fontSize:"30px"},children:[(0,n.jsx)("h1",{children:"I AM THE PROBE"}),(0,n.jsx)("p",{children:"If you see this, we are editing the correct code."})]})},4202:(e,t)=>{var a=Symbol.for("react.element"),n=Symbol.for("react.portal"),s=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),l=Symbol.for("react.provider"),o=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),p=Symbol.iterator;var f={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m=Object.assign,x={};function g(e,t,a){this.props=e,this.context=t,this.refs=x,this.updater=a||f}function v(){}function y(e,t,a){this.props=e,this.context=t,this.refs=x,this.updater=a||f}g.prototype.isReactComponent={},g.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},g.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},v.prototype=g.prototype;var b=y.prototype=new v;b.constructor=y,m(b,g.prototype),b.isPureReactComponent=!0;var j=Array.isArray,w=Object.prototype.hasOwnProperty,N={current:null},S={key:!0,ref:!0,__self:!0,__source:!0};function k(e,t,n){var s,r={},i=null,l=null;if(null!=t)for(s in void 0!==t.ref&&(l=t.ref),void 0!==t.key&&(i=""+t.key),t)w.call(t,s)&&!S.hasOwnProperty(s)&&(r[s]=t[s]);var o=arguments.length-2;if(1===o)r.children=n;else if(1<o){for(var c=Array(o),d=0;d<o;d++)c[d]=arguments[d+2];r.children=c}if(e&&e.defaultProps)for(s in o=e.defaultProps)void 0===r[s]&&(r[s]=o[s]);return{$$typeof:a,type:e,key:i,ref:l,props:r,_owner:N.current}}function A(e){return"object"===typeof e&&null!==e&&e.$$typeof===a}var C=/\/+/g;function _(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(e){return t[e]})}(""+e.key):t.toString(36)}function L(e,t,s,r,i){var l=typeof e;"undefined"!==l&&"boolean"!==l||(e=null);var o=!1;if(null===e)o=!0;else switch(l){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case a:case n:o=!0}}if(o)return i=i(o=e),e=""===r?"."+_(o,0):r,j(i)?(s="",null!=e&&(s=e.replace(C,"$&/")+"/"),L(i,t,s,"",function(e){return e})):null!=i&&(A(i)&&(i=function(e,t){return{$$typeof:a,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(i,s+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(C,"$&/")+"/")+e)),t.push(i)),1;if(o=0,r=""===r?".":r+":",j(e))for(var c=0;c<e.length;c++){var d=r+_(l=e[c],c);o+=L(l,t,s,d,i)}else if(d=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=p&&e[p]||e["@@iterator"])?e:null}(e),"function"===typeof d)for(e=d.call(e),c=0;!(l=e.next()).done;)o+=L(l=l.value,t,s,d=r+_(l,c++),i);else if("object"===l)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function T(e,t,a){if(null==e)return e;var n=[],s=0;return L(e,n,"","",function(e){return t.call(a,e,s++)}),n}function E(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)},function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var D={current:null},P={transition:null},R={ReactCurrentDispatcher:D,ReactCurrentBatchConfig:P,ReactCurrentOwner:N};function I(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:T,forEach:function(e,t,a){T(e,function(){t.apply(this,arguments)},a)},count:function(e){var t=0;return T(e,function(){t++}),t},toArray:function(e){return T(e,function(e){return e})||[]},only:function(e){if(!A(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=g,t.Fragment=s,t.Profiler=i,t.PureComponent=y,t.StrictMode=r,t.Suspense=d,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=R,t.act=I,t.cloneElement=function(e,t,n){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var s=m({},e.props),r=e.key,i=e.ref,l=e._owner;if(null!=t){if(void 0!==t.ref&&(i=t.ref,l=N.current),void 0!==t.key&&(r=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(c in t)w.call(t,c)&&!S.hasOwnProperty(c)&&(s[c]=void 0===t[c]&&void 0!==o?o[c]:t[c])}var c=arguments.length-2;if(1===c)s.children=n;else if(1<c){o=Array(c);for(var d=0;d<c;d++)o[d]=arguments[d+2];s.children=o}return{$$typeof:a,type:e.type,key:r,ref:i,props:s,_owner:l}},t.createContext=function(e){return(e={$$typeof:o,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:l,_context:e},e.Consumer=e},t.createElement=k,t.createFactory=function(e){var t=k.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=A,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:E}},t.memo=function(e,t){return{$$typeof:u,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=P.transition;P.transition={};try{e()}finally{P.transition=t}},t.unstable_act=I,t.useCallback=function(e,t){return D.current.useCallback(e,t)},t.useContext=function(e){return D.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return D.current.useDeferredValue(e)},t.useEffect=function(e,t){return D.current.useEffect(e,t)},t.useId=function(){return D.current.useId()},t.useImperativeHandle=function(e,t,a){return D.current.useImperativeHandle(e,t,a)},t.useInsertionEffect=function(e,t){return D.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return D.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return D.current.useMemo(e,t)},t.useReducer=function(e,t,a){return D.current.useReducer(e,t,a)},t.useRef=function(e){return D.current.useRef(e)},t.useState=function(e){return D.current.useState(e)},t.useSyncExternalStore=function(e,t,a){return D.current.useSyncExternalStore(e,t,a)},t.useTransition=function(){return D.current.useTransition()},t.version="18.3.1"},4391:(e,t,a)=>{var n=a(7950);t.createRoot=n.createRoot,t.hydrateRoot=n.hydrateRoot},4760:(e,t,a)=>{a.d(t,{A:()=>r});a(5043);var n=a(5475),s=a(579);const r=()=>(0,s.jsxs)("div",{style:{padding:"20px",background:"white",height:"100vh"},children:[(0,s.jsx)("h1",{children:"Router Verification Page"}),(0,s.jsx)("p",{children:"If you see this, React Router is working correctly."}),(0,s.jsxs)("p",{children:["Current URL: ",window.location.href]}),(0,s.jsx)(n.N_,{to:"/accountant",style:{display:"block",marginTop:"20px",color:"blue"},children:"Go Back to Accountant Dashboard"})]})},4980:(e,t,a)=>{a.d(t,{A:()=>r});var n=a(2284);function s(e){var t=function(e,t){if("object"!=(0,n.A)(e)||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var s=a.call(e,t||"default");if("object"!=(0,n.A)(s))return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==(0,n.A)(t)?t:t+""}function r(e,t,a){return(t=s(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}},5043:(e,t,a)=>{e.exports=a(4202)},5475:(e,t,a)=>{var n,s;a.d(t,{Kd:()=>m,N_:()=>v,k2:()=>y});var r=a(5043),i=a(7950),l=a(3216),o=a(1387);function c(){return c=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},c.apply(this,arguments)}function d(e,t){if(null==e)return{};var a,n,s={},r=Object.keys(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||(s[a]=e[a]);return s}new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);const u=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],h=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"];try{window.__reactRouterVersion="6"}catch(N){}const p=r.createContext({isTransitioning:!1});new Map;const f=(n||(n=a.t(r,2))).startTransition;(s||(s=a.t(i,2))).flushSync,(n||(n=a.t(r,2))).useId;function m(e){let{basename:t,children:a,future:n,window:s}=e,i=r.useRef();null==i.current&&(i.current=(0,o.zR)({window:s,v5Compat:!0}));let c=i.current,[d,u]=r.useState({action:c.action,location:c.location}),{v7_startTransition:h}=n||{},p=r.useCallback(e=>{h&&f?f(()=>u(e)):u(e)},[u,h]);return r.useLayoutEffect(()=>c.listen(p),[c,p]),r.useEffect(()=>(0,l.V8)(n),[n]),r.createElement(l.Ix,{basename:t,children:a,location:d.location,navigationType:d.action,navigator:c,future:n})}const x="undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof window.document.createElement,g=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,v=r.forwardRef(function(e,t){let a,{onClick:n,relative:s,reloadDocument:i,replace:h,state:p,target:f,to:m,preventScrollReset:v,viewTransition:y}=e,b=d(e,u),{basename:j}=r.useContext(l.jb),w=!1;if("string"===typeof m&&g.test(m)&&(a=m,x))try{let e=new URL(window.location.href),t=m.startsWith("//")?new URL(e.protocol+m):new URL(m),a=(0,o.pb)(t.pathname,j);t.origin===e.origin&&null!=a?m=a+t.search+t.hash:w=!0}catch(N){}let S=(0,l.$P)(m,{relative:s}),k=function(e,t){let{target:a,replace:n,state:s,preventScrollReset:i,relative:c,viewTransition:d}=void 0===t?{}:t,u=(0,l.Zp)(),h=(0,l.zy)(),p=(0,l.x$)(e,{relative:c});return r.useCallback(t=>{if(function(e,t){return 0===e.button&&(!t||"_self"===t)&&!function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e)}(t,a)){t.preventDefault();let a=void 0!==n?n:(0,o.AO)(h)===(0,o.AO)(p);u(e,{replace:a,state:s,preventScrollReset:i,relative:c,viewTransition:d})}},[h,u,p,n,s,a,e,i,c,d])}(m,{replace:h,state:p,target:f,preventScrollReset:v,relative:s,viewTransition:y});return r.createElement("a",c({},b,{href:a||S,onClick:w||i?n:function(e){n&&n(e),e.defaultPrevented||k(e)},ref:t,target:f}))});const y=r.forwardRef(function(e,t){let{"aria-current":a="page",caseSensitive:n=!1,className:s="",end:i=!1,style:u,to:f,viewTransition:m,children:x}=e,g=d(e,h),y=(0,l.x$)(f,{relative:g.relative}),j=(0,l.zy)(),N=r.useContext(l.Rq),{navigator:S,basename:k}=r.useContext(l.jb),A=null!=N&&function(e,t){void 0===t&&(t={});let a=r.useContext(p);null==a&&(0,o.Oi)(!1);let{basename:n}=w(b.useViewTransitionState),s=(0,l.x$)(e,{relative:t.relative});if(!a.isTransitioning)return!1;let i=(0,o.pb)(a.currentLocation.pathname,n)||a.currentLocation.pathname,c=(0,o.pb)(a.nextLocation.pathname,n)||a.nextLocation.pathname;return null!=(0,o.B6)(s.pathname,c)||null!=(0,o.B6)(s.pathname,i)}(y)&&!0===m,C=S.encodeLocation?S.encodeLocation(y).pathname:y.pathname,_=j.pathname,L=N&&N.navigation&&N.navigation.location?N.navigation.location.pathname:null;n||(_=_.toLowerCase(),L=L?L.toLowerCase():null,C=C.toLowerCase()),L&&k&&(L=(0,o.pb)(L,k)||L);const T="/"!==C&&C.endsWith("/")?C.length-1:C.length;let E,D=_===C||!i&&_.startsWith(C)&&"/"===_.charAt(T),P=null!=L&&(L===C||!i&&L.startsWith(C)&&"/"===L.charAt(C.length)),R={isActive:D,isPending:P,isTransitioning:A},I=D?a:void 0;E="function"===typeof s?s(R):[s,D?"active":null,P?"pending":null,A?"transitioning":null].filter(Boolean).join(" ");let B="function"===typeof u?u(R):u;return r.createElement(v,c({},g,{"aria-current":I,className:E,ref:t,style:B,to:f,viewTransition:m}),"function"===typeof x?x(R):x)});var b,j;function w(e){let t=r.useContext(l.sp);return t||(0,o.Oi)(!1),t}(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(b||(b={})),function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"}(j||(j={}))},7234:(e,t)=>{function a(e,t){var a=e.length;e.push(t);e:for(;0<a;){var n=a-1>>>1,s=e[n];if(!(0<r(s,t)))break e;e[n]=t,e[a]=s,a=n}}function n(e){return 0===e.length?null:e[0]}function s(e){if(0===e.length)return null;var t=e[0],a=e.pop();if(a!==t){e[0]=a;e:for(var n=0,s=e.length,i=s>>>1;n<i;){var l=2*(n+1)-1,o=e[l],c=l+1,d=e[c];if(0>r(o,a))c<s&&0>r(d,o)?(e[n]=d,e[c]=a,n=c):(e[n]=o,e[l]=a,n=l);else{if(!(c<s&&0>r(d,a)))break e;e[n]=d,e[c]=a,n=c}}}return t}function r(e,t){var a=e.sortIndex-t.sortIndex;return 0!==a?a:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var i=performance;t.unstable_now=function(){return i.now()}}else{var l=Date,o=l.now();t.unstable_now=function(){return l.now()-o}}var c=[],d=[],u=1,h=null,p=3,f=!1,m=!1,x=!1,g="function"===typeof setTimeout?setTimeout:null,v="function"===typeof clearTimeout?clearTimeout:null,y="undefined"!==typeof setImmediate?setImmediate:null;function b(e){for(var t=n(d);null!==t;){if(null===t.callback)s(d);else{if(!(t.startTime<=e))break;s(d),t.sortIndex=t.expirationTime,a(c,t)}t=n(d)}}function j(e){if(x=!1,b(e),!m)if(null!==n(c))m=!0,P(w);else{var t=n(d);null!==t&&R(j,t.startTime-e)}}function w(e,a){m=!1,x&&(x=!1,v(A),A=-1),f=!0;var r=p;try{for(b(a),h=n(c);null!==h&&(!(h.expirationTime>a)||e&&!L());){var i=h.callback;if("function"===typeof i){h.callback=null,p=h.priorityLevel;var l=i(h.expirationTime<=a);a=t.unstable_now(),"function"===typeof l?h.callback=l:h===n(c)&&s(c),b(a)}else s(c);h=n(c)}if(null!==h)var o=!0;else{var u=n(d);null!==u&&R(j,u.startTime-a),o=!1}return o}finally{h=null,p=r,f=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var N,S=!1,k=null,A=-1,C=5,_=-1;function L(){return!(t.unstable_now()-_<C)}function T(){if(null!==k){var e=t.unstable_now();_=e;var a=!0;try{a=k(!0,e)}finally{a?N():(S=!1,k=null)}}else S=!1}if("function"===typeof y)N=function(){y(T)};else if("undefined"!==typeof MessageChannel){var E=new MessageChannel,D=E.port2;E.port1.onmessage=T,N=function(){D.postMessage(null)}}else N=function(){g(T,0)};function P(e){k=e,S||(S=!0,N())}function R(e,a){A=g(function(){e(t.unstable_now())},a)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){m||f||(m=!0,P(w))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return n(c)},t.unstable_next=function(e){switch(p){case 1:case 2:case 3:var t=3;break;default:t=p}var a=p;p=t;try{return e()}finally{p=a}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var a=p;p=e;try{return t()}finally{p=a}},t.unstable_scheduleCallback=function(e,s,r){var i=t.unstable_now();switch("object"===typeof r&&null!==r?r="number"===typeof(r=r.delay)&&0<r?i+r:i:r=i,e){case 1:var l=-1;break;case 2:l=250;break;case 5:l=1073741823;break;case 4:l=1e4;break;default:l=5e3}return e={id:u++,callback:s,priorityLevel:e,startTime:r,expirationTime:l=r+l,sortIndex:-1},r>i?(e.sortIndex=r,a(d,e),null===n(c)&&e===n(d)&&(x?(v(A),A=-1):x=!0,R(j,r-i))):(e.sortIndex=l,a(c,e),m||f||(m=!0,P(w))),e},t.unstable_shouldYield=L,t.unstable_wrapCallback=function(e){var t=p;return function(){var a=p;p=t;try{return e.apply(this,arguments)}finally{p=a}}}},7950:(e,t,a)=>{!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=a(2730)},8853:(e,t,a)=>{e.exports=a(7234)},9379:(e,t,a)=>{a.d(t,{A:()=>r});var n=a(4980);function s(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}function r(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?s(Object(a),!0).forEach(function(t){(0,n.A)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):s(Object(a)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}},9432:(e,t,a)=>{a.d(t,{A:()=>l});var n=a(5043),s=a(9722),r=a(579);const i="http://localhost:5000";function l(){const[e,t]=(0,n.useState)(null),[a,l]=(0,n.useState)(""),[o,c]=(0,n.useState)(""),[d,u]=(0,n.useState)(!1),h=["image/jpeg","image/png","image/gif","image/webp","application/pdf"];return(0,r.jsxs)("div",{style:{padding:"1rem"},children:[(0,r.jsx)("h2",{children:"Upload Document"}),(0,r.jsx)("p",{style:{color:"#555"},children:"Allowed: JPG, PNG, GIF, WEBP, PDF (max 10MB)."}),(0,r.jsxs)("form",{onSubmit:async a=>{if(a.preventDefault(),l(""),c(""),e)try{u(!0);const a=localStorage.getItem("token"),n=new FormData;n.append("file",e),await s.A.post("".concat(i,"/api/uploads/document"),n,{headers:{Authorization:a?"Bearer ".concat(a):"","Content-Type":"multipart/form-data"}}),c("Upload successful"),t(null)}catch(o){var n,r;const e=(null===o||void 0===o||null===(n=o.response)||void 0===n||null===(r=n.data)||void 0===r?void 0:r.message)||"Upload failed";l(e)}finally{u(!1)}else l("Please choose a file")},children:[(0,r.jsx)("input",{type:"file",accept:".jpg,.jpeg,.png,.gif,.webp,.pdf",onChange:e=>{var a;l(""),c("");const n=null===(a=e.target.files)||void 0===a?void 0:a[0];if(n)return h.includes(n.type)?n.size>10485760?(l("File too large. Max 10 MB"),void t(null)):void t(n):(l("Invalid file type. Allowed: JPG, PNG, GIF, WEBP, PDF"),void t(null));t(null)}}),(0,r.jsx)("div",{style:{marginTop:"0.75rem"},children:(0,r.jsx)("button",{disabled:d,type:"submit",className:"btn btn-sm btn-primary",children:d?"Uploading...":"Upload"})})]}),a&&(0,r.jsx)("p",{style:{color:"#c0392b",marginTop:"0.75rem"},children:a}),o&&(0,r.jsx)("p",{style:{color:"#2ecc71",marginTop:"0.75rem"},children:o})]})}},9722:(e,t,a)=>{a.d(t,{A:()=>Ct});var n={};function s(e,t){return function(){return e.apply(t,arguments)}}a.r(n),a.d(n,{hasBrowserEnv:()=>de,hasStandardBrowserEnv:()=>he,hasStandardBrowserWebWorkerEnv:()=>pe,navigator:()=>ue,origin:()=>fe});const{toString:r}=Object.prototype,{getPrototypeOf:i}=Object,{iterator:l,toStringTag:o}=Symbol,c=(d=Object.create(null),e=>{const t=r.call(e);return d[t]||(d[t]=t.slice(8,-1).toLowerCase())});var d;const u=e=>(e=e.toLowerCase(),t=>c(t)===e),h=e=>t=>typeof t===e,{isArray:p}=Array,f=h("undefined");function m(e){return null!==e&&!f(e)&&null!==e.constructor&&!f(e.constructor)&&v(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const x=u("ArrayBuffer");const g=h("string"),v=h("function"),y=h("number"),b=e=>null!==e&&"object"===typeof e,j=e=>{if("object"!==c(e))return!1;const t=i(e);return(null===t||t===Object.prototype||null===Object.getPrototypeOf(t))&&!(o in e)&&!(l in e)},w=u("Date"),N=u("File"),S=u("Blob"),k=u("FileList"),A=u("URLSearchParams"),[C,_,L,T]=["ReadableStream","Request","Response","Headers"].map(u);function E(e,t){let a,n,{allOwnKeys:s=!1}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(null!==e&&"undefined"!==typeof e)if("object"!==typeof e&&(e=[e]),p(e))for(a=0,n=e.length;a<n;a++)t.call(null,e[a],a,e);else{if(m(e))return;const n=s?Object.getOwnPropertyNames(e):Object.keys(e),r=n.length;let i;for(a=0;a<r;a++)i=n[a],t.call(null,e[i],i,e)}}function D(e,t){if(m(e))return null;t=t.toLowerCase();const a=Object.keys(e);let n,s=a.length;for(;s-- >0;)if(n=a[s],t===n.toLowerCase())return n;return null}const P="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:"undefined"!==typeof window?window:global,R=e=>!f(e)&&e!==P;const I=(B="undefined"!==typeof Uint8Array&&i(Uint8Array),e=>B&&e instanceof B);var B;const F=u("HTMLFormElement"),O=(e=>{let{hasOwnProperty:t}=e;return(e,a)=>t.call(e,a)})(Object.prototype),q=u("RegExp"),z=(e,t)=>{const a=Object.getOwnPropertyDescriptors(e),n={};E(a,(a,s)=>{let r;!1!==(r=t(a,s,e))&&(n[s]=r||a)}),Object.defineProperties(e,n)};const M=u("AsyncFunction"),U=((e,t)=>{return e?setImmediate:t?(a="axios@".concat(Math.random()),n=[],P.addEventListener("message",e=>{let{source:t,data:s}=e;t===P&&s===a&&n.length&&n.shift()()},!1),e=>{n.push(e),P.postMessage(a,"*")}):e=>setTimeout(e);var a,n})("function"===typeof setImmediate,v(P.postMessage)),W="undefined"!==typeof queueMicrotask?queueMicrotask.bind(P):"undefined"!==typeof process&&process.nextTick||U,H={isArray:p,isArrayBuffer:x,isBuffer:m,isFormData:e=>{let t;return e&&("function"===typeof FormData&&e instanceof FormData||v(e.append)&&("formdata"===(t=c(e))||"object"===t&&v(e.toString)&&"[object FormData]"===e.toString()))},isArrayBufferView:function(e){let t;return t="undefined"!==typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&x(e.buffer),t},isString:g,isNumber:y,isBoolean:e=>!0===e||!1===e,isObject:b,isPlainObject:j,isEmptyObject:e=>{if(!b(e)||m(e))return!1;try{return 0===Object.keys(e).length&&Object.getPrototypeOf(e)===Object.prototype}catch(t){return!1}},isReadableStream:C,isRequest:_,isResponse:L,isHeaders:T,isUndefined:f,isDate:w,isFile:N,isBlob:S,isRegExp:q,isFunction:v,isStream:e=>b(e)&&v(e.pipe),isURLSearchParams:A,isTypedArray:I,isFileList:k,forEach:E,merge:function e(){const{caseless:t,skipUndefined:a}=R(this)&&this||{},n={},s=(s,r)=>{const i=t&&D(n,r)||r;j(n[i])&&j(s)?n[i]=e(n[i],s):j(s)?n[i]=e({},s):p(s)?n[i]=s.slice():a&&f(s)||(n[i]=s)};for(let r=0,i=arguments.length;r<i;r++)arguments[r]&&E(arguments[r],s);return n},extend:function(e,t,a){let{allOwnKeys:n}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return E(t,(t,n)=>{a&&v(t)?e[n]=s(t,a):e[n]=t},{allOwnKeys:n}),e},trim:e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),stripBOM:e=>(65279===e.charCodeAt(0)&&(e=e.slice(1)),e),inherits:(e,t,a,n)=>{e.prototype=Object.create(t.prototype,n),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),a&&Object.assign(e.prototype,a)},toFlatObject:(e,t,a,n)=>{let s,r,l;const o={};if(t=t||{},null==e)return t;do{for(s=Object.getOwnPropertyNames(e),r=s.length;r-- >0;)l=s[r],n&&!n(l,e,t)||o[l]||(t[l]=e[l],o[l]=!0);e=!1!==a&&i(e)}while(e&&(!a||a(e,t))&&e!==Object.prototype);return t},kindOf:c,kindOfTest:u,endsWith:(e,t,a)=>{e=String(e),(void 0===a||a>e.length)&&(a=e.length),a-=t.length;const n=e.indexOf(t,a);return-1!==n&&n===a},toArray:e=>{if(!e)return null;if(p(e))return e;let t=e.length;if(!y(t))return null;const a=new Array(t);for(;t-- >0;)a[t]=e[t];return a},forEachEntry:(e,t)=>{const a=(e&&e[l]).call(e);let n;for(;(n=a.next())&&!n.done;){const a=n.value;t.call(e,a[0],a[1])}},matchAll:(e,t)=>{let a;const n=[];for(;null!==(a=e.exec(t));)n.push(a);return n},isHTMLForm:F,hasOwnProperty:O,hasOwnProp:O,reduceDescriptors:z,freezeMethods:e=>{z(e,(t,a)=>{if(v(e)&&-1!==["arguments","caller","callee"].indexOf(a))return!1;const n=e[a];v(n)&&(t.enumerable=!1,"writable"in t?t.writable=!1:t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+a+"'")}))})},toObjectSet:(e,t)=>{const a={},n=e=>{e.forEach(e=>{a[e]=!0})};return p(e)?n(e):n(String(e).split(t)),a},toCamelCase:e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(e,t,a){return t.toUpperCase()+a}),noop:()=>{},toFiniteNumber:(e,t)=>null!=e&&Number.isFinite(e=+e)?e:t,findKey:D,global:P,isContextDefined:R,isSpecCompliantForm:function(e){return!!(e&&v(e.append)&&"FormData"===e[o]&&e[l])},toJSONObject:e=>{const t=new Array(10),a=(e,n)=>{if(b(e)){if(t.indexOf(e)>=0)return;if(m(e))return e;if(!("toJSON"in e)){t[n]=e;const s=p(e)?[]:{};return E(e,(e,t)=>{const r=a(e,n+1);!f(r)&&(s[t]=r)}),t[n]=void 0,s}}return e};return a(e,0)},isAsyncFn:M,isThenable:e=>e&&(b(e)||v(e))&&v(e.then)&&v(e.catch),setImmediate:U,asap:W,isIterable:e=>null!=e&&v(e[l])};function V(e,t,a,n,s){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack,this.message=e,this.name="AxiosError",t&&(this.code=t),a&&(this.config=a),n&&(this.request=n),s&&(this.response=s,this.status=s.status?s.status:null)}H.inherits(V,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:H.toJSONObject(this.config),code:this.code,status:this.status}}});const G=V.prototype,J={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{J[e]={value:e}}),Object.defineProperties(V,J),Object.defineProperty(G,"isAxiosError",{value:!0}),V.from=(e,t,a,n,s,r)=>{const i=Object.create(G);H.toFlatObject(e,i,function(e){return e!==Error.prototype},e=>"isAxiosError"!==e);const l=e&&e.message?e.message:"Error",o=null==t&&e?e.code:t;return V.call(i,l,o,a,n,s),e&&null==i.cause&&Object.defineProperty(i,"cause",{value:e,configurable:!0}),i.name=e&&e.name||"Error",r&&Object.assign(i,r),i};const Y=V;function K(e){return H.isPlainObject(e)||H.isArray(e)}function Q(e){return H.endsWith(e,"[]")?e.slice(0,-2):e}function $(e,t,a){return e?e.concat(t).map(function(e,t){return e=Q(e),!a&&t?"["+e+"]":e}).join(a?".":""):t}const X=H.toFlatObject(H,{},null,function(e){return/^is[A-Z]/.test(e)});const Z=function(e,t,a){if(!H.isObject(e))throw new TypeError("target must be an object");t=t||new FormData;const n=(a=H.toFlatObject(a,{metaTokens:!0,dots:!1,indexes:!1},!1,function(e,t){return!H.isUndefined(t[e])})).metaTokens,s=a.visitor||c,r=a.dots,i=a.indexes,l=(a.Blob||"undefined"!==typeof Blob&&Blob)&&H.isSpecCompliantForm(t);if(!H.isFunction(s))throw new TypeError("visitor must be a function");function o(e){if(null===e)return"";if(H.isDate(e))return e.toISOString();if(H.isBoolean(e))return e.toString();if(!l&&H.isBlob(e))throw new Y("Blob is not supported. Use a Buffer instead.");return H.isArrayBuffer(e)||H.isTypedArray(e)?l&&"function"===typeof Blob?new Blob([e]):Buffer.from(e):e}function c(e,a,s){let l=e;if(e&&!s&&"object"===typeof e)if(H.endsWith(a,"{}"))a=n?a:a.slice(0,-2),e=JSON.stringify(e);else if(H.isArray(e)&&function(e){return H.isArray(e)&&!e.some(K)}(e)||(H.isFileList(e)||H.endsWith(a,"[]"))&&(l=H.toArray(e)))return a=Q(a),l.forEach(function(e,n){!H.isUndefined(e)&&null!==e&&t.append(!0===i?$([a],n,r):null===i?a:a+"[]",o(e))}),!1;return!!K(e)||(t.append($(s,a,r),o(e)),!1)}const d=[],u=Object.assign(X,{defaultVisitor:c,convertValue:o,isVisitable:K});if(!H.isObject(e))throw new TypeError("data must be an object");return function e(a,n){if(!H.isUndefined(a)){if(-1!==d.indexOf(a))throw Error("Circular reference detected in "+n.join("."));d.push(a),H.forEach(a,function(a,r){!0===(!(H.isUndefined(a)||null===a)&&s.call(t,a,H.isString(r)?r.trim():r,n,u))&&e(a,n?n.concat(r):[r])}),d.pop()}}(e),t};function ee(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(e){return t[e]})}function te(e,t){this._pairs=[],e&&Z(e,this,t)}const ae=te.prototype;ae.append=function(e,t){this._pairs.push([e,t])},ae.toString=function(e){const t=e?function(t){return e.call(this,t,ee)}:ee;return this._pairs.map(function(e){return t(e[0])+"="+t(e[1])},"").join("&")};const ne=te;function se(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function re(e,t,a){if(!t)return e;const n=a&&a.encode||se;H.isFunction(a)&&(a={serialize:a});const s=a&&a.serialize;let r;if(r=s?s(t,a):H.isURLSearchParams(t)?t.toString():new ne(t,a).toString(n),r){const t=e.indexOf("#");-1!==t&&(e=e.slice(0,t)),e+=(-1===e.indexOf("?")?"?":"&")+r}return e}const ie=class{constructor(){this.handlers=[]}use(e,t,a){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!a&&a.synchronous,runWhen:a?a.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){H.forEach(this.handlers,function(t){null!==t&&e(t)})}},le={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1};var oe=a(9379);const ce={isBrowser:!0,classes:{URLSearchParams:"undefined"!==typeof URLSearchParams?URLSearchParams:ne,FormData:"undefined"!==typeof FormData?FormData:null,Blob:"undefined"!==typeof Blob?Blob:null},protocols:["http","https","file","blob","url","data"]},de="undefined"!==typeof window&&"undefined"!==typeof document,ue="object"===typeof navigator&&navigator||void 0,he=de&&(!ue||["ReactNative","NativeScript","NS"].indexOf(ue.product)<0),pe="undefined"!==typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&"function"===typeof self.importScripts,fe=de&&window.location.href||"http://localhost",me=(0,oe.A)((0,oe.A)({},n),ce);const xe=function(e){function t(e,a,n,s){let r=e[s++];if("__proto__"===r)return!0;const i=Number.isFinite(+r),l=s>=e.length;if(r=!r&&H.isArray(n)?n.length:r,l)return H.hasOwnProp(n,r)?n[r]=[n[r],a]:n[r]=a,!i;n[r]&&H.isObject(n[r])||(n[r]=[]);return t(e,a,n[r],s)&&H.isArray(n[r])&&(n[r]=function(e){const t={},a=Object.keys(e);let n;const s=a.length;let r;for(n=0;n<s;n++)r=a[n],t[r]=e[r];return t}(n[r])),!i}if(H.isFormData(e)&&H.isFunction(e.entries)){const a={};return H.forEachEntry(e,(e,n)=>{t(function(e){return H.matchAll(/\w+|\[(\w*)]/g,e).map(e=>"[]"===e[0]?"":e[1]||e[0])}(e),n,a,0)}),a}return null};const ge={transitional:le,adapter:["xhr","http","fetch"],transformRequest:[function(e,t){const a=t.getContentType()||"",n=a.indexOf("application/json")>-1,s=H.isObject(e);s&&H.isHTMLForm(e)&&(e=new FormData(e));if(H.isFormData(e))return n?JSON.stringify(xe(e)):e;if(H.isArrayBuffer(e)||H.isBuffer(e)||H.isStream(e)||H.isFile(e)||H.isBlob(e)||H.isReadableStream(e))return e;if(H.isArrayBufferView(e))return e.buffer;if(H.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let r;if(s){if(a.indexOf("application/x-www-form-urlencoded")>-1)return function(e,t){return Z(e,new me.classes.URLSearchParams,(0,oe.A)({visitor:function(e,t,a,n){return me.isNode&&H.isBuffer(e)?(this.append(t,e.toString("base64")),!1):n.defaultVisitor.apply(this,arguments)}},t))}(e,this.formSerializer).toString();if((r=H.isFileList(e))||a.indexOf("multipart/form-data")>-1){const t=this.env&&this.env.FormData;return Z(r?{"files[]":e}:e,t&&new t,this.formSerializer)}}return s||n?(t.setContentType("application/json",!1),function(e,t,a){if(H.isString(e))try{return(t||JSON.parse)(e),H.trim(e)}catch(n){if("SyntaxError"!==n.name)throw n}return(a||JSON.stringify)(e)}(e)):e}],transformResponse:[function(e){const t=this.transitional||ge.transitional,a=t&&t.forcedJSONParsing,n="json"===this.responseType;if(H.isResponse(e)||H.isReadableStream(e))return e;if(e&&H.isString(e)&&(a&&!this.responseType||n)){const a=!(t&&t.silentJSONParsing)&&n;try{return JSON.parse(e,this.parseReviver)}catch(s){if(a){if("SyntaxError"===s.name)throw Y.from(s,Y.ERR_BAD_RESPONSE,this,null,this.response);throw s}}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:me.classes.FormData,Blob:me.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};H.forEach(["delete","get","head","post","put","patch"],e=>{ge.headers[e]={}});const ve=ge,ye=H.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),be=Symbol("internals");function je(e){return e&&String(e).trim().toLowerCase()}function we(e){return!1===e||null==e?e:H.isArray(e)?e.map(we):String(e)}function Ne(e,t,a,n,s){return H.isFunction(n)?n.call(this,t,a):(s&&(t=a),H.isString(t)?H.isString(n)?-1!==t.indexOf(n):H.isRegExp(n)?n.test(t):void 0:void 0)}class Se{constructor(e){e&&this.set(e)}set(e,t,a){const n=this;function s(e,t,a){const s=je(t);if(!s)throw new Error("header name must be a non-empty string");const r=H.findKey(n,s);(!r||void 0===n[r]||!0===a||void 0===a&&!1!==n[r])&&(n[r||t]=we(e))}const r=(e,t)=>H.forEach(e,(e,a)=>s(e,a,t));if(H.isPlainObject(e)||e instanceof this.constructor)r(e,t);else if(H.isString(e)&&(e=e.trim())&&!/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim()))r((e=>{const t={};let a,n,s;return e&&e.split("\n").forEach(function(e){s=e.indexOf(":"),a=e.substring(0,s).trim().toLowerCase(),n=e.substring(s+1).trim(),!a||t[a]&&ye[a]||("set-cookie"===a?t[a]?t[a].push(n):t[a]=[n]:t[a]=t[a]?t[a]+", "+n:n)}),t})(e),t);else if(H.isObject(e)&&H.isIterable(e)){let a,n,s={};for(const t of e){if(!H.isArray(t))throw TypeError("Object iterator must return a key-value pair");s[n=t[0]]=(a=s[n])?H.isArray(a)?[...a,t[1]]:[a,t[1]]:t[1]}r(s,t)}else null!=e&&s(t,e,a);return this}get(e,t){if(e=je(e)){const a=H.findKey(this,e);if(a){const e=this[a];if(!t)return e;if(!0===t)return function(e){const t=Object.create(null),a=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=a.exec(e);)t[n[1]]=n[2];return t}(e);if(H.isFunction(t))return t.call(this,e,a);if(H.isRegExp(t))return t.exec(e);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=je(e)){const a=H.findKey(this,e);return!(!a||void 0===this[a]||t&&!Ne(0,this[a],a,t))}return!1}delete(e,t){const a=this;let n=!1;function s(e){if(e=je(e)){const s=H.findKey(a,e);!s||t&&!Ne(0,a[s],s,t)||(delete a[s],n=!0)}}return H.isArray(e)?e.forEach(s):s(e),n}clear(e){const t=Object.keys(this);let a=t.length,n=!1;for(;a--;){const s=t[a];e&&!Ne(0,this[s],s,e,!0)||(delete this[s],n=!0)}return n}normalize(e){const t=this,a={};return H.forEach(this,(n,s)=>{const r=H.findKey(a,s);if(r)return t[r]=we(n),void delete t[s];const i=e?function(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,t,a)=>t.toUpperCase()+a)}(s):String(s).trim();i!==s&&delete t[s],t[i]=we(n),a[i]=!0}),this}concat(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return this.constructor.concat(this,...t)}toJSON(e){const t=Object.create(null);return H.forEach(this,(a,n)=>{null!=a&&!1!==a&&(t[n]=e&&H.isArray(a)?a.join(", "):a)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(e=>{let[t,a]=e;return t+": "+a}).join("\n")}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e){const t=new this(e);for(var a=arguments.length,n=new Array(a>1?a-1:0),s=1;s<a;s++)n[s-1]=arguments[s];return n.forEach(e=>t.set(e)),t}static accessor(e){const t=(this[be]=this[be]={accessors:{}}).accessors,a=this.prototype;function n(e){const n=je(e);t[n]||(!function(e,t){const a=H.toCamelCase(" "+t);["get","set","has"].forEach(n=>{Object.defineProperty(e,n+a,{value:function(e,a,s){return this[n].call(this,t,e,a,s)},configurable:!0})})}(a,e),t[n]=!0)}return H.isArray(e)?e.forEach(n):n(e),this}}Se.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),H.reduceDescriptors(Se.prototype,(e,t)=>{let{value:a}=e,n=t[0].toUpperCase()+t.slice(1);return{get:()=>a,set(e){this[n]=e}}}),H.freezeMethods(Se);const ke=Se;function Ae(e,t){const a=this||ve,n=t||a,s=ke.from(n.headers);let r=n.data;return H.forEach(e,function(e){r=e.call(a,r,s.normalize(),t?t.status:void 0)}),s.normalize(),r}function Ce(e){return!(!e||!e.__CANCEL__)}function _e(e,t,a){Y.call(this,null==e?"canceled":e,Y.ERR_CANCELED,t,a),this.name="CanceledError"}H.inherits(_e,Y,{__CANCEL__:!0});const Le=_e;function Te(e,t,a){const n=a.config.validateStatus;a.status&&n&&!n(a.status)?t(new Y("Request failed with status code "+a.status,[Y.ERR_BAD_REQUEST,Y.ERR_BAD_RESPONSE][Math.floor(a.status/100)-4],a.config,a.request,a)):e(a)}const Ee=function(e,t){e=e||10;const a=new Array(e),n=new Array(e);let s,r=0,i=0;return t=void 0!==t?t:1e3,function(l){const o=Date.now(),c=n[i];s||(s=o),a[r]=l,n[r]=o;let d=i,u=0;for(;d!==r;)u+=a[d++],d%=e;if(r=(r+1)%e,r===i&&(i=(i+1)%e),o-s<t)return;const h=c&&o-c;return h?Math.round(1e3*u/h):void 0}};const De=function(e,t){let a,n,s=0,r=1e3/t;const i=function(t){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Date.now();s=r,a=null,n&&(clearTimeout(n),n=null),e(...t)};return[function(){const e=Date.now(),t=e-s;for(var l=arguments.length,o=new Array(l),c=0;c<l;c++)o[c]=arguments[c];t>=r?i(o,e):(a=o,n||(n=setTimeout(()=>{n=null,i(a)},r-t)))},()=>a&&i(a)]},Pe=function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3,n=0;const s=Ee(50,250);return De(a=>{const r=a.loaded,i=a.lengthComputable?a.total:void 0,l=r-n,o=s(l);n=r;e({loaded:r,total:i,progress:i?r/i:void 0,bytes:l,rate:o||void 0,estimated:o&&i&&r<=i?(i-r)/o:void 0,event:a,lengthComputable:null!=i,[t?"download":"upload"]:!0})},a)},Re=(e,t)=>{const a=null!=e;return[n=>t[0]({lengthComputable:a,total:e,loaded:n}),t[1]]},Ie=e=>function(){for(var t=arguments.length,a=new Array(t),n=0;n<t;n++)a[n]=arguments[n];return H.asap(()=>e(...a))},Be=me.hasStandardBrowserEnv?((e,t)=>a=>(a=new URL(a,me.origin),e.protocol===a.protocol&&e.host===a.host&&(t||e.port===a.port)))(new URL(me.origin),me.navigator&&/(msie|trident)/i.test(me.navigator.userAgent)):()=>!0,Fe=me.hasStandardBrowserEnv?{write(e,t,a,n,s,r){const i=[e+"="+encodeURIComponent(t)];H.isNumber(a)&&i.push("expires="+new Date(a).toGMTString()),H.isString(n)&&i.push("path="+n),H.isString(s)&&i.push("domain="+s),!0===r&&i.push("secure"),document.cookie=i.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read:()=>null,remove(){}};function Oe(e,t,a){let n=!/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t);return e&&(n||0==a)?function(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}(e,t):t}const qe=e=>e instanceof ke?(0,oe.A)({},e):e;function ze(e,t){t=t||{};const a={};function n(e,t,a,n){return H.isPlainObject(e)&&H.isPlainObject(t)?H.merge.call({caseless:n},e,t):H.isPlainObject(t)?H.merge({},t):H.isArray(t)?t.slice():t}function s(e,t,a,s){return H.isUndefined(t)?H.isUndefined(e)?void 0:n(void 0,e,0,s):n(e,t,0,s)}function r(e,t){if(!H.isUndefined(t))return n(void 0,t)}function i(e,t){return H.isUndefined(t)?H.isUndefined(e)?void 0:n(void 0,e):n(void 0,t)}function l(a,s,r){return r in t?n(a,s):r in e?n(void 0,a):void 0}const o={url:r,method:r,data:r,baseURL:i,transformRequest:i,transformResponse:i,paramsSerializer:i,timeout:i,timeoutMessage:i,withCredentials:i,withXSRFToken:i,adapter:i,responseType:i,xsrfCookieName:i,xsrfHeaderName:i,onUploadProgress:i,onDownloadProgress:i,decompress:i,maxContentLength:i,maxBodyLength:i,beforeRedirect:i,transport:i,httpAgent:i,httpsAgent:i,cancelToken:i,socketPath:i,responseEncoding:i,validateStatus:l,headers:(e,t,a)=>s(qe(e),qe(t),0,!0)};return H.forEach(Object.keys((0,oe.A)((0,oe.A)({},e),t)),function(n){const r=o[n]||s,i=r(e[n],t[n],n);H.isUndefined(i)&&r!==l||(a[n]=i)}),a}const Me=e=>{const t=ze({},e);let{data:a,withXSRFToken:n,xsrfHeaderName:s,xsrfCookieName:r,headers:i,auth:l}=t;if(t.headers=i=ke.from(i),t.url=re(Oe(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),l&&i.set("Authorization","Basic "+btoa((l.username||"")+":"+(l.password?unescape(encodeURIComponent(l.password)):""))),H.isFormData(a))if(me.hasStandardBrowserEnv||me.hasStandardBrowserWebWorkerEnv)i.setContentType(void 0);else if(H.isFunction(a.getHeaders)){const e=a.getHeaders(),t=["content-type","content-length"];Object.entries(e).forEach(e=>{let[a,n]=e;t.includes(a.toLowerCase())&&i.set(a,n)})}if(me.hasStandardBrowserEnv&&(n&&H.isFunction(n)&&(n=n(t)),n||!1!==n&&Be(t.url))){const e=s&&r&&Fe.read(r);e&&i.set(s,e)}return t},Ue="undefined"!==typeof XMLHttpRequest&&function(e){return new Promise(function(t,a){const n=Me(e);let s=n.data;const r=ke.from(n.headers).normalize();let i,l,o,c,d,{responseType:u,onUploadProgress:h,onDownloadProgress:p}=n;function f(){c&&c(),d&&d(),n.cancelToken&&n.cancelToken.unsubscribe(i),n.signal&&n.signal.removeEventListener("abort",i)}let m=new XMLHttpRequest;function x(){if(!m)return;const n=ke.from("getAllResponseHeaders"in m&&m.getAllResponseHeaders());Te(function(e){t(e),f()},function(e){a(e),f()},{data:u&&"text"!==u&&"json"!==u?m.response:m.responseText,status:m.status,statusText:m.statusText,headers:n,config:e,request:m}),m=null}m.open(n.method.toUpperCase(),n.url,!0),m.timeout=n.timeout,"onloadend"in m?m.onloadend=x:m.onreadystatechange=function(){m&&4===m.readyState&&(0!==m.status||m.responseURL&&0===m.responseURL.indexOf("file:"))&&setTimeout(x)},m.onabort=function(){m&&(a(new Y("Request aborted",Y.ECONNABORTED,e,m)),m=null)},m.onerror=function(t){const n=t&&t.message?t.message:"Network Error",s=new Y(n,Y.ERR_NETWORK,e,m);s.event=t||null,a(s),m=null},m.ontimeout=function(){let t=n.timeout?"timeout of "+n.timeout+"ms exceeded":"timeout exceeded";const s=n.transitional||le;n.timeoutErrorMessage&&(t=n.timeoutErrorMessage),a(new Y(t,s.clarifyTimeoutError?Y.ETIMEDOUT:Y.ECONNABORTED,e,m)),m=null},void 0===s&&r.setContentType(null),"setRequestHeader"in m&&H.forEach(r.toJSON(),function(e,t){m.setRequestHeader(t,e)}),H.isUndefined(n.withCredentials)||(m.withCredentials=!!n.withCredentials),u&&"json"!==u&&(m.responseType=n.responseType),p&&([o,d]=Pe(p,!0),m.addEventListener("progress",o)),h&&m.upload&&([l,c]=Pe(h),m.upload.addEventListener("progress",l),m.upload.addEventListener("loadend",c)),(n.cancelToken||n.signal)&&(i=t=>{m&&(a(!t||t.type?new Le(null,e,m):t),m.abort(),m=null)},n.cancelToken&&n.cancelToken.subscribe(i),n.signal&&(n.signal.aborted?i():n.signal.addEventListener("abort",i)));const g=function(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}(n.url);g&&-1===me.protocols.indexOf(g)?a(new Y("Unsupported protocol "+g+":",Y.ERR_BAD_REQUEST,e)):m.send(s||null)})},We=(e,t)=>{const{length:a}=e=e?e.filter(Boolean):[];if(t||a){let a,n=new AbortController;const s=function(e){if(!a){a=!0,i();const t=e instanceof Error?e:this.reason;n.abort(t instanceof Y?t:new Le(t instanceof Error?t.message:t))}};let r=t&&setTimeout(()=>{r=null,s(new Y("timeout ".concat(t," of ms exceeded"),Y.ETIMEDOUT))},t);const i=()=>{e&&(r&&clearTimeout(r),r=null,e.forEach(e=>{e.unsubscribe?e.unsubscribe(s):e.removeEventListener("abort",s)}),e=null)};e.forEach(e=>e.addEventListener("abort",s));const{signal:l}=n;return l.unsubscribe=()=>H.asap(i),l}};function He(e,t){this.v=e,this.k=t}function Ve(e){return function(){return new Ge(e.apply(this,arguments))}}function Ge(e){var t,a;function n(t,a){try{var r=e[t](a),i=r.value,l=i instanceof He;Promise.resolve(l?i.v:i).then(function(a){if(l){var o="return"===t?"return":"next";if(!i.k||a.done)return n(o,a);a=e[o](a).value}s(r.done?"return":"normal",a)},function(e){n("throw",e)})}catch(e){s("throw",e)}}function s(e,s){switch(e){case"return":t.resolve({value:s,done:!0});break;case"throw":t.reject(s);break;default:t.resolve({value:s,done:!1})}(t=t.next)?n(t.key,t.arg):a=null}this._invoke=function(e,s){return new Promise(function(r,i){var l={key:e,arg:s,resolve:r,reject:i,next:null};a?a=a.next=l:(t=a=l,n(e,s))})},"function"!=typeof e.return&&(this.return=void 0)}function Je(e){return new He(e,0)}function Ye(e){var t={},a=!1;function n(t,n){return a=!0,n=new Promise(function(a){a(e[t](n))}),{done:!1,value:new He(n,1)}}return t["undefined"!=typeof Symbol&&Symbol.iterator||"@@iterator"]=function(){return this},t.next=function(e){return a?(a=!1,e):n("next",e)},"function"==typeof e.throw&&(t.throw=function(e){if(a)throw a=!1,e;return n("throw",e)}),"function"==typeof e.return&&(t.return=function(e){return a?(a=!1,e):n("return",e)}),t}function Ke(e){var t,a,n,s=2;for("undefined"!=typeof Symbol&&(a=Symbol.asyncIterator,n=Symbol.iterator);s--;){if(a&&null!=(t=e[a]))return t.call(e);if(n&&null!=(t=e[n]))return new Qe(t.call(e));a="@@asyncIterator",n="@@iterator"}throw new TypeError("Object is not async iterable")}function Qe(e){function t(e){if(Object(e)!==e)return Promise.reject(new TypeError(e+" is not an object."));var t=e.done;return Promise.resolve(e.value).then(function(e){return{value:e,done:t}})}return Qe=function(e){this.s=e,this.n=e.next},Qe.prototype={s:null,n:null,next:function(){return t(this.n.apply(this.s,arguments))},return:function(e){var a=this.s.return;return void 0===a?Promise.resolve({value:e,done:!0}):t(a.apply(this.s,arguments))},throw:function(e){var a=this.s.return;return void 0===a?Promise.reject(e):t(a.apply(this.s,arguments))}},new Qe(e)}Ge.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},Ge.prototype.next=function(e){return this._invoke("next",e)},Ge.prototype.throw=function(e){return this._invoke("throw",e)},Ge.prototype.return=function(e){return this._invoke("return",e)};const $e=function*(e,t){let a=e.byteLength;if(!t||a<t)return void(yield e);let n,s=0;for(;s<a;)n=s+t,yield e.slice(s,n),s=n},Xe=function(){var e=Ve(function*(e,t){var a,n=!1,s=!1;try{for(var r,i=Ke(Ze(e));n=!(r=yield Je(i.next())).done;n=!1){const e=r.value;yield*Ye(Ke($e(e,t)))}}catch(l){s=!0,a=l}finally{try{n&&null!=i.return&&(yield Je(i.return()))}finally{if(s)throw a}}});return function(t,a){return e.apply(this,arguments)}}(),Ze=function(){var e=Ve(function*(e){if(e[Symbol.asyncIterator])return void(yield*Ye(Ke(e)));const t=e.getReader();try{for(;;){const{done:e,value:a}=yield Je(t.read());if(e)break;yield a}}finally{yield Je(t.cancel())}});return function(t){return e.apply(this,arguments)}}(),et=(e,t,a,n)=>{const s=Xe(e,t);let r,i=0,l=e=>{r||(r=!0,n&&n(e))};return new ReadableStream({async pull(e){try{const{done:t,value:n}=await s.next();if(t)return l(),void e.close();let r=n.byteLength;if(a){let e=i+=r;a(e)}e.enqueue(new Uint8Array(n))}catch(t){throw l(t),t}},cancel:e=>(l(e),s.return())},{highWaterMark:2})},{isFunction:tt}=H,at=(e=>{let{Request:t,Response:a}=e;return{Request:t,Response:a}})(H.global),{ReadableStream:nt,TextEncoder:st}=H.global,rt=function(e){try{for(var t=arguments.length,a=new Array(t>1?t-1:0),n=1;n<t;n++)a[n-1]=arguments[n];return!!e(...a)}catch(s){return!1}},it=e=>{e=H.merge.call({skipUndefined:!0},at,e);const{fetch:t,Request:a,Response:n}=e,s=t?tt(t):"function"===typeof fetch,r=tt(a),i=tt(n);if(!s)return!1;const l=s&&tt(nt),o=s&&("function"===typeof st?(c=new st,e=>c.encode(e)):async e=>new Uint8Array(await new a(e).arrayBuffer()));var c;const d=r&&l&&rt(()=>{let e=!1;const t=new a(me.origin,{body:new nt,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t}),u=i&&l&&rt(()=>H.isReadableStream(new n("").body)),h={stream:u&&(e=>e.body)};s&&["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!h[e]&&(h[e]=(t,a)=>{let n=t&&t[e];if(n)return n.call(t);throw new Y("Response type '".concat(e,"' is not supported"),Y.ERR_NOT_SUPPORT,a)})});const p=async(e,t)=>{const n=H.toFiniteNumber(e.getContentLength());return null==n?(async e=>{if(null==e)return 0;if(H.isBlob(e))return e.size;if(H.isSpecCompliantForm(e)){const t=new a(me.origin,{method:"POST",body:e});return(await t.arrayBuffer()).byteLength}return H.isArrayBufferView(e)||H.isArrayBuffer(e)?e.byteLength:(H.isURLSearchParams(e)&&(e+=""),H.isString(e)?(await o(e)).byteLength:void 0)})(t):n};return async e=>{let{url:s,method:i,data:l,signal:o,cancelToken:c,timeout:f,onDownloadProgress:m,onUploadProgress:x,responseType:g,headers:v,withCredentials:y="same-origin",fetchOptions:b}=Me(e),j=t||fetch;g=g?(g+"").toLowerCase():"text";let w=We([o,c&&c.toAbortSignal()],f),N=null;const S=w&&w.unsubscribe&&(()=>{w.unsubscribe()});let k;try{if(x&&d&&"get"!==i&&"head"!==i&&0!==(k=await p(v,l))){let e,t=new a(s,{method:"POST",body:l,duplex:"half"});if(H.isFormData(l)&&(e=t.headers.get("content-type"))&&v.setContentType(e),t.body){const[e,a]=Re(k,Pe(Ie(x)));l=et(t.body,65536,e,a)}}H.isString(y)||(y=y?"include":"omit");const t=r&&"credentials"in a.prototype,o=(0,oe.A)((0,oe.A)({},b),{},{signal:w,method:i.toUpperCase(),headers:v.normalize().toJSON(),body:l,duplex:"half",credentials:t?y:void 0});N=r&&new a(s,o);let c=await(r?j(N,b):j(s,o));const f=u&&("stream"===g||"response"===g);if(u&&(m||f&&S)){const e={};["status","statusText","headers"].forEach(t=>{e[t]=c[t]});const t=H.toFiniteNumber(c.headers.get("content-length")),[a,s]=m&&Re(t,Pe(Ie(m),!0))||[];c=new n(et(c.body,65536,a,()=>{s&&s(),S&&S()}),e)}g=g||"text";let A=await h[H.findKey(h,g)||"text"](c,e);return!f&&S&&S(),await new Promise((t,a)=>{Te(t,a,{data:A,headers:ke.from(c.headers),status:c.status,statusText:c.statusText,config:e,request:N})})}catch(A){if(S&&S(),A&&"TypeError"===A.name&&/Load failed|fetch/i.test(A.message))throw Object.assign(new Y("Network Error",Y.ERR_NETWORK,e,N),{cause:A.cause||A});throw Y.from(A,A&&A.code,e,N)}}},lt=new Map,ot=e=>{let t=e?e.env:{};const{fetch:a,Request:n,Response:s}=t,r=[n,s,a];let i,l,o=r.length,c=lt;for(;o--;)i=r[o],l=c.get(i),void 0===l&&c.set(i,l=o?new Map:it(t)),c=l;return l},ct=(ot(),{http:null,xhr:Ue,fetch:{get:ot}});H.forEach(ct,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch(a){}Object.defineProperty(e,"adapterName",{value:t})}});const dt=e=>"- ".concat(e),ut=e=>H.isFunction(e)||null===e||!1===e,ht=(e,t)=>{e=H.isArray(e)?e:[e];const{length:a}=e;let n,s;const r={};for(let i=0;i<a;i++){let a;if(n=e[i],s=n,!ut(n)&&(s=ct[(a=String(n)).toLowerCase()],void 0===s))throw new Y("Unknown adapter '".concat(a,"'"));if(s&&(H.isFunction(s)||(s=s.get(t))))break;r[a||"#"+i]=s}if(!s){const e=Object.entries(r).map(e=>{let[t,a]=e;return"adapter ".concat(t," ")+(!1===a?"is not supported by the environment":"is not available in the build")});let t=a?e.length>1?"since :\n"+e.map(dt).join("\n"):" "+dt(e[0]):"as no adapter specified";throw new Y("There is no suitable adapter to dispatch the request "+t,"ERR_NOT_SUPPORT")}return s};function pt(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Le(null,e)}function ft(e){pt(e),e.headers=ke.from(e.headers),e.data=Ae.call(e,e.transformRequest),-1!==["post","put","patch"].indexOf(e.method)&&e.headers.setContentType("application/x-www-form-urlencoded",!1);return ht(e.adapter||ve.adapter,e)(e).then(function(t){return pt(e),t.data=Ae.call(e,e.transformResponse,t),t.headers=ke.from(t.headers),t},function(t){return Ce(t)||(pt(e),t&&t.response&&(t.response.data=Ae.call(e,e.transformResponse,t.response),t.response.headers=ke.from(t.response.headers))),Promise.reject(t)})}const mt="1.12.2",xt={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{xt[e]=function(a){return typeof a===e||"a"+(t<1?"n ":" ")+e}});const gt={};xt.transitional=function(e,t,a){function n(e,t){return"[Axios v"+mt+"] Transitional option '"+e+"'"+t+(a?". "+a:"")}return(a,s,r)=>{if(!1===e)throw new Y(n(s," has been removed"+(t?" in "+t:"")),Y.ERR_DEPRECATED);return t&&!gt[s]&&(gt[s]=!0,console.warn(n(s," has been deprecated since v"+t+" and will be removed in the near future"))),!e||e(a,s,r)}},xt.spelling=function(e){return(t,a)=>(console.warn("".concat(a," is likely a misspelling of ").concat(e)),!0)};const vt={assertOptions:function(e,t,a){if("object"!==typeof e)throw new Y("options must be an object",Y.ERR_BAD_OPTION_VALUE);const n=Object.keys(e);let s=n.length;for(;s-- >0;){const r=n[s],i=t[r];if(i){const t=e[r],a=void 0===t||i(t,r,e);if(!0!==a)throw new Y("option "+r+" must be "+a,Y.ERR_BAD_OPTION_VALUE);continue}if(!0!==a)throw new Y("Unknown option "+r,Y.ERR_BAD_OPTION)}},validators:xt},yt=vt.validators;class bt{constructor(e){this.defaults=e||{},this.interceptors={request:new ie,response:new ie}}async request(e,t){try{return await this._request(e,t)}catch(a){if(a instanceof Error){let e={};Error.captureStackTrace?Error.captureStackTrace(e):e=new Error;const t=e.stack?e.stack.replace(/^.+\n/,""):"";try{a.stack?t&&!String(a.stack).endsWith(t.replace(/^.+\n.+\n/,""))&&(a.stack+="\n"+t):a.stack=t}catch(n){}}throw a}}_request(e,t){"string"===typeof e?(t=t||{}).url=e:t=e||{},t=ze(this.defaults,t);const{transitional:a,paramsSerializer:n,headers:s}=t;void 0!==a&&vt.assertOptions(a,{silentJSONParsing:yt.transitional(yt.boolean),forcedJSONParsing:yt.transitional(yt.boolean),clarifyTimeoutError:yt.transitional(yt.boolean)},!1),null!=n&&(H.isFunction(n)?t.paramsSerializer={serialize:n}:vt.assertOptions(n,{encode:yt.function,serialize:yt.function},!0)),void 0!==t.allowAbsoluteUrls||(void 0!==this.defaults.allowAbsoluteUrls?t.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:t.allowAbsoluteUrls=!0),vt.assertOptions(t,{baseUrl:yt.spelling("baseURL"),withXsrfToken:yt.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let r=s&&H.merge(s.common,s[t.method]);s&&H.forEach(["delete","get","head","post","put","patch","common"],e=>{delete s[e]}),t.headers=ke.concat(r,s);const i=[];let l=!0;this.interceptors.request.forEach(function(e){"function"===typeof e.runWhen&&!1===e.runWhen(t)||(l=l&&e.synchronous,i.unshift(e.fulfilled,e.rejected))});const o=[];let c;this.interceptors.response.forEach(function(e){o.push(e.fulfilled,e.rejected)});let d,u=0;if(!l){const e=[ft.bind(this),void 0];for(e.unshift(...i),e.push(...o),d=e.length,c=Promise.resolve(t);u<d;)c=c.then(e[u++],e[u++]);return c}d=i.length;let h=t;for(;u<d;){const e=i[u++],t=i[u++];try{h=e(h)}catch(p){t.call(this,p);break}}try{c=ft.call(this,h)}catch(p){return Promise.reject(p)}for(u=0,d=o.length;u<d;)c=c.then(o[u++],o[u++]);return c}getUri(e){return re(Oe((e=ze(this.defaults,e)).baseURL,e.url,e.allowAbsoluteUrls),e.params,e.paramsSerializer)}}H.forEach(["delete","get","head","options"],function(e){bt.prototype[e]=function(t,a){return this.request(ze(a||{},{method:e,url:t,data:(a||{}).data}))}}),H.forEach(["post","put","patch"],function(e){function t(t){return function(a,n,s){return this.request(ze(s||{},{method:e,headers:t?{"Content-Type":"multipart/form-data"}:{},url:a,data:n}))}}bt.prototype[e]=t(),bt.prototype[e+"Form"]=t(!0)});const jt=bt;class wt{constructor(e){if("function"!==typeof e)throw new TypeError("executor must be a function.");let t;this.promise=new Promise(function(e){t=e});const a=this;this.promise.then(e=>{if(!a._listeners)return;let t=a._listeners.length;for(;t-- >0;)a._listeners[t](e);a._listeners=null}),this.promise.then=e=>{let t;const n=new Promise(e=>{a.subscribe(e),t=e}).then(e);return n.cancel=function(){a.unsubscribe(t)},n},e(function(e,n,s){a.reason||(a.reason=new Le(e,n,s),t(a.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){this.reason?e(this.reason):this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);-1!==t&&this._listeners.splice(t,1)}toAbortSignal(){const e=new AbortController,t=t=>{e.abort(t)};return this.subscribe(t),e.signal.unsubscribe=()=>this.unsubscribe(t),e.signal}static source(){let e;return{token:new wt(function(t){e=t}),cancel:e}}}const Nt=wt;const St={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(St).forEach(e=>{let[t,a]=e;St[a]=t});const kt=St;const At=function e(t){const a=new jt(t),n=s(jt.prototype.request,a);return H.extend(n,jt.prototype,a,{allOwnKeys:!0}),H.extend(n,a,null,{allOwnKeys:!0}),n.create=function(a){return e(ze(t,a))},n}(ve);At.Axios=jt,At.CanceledError=Le,At.CancelToken=Nt,At.isCancel=Ce,At.VERSION=mt,At.toFormData=Z,At.AxiosError=Y,At.Cancel=At.CanceledError,At.all=function(e){return Promise.all(e)},At.spread=function(e){return function(t){return e.apply(null,t)}},At.isAxiosError=function(e){return H.isObject(e)&&!0===e.isAxiosError},At.mergeConfig=ze,At.AxiosHeaders=ke,At.formToJSON=e=>xe(H.isHTMLForm(e)?new FormData(e):e),At.getAdapter=ht,At.HttpStatusCode=kt,At.default=At;const Ct=At}},t={};function a(n){var s=t[n];if(void 0!==s)return s.exports;var r=t[n]={exports:{}};return e[n].call(r.exports,r,r.exports,a),r.exports}a.m=e,(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;a.t=function(n,s){if(1&s&&(n=this(n)),8&s)return n;if("object"===typeof n&&n){if(4&s&&n.__esModule)return n;if(16&s&&"function"===typeof n.then)return n}var r=Object.create(null);a.r(r);var i={};e=e||[null,t({}),t([]),t(t)];for(var l=2&s&&n;("object"==typeof l||"function"==typeof l)&&!~e.indexOf(l);l=t(l))Object.getOwnPropertyNames(l).forEach(e=>i[e]=()=>n[e]);return i.default=()=>n,a.d(r,i),r}})(),a.d=(e,t)=>{for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},a.f={},a.e=e=>Promise.all(Object.keys(a.f).reduce((t,n)=>(a.f[n](e,t),t),[])),a.u=e=>"static/js/"+e+"."+{239:"64188e73",455:"b20972bb",977:"361614d3"}[e]+".chunk.js",a.miniCssF=e=>{},a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={},t="holy-family-polymers-frontend:";a.l=(n,s,r,i)=>{if(e[n])e[n].push(s);else{var l,o;if(void 0!==r)for(var c=document.getElementsByTagName("script"),d=0;d<c.length;d++){var u=c[d];if(u.getAttribute("src")==n||u.getAttribute("data-webpack")==t+r){l=u;break}}l||(o=!0,(l=document.createElement("script")).charset="utf-8",a.nc&&l.setAttribute("nonce",a.nc),l.setAttribute("data-webpack",t+r),l.src=n),e[n]=[s];var h=(t,a)=>{l.onerror=l.onload=null,clearTimeout(p);var s=e[n];if(delete e[n],l.parentNode&&l.parentNode.removeChild(l),s&&s.forEach(e=>e(a)),t)return t(a)},p=setTimeout(h.bind(null,void 0,{type:"timeout",target:l}),12e4);l.onerror=h.bind(null,l.onerror),l.onload=h.bind(null,l.onload),o&&document.head.appendChild(l)}}})(),a.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.p="/",(()=>{var e={792:0};a.f.j=(t,n)=>{var s=a.o(e,t)?e[t]:void 0;if(0!==s)if(s)n.push(s[2]);else{var r=new Promise((a,n)=>s=e[t]=[a,n]);n.push(s[2]=r);var i=a.p+a.u(t),l=new Error;a.l(i,n=>{if(a.o(e,t)&&(0!==(s=e[t])&&(e[t]=void 0),s)){var r=n&&("load"===n.type?"missing":n.type),i=n&&n.target&&n.target.src;l.message="Loading chunk "+t+" failed.\n("+r+": "+i+")",l.name="ChunkLoadError",l.type=r,l.request=i,s[1](l)}},"chunk-"+t,t)}};var t=(t,n)=>{var s,r,[i,l,o]=n,c=0;if(i.some(t=>0!==e[t])){for(s in l)a.o(l,s)&&(a.m[s]=l[s]);if(o)o(a)}for(t&&t(n);c<i.length;c++)r=i[c],a.o(e,r)&&e[r]&&e[r][0](),e[r]=0},n=self.webpackChunkholy_family_polymers_frontend=self.webpackChunkholy_family_polymers_frontend||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var n=a(5043),s=a(4391),r=a(5475),i=a(9379);function l(e,t){if(null==e)return{};var a,n,s=function(e,t){if(null==e)return{};var a={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;a[n]=e[n]}return a}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],-1===t.indexOf(a)&&{}.propertyIsEnumerable.call(e,a)&&(s[a]=e[a])}return s}const o=["onSuccess","onError","useOneTap","promptMomentNotification","type","theme","size","text","shape","logo_alignment","width","locale","click_listener","containerProps"];const c=(0,n.createContext)(null);function d(e){let{clientId:t,nonce:a,onScriptLoadSuccess:s,onScriptLoadError:r,children:i}=e;const l=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{nonce:t,onScriptLoadSuccess:a,onScriptLoadError:s}=e,[r,i]=(0,n.useState)(!1),l=(0,n.useRef)(a);l.current=a;const o=(0,n.useRef)(s);return o.current=s,(0,n.useEffect)(()=>{const e=document.createElement("script");return e.src="https://accounts.google.com/gsi/client",e.async=!0,e.defer=!0,e.nonce=t,e.onload=()=>{var e;i(!0),null===(e=l.current)||void 0===e||e.call(l)},e.onerror=()=>{var e;i(!1),null===(e=o.current)||void 0===e||e.call(o)},document.body.appendChild(e),()=>{document.body.removeChild(e)}},[t]),r}({nonce:a,onScriptLoadSuccess:s,onScriptLoadError:r}),o=(0,n.useMemo)(()=>({clientId:t,scriptLoadedSuccessfully:l}),[t,l]);return n.createElement(c.Provider,{value:o},i)}function u(){const e=(0,n.useContext)(c);if(!e)throw new Error("Google OAuth components must be used within GoogleOAuthProvider");return e}function h(e){var t;return null!==(t=null===e||void 0===e?void 0:e.clientId)&&void 0!==t?t:null===e||void 0===e?void 0:e.client_id}const p={large:40,medium:32,small:20};function f(e){let{onSuccess:t,onError:a,useOneTap:s,promptMomentNotification:r,type:c="standard",theme:d="outline",size:f="large",text:m,shape:x,logo_alignment:g,width:v,locale:y,click_listener:b,containerProps:j}=e,w=l(e,o);const N=(0,n.useRef)(null),{clientId:S,scriptLoadedSuccessfully:k}=u(),A=(0,n.useRef)(t);A.current=t;const C=(0,n.useRef)(a);C.current=a;const _=(0,n.useRef)(r);return _.current=r,(0,n.useEffect)(()=>{var e,t,a,n,r,l,o,u,p;if(k)return null===(a=null===(t=null===(e=null===window||void 0===window?void 0:window.google)||void 0===e?void 0:e.accounts)||void 0===t?void 0:t.id)||void 0===a||a.initialize((0,i.A)({client_id:S,callback:e=>{var t;if(!(null===e||void 0===e?void 0:e.credential))return null===(t=C.current)||void 0===t?void 0:t.call(C);const{credential:a,select_by:n}=e;A.current({credential:a,clientId:h(e),select_by:n})}},w)),null===(l=null===(r=null===(n=null===window||void 0===window?void 0:window.google)||void 0===n?void 0:n.accounts)||void 0===r?void 0:r.id)||void 0===l||l.renderButton(N.current,{type:c,theme:d,size:f,text:m,shape:x,logo_alignment:g,width:v,locale:y,click_listener:b}),s&&(null===(p=null===(u=null===(o=null===window||void 0===window?void 0:window.google)||void 0===o?void 0:o.accounts)||void 0===u?void 0:u.id)||void 0===p||p.prompt(_.current)),()=>{var e,t,a;s&&(null===(a=null===(t=null===(e=null===window||void 0===window?void 0:window.google)||void 0===e?void 0:e.accounts)||void 0===t?void 0:t.id)||void 0===a||a.cancel())}},[S,k,s,c,d,f,m,x,g,v,y]),n.createElement("div",(0,i.A)((0,i.A)({},j),{},{ref:N,style:(0,i.A)({height:p[f]},null===j||void 0===j?void 0:j.style)}))}var m=a(9722),x=a(579);const g=(0,n.createContext)(null),v=e=>{let{children:t}=e;const[a,s]=(0,n.useState)(null),[r,l]=(0,n.useState)(null),[o,c]=(0,n.useState)(!0),d="http://localhost:5000",u=(0,n.useCallback)(e=>{try{const t=document&&document.body;if(!t)return;["role-admin","role-manager","role-accountant","role-delivery_staff","role-field_staff","role-user","role-lab","role-lab_manager","role-lab_staff"].forEach(e=>t.classList.remove(e));const a=e&&e.role?"role-".concat(e.role):null;a&&t.classList.add(a)}catch(t){}},[]);(0,n.useEffect)(()=>{try{const e=localStorage.getItem("auth");if(e){const t=JSON.parse(e);s(t.user||null),l(t.token||null),u(t.user||null)}}finally{c(!1)}},[u]);const h=(0,n.useCallback)(e=>{e&&e.token?(localStorage.setItem("auth",JSON.stringify(e)),localStorage.setItem("token",e.token),u(e.user||null)):(localStorage.removeItem("auth"),localStorage.removeItem("token"),u(null))},[u]),p=(0,n.useCallback)(async(e,t)=>{const{data:a}=await m.A.post("".concat(d,"/api/auth/login"),{email:e,password:t});return s(a.user),l(a.token),h({user:a.user,token:a.token}),a},[d,h]),f=(0,n.useCallback)(async e=>{const{data:t}=await m.A.post("".concat(d,"/api/auth/staff-login"),{staffId:e});return s(t.user),l(t.token),h({user:t.user,token:t.token}),t},[d,h]),v=(0,n.useCallback)(async e=>{const{data:t}=await m.A.post("".concat(d,"/api/auth/register"),e);return t},[d]),y=(0,n.useCallback)(async e=>{try{const{data:t}=await m.A.post("".concat(d,"/api/auth/google-signin"),{token:e});return s(t.user),l(t.token),h({user:t.user,token:t.token}),t}catch(t){throw console.error("Google Sign-In Error:",t),t}},[d,h]),b=(0,n.useCallback)(async()=>{window.confirm("Are you sure you want to log out?")&&(s(null),l(null),h(null))},[h]),j=(0,n.useCallback)(async()=>{if(!r)return null;try{const{data:e}=await m.A.get("".concat(d,"/api/users/profile"),{headers:{Authorization:"Bearer ".concat(r)}});return e&&(s(e),h({user:e,token:r})),e}catch(e){s(null),l(null),h(null)}},[d,r,h]),w=(0,n.useCallback)(async e=>{if(!r)return null;try{const{data:t}=await m.A.put("".concat(d,"/api/users/profile"),e,{headers:{Authorization:"Bearer ".concat(r)}});if(t){const e=(0,i.A)((0,i.A)({},a),t);return s(e),h({user:e,token:r}),e}}catch(t){throw console.error("Update profile error:",t),t}},[d,r,a,h]),N=(0,n.useMemo)(()=>({user:a,token:r,isAuthenticated:Boolean(r&&a),loading:o,login:p,logout:b,register:v,googleSignIn:y,staffLogin:f,validateToken:j,updateProfile:w}),[a,r,o,p,b,v,y,f,j,w]);return(0,x.jsx)(g.Provider,{value:N,children:t})},y=()=>{const e=(0,n.useContext)(g);if(!e)throw new Error("useAuth must be used within an AuthProvider");return e},b=(0,n.createContext)(null),j=e=>{let{children:t}=e;const[a,s]=(0,n.useState)([]),r=e=>s(t=>[...t,e]),i=e=>s(t=>t.filter(t=>t.id!==e)),l=()=>s([]),o=(0,n.useMemo)(()=>({items:a,addItem:r,removeItem:i,clear:l}),[a]);return(0,x.jsx)(b.Provider,{value:o,children:t})};var w=a(3216);const N=["children","className","title","subtitle","icon","onClick"],S=["children","variant","size","className","icon","loading","disabled"],k=["children","visible","onClose","className"],A=(0,n.createContext)(),C={admin:{primary:"#4f46e5",secondary:"#6366f1",light:"#e0e7ff",dark:"#312e81",name:"Admin"},manager:{primary:"#0ea5a4",secondary:"#14b8a6",light:"#ccfbf1",dark:"#134e4a",name:"Manager"},labour:{primary:"#f59e0b",secondary:"#fbbf24",light:"#fef3c7",dark:"#92400e",name:"Labour"},field_staff:{primary:"#06b6d4",secondary:"#22d3ee",light:"#cffafe",dark:"#155e75",name:"Field Staff"},lab:{primary:"#7c3aed",secondary:"#8b5cf6",light:"#ede9fe",dark:"#581c87",name:"Lab"},customer:{primary:"#10b981",secondary:"#34d399",light:"#d1fae5",dark:"#064e3b",name:"Customer"}},_=e=>{let{children:t}=e;const[a,s]=(0,n.useState)(null),[r,i]=(0,n.useState)(null);(0,n.useEffect)(()=>{const e=JSON.parse(localStorage.getItem("user")||"{}").role||"customer";s(e),i(C[e]||C.customer),document.body.className=document.body.className.replace(/role-\w+/g,""),document.body.classList.add("role-".concat(e))},[]);const l={userRole:a,roleColors:r,getRoleColor:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"primary";return(null===r||void 0===r?void 0:r[e])||C.customer[e]},getRoleName:()=>(null===r||void 0===r?void 0:r.name)||"Customer",ROLE_COLORS:C};return(0,x.jsx)(A.Provider,{value:l,children:t})},L=()=>{const e=(0,n.useContext)(A);if(!e)throw new Error("useRoleTheme must be used within a RoleThemeProvider");return e},T=e=>{let{children:t,className:a="",title:n,subtitle:s,icon:r,onClick:o}=e,c=l(e,N);const{userRole:d}=L();return(0,x.jsxs)("div",(0,i.A)((0,i.A)({className:"dashboard-card role-".concat(d," ").concat(a),onClick:o},c),{},{children:[(n||r)&&(0,x.jsxs)("div",{className:"card-header",style:{marginBottom:"16px"},children:[r&&(0,x.jsx)("i",{className:"".concat(r," text-role-primary"),style:{fontSize:"1.5rem",marginRight:"12px"}}),n&&(0,x.jsx)("h3",{className:"card-title",style:{margin:0,color:"var(--role-primary)"},children:n}),s&&(0,x.jsx)("p",{className:"card-subtitle",style:{margin:"4px 0 0 0",opacity:.8,fontSize:"0.875rem"},children:s})]}),(0,x.jsx)("div",{className:"card-content",children:t})]}))},E=e=>{let{children:t,variant:a="primary",size:n="medium",className:s="",icon:r,loading:o=!1,disabled:c=!1}=e,d=l(e,S);const{userRole:u}=L();return(0,x.jsxs)("button",(0,i.A)((0,i.A)({className:"".concat({primary:"btn-role",outline:"btn-role-outline",ghost:"bg-transparent text-role-primary hover:bg-role-primary hover:text-white"}[a]," ").concat({small:"px-3 py-1.5 text-sm",medium:"px-4 py-2 text-base",large:"px-6 py-3 text-lg"}[n]," ").concat(s," role-").concat(u),disabled:c||o},d),{},{children:[o&&(0,x.jsx)("i",{className:"fas fa-spinner fa-spin mr-2"}),r&&!o&&(0,x.jsx)("i",{className:"".concat(r," mr-2")}),t]}))},D=e=>{let{status:t,children:a,className:n="",size:s="medium"}=e;return(0,x.jsx)("span",{className:"status-indicator ".concat(t," ").concat({small:"px-2 py-1 text-xs",medium:"px-3 py-1.5 text-sm",large:"px-4 py-2 text-base"}[s]," ").concat(n),children:a})},P=e=>{let{progress:t,label:a,className:n="",showPercentage:s=!0}=e;const{userRole:r}=L();return(0,x.jsxs)("div",{className:"progress-container ".concat(n),children:[(a||s)&&(0,x.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"8px"},children:[a&&(0,x.jsx)("span",{className:"text-sm font-medium",children:a}),s&&(0,x.jsxs)("span",{className:"text-sm font-medium",children:[Math.round(t),"%"]})]}),(0,x.jsx)("div",{className:"progress-bar",style:{width:"".concat(Math.min(100,Math.max(0,t)),"%")}})]})},R=e=>{let{children:t,visible:a=!0,onClose:n,className:s=""}=e,r=l(e,k);const{userRole:o}=L();return a?(0,x.jsxs)("div",(0,i.A)((0,i.A)({className:"floating-prompt role-".concat(o," ").concat(s)},r),{},{children:[n&&(0,x.jsx)("button",{onClick:n,style:{position:"absolute",top:"8px",right:"8px",background:"none",border:"none",color:"white",cursor:"pointer",fontSize:"1.2rem"},children:"\xd7"}),t]})):null},I=e=>{let{children:t,content:a,position:n="top",className:s=""}=e;return(0,x.jsxs)("div",{className:"tooltip ".concat(s),children:[t,(0,x.jsx)("span",{className:"tooltip-text",children:a})]})},B=()=>{const{isAuthenticated:e,logout:t,user:a}=y(),s=(0,w.Zp)(),[i,l]=(0,n.useState)(!1),o=(0,n.useRef)(null),[c,d]=(0,n.useState)(!1);(0,n.useEffect)(()=>{const e=e=>{o.current&&!o.current.contains(e.target)&&l(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),(0,n.useEffect)(()=>{const e=()=>d(window.scrollY>10);return e(),window.addEventListener("scroll",e,{passive:!0}),()=>window.removeEventListener("scroll",e)},[]);return(0,x.jsx)(x.Fragment,{children:(0,x.jsx)("nav",{className:"navbar".concat(c?" scrolled":""),children:(0,x.jsxs)("div",{className:"navbar-container",children:[(0,x.jsx)(r.N_,{to:"/",className:"navbar-logo",children:(0,x.jsx)("div",{className:"navbar-logo",children:(0,x.jsx)("img",{src:"/images/logo.png",alt:"Company Logo",className:"company-logo"})})}),(0,x.jsxs)("ul",{className:"nav-menu",children:[(0,x.jsx)("li",{className:"nav-item",children:(0,x.jsx)(r.k2,{to:"/",className:e=>{let{isActive:t}=e;return t?"nav-link active":"nav-link"},children:"Home"})}),(0,x.jsx)("li",{className:"nav-item",children:(0,x.jsx)(r.k2,{to:"/about",className:e=>{let{isActive:t}=e;return t?"nav-link active":"nav-link"},children:"About"})}),(0,x.jsx)("li",{className:"nav-item",children:(0,x.jsx)(r.k2,{to:"/history",className:e=>{let{isActive:t}=e;return t?"nav-link active":"nav-link"},children:"History"})}),(0,x.jsx)("li",{className:"nav-item",children:(0,x.jsx)(r.k2,{to:"/gallery",className:e=>{let{isActive:t}=e;return t?"nav-link active":"nav-link"},children:"Gallery"})}),(0,x.jsx)("li",{className:"nav-item",children:(0,x.jsx)(r.k2,{to:"/contact",className:e=>{let{isActive:t}=e;return t?"nav-link active":"nav-link"},children:"Contact"})}),(0,x.jsx)("li",{className:"nav-item",children:null})]}),e?(0,x.jsxs)("div",{className:"nav-auth-buttons",children:[(0,x.jsxs)("div",{className:"profile-menu",ref:o,children:[(0,x.jsxs)("button",{type:"button",className:"nav-button btn-login",onClick:()=>l(e=>!e),children:[(0,x.jsx)("i",{className:"fas fa-user-circle",style:{marginRight:6}}),null!==a&&void 0!==a&&a.name?"Hi, ".concat(a.name.split(" ")[0]):"Profile",(0,x.jsx)("i",{className:"fas fa-caret-down",style:{marginLeft:6}})]}),i&&(0,x.jsxs)("div",{className:"profile-dropdown",children:[(0,x.jsxs)(r.k2,{to:"/user/profile/view",className:"dropdown-item",onClick:()=>l(!1),children:[(0,x.jsx)("i",{className:"fas fa-eye"}),(0,x.jsx)("span",{children:"View Profile"})]}),(0,x.jsxs)(r.k2,{to:"/user/profile",className:"dropdown-item",onClick:()=>l(!1),children:[(0,x.jsx)("i",{className:"fas fa-pen"}),(0,x.jsx)("span",{children:"Edit Profile"})]})]})]}),(0,x.jsx)("button",{className:"nav-button btn-register",onClick:async()=>{try{await t(),s("/login")}catch(e){s("/login")}},children:"Logout"})]}):(0,x.jsx)("div",{className:"nav-auth-buttons",children:(0,x.jsx)(r.N_,{to:"/login",className:"nav-button btn-login",children:"Login"})})]})})})},F=()=>{const e=(0,w.zy)();(0,n.useEffect)(()=>{const e=e=>{const t=e.target;if(!t||"INPUT"!==t.tagName||"number"!==t.type)return;const a=["Backspace","Delete","ArrowLeft","ArrowRight","ArrowUp","ArrowDown","Home","End","Tab"];if(e.ctrlKey||e.metaKey)return;if(["e","E","+","-"].includes(e.key))e.preventDefault();else if(1===e.key.length){const n=/[0-9]/.test(e.key),s="."===e.key,r=t.getAttribute("step"),i=null===r||"any"===r||/\./.test(r);n||s&&i||a.includes(e.key)||e.preventDefault()}},t=e=>{var t;const a=e.target;if(!a||"INPUT"!==a.tagName||"number"!==a.type)return;const n=null===(t=e.clipboardData||window.clipboardData)||void 0===t?void 0:t.getData("text");if("string"!==typeof n)return;const s=a.getAttribute("step"),r=null===s||"any"===s||/\./.test(s)?n.replace(/[^0-9.]/g,""):n.replace(/[^0-9]/g,"");if(r!==n){e.preventDefault();const t=a.selectionStart,n=a.selectionEnd,s=a.value||"";a.value=s.slice(0,t)+r+s.slice(n),a.dispatchEvent(new Event("input",{bubbles:!0}))}};return document.addEventListener("keydown",e,!0),document.addEventListener("paste",t,!0),()=>{document.removeEventListener("keydown",e,!0),document.removeEventListener("paste",t,!0)}},[]);const t=["/about","/history","/contact","/gallery"].some(t=>e.pathname.startsWith(t));return(0,n.useEffect)(()=>(t?document.body.classList.add("brand-gradient-root"):document.body.classList.remove("brand-gradient-root"),()=>{document.body.classList.remove("brand-gradient-root")}),[t]),(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(B,{}),(0,x.jsxs)("main",{className:t?"brand-gradient":"",children:[(0,x.jsx)(w.sv,{})," "]})]})},O=e=>{let{showAvatar:t=!0,showName:a=!0,showRole:n=!0,showEmail:s=!1,layout:r="horizontal",size:l="medium",className:o="",style:c={}}=e;const{user:d}=y();if(!d)return null;const u={small:{avatar:"24px",nameFont:"12px",roleFont:"10px",emailFont:"10px"},medium:{avatar:"32px",nameFont:"14px",roleFont:"12px",emailFont:"11px"},large:{avatar:"40px",nameFont:"16px",roleFont:"14px",emailFont:"12px"}},h=u[l]||u.medium,p=(0,i.A)({display:"flex",alignItems:"horizontal"===r?"center":"flex-start",flexDirection:"horizontal"===r?"row":"column",gap:"horizontal"===r?"8px":"4px"},c),f={width:h.avatar,height:h.avatar,borderRadius:"50%",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontSize:"calc(".concat(h.avatar," * 0.4)"),fontWeight:"600",flexShrink:0},m={display:"flex",flexDirection:"column",alignItems:"horizontal"===r?"flex-start":"center",gap:"2px"},g={fontSize:h.nameFont,fontWeight:"600",color:"#1e293b",margin:0,lineHeight:1.2},v={fontSize:h.roleFont,fontWeight:"500",color:"#64748b",background:"rgba(59, 130, 246, 0.1)",padding:"2px 6px",borderRadius:"4px",border:"1px solid rgba(59, 130, 246, 0.2)",textTransform:"uppercase",letterSpacing:"0.3px",margin:0,lineHeight:1},b={fontSize:h.emailFont,color:"#94a3b8",margin:0,lineHeight:1.2};return(0,x.jsxs)("div",{className:"user-display ".concat(o),style:p,children:[t&&(0,x.jsx)("div",{style:f,children:d.profilePicture?(0,x.jsx)("img",{src:d.profilePicture,alt:"Profile",style:{width:"100%",height:"100%",borderRadius:"50%",objectFit:"cover"}}):(w=d.name,w?w.split(" ").map(e=>e.charAt(0)).join("").toUpperCase().slice(0,2):"U")}),(0,x.jsxs)("div",{style:m,children:[a&&(0,x.jsx)("div",{style:g,children:d.name||"User"}),n&&(0,x.jsx)("div",{style:v,children:(j=d.role,j?j.replace(/_/g," ").toUpperCase():"User")}),s&&d.email&&(0,x.jsx)("div",{style:b,children:d.email})]})]});var j,w},q=e=>{let{className:t="",style:a={},showIcon:n=!0,showText:s=!0,variant:r="default",size:l="medium"}=e;const o=(0,w.Zp)(),{logout:c}=y(),d={default:{background:"rgba(239, 68, 68, 0.1)",color:"#ef4444",border:"1px solid rgba(239, 68, 68, 0.2)",borderRadius:"8px",padding:"small"===l?"6px 12px":"large"===l?"12px 20px":"8px 16px",fontSize:"small"===l?"12px":"large"===l?"16px":"14px",fontWeight:"500",cursor:"pointer",transition:"all 0.2s ease",display:"flex",alignItems:"center",gap:n&&s?"8px":"0",":hover":{background:"#ef4444",color:"white"}},minimal:{background:"transparent",color:"#64748b",border:"none",padding:"small"===l?"4px 8px":"large"===l?"8px 12px":"6px 10px",fontSize:"small"===l?"12px":"large"===l?"16px":"14px",cursor:"pointer",transition:"all 0.2s ease",display:"flex",alignItems:"center",gap:n&&s?"6px":"0",":hover":{color:"#ef4444"}},danger:{background:"#ef4444",color:"white",border:"none",borderRadius:"8px",padding:"small"===l?"6px 12px":"large"===l?"12px 20px":"8px 16px",fontSize:"small"===l?"12px":"large"===l?"16px":"14px",fontWeight:"600",cursor:"pointer",transition:"all 0.2s ease",display:"flex",alignItems:"center",gap:n&&s?"8px":"0",":hover":{background:"#dc2626"}}},u=d[r]||d.default;return(0,x.jsxs)("button",{onClick:async()=>{try{await c(),o("/login")}catch(e){o("/login")}},className:"logout-button ".concat(t),style:(0,i.A)((0,i.A)({},u),a),onMouseEnter:e=>{"default"===r?(e.target.style.background="#ef4444",e.target.style.color="white"):"minimal"===r?e.target.style.color="#ef4444":"danger"===r&&(e.target.style.background="#dc2626")},onMouseLeave:e=>{"default"===r?(e.target.style.background="rgba(239, 68, 68, 0.1)",e.target.style.color="#ef4444"):"minimal"===r?e.target.style.color="#64748b":"danger"===r&&(e.target.style.background="#ef4444")},title:"Logout",children:[n&&(0,x.jsx)("i",{className:"fas fa-sign-out-alt"}),s&&(0,x.jsx)("span",{children:"Logout"})]})},z=e=>{let{showIcons:t=!0,showProfile:a=!0,showLogout:s=!0}=e;const{user:i,logout:l}=y(),o=(0,w.Zp)(),[c,d]=(0,n.useState)(!1),u=(0,n.useRef)(null);(0,n.useEffect)(()=>{const e=e=>{u.current&&!u.current.contains(e.target)&&d(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);return(0,x.jsx)("div",{className:"user-module",children:(0,x.jsxs)("div",{className:"user-module-right",children:[t&&(0,x.jsxs)("div",{className:"user-module-icons",children:[(0,x.jsxs)("button",{className:"icon-btn notification-btn",title:"Notifications",onClick:()=>o("/user/notifications"),children:[(0,x.jsx)("i",{className:"fas fa-bell"}),(0,x.jsx)("span",{className:"notification-badge"})]}),s&&(0,x.jsx)("button",{className:"icon-btn",title:"Logout",onClick:async()=>{try{await l(),o("/login")}catch(e){o("/login")}},style:{color:"#ef4444"},children:(0,x.jsx)("i",{className:"fas fa-power-off"})})]}),a&&(0,x.jsxs)("div",{className:"user-module-profile",children:[(0,x.jsx)("div",{className:"profile-info",onClick:()=>o("/user/profile/view"),children:(0,x.jsx)(O,{size:"medium",layout:"horizontal",showEmail:!1})}),(0,x.jsxs)("div",{className:"profile-menu",ref:u,children:[(0,x.jsx)("button",{type:"button",className:"profile-dropdown-btn",onClick:()=>d(!c),children:(0,x.jsx)("i",{className:"fas fa-ellipsis-v"})}),c&&(0,x.jsxs)("div",{className:"profile-dropdown",children:[(0,x.jsxs)(r.k2,{to:"/user/profile/view",className:"dropdown-item",onClick:()=>d(!1),children:[(0,x.jsx)("i",{className:"fas fa-eye"}),(0,x.jsx)("span",{children:"View Profile"})]}),(0,x.jsxs)(r.k2,{to:"/user/profile",className:"dropdown-item",onClick:()=>d(!1),children:[(0,x.jsx)("i",{className:"fas fa-pen"}),(0,x.jsx)("span",{children:"Edit Profile"})]}),s&&(0,x.jsx)("div",{onClick:()=>d(!1),children:(0,x.jsx)(q,{variant:"minimal",size:"small",className:"dropdown-item logout-item",style:{justifyContent:"flex-start",width:"100%",background:"var(--role-primary, #3b82f6)",color:"white",marginTop:"4px",fontWeight:"600"}})})]})]})]})]})})},M=e=>{let{children:t}=e;const a=(0,w.Zp)(),{logout:s}=y(),[i,l]=(0,n.useState)(!1),o=(0,n.useRef)(null);return(0,n.useEffect)(()=>{const e=e=>{o.current&&!o.current.contains(e.target)&&l(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),(0,x.jsxs)("div",{className:"dashboard-container",children:[(0,x.jsxs)("aside",{className:"sidebar",children:[(0,x.jsx)("div",{className:"sidebar-header",children:"HFP Dashboard"}),(0,x.jsxs)("ul",{className:"sidebar-nav",children:[(0,x.jsx)("li",{className:"nav-item",children:(0,x.jsxs)(r.k2,{to:"/user/my-actions",children:[(0,x.jsx)("i",{className:"fas fa-tasks nav-icon"})," My Actions"]})}),(0,x.jsx)("li",{className:"nav-item",children:(0,x.jsxs)(r.k2,{to:"/user/profile",children:[(0,x.jsx)("i",{className:"fas fa-user nav-icon"})," Profile"]})}),(0,x.jsx)("li",{className:"nav-item",children:(0,x.jsxs)(r.k2,{to:"/user/live-rate",children:[(0,x.jsx)("i",{className:"fas fa-chart-line nav-icon"})," Live Rate"]})}),(0,x.jsx)("li",{className:"nav-item",children:(0,x.jsxs)(r.k2,{to:"/user/requests",children:[(0,x.jsx)("i",{className:"fas fa-life-ring nav-icon"})," Requests"]})}),(0,x.jsx)("li",{className:"nav-item",children:(0,x.jsxs)(r.k2,{to:"/user/transactions",children:[(0,x.jsx)("i",{className:"fas fa-receipt nav-icon"})," Transactions"]})})]}),(0,x.jsx)("div",{className:"sidebar-footer",style:{padding:"1rem",marginTop:"auto"},children:(0,x.jsxs)("button",{onClick:async()=>{try{await s(),a("/login")}catch(e){a("/login")}},style:{width:"100%",background:"rgba(239, 68, 68, 0.1)",color:"#ef4444",border:"1px solid rgba(239, 68, 68, 0.2)",padding:"10px",borderRadius:"8px",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",cursor:"pointer",transition:"all 0.2s"},onMouseEnter:e=>{e.target.style.background="#ef4444",e.target.style.color="white"},onMouseLeave:e=>{e.target.style.background="rgba(239, 68, 68, 0.1)",e.target.style.color="#ef4444"},children:[(0,x.jsx)("i",{className:"fas fa-sign-out-alt"})," Logout"]})})]}),(0,x.jsxs)("div",{className:"main-content-wrapper",children:[(0,x.jsx)("header",{className:"dashboard-header",children:(0,x.jsx)(z,{showIcons:!0,showProfile:!0,showLogout:!0})}),(0,x.jsx)("main",{className:"dashboard-content",children:t})]})]})},U=e=>{let{children:t}=e;const{isAuthenticated:a,loading:n,user:s}=y(),r=(0,w.zy)();return n?(0,x.jsx)("div",{children:"Loading..."}):a&&s?"lab"===s.role&&String(r.pathname||"").startsWith("/user")?(0,x.jsx)(w.C5,{to:"/lab/dashboard",replace:!0}):t:(0,x.jsx)(w.C5,{to:"/login",state:{from:r.pathname}})},W=e=>{let{children:t}=e;const{isAuthenticated:a,loading:n,user:s}=y(),r=(0,w.zy)(),i=new URLSearchParams(r.search),l="1"===i.get("force")||"1"===i.get("switch");if(n)return(0,x.jsx)("div",{children:"Loading..."});if(!l&&a&&s){const e=s.role;return"admin"===e?(0,x.jsx)(w.C5,{to:"/admin/home"}):"manager"===e?(0,x.jsx)(w.C5,{to:"/manager/home"}):"field_staff"===e?(0,x.jsx)(w.C5,{to:"/staff"}):(0,x.jsx)(w.C5,{to:"/user"})}return t},H=e=>{let{children:t}=e;const{isAuthenticated:a,user:n,loading:s}=y(),r=(0,w.zy)();return s?(0,x.jsx)("div",{children:"Loading..."}):a&&n&&"admin"===n.role?t:(0,x.jsx)(w.C5,{to:"/login",state:{from:r.pathname},replace:!0})},V=e=>{let{children:t}=e;const a=(0,w.Zp)(),{logout:n}=y();return(0,x.jsxs)("div",{className:"admin-layout role-admin",children:[(0,x.jsxs)("aside",{className:"admin-sidebar",children:[(0,x.jsxs)("div",{className:"admin-brand",children:[(0,x.jsx)("img",{src:"/images/logo.png",alt:"HFP"}),(0,x.jsx)("span",{children:"Admin Dashboard"})]}),(0,x.jsxs)("nav",{className:"admin-nav",children:[(0,x.jsx)(r.k2,{to:"/admin/home",className:e=>{let{isActive:t}=e;return t?"admin-link active":"admin-link"},children:"Home"}),(0,x.jsx)(r.k2,{to:"/admin/attendance",className:e=>{let{isActive:t}=e;return t?"admin-link active":"admin-link"},children:"Attendance"}),(0,x.jsx)(r.k2,{to:"/admin/staff",className:e=>{let{isActive:t}=e;return t?"admin-link active":"admin-link"},children:"Staff"}),(0,x.jsx)(r.k2,{to:"/admin/yard-stock",className:e=>{let{isActive:t}=e;return t?"admin-link active":"admin-link"},children:"Yard Stock"}),(0,x.jsx)(r.k2,{to:"/admin/godown-rubber-stock",className:e=>{let{isActive:t}=e;return t?"admin-link active":"admin-link"},children:"Godown Rubber Stock"}),(0,x.jsx)(r.k2,{to:"/admin/hanger-space",className:e=>{let{isActive:t}=e;return t?"admin-link active":"admin-link"},children:"Hanger Free Space"}),(0,x.jsx)(r.k2,{to:"/admin/chemical-stock-history",className:e=>{let{isActive:t}=e;return t?"admin-link active":"admin-link"},children:"Chemical Stock History"}),(0,x.jsx)(r.k2,{to:"/admin/worker-schedule",className:e=>{let{isActive:t}=e;return t?"admin-link active":"admin-link"},children:"Worker Schedule"}),(0,x.jsx)(r.k2,{to:"/admin/worker-documents",className:e=>{let{isActive:t}=e;return t?"admin-link active":"admin-link"},children:"Worker Documents"}),(0,x.jsx)(r.k2,{to:"/admin/create-barrel",className:e=>{let{isActive:t}=e;return t?"admin-link active":"admin-link"},children:"Barrel"}),(0,x.jsx)(r.k2,{to:"/admin/chem-requests",className:e=>{let{isActive:t}=e;return t?"admin-link active":"admin-link"},children:"Chemical Requests"}),(0,x.jsx)(r.k2,{to:"/admin/rates",className:e=>{let{isActive:t}=e;return t?"admin-link active":"admin-link"},children:"Rates"})]})]}),(0,x.jsxs)("main",{className:"admin-content brand-gradient",children:[(0,x.jsxs)("div",{className:"admin-header",children:[(0,x.jsx)("h1",{children:"Administration"}),(0,x.jsxs)("button",{className:"admin-signout",onClick:async()=>{try{await n()}finally{a("/",{replace:!0})}},title:"Sign out",children:[(0,x.jsx)("i",{className:"fas fa-sign-out-alt"}),(0,x.jsx)("span",{children:"Sign out"})]})]}),t||(0,x.jsx)(w.sv,{})]})]})},G=e=>{let{children:t}=e;const{isAuthenticated:a,user:n,loading:s}=y(),r=(0,w.zy)();return s?(0,x.jsx)("div",{children:"Loading..."}):a&&n?"manager"!==n.role&&"admin"!==n.role?(0,x.jsx)(w.C5,{to:"/user",replace:!0}):t:(0,x.jsx)(w.C5,{to:"/login",state:{from:r.pathname},replace:!0})},J=e=>{let{children:t}=e;const a=(0,w.Zp)(),{logout:s}=y(),[i]=(0,n.useState)(!0),[l,o]=(0,n.useState)(0),[c,d]=(0,n.useState)(!1),[u,h]=(0,n.useState)([]),p=(0,n.useRef)(null),f=(0,n.useRef)(null),m="http://localhost:5000",g=localStorage.getItem("token");return(0,n.useEffect)(()=>{const e=async()=>{try{if(!g)return o(0),void h([]);const e=await fetch("".concat(m,"/api/notifications?limit=5"),{headers:{Authorization:"Bearer ".concat(g)}});if(e.ok){const t=await e.json(),a=Array.isArray(null===t||void 0===t?void 0:t.notifications)?t.notifications:Array.isArray(t)?t:[];h(a),o(Number((null===t||void 0===t?void 0:t.unread)||a.filter(e=>!e.read).length))}else o(0),h([])}catch(e){o(0),h([])}};e();const t=setInterval(e,6e4);return()=>clearInterval(t)},[m,g]),(0,n.useEffect)(()=>{const e=e=>{p.current&&p.current.contains(e.target),f.current&&!f.current.contains(e.target)&&d(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),(0,x.jsxs)("div",{className:"dashboard-container",children:[(0,x.jsxs)("aside",{className:"sidebar sidebar--flush-left ".concat(i?"":"sidebar--hidden"),children:[(0,x.jsx)("div",{className:"sidebar-header",children:"Manager"}),(0,x.jsxs)("ul",{className:"sidebar-nav",children:[(0,x.jsx)("li",{className:"nav-item",children:(0,x.jsx)(r.k2,{to:"/manager/live",children:"Live Check-ins"})}),(0,x.jsx)("li",{className:"nav-item",children:(0,x.jsx)(r.k2,{to:"/manager/leaves",children:"Pending Leaves"})}),(0,x.jsx)("li",{className:"nav-item",children:(0,x.jsxs)(r.k2,{to:"/manager/attendance",style:{display:"flex",alignItems:"center"},children:[(0,x.jsx)("i",{className:"fa-solid fa-circle-check",style:{fontSize:"1.2rem",marginRight:"0.8rem",color:"inherit",display:"inline-block",width:"20px"}}),"Attendance Verify"]})}),(0,x.jsx)("li",{className:"nav-item",children:(0,x.jsx)(r.k2,{to:"/manager/completed",children:"Complaint & action"})}),(0,x.jsx)("li",{className:"nav-item",children:(0,x.jsx)(r.k2,{to:"/manager/hanger-space",children:"Hanger Space"})}),(0,x.jsx)("li",{className:"nav-item",children:(0,x.jsx)(r.k2,{to:"/manager/shifts",children:"Shift Planning"})}),(0,x.jsx)("li",{className:"nav-item",children:(0,x.jsx)(r.k2,{to:"/manager/sell-requests",children:"Sell Requests"})}),(0,x.jsx)("li",{className:"nav-item",children:(0,x.jsx)(r.k2,{to:"/manager/barrel-requests",children:"Barrel Requests"})}),(0,x.jsx)("li",{className:"nav-item",children:(0,x.jsx)(r.k2,{to:"/manager/barrel-allocation",children:"Barrel Allocation"})}),(0,x.jsx)("li",{className:"nav-item",children:(0,x.jsx)(r.k2,{to:"/manager/returned-barrels",children:"Returned Barrels"})}),(0,x.jsx)("li",{className:"nav-item",children:(0,x.jsx)(r.k2,{to:"/manager/latex-billing",children:"Latex Billing"})}),(0,x.jsx)("li",{className:"nav-item",children:(0,x.jsx)(r.k2,{to:"/manager/rates",children:"Set Live Rate"})}),(0,x.jsx)("li",{className:"nav-item",children:(0,x.jsx)(r.k2,{to:"/manager/wages",children:"Wages"})}),(0,x.jsx)("li",{className:"nav-item",children:(0,x.jsx)(r.k2,{to:"/manager/staff-salary",children:"Staff Salary"})}),(0,x.jsx)("li",{className:"nav-item",children:(0,x.jsx)(r.k2,{to:"/manager/stock",children:"Stock"})}),(0,x.jsx)("li",{className:"nav-item",children:(0,x.jsx)(r.k2,{to:"/manager/chem-requests",children:"Chemical Requests"})}),(0,x.jsx)("li",{className:"nav-item",children:(0,x.jsx)(r.k2,{to:"/manager/notifications",children:"\ud83d\udce2 Send Notifications"})})]})]}),(0,x.jsxs)("div",{className:"main-content-wrapper",children:[(0,x.jsx)("header",{className:"dashboard-header",style:{justifyContent:"flex-end"},children:(0,x.jsxs)("div",{className:"user-header-actions",children:[(0,x.jsxs)("div",{className:"notification-bell",ref:f,style:{position:"relative",marginRight:"16px"},children:[(0,x.jsxs)("button",{type:"button",className:"bell-button",onClick:()=>d(!c),style:{position:"relative",background:"transparent",border:"none",cursor:"pointer",padding:"8px",fontSize:"20px",color:"#333"},title:"Notifications",children:[(0,x.jsx)("i",{className:"fas fa-bell"}),l>0&&(0,x.jsx)("span",{style:{position:"absolute",top:"4px",right:"4px",backgroundColor:"#ef4444",color:"white",borderRadius:"50%",minWidth:"18px",height:"18px",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"11px",fontWeight:"bold",padding:"0 4px"},children:l>99?"99+":l})]}),c&&(0,x.jsxs)("div",{style:{position:"absolute",top:"100%",right:0,marginTop:"8px",width:"320px",maxHeight:"400px",backgroundColor:"white",borderRadius:"8px",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)",border:"1px solid #e5e7eb",zIndex:1e3,overflow:"hidden"},children:[(0,x.jsxs)("div",{style:{padding:"12px 16px",borderBottom:"1px solid #e5e7eb",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,x.jsx)("h3",{style:{margin:0,fontSize:"16px",fontWeight:"600"},children:"Notifications"}),l>0&&(0,x.jsxs)("span",{style:{backgroundColor:"#ef4444",color:"white",borderRadius:"12px",padding:"2px 8px",fontSize:"12px",fontWeight:"600"},children:[l," new"]})]}),(0,x.jsx)("div",{style:{maxHeight:"300px",overflowY:"auto"},children:0===u.length?(0,x.jsxs)("div",{style:{padding:"32px 16px",textAlign:"center",color:"#6b7280"},children:[(0,x.jsx)("i",{className:"fas fa-bell-slash",style:{fontSize:"32px",marginBottom:"8px",display:"block"}}),(0,x.jsx)("p",{style:{margin:0},children:"No notifications"})]}):u.map(e=>(0,x.jsx)("div",{style:{padding:"12px 16px",borderBottom:"1px solid #f3f4f6",backgroundColor:e.read?"white":"#eff6ff",cursor:"pointer",transition:"background-color 0.2s"},onMouseEnter:e=>e.currentTarget.style.backgroundColor="#f9fafb",onMouseLeave:t=>t.currentTarget.style.backgroundColor=e.read?"white":"#eff6ff",onClick:()=>{e.link&&a(e.link),d(!1)},children:(0,x.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"start"},children:[(0,x.jsxs)("div",{style:{flex:1},children:[(0,x.jsx)("div",{style:{fontWeight:e.read?"400":"600",fontSize:"14px",marginBottom:"4px"},children:e.title}),(0,x.jsx)("div",{style:{fontSize:"13px",color:"#6b7280"},children:e.message}),(0,x.jsx)("div",{style:{fontSize:"11px",color:"#9ca3af",marginTop:"4px"},children:new Date(e.createdAt).toLocaleString()})]}),!e.read&&(0,x.jsx)("div",{style:{width:"8px",height:"8px",borderRadius:"50%",backgroundColor:"#3b82f6",marginLeft:"8px",marginTop:"6px"}})]})},e._id))})]})]}),(0,x.jsx)("div",{className:"profile-menu",ref:p,children:(0,x.jsxs)("button",{type:"button",className:"profile-link",onClick:()=>{},children:[(0,x.jsx)("i",{className:"fas fa-user-circle"}),(0,x.jsx)("span",{children:"Profile"})]})}),(0,x.jsx)("button",{className:"logout-button",onClick:async()=>{try{await s(),a("/login")}catch(e){a("/login")}},children:"Logout"})]})}),(0,x.jsx)("main",{className:"dashboard-content",children:t})]})]})},Y=()=>{const[e,t]=(0,n.useState)(!0),[a,s]=(0,n.useState)(""),[r,l]=(0,n.useState)({attendance:{today:{present:0,absent:0,late:0,unverified:0},week:{present:0,absences:0},stats:{totalRecords:0,verifiedRecords:0,unverifiedRecords:0}},bills:{pending:0,totalAmount:0,byCategory:[]},rates:{pending:0,latest:[]},stock:{summary:null,alerts:[]}}),[o,c]=(0,n.useState)([]),[d,u]=(0,n.useState)(0),h=(0,w.Zp)(),p="http://localhost:5000",f=localStorage.getItem("token"),g=(0,n.useMemo)(()=>({headers:{Authorization:"Bearer ".concat(f)}}),[f]),v=(0,n.useCallback)(async()=>{t(!0),s("");try{var e,a,n,r,i,o;const t=await m.A.get("".concat(p,"/api/workers/attendance/summary/today"),g);await new Promise(e=>setTimeout(e,100));const s=await m.A.get("".concat(p,"/api/workers/attendance/stats"),g);await new Promise(e=>setTimeout(e,100));const c=await m.A.get("".concat(p,"/api/bills/manager/pending"),g);await new Promise(e=>setTimeout(e,100));const d=await m.A.get("".concat(p,"/api/daily-rates/admin/pending"),g);await new Promise(e=>setTimeout(e,100));const u=await m.A.get("".concat(p,"/api/stock/summary"),g);l({attendance:{today:t.data||{present:0,absent:0,late:0},week:{present:0,absences:0},stats:s.data||{totalRecords:0,verifiedRecords:0,unverifiedRecords:0}},bills:{pending:(null===(e=c.data)||void 0===e?void 0:e.total)||0,totalAmount:(null===(a=c.data)||void 0===a||null===(n=a.bills)||void 0===n?void 0:n.reduce((e,t)=>e+t.requestedAmount,0))||0,byCategory:(null===(r=c.data)||void 0===r?void 0:r.stats)||[]},rates:{pending:(null===(i=d.data)||void 0===i?void 0:i.total)||0,latest:(null===(o=d.data)||void 0===o?void 0:o.rates)||[]},stock:{summary:u.data||null,alerts:[]}})}catch(u){var c,d;s((null===u||void 0===u||null===(c=u.response)||void 0===c||null===(d=c.data)||void 0===d?void 0:d.message)||(null===u||void 0===u?void 0:u.message)||"Failed to load dashboard data")}finally{t(!1)}},[p,g]);(0,n.useEffect)(()=>{v();const e=setInterval(v,3e5);return()=>clearInterval(e)},[v]),(0,n.useEffect)(()=>{const e=async()=>{try{if(!f)return console.log("No authentication token found, skipping notifications"),c([]),void u(0);const e=await fetch("".concat(p,"/api/notifications?limit=10"),{headers:g});if(e.ok){const t=await e.json(),a=Array.isArray(null===t||void 0===t?void 0:t.notifications)?t.notifications:Array.isArray(t)?t:[];c(a),u(Number((null===t||void 0===t?void 0:t.unread)||a.filter(e=>!e.read).length))}else{if(401===e.status)return console.log("User not authenticated, redirecting to login"),void h("/login");if(429===e.status)return void console.log("Notifications rate limited, will retry later");c([]),u(0)}}catch(a){var e;null!==(e=a.message)&&void 0!==e&&e.includes("429")||console.error("Error loading notifications:",a),c([]),u(0)}};e();const t=setInterval(e,12e4);return()=>clearInterval(t)},[p,g,f,h]);const y=e=>{if(!e)return null;const t={sampleId:"Sample ID",customerName:"Customer",calculatedAmount:"Amount",marketRate:"Market Rate",companyRate:"Company Rate",quantity:"Quantity",drcPercentage:"DRC %",requestId:"Request ID",barrelCount:"Barrel Count",customer:"Customer",receivedAt:"Received At",workerId:"Worker ID",billId:"Bill ID"};return Object.entries(e).filter(e=>{let[t,a]=e;return void 0!==a&&null!==a&&""!==a}).map(e=>{let[a,n]=e;return{label:t[a]||a.replace(/([A-Z])/g," $1").trim(),value:String(n)}})},b=e=>{if(!e)return"\ud83d\udccb";const t=e.toLowerCase();return t.includes("billing")||t.includes("latex")?"\ud83d\udcb0":t.includes("drc")||t.includes("test")?"\ud83e\uddea":t.includes("attendance")?"\ud83d\udc65":t.includes("leave")?"\ud83d\udcc5":t.includes("bill")||t.includes("payment")?"\ud83d\udcb3":t.includes("stock")||t.includes("inventory")?"\ud83d\udce6":t.includes("rate")?"\ud83d\udcb9":t.includes("delivery")?"\ud83d\ude9a":"\ud83d\udccb"};return e?(0,x.jsxs)("div",{className:"manager-dashboard",style:{textAlign:"center",paddingTop:60},children:[(0,x.jsx)("h2",{children:"Manager Dashboard"}),(0,x.jsx)("div",{children:"Loading dashboard data..."})]}):(0,x.jsxs)("div",{style:{padding:16},children:[(0,x.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:24},children:[(0,x.jsx)("h2",{style:{margin:0},children:"Manager Dashboard"}),(0,x.jsx)("button",{onClick:v,disabled:e,children:e?"Refreshing...":"Refresh"})]}),a&&(0,x.jsx)("div",{style:{color:"tomato",marginBottom:16,padding:12,background:"#fee",borderRadius:4},children:a}),(0,x.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",gap:16,marginBottom:32},children:[(0,x.jsxs)("div",{className:"dash-card",children:[(0,x.jsx)("h4",{style:{marginTop:0,color:"#2563eb"},children:"Today's Attendance"}),(0,x.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8},children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("div",{style:{fontSize:24,fontWeight:"bold",color:"#16a34a"},children:r.attendance.today.present}),(0,x.jsx)("div",{style:{fontSize:12,color:"#6b7280"},children:"Present"})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("div",{style:{fontSize:24,fontWeight:"bold",color:"#dc2626"},children:r.attendance.today.absent}),(0,x.jsx)("div",{style:{fontSize:12,color:"#6b7280"},children:"Absent"})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("div",{style:{fontSize:24,fontWeight:"bold",color:"#d97706"},children:r.attendance.today.late}),(0,x.jsx)("div",{style:{fontSize:12,color:"#6b7280"},children:"Late"})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("div",{style:{fontSize:24,fontWeight:"bold",color:"#7c3aed"},children:r.attendance.stats.unverifiedRecords}),(0,x.jsx)("div",{style:{fontSize:12,color:"#6b7280"},children:"Unverified"})]})]})]}),(0,x.jsxs)("div",{className:"dash-card",children:[(0,x.jsx)("h4",{style:{marginTop:0,color:"#2563eb"},children:"Pending Bill Requests"}),(0,x.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8},children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("div",{style:{fontSize:24,fontWeight:"bold",color:"#dc2626"},children:r.bills.pending}),(0,x.jsx)("div",{style:{fontSize:12,color:"#6b7280"},children:"Requests"})]}),(0,x.jsxs)("div",{children:[(0,x.jsxs)("div",{style:{fontSize:24,fontWeight:"bold",color:"#16a34a"},children:["\u20b9",r.bills.totalAmount.toLocaleString()]}),(0,x.jsx)("div",{style:{fontSize:12,color:"#6b7280"},children:"Total Amount"})]})]}),r.bills.byCategory.length>0&&(0,x.jsxs)("div",{style:{marginTop:12,fontSize:12},children:[(0,x.jsx)("div",{style:{fontWeight:"bold",marginBottom:4},children:"By Category:"}),r.bills.byCategory.map((e,t)=>(0,x.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,x.jsxs)("span",{children:[e._id,":"]}),(0,x.jsxs)("span",{children:[e.count," (\u20b9",e.totalAmount.toLocaleString(),")"]})]},t))]})]}),(0,x.jsxs)("div",{className:"dash-card",children:[(0,x.jsx)("h4",{style:{marginTop:0,color:"#2563eb"},children:"Rate Updates"}),(0,x.jsxs)("div",{children:[(0,x.jsx)("div",{style:{fontSize:24,fontWeight:"bold",color:"#dc2626"},children:r.rates.pending}),(0,x.jsx)("div",{style:{fontSize:12,color:"#6b7280"},children:"Pending Admin Approval"})]}),r.rates.latest.length>0&&(0,x.jsxs)("div",{style:{marginTop:12,fontSize:12},children:[(0,x.jsx)("div",{style:{fontWeight:"bold",marginBottom:4},children:"Recent Submissions:"}),r.rates.latest.slice(0,3).map((e,t)=>(0,x.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,x.jsxs)("span",{children:[e.category,":"]}),(0,x.jsxs)("span",{children:["\u20b9",e.inr," / $",e.usd]})]},t))]})]}),(0,x.jsxs)("div",{className:"dash-card",children:[(0,x.jsx)("h4",{style:{marginTop:0,color:"#2563eb"},children:"Stock Overview"}),r.stock.summary?(0,x.jsxs)("div",{children:[(0,x.jsx)("div",{style:{fontSize:24,fontWeight:"bold",color:"#16a34a"},children:r.stock.summary.rubberBandUnits||0}),(0,x.jsx)("div",{style:{fontSize:12,color:"#6b7280"},children:"Rubber Band Units"}),void 0!==r.stock.summary.latexLiters&&(0,x.jsxs)("div",{style:{marginTop:8},children:[(0,x.jsxs)("div",{style:{fontSize:18,fontWeight:"bold",color:"#2563eb"},children:[r.stock.summary.latexLiters,"L"]}),(0,x.jsx)("div",{style:{fontSize:12,color:"#6b7280"},children:"Latex Stock"})]})]}):(0,x.jsx)("div",{style:{color:"#6b7280"},children:"No stock data available"})]})]}),(0,x.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:16,marginBottom:32},children:[(0,x.jsxs)("button",{className:"btn btn-primary",onClick:()=>window.location.href="/manager/attendance",style:{padding:16,textAlign:"center"},children:[(0,x.jsx)("div",{style:{fontSize:18,fontWeight:"bold"},children:"Verify Attendance"}),(0,x.jsx)("div",{style:{fontSize:12,opacity:.8},children:"GPS-based verification"})]}),(0,x.jsxs)("button",{className:"btn btn-primary",onClick:()=>window.location.href="/manager/bills",style:{padding:16,textAlign:"center"},children:[(0,x.jsx)("div",{style:{fontSize:18,fontWeight:"bold"},children:"Review Bills"}),(0,x.jsxs)("div",{style:{fontSize:12,opacity:.8},children:[r.bills.pending," pending"]})]}),(0,x.jsxs)("button",{className:"btn btn-primary",onClick:()=>window.location.href="/manager/rates",style:{padding:16,textAlign:"center"},children:[(0,x.jsx)("div",{style:{fontSize:18,fontWeight:"bold"},children:"Update Rates"}),(0,x.jsx)("div",{style:{fontSize:12,opacity:.8},children:"Submit for admin approval"})]}),(0,x.jsxs)("button",{className:"btn btn-primary",onClick:()=>window.location.href="/manager/shifts",style:{padding:16,textAlign:"center"},children:[(0,x.jsx)("div",{style:{fontSize:18,fontWeight:"bold"},children:"Manage Shifts"}),(0,x.jsx)("div",{style:{fontSize:12,opacity:.8},children:"Create schedules"})]}),(0,x.jsxs)("button",{className:"btn btn-primary",onClick:()=>window.location.href="/manager/stock",style:{padding:16,textAlign:"center"},children:[(0,x.jsx)("div",{style:{fontSize:18,fontWeight:"bold"},children:"Monitor Stock"}),(0,x.jsx)("div",{style:{fontSize:12,opacity:.8},children:"View-only access"})]}),(0,x.jsxs)("button",{className:"btn btn-primary",onClick:()=>window.location.href="/manager/reports",style:{padding:16,textAlign:"center"},children:[(0,x.jsx)("div",{style:{fontSize:18,fontWeight:"bold"},children:"Generate Reports"}),(0,x.jsx)("div",{style:{fontSize:12,opacity:.8},children:"For admin review"})]})]}),(0,x.jsxs)("div",{className:"notifications-section",children:[(0,x.jsxs)("div",{className:"notifications-header",children:[(0,x.jsx)("h4",{children:"Recent Notifications"}),d>0&&(0,x.jsxs)("span",{className:"unread-badge",children:[d," new"]})]}),0===o.length?(0,x.jsxs)("div",{className:"empty-state",children:[(0,x.jsx)("div",{className:"empty-icon",children:"\ud83d\udd14"}),(0,x.jsx)("p",{className:"empty-text",children:"No notifications at the moment"}),(0,x.jsx)("p",{className:"empty-subtext",children:"You're all caught up!"})]}):(0,x.jsx)("div",{className:"notifications-list",children:o.slice(0,5).map(e=>(0,x.jsxs)("div",{className:"notification-item ".concat(e.read?"":"unread"),children:[(0,x.jsx)("div",{className:"notification-icon",children:b(e.title)}),(0,x.jsxs)("div",{className:"notification-content",children:[(0,x.jsx)("div",{className:"notification-title",children:e.title||"Update"}),(0,x.jsx)("div",{className:"notification-message",children:e.message}),e.meta&&y(e.meta)&&y(e.meta).length>0&&(0,x.jsx)("div",{className:"notification-metadata",children:y(e.meta).map((e,t)=>(0,x.jsxs)("span",{className:"metadata-item",children:[(0,x.jsxs)("strong",{children:[e.label,":"]})," ",e.value]},t))}),(0,x.jsx)("div",{className:"notification-time",children:new Date(e.createdAt).toLocaleString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})})]}),(0,x.jsxs)("div",{className:"notification-actions",children:[e.link&&(0,x.jsx)("button",{className:"notif-action-btn notif-open-btn",onClick:()=>{e.link.startsWith("http")?window.open(e.link,"_blank"):h(e.link)},children:"Open"}),!e.read&&(0,x.jsx)("button",{className:"notif-action-btn notif-mark-btn",onClick:()=>(async e=>{try{(await fetch("".concat(p,"/api/notifications/").concat(e,"/read"),{method:"PATCH",headers:g})).ok&&(c(t=>t.map(t=>t._id===e?(0,i.A)((0,i.A)({},t),{},{read:!0}):t)),u(e=>Math.max(0,e-1)))}catch(t){}})(e._id),children:"Mark Read"})]})]},e._id))})]})]})},K=()=>{const e="http://localhost:5000",t="undefined"!==typeof window?localStorage.getItem("token"):null,[a,s]=(0,n.useState)(!0),[r,i]=(0,n.useState)(""),[l,o]=(0,n.useState)({today:{present:0,absent:0,late:0},week:{present:0,absences:0},pendingLeaves:0}),c=(0,n.useCallback)(async()=>{s(!0),i("");try{const a=t?{Authorization:"Bearer ".concat(t)}:{},[n,s,r]=await Promise.all([fetch("".concat(e,"/api/workers/attendance/summary/today"),{headers:a}),fetch("".concat(e,"/api/workers/attendance/summary/week"),{headers:a}),fetch("".concat(e,"/api/leave/pending-count"),{headers:a})]),i=async e=>{if(!e.ok)return null;return(e.headers.get("content-type")||"").includes("application/json")?e.json():null},[l,c,d]=await Promise.all([i(n),i(s),i(r)]);o({today:l||{present:0,absent:0,late:0},week:c||{present:0,absences:0},pendingLeaves:d&&d.count||0})}catch(a){i((null===a||void 0===a?void 0:a.message)||"Failed to load")}finally{s(!1)}},[t,e]);return(0,n.useEffect)(()=>{c()},[c]),(0,x.jsxs)("div",{style:{padding:16},children:[(0,x.jsx)("h2",{children:"Manager Overview"}),r&&(0,x.jsx)("div",{style:{color:"tomato",marginTop:8},children:r}),a?(0,x.jsx)("div",{children:"Loading..."}):(0,x.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(220px, 1fr))",gap:12,marginTop:12},children:[(0,x.jsxs)("div",{className:"dash-card",children:[(0,x.jsx)("h4",{style:{marginTop:0},children:"Today Attendance"}),(0,x.jsxs)("div",{children:["Present: ",(0,x.jsx)("b",{children:l.today.present})]}),(0,x.jsxs)("div",{children:["Absent: ",(0,x.jsx)("b",{children:l.today.absent})]}),(0,x.jsxs)("div",{children:["Late: ",(0,x.jsx)("b",{children:l.today.late})]})]}),(0,x.jsxs)("div",{className:"dash-card",children:[(0,x.jsx)("h4",{style:{marginTop:0},children:"This Week"}),(0,x.jsxs)("div",{children:["Present Entries: ",(0,x.jsx)("b",{children:l.week.present})]}),(0,x.jsxs)("div",{children:["Absences: ",(0,x.jsx)("b",{children:l.week.absences})]})]}),(0,x.jsxs)("div",{className:"dash-card",children:[(0,x.jsx)("h4",{style:{marginTop:0},children:"Pending Approvals"}),(0,x.jsxs)("div",{children:["Leave Requests: ",(0,x.jsx)("b",{children:l.pendingLeaves})]})]})]})]})};function Q(){const e=localStorage.getItem("token");return e?{Authorization:"Bearer ".concat(e)}:{}}const $=()=>{var e,t;const[a,s]=(0,n.useState)([]),[r,i]=(0,n.useState)(!1),[l,o]=(0,n.useState)(""),[c,d]=(0,n.useState)(null),u=async()=>{i(!0),o("");try{const e=await fetch("".concat("http://localhost:5000","/api/delivery/locations?role=delivery_staff"),{headers:Q(),credentials:"include"});if(!e.ok){const t=await e.text();throw new Error("Failed (".concat(e.status,") ").concat(t.slice(0,80)))}const t=await e.json(),a=Array.isArray(null===t||void 0===t?void 0:t.items)?t.items:[];s(a),!c&&a.length&&d(a[0])}catch(e){o((null===e||void 0===e?void 0:e.message)||"Failed to load locations")}finally{i(!1)}};(0,n.useEffect)(()=>{u()},[]);const h=(0,n.useMemo)(()=>{var e;const t=null===c||void 0===c?void 0:c.coords;if(t&&"number"===typeof t.lat&&"number"===typeof t.lng)return t;return(null===(e=a[0])||void 0===e?void 0:e.coords)||{lat:9.5916,lng:76.5222}},[c,a]);return(0,x.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"280px 1fr",gap:16},children:[(0,x.jsxs)("aside",{style:{background:"#fff",border:"1px solid #e5e7eb",borderRadius:12,padding:12},children:[(0,x.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,x.jsx)("h3",{style:{margin:0},children:"Live Staff"}),(0,x.jsx)("button",{onClick:u,disabled:r,className:"btn btn-sm",children:r?"...":"Refresh"})]}),l&&(0,x.jsx)("div",{style:{color:"tomato",marginTop:8},children:l}),(0,x.jsxs)("ul",{style:{listStyle:"none",margin:0,padding:0,marginTop:8,display:"grid",gap:8},children:[a.map(e=>{var t,a,n,s,r,i,l,o,u;return(0,x.jsxs)("li",{style:{border:"1px solid #e5e7eb",borderRadius:10,padding:8,cursor:"pointer",background:(null===c||void 0===c?void 0:c._id)===e._id?"#fef3c7":"#fff"},onClick:()=>d(e),children:[(0,x.jsx)("div",{style:{fontWeight:700},children:(null===(t=e.user)||void 0===t?void 0:t.name)||(null===(a=e.user)||void 0===a?void 0:a.email)||"Unknown"}),(0,x.jsx)("div",{style:{fontSize:12,color:"#64748b"},children:(null===(n=e.user)||void 0===n?void 0:n.role)||"staff"}),(0,x.jsxs)("div",{style:{fontSize:12,color:"#475569",marginTop:4},children:["Lat ",null===(s=e.coords)||void 0===s||null===(r=s.lat)||void 0===r||null===(i=r.toFixed)||void 0===i?void 0:i.call(r,5)," \u2022 Lng ",null===(l=e.coords)||void 0===l||null===(o=l.lng)||void 0===o||null===(u=o.toFixed)||void 0===u?void 0:u.call(o,5)]}),(0,x.jsxs)("div",{style:{display:"flex",gap:8,marginTop:6},children:[e.coords&&(0,x.jsx)("a",{className:"btn btn-sm",target:"_blank",rel:"noreferrer",href:"https://www.google.com/maps?q=".concat(e.coords.lat,",").concat(e.coords.lng),children:"Open Map"}),(0,x.jsx)("span",{style:{fontSize:12,alignSelf:"center",color:"#94a3b8"},children:new Date(e.updatedAt).toLocaleString()})]})]},e._id)}),0===a.length&&!r&&(0,x.jsx)("li",{style:{color:"#64748b"},children:"No active locations"})]})]}),(0,x.jsxs)("section",{style:{background:"#fff",border:"1px solid #e5e7eb",borderRadius:12,padding:12},children:[(0,x.jsx)("h3",{style:{marginTop:0},children:"Map View"}),(0,x.jsx)("div",{style:{position:"relative",width:"100%",height:480,borderRadius:12,overflow:"hidden",boxShadow:"0 12px 28px rgba(0,0,0,0.08)"},children:(0,x.jsx)("iframe",{title:"Live Staff Map",src:"https://www.google.com/maps?q=".concat(h.lat,",").concat(h.lng,"&z=13&output=embed"),loading:"lazy",style:{position:"absolute",inset:0,width:"100%",height:"100%",border:0}})}),c&&(0,x.jsxs)("div",{style:{marginTop:12,color:"#475569"},children:["Focusing: ",(0,x.jsx)("strong",{children:(null===(e=c.user)||void 0===e?void 0:e.name)||(null===(t=c.user)||void 0===t?void 0:t.email)||"Unknown"})," \u2014 ",new Date(c.updatedAt).toLocaleString()]})]})]})},X="http://localhost:5000",Z=()=>{try{const e=localStorage.getItem("token");return e?{Authorization:"Bearer ".concat(e)}:{}}catch(e){return{}}},ee=(e,t)=>m.A.get(e,{withCredentials:!0,headers:Z(),params:t}).then(e=>e.data),te=(e,t)=>m.A.post(e,t,{withCredentials:!0,headers:Z()}).then(e=>e.data),ae=(e,t)=>m.A.put(e,t,{withCredentials:!0,headers:Z()}).then(e=>e.data),ne=e=>ee("".concat(X,"/api/schedules/by-week"),{weekStart:e}),se=()=>ee("".concat(X,"/api/hanger-spaces")),re=()=>te("".concat(X,"/api/hanger-spaces/seed-grid")),ie=function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return ae("".concat(X,"/api/hanger-spaces/").concat(e,"/status"),{status:t,product:a})},le=(e,t)=>te("".concat(X,"/api/hanger-spaces/bulk/status"),{ids:e,status:t}),oe=e=>te("".concat(X,"/api/barrel-logistics/approve/purchase"),{barrelId:e}),ce=e=>te("".concat(X,"/api/barrel-logistics/approve/disposal"),{barrelId:e}),de=e=>te("".concat(X,"/api/barrel-logistics/request/disposal"),{barrelId:e}),ue=()=>ee("".concat(X,"/api/stock")),he=()=>ee("".concat(X,"/api/chemicals")),pe=()=>ee("".concat(X,"/api/chemicals/alerts/all")),fe=()=>{const e=(0,n.useMemo)(()=>{return e=new Date,new Date(e).toISOString().slice(0,10);var e},[]),[t,a]=(0,n.useState)([]),[s,r]=(0,n.useState)(!0),[i,l]=(0,n.useState)(""),[o,c]=(0,n.useState)(""),[d,u]=(0,n.useState)("all"),[h,p]=(0,n.useState)("table"),[f,m]=(0,n.useState)(!0),[g,v]=(0,n.useState)(0),y=(0,n.useCallback)(async()=>{r(!0),l("");try{const t=await function(){let{from:e,to:t,staffId:a,page:n=1,limit:s=50}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return ee("".concat(X,"/api/workers/attendance"),{from:e,to:t,staffId:a,page:n,limit:s})}({from:e,to:e,limit:500}),n=(Array.isArray(null===t||void 0===t?void 0:t.records)?t.records:Array.isArray(t)?t:[]).filter(e=>e.checkInAt&&!e.checkOutAt);a(n)}catch(t){l((null===t||void 0===t?void 0:t.message)||"Failed to load"),a([])}finally{r(!1)}},[e]);(0,n.useEffect)(()=>{if(y(),f){const e=setInterval(y,3e4);return()=>clearInterval(e)}},[y,f]),(0,n.useEffect)(()=>{const e=setInterval(()=>v(e=>e+1),1e3);return()=>clearInterval(e)},[]);const b=(0,n.useMemo)(()=>{let e=[...t];if(o.trim()){const t=o.toLowerCase();e=e.filter(e=>(e.staffName||"").toLowerCase().includes(t)||(e.staff||"").toLowerCase().includes(t)||(e.role||"").toLowerCase().includes(t)||(e.department||"").toLowerCase().includes(t))}return"on-time"===d?e=e.filter(e=>!e.isLate):"late"===d&&(e=e.filter(e=>e.isLate)),e},[t,o,d]),j=(0,n.useMemo)(()=>({total:t.length,onTime:t.filter(e=>!e.isLate).length,late:t.filter(e=>e.isLate).length,avgDuration:t.length>0?t.reduce((e,t)=>{const a=t.checkInAt?new Date(t.checkInAt):null;return e+(a?Date.now()-a.getTime():0)},0)/t.length:0}),[t,g]),w=e=>{const t=Math.floor(e/1e3),a=String(Math.floor(t/3600)).padStart(2,"0"),n=String(Math.floor(t%3600/60)).padStart(2,"0"),s=String(t%60).padStart(2,"0");return"".concat(a,":").concat(n,":").concat(s)},N=e=>{if(!e)return"?";const t=e.trim().split(" ");return 1===t.length?t[0].charAt(0).toUpperCase():(t[0].charAt(0)+t[t.length-1].charAt(0)).toUpperCase()},S=e=>({manager:"#8b5cf6",delivery_staff:"#3b82f6",lab:"#10b981",accountant:"#f59e0b",admin:"#ef4444",field_staff:"#06b6d4",staff:"#6b7280"}[e]||"#6b7280");return(0,x.jsxs)("div",{style:{padding:16,maxWidth:1400,margin:"0 auto"},children:[(0,x.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:24},children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("h2",{style:{margin:0,fontSize:28,color:"#1e293b"},children:"\ud83d\udd34 Live Check-ins"}),(0,x.jsx)("p",{style:{margin:"4px 0 0 0",color:"#64748b",fontSize:14},children:"Real-time staff attendance monitoring \u2022 Updates every 30 seconds"})]}),(0,x.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[(0,x.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:6,fontSize:14,color:"#475569"},children:[(0,x.jsx)("input",{type:"checkbox",checked:f,onChange:e=>m(e.target.checked),style:{cursor:"pointer"}}),"Auto-refresh"]}),(0,x.jsx)("button",{className:"btn",onClick:y,disabled:s,style:{background:"#10b981",borderColor:"#10b981",minWidth:100},children:s?"\u23f3 Loading...":"\ud83d\udd04 Refresh"})]})]}),i&&(0,x.jsxs)("div",{style:{background:"#fee2e2",border:"1px solid #ef4444",color:"#dc2626",padding:12,borderRadius:8,marginBottom:16},children:["\u26a0\ufe0f ",i]}),(0,x.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:16,marginBottom:24},children:[(0,x.jsxs)("div",{style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",padding:20,borderRadius:12,color:"white",boxShadow:"0 4px 6px rgba(0,0,0,0.1)"},children:[(0,x.jsx)("div",{style:{fontSize:14,opacity:.9,marginBottom:8},children:"\ud83d\udc65 Currently Active"}),(0,x.jsx)("div",{style:{fontSize:36,fontWeight:"bold"},children:j.total}),(0,x.jsx)("div",{style:{fontSize:12,opacity:.8,marginTop:4},children:"Staff checked in"})]}),(0,x.jsxs)("div",{style:{background:"linear-gradient(135deg, #10b981 0%, #059669 100%)",padding:20,borderRadius:12,color:"white",boxShadow:"0 4px 6px rgba(0,0,0,0.1)"},children:[(0,x.jsx)("div",{style:{fontSize:14,opacity:.9,marginBottom:8},children:"\u2705 On Time"}),(0,x.jsx)("div",{style:{fontSize:36,fontWeight:"bold"},children:j.onTime}),(0,x.jsxs)("div",{style:{fontSize:12,opacity:.8,marginTop:4},children:[j.total>0?Math.round(j.onTime/j.total*100):0,"% punctuality"]})]}),(0,x.jsxs)("div",{style:{background:"linear-gradient(135deg, #f59e0b 0%, #d97706 100%)",padding:20,borderRadius:12,color:"white",boxShadow:"0 4px 6px rgba(0,0,0,0.1)"},children:[(0,x.jsx)("div",{style:{fontSize:14,opacity:.9,marginBottom:8},children:"\u23f0 Late Arrivals"}),(0,x.jsx)("div",{style:{fontSize:36,fontWeight:"bold"},children:j.late}),(0,x.jsxs)("div",{style:{fontSize:12,opacity:.8,marginTop:4},children:[j.total>0?Math.round(j.late/j.total*100):0,"% late today"]})]}),(0,x.jsxs)("div",{style:{background:"linear-gradient(135deg, #3b82f6 0%, #2563eb 100%)",padding:20,borderRadius:12,color:"white",boxShadow:"0 4px 6px rgba(0,0,0,0.1)"},children:[(0,x.jsx)("div",{style:{fontSize:14,opacity:.9,marginBottom:8},children:"\u23f1\ufe0f Avg Duration"}),(0,x.jsxs)("div",{style:{fontSize:36,fontWeight:"bold"},children:[j.avgDuration>0?w(j.avgDuration).split(":")[0]:"0","h"]}),(0,x.jsxs)("div",{style:{fontSize:12,opacity:.8,marginTop:4},children:[w(j.avgDuration)," average"]})]})]}),(0,x.jsxs)("div",{style:{background:"white",padding:16,borderRadius:12,boxShadow:"0 1px 3px rgba(0,0,0,0.1)",marginBottom:16,display:"flex",gap:12,flexWrap:"wrap",alignItems:"center"},children:[(0,x.jsx)("input",{type:"text",placeholder:"\ud83d\udd0d Search staff by name, ID, or role...",value:o,onChange:e=>c(e.target.value),style:{flex:1,minWidth:250,padding:"10px 14px",border:"1px solid #e2e8f0",borderRadius:8,fontSize:14}}),(0,x.jsxs)("select",{value:d,onChange:e=>u(e.target.value),style:{padding:"10px 14px",border:"1px solid #e2e8f0",borderRadius:8,fontSize:14,cursor:"pointer"},children:[(0,x.jsxs)("option",{value:"all",children:["\ud83d\udccb All (",t.length,")"]}),(0,x.jsxs)("option",{value:"on-time",children:["\u2705 On Time (",j.onTime,")"]}),(0,x.jsxs)("option",{value:"late",children:["\u23f0 Late (",j.late,")"]})]}),(0,x.jsxs)("div",{style:{display:"flex",gap:4,background:"#f1f5f9",borderRadius:8,padding:4},children:[(0,x.jsx)("button",{onClick:()=>p("table"),style:{padding:"6px 12px",border:"none",borderRadius:6,background:"table"===h?"white":"transparent",cursor:"pointer",fontSize:14,fontWeight:"table"===h?"bold":"normal"},children:"\ud83d\udcca Table"}),(0,x.jsx)("button",{onClick:()=>p("grid"),style:{padding:"6px 12px",border:"none",borderRadius:6,background:"grid"===h?"white":"transparent",cursor:"pointer",fontSize:14,fontWeight:"grid"===h?"bold":"normal"},children:"\ud83c\udfb4 Cards"})]}),(0,x.jsxs)("div",{style:{marginLeft:"auto",color:"#64748b",fontSize:13},children:["Showing ",b.length," of ",t.length]})]}),"table"===h?(0,x.jsx)("div",{style:{background:"white",borderRadius:12,boxShadow:"0 1px 3px rgba(0,0,0,0.1)",overflow:"hidden"},children:(0,x.jsx)("div",{style:{overflowX:"auto"},children:(0,x.jsxs)("table",{className:"dashboard-table",style:{minWidth:800,margin:0},children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{style:{background:"#f8fafc"},children:[(0,x.jsx)("th",{style:{padding:"14px 16px"},children:"Staff"}),(0,x.jsx)("th",{style:{padding:"14px 16px"},children:"Staff ID"}),(0,x.jsx)("th",{style:{padding:"14px 16px"},children:"Role"}),(0,x.jsx)("th",{style:{padding:"14px 16px"},children:"Check In"}),(0,x.jsx)("th",{style:{padding:"14px 16px"},children:"Status"}),(0,x.jsx)("th",{style:{padding:"14px 16px"},children:"Duration"})]})}),(0,x.jsxs)("tbody",{children:[b.map(e=>{const t=e.checkInAt?new Date(e.checkInAt):null,a=t?Date.now()-t.getTime():0,n=S(e.role);return(0,x.jsxs)("tr",{style:{borderBottom:"1px solid #f1f5f9"},children:[(0,x.jsx)("td",{style:{padding:"12px 16px"},children:(0,x.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12},children:[(0,x.jsx)("div",{style:{width:40,height:40,borderRadius:"50%",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:"bold",fontSize:14},children:N(e.staffName)}),(0,x.jsxs)("div",{children:[(0,x.jsx)("div",{style:{fontWeight:"600",color:"#1e293b"},children:e.staffName||"-"}),(0,x.jsx)("div",{style:{fontSize:12,color:"#64748b"},children:e.department||"N/A"})]})]})}),(0,x.jsx)("td",{style:{padding:"12px 16px",color:"#475569"},children:e.staff||"-"}),(0,x.jsx)("td",{style:{padding:"12px 16px"},children:(0,x.jsx)("span",{style:{background:n,color:"white",padding:"4px 10px",borderRadius:12,fontSize:12,fontWeight:"500"},children:e.role||"Staff"})}),(0,x.jsx)("td",{style:{padding:"12px 16px",color:"#475569"},children:t?t.toLocaleTimeString("en-IN",{hour:"2-digit",minute:"2-digit"}):"-"}),(0,x.jsx)("td",{style:{padding:"12px 16px"},children:e.isLate?(0,x.jsx)("span",{style:{background:"#fee2e2",color:"#dc2626",padding:"4px 10px",borderRadius:12,fontSize:12,fontWeight:"500"},children:"\u23f0 Late"}):(0,x.jsx)("span",{style:{background:"#d1fae5",color:"#059669",padding:"4px 10px",borderRadius:12,fontSize:12,fontWeight:"500"},children:"\u2705 On Time"})}),(0,x.jsx)("td",{style:{padding:"12px 16px"},children:(0,x.jsx)("span",{style:{background:"#eff6ff",color:"#2563eb",padding:"6px 12px",borderRadius:8,fontSize:14,fontWeight:"600",fontFamily:"monospace"},children:t?w(a):"-"})})]},"".concat(e.staff,"-").concat(e.date))}),!s&&0===b.length&&(0,x.jsx)("tr",{children:(0,x.jsxs)("td",{colSpan:6,style:{padding:48,textAlign:"center"},children:[(0,x.jsx)("div",{style:{fontSize:48,marginBottom:12},children:o||"all"!==d?"\ud83d\udd0d":"\ud83d\ude34"}),(0,x.jsx)("div",{style:{fontSize:18,fontWeight:"bold",color:"#64748b",marginBottom:4},children:o||"all"!==d?"No matching staff found":"No one is currently checked in"}),(0,x.jsx)("div",{style:{fontSize:14,color:"#94a3b8"},children:o||"all"!==d?"Try adjusting your search or filters":"Staff will appear here when they check in"})]})})]})]})})}):(0,x.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(300px, 1fr))",gap:16},children:[b.map(e=>{const t=e.checkInAt?new Date(e.checkInAt):null,a=t?Date.now()-t.getTime():0,n=S(e.role);return(0,x.jsxs)("div",{style:{background:"white",borderRadius:12,padding:20,boxShadow:"0 1px 3px rgba(0,0,0,0.1)",border:e.isLate?"2px solid #fecaca":"2px solid #d1fae5",transition:"transform 0.2s, box-shadow 0.2s",cursor:"pointer"},onMouseEnter:e=>{e.currentTarget.style.transform="translateY(-4px)",e.currentTarget.style.boxShadow="0 8px 16px rgba(0,0,0,0.15)"},onMouseLeave:e=>{e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="0 1px 3px rgba(0,0,0,0.1)"},children:[(0,x.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:16},children:[(0,x.jsx)("div",{style:{width:56,height:56,borderRadius:"50%",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:"bold",fontSize:20},children:N(e.staffName)}),(0,x.jsxs)("div",{style:{flex:1},children:[(0,x.jsx)("div",{style:{fontWeight:"bold",fontSize:16,color:"#1e293b",marginBottom:2},children:e.staffName||"Unknown"}),(0,x.jsxs)("div",{style:{fontSize:13,color:"#64748b"},children:["ID: ",e.staff||"-"]})]}),e.isLate?(0,x.jsx)("div",{style:{width:12,height:12,borderRadius:"50%",background:"#ef4444",animation:"pulse 2s infinite"}}):(0,x.jsx)("div",{style:{width:12,height:12,borderRadius:"50%",background:"#10b981"}})]}),(0,x.jsxs)("div",{style:{display:"grid",gap:10},children:[(0,x.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,x.jsx)("span",{style:{fontSize:13,color:"#64748b"},children:"Role"}),(0,x.jsx)("span",{style:{background:n,color:"white",padding:"3px 8px",borderRadius:10,fontSize:11,fontWeight:"600"},children:e.role||"Staff"})]}),(0,x.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,x.jsx)("span",{style:{fontSize:13,color:"#64748b"},children:"Check In"}),(0,x.jsx)("span",{style:{fontSize:13,fontWeight:"600",color:"#1e293b"},children:t?t.toLocaleTimeString("en-IN",{hour:"2-digit",minute:"2-digit"}):"-"})]}),(0,x.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,x.jsx)("span",{style:{fontSize:13,color:"#64748b"},children:"Status"}),(0,x.jsx)("span",{style:{background:e.isLate?"#fee2e2":"#d1fae5",color:e.isLate?"#dc2626":"#059669",padding:"3px 8px",borderRadius:10,fontSize:11,fontWeight:"600"},children:e.isLate?"\u23f0 Late":"\u2705 On Time"})]}),(0,x.jsxs)("div",{style:{marginTop:8,padding:"12px",background:"linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%)",borderRadius:8,textAlign:"center"},children:[(0,x.jsx)("div",{style:{fontSize:11,color:"#64748b",marginBottom:4},children:"Duration"}),(0,x.jsx)("div",{style:{fontSize:24,fontWeight:"bold",color:"#2563eb",fontFamily:"monospace"},children:t?w(a):"--:--:--"})]})]})]},"".concat(e.staff,"-").concat(e.date))}),!s&&0===b.length&&(0,x.jsxs)("div",{style:{gridColumn:"1 / -1",padding:48,textAlign:"center",background:"white",borderRadius:12,boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:[(0,x.jsx)("div",{style:{fontSize:64,marginBottom:16},children:o||"all"!==d?"\ud83d\udd0d":"\ud83d\ude34"}),(0,x.jsx)("div",{style:{fontSize:20,fontWeight:"bold",color:"#64748b",marginBottom:8},children:o||"all"!==d?"No matching staff found":"No one is currently checked in"}),(0,x.jsx)("div",{style:{fontSize:14,color:"#94a3b8"},children:o||"all"!==d?"Try adjusting your search or filters":"Staff will appear here when they check in"})]})]})]})},me=e=>{let{isOpen:t,onClose:a,staffId:s=null}=e;const r="http://localhost:5000",i=localStorage.getItem("token"),[l,o]=(0,n.useState)([]),[c,d]=(0,n.useState)(!1),[u,h]=(0,n.useState)("");(0,n.useEffect)(()=>{t&&i&&p()},[t,s]);const p=async()=>{try{d(!0),h("");const e=s?"".concat(r,"/api/leave/staff/").concat(s,"/history"):"".concat(r,"/api/leave/my-leaves"),t=await fetch(e,{headers:{Authorization:"Bearer ".concat(i)}});if(t.ok){const e=await t.json(),a=Array.isArray(e)?e:Array.isArray(null===e||void 0===e?void 0:e.leaves)?e.leaves:[];o(a)}else{const e=403===t.status?"Not authorized to view this history":"Failed to load leave history";h(e),o([])}}catch(e){console.error("Error loading leave history:",e),h("Failed to load leave history"),o([])}finally{d(!1)}},f=e=>e?new Date(e).toLocaleDateString("en-GB"):"-";return t?(0,x.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1050},children:(0,x.jsxs)("div",{style:{backgroundColor:"white",borderRadius:"8px",maxWidth:"900px",width:"90%",maxHeight:"80vh",display:"flex",flexDirection:"column",boxShadow:"0 4px 20px rgba(0,0,0,0.3)"},children:[(0,x.jsxs)("div",{style:{padding:"20px 24px",borderBottom:"1px solid #e0e0e0",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,x.jsx)("h3",{style:{margin:0,fontSize:"20px"},children:"Leave History"}),(0,x.jsx)("button",{onClick:a,style:{background:"none",border:"none",fontSize:"24px",cursor:"pointer",color:"#666",padding:"0 8px"},children:"\xd7"})]}),(0,x.jsxs)("div",{style:{padding:"24px",overflowY:"auto",flex:1},children:[u&&(0,x.jsx)("div",{style:{color:"#dc3545",backgroundColor:"#f8d7da",padding:"12px",borderRadius:"4px",marginBottom:"16px"},children:u}),c?(0,x.jsx)("div",{style:{textAlign:"center",padding:"40px"},children:(0,x.jsx)("div",{children:"Loading leave history..."})}):(0,x.jsx)("div",{style:{overflowX:"auto"},children:(0,x.jsxs)("table",{className:"table table-striped table-hover",children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{children:"Leave Type"}),(0,x.jsx)("th",{children:"Start Date"}),(0,x.jsx)("th",{children:"End Date"}),(0,x.jsx)("th",{children:"Status"}),(0,x.jsx)("th",{children:"Reason"})]})}),(0,x.jsxs)("tbody",{children:[l.map(e=>{return(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{style:{textTransform:"capitalize"},children:e.leaveType||"-"}),(0,x.jsx)("td",{children:f(e.startDate)}),(0,x.jsx)("td",{children:f(e.endDate)}),(0,x.jsx)("td",{children:(t=e.status,(0,x.jsx)("span",{style:{padding:"4px 12px",borderRadius:"12px",fontSize:"12px",fontWeight:"600",backgroundColor:{pending:"#ffc107",approved:"#28a745",rejected:"#dc3545"}[t]||"#6c757d",color:"white",textTransform:"capitalize"},children:t}))}),(0,x.jsx)("td",{style:{maxWidth:"250px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:e.reason||"-"})]},e._id);var t}),0===l.length&&(0,x.jsx)("tr",{children:(0,x.jsx)("td",{colSpan:5,style:{textAlign:"center",padding:"40px",color:"#6c757d"},children:"No leave records found"})})]})]})})]}),(0,x.jsxs)("div",{style:{padding:"16px 24px",borderTop:"1px solid #e0e0e0",display:"flex",justifyContent:"flex-end",gap:"8px"},children:[(0,x.jsx)("button",{className:"btn btn-secondary",onClick:a,children:"Close"}),(0,x.jsx)("button",{className:"btn btn-primary",onClick:p,disabled:c,children:c?"Refreshing...":"Refresh"})]})]})}):null},xe=()=>{var e;const t="http://localhost:5000",a="undefined"!==typeof window?localStorage.getItem("token"):null,s=(0,w.Zp)(),[r,l]=(0,n.useState)("leaves"),[o,c]=(0,n.useState)([]),[d,u]=(0,n.useState)(!0),[h,p]=(0,n.useState)(""),[f,m]=(0,n.useState)([]),[g,v]=(0,n.useState)(!1),[y,b]=(0,n.useState)(""),[j,N]=(0,n.useState)(null),[S,k]=(0,n.useState)(!1),[A,C]=(0,n.useState)({action:"",response:""}),[_,L]=(0,n.useState)(!1),[T,E]=(0,n.useState)(!1),[D,P]=(0,n.useState)(null),R=a?{Authorization:"Bearer ".concat(a),"Content-Type":"application/json"}:{"Content-Type":"application/json"},I=async()=>{u(!0),p("");try{const e=await fetch("".concat(t,"/api/leave/pending"),{headers:R});if(!e.ok)throw new Error("Failed to load pending leaves (".concat(e.status,")"));if(!(e.headers.get("content-type")||"").includes("application/json"))throw new Error("Unexpected response for pending leaves");const a=await e.json();c(Array.isArray(a)?a:Array.isArray(null===a||void 0===a?void 0:a.records)?a.records:[])}catch(e){p((null===e||void 0===e?void 0:e.message)||"Failed to load"),c([])}finally{u(!1)}},B=(0,n.useCallback)(async()=>{try{v(!0),b("");const e=await fetch("".concat(t,"/api/schedules/change-requests/pending"),{headers:R});if(e.ok){const t=await e.json();m(t)}else{const t=await e.json();b(t.message||"Failed to load schedule requests")}}catch(h){console.error("Error fetching schedule requests:",h),b("Failed to load schedule requests")}finally{v(!1)}},[t,R]);(0,n.useEffect)(()=>{I(),B()},[I,B]);const F=async(e,a)=>{try{var n,s;const r=(null===e||void 0===e?void 0:e.staffName)||(null===e||void 0===e||null===(n=e.staff)||void 0===n?void 0:n.name)||(null===e||void 0===e||null===(s=e.staff)||void 0===s?void 0:s.email)||"this staff member",i=null!==e&&void 0!==e&&e.startDate?new Date(e.startDate).toLocaleDateString():"",l=null!==e&&void 0!==e&&e.endDate?new Date(e.endDate).toLocaleDateString():"";if("approve"!==a){const n=window.prompt("Enter rejection reason for ".concat(r," (optional):"),"")||"";if(!window.confirm("Reject leave for ".concat(r,"?")))return;const s="".concat(t,"/api/leave/reject/").concat(e._id),i=await fetch(s,{method:"POST",headers:R,body:JSON.stringify({reason:n})});if(!i.ok)throw new Error("".concat(a," failed (").concat(i.status,")"));return void await I()}if(!window.confirm("Approve leave for ".concat(r,"\nFrom: ").concat(i,"  To: ").concat(l,"?")))return;const o="".concat(t,"/api/leave/approve/").concat(e._id),c=await fetch(o,{method:"POST",headers:R});if(!c.ok)throw new Error("".concat(a," failed (").concat(c.status,")"));await I()}catch(r){p((null===r||void 0===r?void 0:r.message)||"".concat(a," failed"))}},O=(e,t)=>{N(e),C({action:t,response:""}),k(!0)},q=e=>new Date(e).toLocaleDateString("en-US",{weekday:"short",year:"numeric",month:"short",day:"numeric"}),z=e=>{switch(e){case"pending":return"#ffa500";case"approved":return"#28a745";case"rejected":return"#dc3545";default:return"#6c757d"}};return(0,x.jsxs)("div",{className:"pending-leaves-container",children:[(0,x.jsxs)("div",{className:"header",children:[(0,x.jsx)("h2",{children:"Staff Requests"}),(0,x.jsx)("button",{onClick:()=>{"leaves"===r?I():B()},disabled:d||g,className:"refresh-btn",children:d||g?"Refreshing...":"Refresh"})]}),(0,x.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:8,gap:8},children:[(0,x.jsx)("button",{className:"btn-secondary",onClick:()=>s("/manager/leave-history"),children:"Full Leave History"}),(0,x.jsx)("button",{className:"btn-primary",onClick:()=>{P(null),E(!0)},style:{padding:"8px 16px",backgroundColor:"#007bff",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"\ud83d\udccb View Leave History"})]}),(0,x.jsxs)("div",{className:"tab-navigation",children:[(0,x.jsxs)("button",{className:"tab-btn ".concat("leaves"===r?"active":""),onClick:()=>l("leaves"),children:[(0,x.jsx)("i",{className:"fas fa-calendar-times"}),"Leave Requests",o.length>0&&(0,x.jsx)("span",{className:"badge",children:o.length})]}),(0,x.jsxs)("button",{className:"tab-btn ".concat("schedules"===r?"active":""),onClick:()=>l("schedules"),children:[(0,x.jsx)("i",{className:"fas fa-calendar-alt"}),"Schedule Requests",f.length>0&&(0,x.jsx)("span",{className:"badge",children:f.length})]})]}),"leaves"===r&&(0,x.jsxs)("div",{className:"tab-content",children:[h&&(0,x.jsx)("div",{className:"error-message",children:h}),(0,x.jsx)("div",{className:"table-container",children:(0,x.jsxs)("table",{className:"dashboard-table",children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{children:"Staff"}),(0,x.jsx)("th",{children:"Type"}),(0,x.jsx)("th",{children:"Day Type"}),(0,x.jsx)("th",{children:"Start"}),(0,x.jsx)("th",{children:"End"}),(0,x.jsx)("th",{children:"Reason"}),(0,x.jsx)("th",{children:"Status"}),(0,x.jsx)("th",{children:"Actions"})]})}),(0,x.jsxs)("tbody",{children:[o.map(e=>{var t,a;const n=e.startDate?new Date(e.startDate):null,s=e.endDate?new Date(e.endDate):null;return(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{children:e.staffName||(null===(t=e.staff)||void 0===t?void 0:t.name)||(null===(a=e.staff)||void 0===a?void 0:a.email)||"-"}),(0,x.jsx)("td",{children:e.leaveType}),(0,x.jsx)("td",{children:e.dayType||"full"}),(0,x.jsx)("td",{children:n?n.toLocaleDateString():"-"}),(0,x.jsx)("td",{children:s?s.toLocaleDateString():"-"}),(0,x.jsx)("td",{className:"reason-cell",title:e.reason,children:e.reason||"-"}),(0,x.jsx)("td",{children:(0,x.jsx)("span",{className:"status-badge ".concat(e.status),children:e.status})}),(0,x.jsx)("td",{children:"pending"===e.status?(0,x.jsxs)("div",{className:"action-buttons",children:[(0,x.jsx)("button",{className:"btn btn-approve",onClick:()=>F(e,"approve"),children:"Approve"}),(0,x.jsx)("button",{className:"btn btn-reject",onClick:()=>F(e,"reject"),children:"Reject"}),(0,x.jsx)("button",{className:"btn btn-info",onClick:()=>{var t;P((null===(t=e.staff)||void 0===t?void 0:t._id)||e.staffId),E(!0)},style:{marginLeft:4,fontSize:12},title:"View staff leave history",children:"History"})]}):(0,x.jsx)("span",{children:"-"})})]},e._id)}),!d&&0===o.length&&(0,x.jsx)("tr",{children:(0,x.jsx)("td",{colSpan:8,className:"no-data",children:"No pending leave requests."})})]})]})})]}),"schedules"===r&&(0,x.jsxs)("div",{className:"tab-content",children:[y&&(0,x.jsx)("div",{className:"error-message",children:y}),g?(0,x.jsx)("div",{className:"loading",children:"Loading schedule requests..."}):(0,x.jsx)("div",{className:"schedule-requests-list",children:0===f.length?(0,x.jsxs)("div",{className:"no-requests",children:[(0,x.jsx)("div",{className:"no-requests-icon",children:(0,x.jsx)("i",{className:"fas fa-calendar-check"})}),(0,x.jsx)("h3",{children:"No pending schedule requests"}),(0,x.jsx)("p",{children:"There are no pending schedule change requests at the moment."})]}):(0,x.jsx)("div",{className:"requests-grid",children:f.map(e=>{var t,a,n;return(0,x.jsxs)("div",{className:"request-card",children:[(0,x.jsxs)("div",{className:"request-header",children:[(0,x.jsxs)("div",{className:"staff-info",children:[(0,x.jsxs)("div",{className:"staff-name",children:[(0,x.jsx)("i",{className:"fas fa-user"}),(null===(t=e.staff)||void 0===t?void 0:t.name)||"Unknown Staff"]}),(0,x.jsxs)("div",{className:"staff-id",children:["ID: ",(null===(a=e.staff)||void 0===a?void 0:a.staffId)||(null===(n=e.staff)||void 0===n?void 0:n.email)]})]}),(0,x.jsxs)("div",{className:"request-status",style:{color:z(e.status)},children:[(0,x.jsx)("i",{className:"fas fa-clock"}),e.status.charAt(0).toUpperCase()+e.status.slice(1)]})]}),(0,x.jsxs)("div",{className:"request-details",children:[(0,x.jsxs)("div",{className:"request-date",children:[(0,x.jsx)("strong",{children:"Requested Date:"})," ",q(e.requestDate)]}),(0,x.jsxs)("div",{className:"shift-change",children:[(0,x.jsxs)("div",{className:"shift-from",children:[(0,x.jsx)("span",{className:"label",children:"From:"}),(0,x.jsxs)("span",{className:"shift-value current",children:[e.currentShift," Shift"]})]}),(0,x.jsx)("i",{className:"fas fa-arrow-right shift-arrow"}),(0,x.jsxs)("div",{className:"shift-to",children:[(0,x.jsx)("span",{className:"label",children:"To:"}),(0,x.jsx)("span",{className:"shift-value requested",children:"Off"===e.requestedShift?"Day Off":"".concat(e.requestedShift," Shift")})]})]}),(0,x.jsxs)("div",{className:"request-reason",children:[(0,x.jsx)("strong",{children:"Reason:"}),(0,x.jsx)("p",{children:e.reason})]}),(0,x.jsx)("div",{className:"request-timestamps",children:(0,x.jsxs)("small",{children:[(0,x.jsx)("i",{className:"fas fa-clock"}),"Submitted: ",q(e.createdAt)]})})]}),(0,x.jsxs)("div",{className:"request-actions",children:[(0,x.jsxs)("button",{className:"btn btn-approve",onClick:()=>O(e,"approve"),children:[(0,x.jsx)("i",{className:"fas fa-check"}),"Approve"]}),(0,x.jsxs)("button",{className:"btn btn-reject",onClick:()=>O(e,"reject"),children:[(0,x.jsx)("i",{className:"fas fa-times"}),"Reject"]})]})]},e._id)})})})]}),S&&(0,x.jsx)("div",{className:"modal-overlay",children:(0,x.jsxs)("div",{className:"response-modal",children:[(0,x.jsxs)("div",{className:"modal-header",children:[(0,x.jsxs)("h3",{children:["approve"===A.action?"Approve":"Reject"," Schedule Request"]}),(0,x.jsx)("button",{onClick:()=>{k(!1),N(null),C({action:"",response:""})},className:"close-btn",children:(0,x.jsx)("i",{className:"fas fa-times"})})]}),(0,x.jsxs)("div",{className:"modal-content",children:[(0,x.jsxs)("div",{className:"request-summary",children:[(0,x.jsx)("h4",{children:"Request Details:"}),(0,x.jsxs)("p",{children:[(0,x.jsx)("strong",{children:"Staff:"})," ",null===j||void 0===j||null===(e=j.staff)||void 0===e?void 0:e.name]}),(0,x.jsxs)("p",{children:[(0,x.jsx)("strong",{children:"Date:"})," ",q(null===j||void 0===j?void 0:j.requestDate)]}),(0,x.jsxs)("p",{children:[(0,x.jsx)("strong",{children:"Change:"})," ",null===j||void 0===j?void 0:j.currentShift," \u2192 ",null===j||void 0===j?void 0:j.requestedShift]}),(0,x.jsxs)("p",{children:[(0,x.jsx)("strong",{children:"Reason:"})," ",null===j||void 0===j?void 0:j.reason]})]}),(0,x.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),L(!0);try{const e="approve"===A.action?"approve":"reject",a=await fetch("".concat(t,"/api/schedules/change-requests/").concat(j._id,"/").concat(e),{method:"POST",headers:R,body:JSON.stringify({response:A.response})});if(a.ok){const e="approve"===A.action?"Schedule request approved successfully!":"Schedule request rejected successfully!";alert(e),k(!1),N(null),C({action:"",response:""}),B()}else{const e=await a.json();alert(e.message||"Failed to ".concat(A.action," request"))}}catch(h){console.error("Error ".concat(A.action,"ing request:"),h),alert("Failed to ".concat(A.action," request"))}finally{L(!1)}},children:[(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{children:"approve"===A.action?"Approval Comments (Optional):":"Rejection Reason (Required):"}),(0,x.jsx)("textarea",{value:A.response,onChange:e=>C((0,i.A)((0,i.A)({},A),{},{response:e.target.value})),placeholder:"approve"===A.action?"Add any comments about the approval...":"Please provide a reason for rejection...",rows:"3",required:"reject"===A.action})]}),(0,x.jsxs)("div",{className:"modal-actions",children:[(0,x.jsx)("button",{type:"button",onClick:()=>{k(!1),N(null),C({action:"",response:""})},className:"btn btn-cancel",children:"Cancel"}),(0,x.jsx)("button",{type:"submit",disabled:_,className:"btn ".concat("approve"===A.action?"btn-approve":"btn-reject"),children:_?"Processing...":"approve"===A.action?"Approve Request":"Reject Request"})]})]})]})]})}),(0,x.jsx)(me,{isOpen:T,onClose:()=>{E(!1),P(null)},staffId:D})]})},ge=["D","E","F","G","H","I","J","K","L"],ve=e=>{let{label:t,cols:a=10,statusMap:n,onClickSlot:s}=e;return(0,x.jsx)("div",{className:"hanger-block","aria-label":"Hanger block ".concat(t),children:ge.map(e=>(0,x.jsx)("div",{className:"hanger-row",children:(0,x.jsx)("div",{className:"row-cells",children:Array.from({length:a}).map((a,r)=>{const i=r+1,l="".concat(t,"-").concat(e,"-").concat(i),o=n.get(l)||"free";return(0,x.jsx)("div",{className:"slot ".concat(o),role:"button",tabIndex:0,onClick:()=>s(t,e,i,o),"aria-label":"".concat(e).concat(i," ").concat(o),title:"".concat(e).concat(i," ").concat(o)},l)})})},"".concat(t,"-").concat(e)))})},ye=e=>{let{side:t="left"}=e;return(0,x.jsx)("div",{className:"row-labels ".concat(t),"aria-hidden":!0,children:ge.map(e=>(0,x.jsx)("div",{className:"row-label",children:e},"".concat(t,"-").concat(e)))})},be=()=>{const[e,t]=(0,n.useState)([]),[a,s]=(0,n.useState)(!1),[r,i]=(0,n.useState)(""),l=(0,n.useMemo)(()=>{const t=new Map;for(const a of e){const e="vacant"===a.status?"free":a.status;t.set("".concat(a.block,"-").concat(a.row,"-").concat(a.col),e)}return t},[e]),o=(0,n.useMemo)(()=>e.filter(e=>"occupied"===e.status).length,[e]),c=async()=>{s(!0),i("");try{const e=await se();t(Array.isArray(e)?e:Array.isArray(null===e||void 0===e?void 0:e.records)?e.records:[])}catch(n){var e,a;i((null===(e=n.response)||void 0===e||null===(a=e.data)||void 0===a?void 0:a.message)||n.message),t([])}finally{s(!1)}};(0,n.useEffect)(()=>{c()},[]);const d=async(t,a,n,s)=>{try{const s=e.find(e=>e.block===t&&e.row===a&&e.col===n);if(!s)return;const r=[{key:"occupied",label:"Occupied (Rubber Band)"},{key:"empty_barrel",label:"Empty Barrel"},{key:"complete_bill",label:"Complete Bill"},{key:"vacant",label:"Vacant"}],i=window.prompt("Set status for ".concat(a).concat(n,":\n+1) Occupied (Rubber Band)\n+2) Empty Barrel\n+3) Complete Bill\n+4) Vacant\nEnter 1-4"),"1"),l=parseInt(i,10);if(!l||l<1||l>4)return;const o=r[l-1].key,d="occupied"===o&&window.prompt("Rubber band label (optional):","")||"";await ie(s._id,o,d),await c()}catch(l){var r,i;alert((null===(r=l.response)||void 0===r||null===(i=r.data)||void 0===i?void 0:i.message)||l.message)}};return(0,x.jsxs)("div",{className:"hanger-page",children:[r&&(0,x.jsx)("div",{style:{color:"#fca5a5",marginBottom:12},children:r}),(0,x.jsxs)("div",{style:{display:"flex",gap:12,alignItems:"center",marginBottom:12},children:[(0,x.jsx)("button",{className:"btn",onClick:c,disabled:a,children:"Reload"}),(0,x.jsx)("button",{className:"btn",onClick:async()=>{await re(),await c()},disabled:a,children:"Seed Grid"}),(0,x.jsxs)("span",{style:{color:"#e2e8f0"},children:["Total: ",e.length," | Occupied: ",o]})]}),(0,x.jsxs)("div",{className:"hanger-wrap",children:[(0,x.jsx)(ye,{side:"left"}),(0,x.jsx)(ve,{label:"A",cols:10,statusMap:l,onClickSlot:d}),(0,x.jsx)("div",{className:"hanger-gap"}),(0,x.jsx)(ve,{label:"B",cols:10,statusMap:l,onClickSlot:d}),(0,x.jsx)(ye,{side:"right"})]}),(0,x.jsxs)("div",{className:"legend",children:[(0,x.jsxs)("div",{className:"legend-item",children:[(0,x.jsx)("span",{className:"slot free"})," Free"]}),(0,x.jsxs)("div",{className:"legend-item",children:[(0,x.jsx)("span",{className:"slot occupied"})," Rubber Band"]}),(0,x.jsxs)("div",{className:"legend-item",children:[(0,x.jsx)("span",{className:"slot empty_barrel"})," Empty Barrel"]}),(0,x.jsxs)("div",{className:"legend-item",children:[(0,x.jsx)("span",{className:"slot complete_bill"})," Complete Bill"]})]})]})},je=e=>new Date(e).toISOString().slice(0,10),we=e=>{const t=new Date(e),a=t.getDay();return t.setDate(t.getDate()-a),t.setHours(0,0,0,0),je(t)},Ne=()=>{const e="http://localhost:5000",t="undefined"!==typeof window?localStorage.getItem("token"):null,a=(0,n.useMemo)(()=>t?{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"}:{"Content-Type":"application/json"},[t]),s=(0,n.useMemo)(()=>je(new Date),[]),[r,l]=(0,n.useState)(we(s)),o=e=>{switch(e){case"field":return{morningStart:"09:00",morningEnd:"17:00",eveningStart:"18:00",eveningEnd:"22:00",what:"collection"};case"accountant":case"delivery":return{morningStart:"08:00",morningEnd:"17:00",eveningStart:"17:00",eveningEnd:"17:00",what:"collection"};case"lab":return{morningStart:"09:00",morningEnd:"17:00",eveningStart:"17:00",eveningEnd:"17:00",what:"collection"};default:return{morningStart:"09:00",morningEnd:"13:00",eveningStart:"13:30",eveningEnd:"18:00",what:"collection"}}},[c,d]=(0,n.useState)(o("field")),[u,h]=(0,n.useState)([]),[p,f]=(0,n.useState)(!1),[m,g]=(0,n.useState)(""),[v,y]=(0,n.useState)(1),[b,j]=(0,n.useState)([]),[w,N]=(0,n.useState)("field"),[S,k]=(0,n.useState)([]),[A,C]=(0,n.useState)([]),[_,L]=(0,n.useState)({date:"",staff:"",shiftType:"Morning"}),[T,E]=(0,n.useState)(-1),[D,P]=(0,n.useState)(""),[R,I]=(0,n.useState)("field"),B=e=>String(e||"").replace(/\D+/g,""),F=e=>String(e||"").replace(/\s+/g,""),O=(e,t)=>{if(!e||!t)return!1;const[a,n]=e.split(":").map(Number),[s,r]=t.split(":").map(Number);return 60*a+n<60*s+r},q=(0,n.useCallback)(async()=>{f(!0),g("");try{const t=await fetch("".concat(e,"/api/schedules/by-week?weekStart=").concat(r,"&group=").concat(encodeURIComponent(w)),{headers:a});if(404===t.status)return void h([]);if(!t.ok)throw new Error("Failed to load (".concat(t.status,")"));const n=await t.json();d({morningStart:n.morningStart,morningEnd:n.morningEnd,eveningStart:n.eveningStart,eveningEnd:n.eveningEnd,what:n.what||"collection"}),h(Array.isArray(n.assignments)?n.assignments.map(e=>({staff:e.staff,shiftType:e.shiftType})):[]),C(Array.isArray(n.overrides)?n.overrides:[])}catch(t){g((null===t||void 0===t?void 0:t.message)||"Failed to load")}finally{f(!1)}},[e,a,r,w]);(0,n.useEffect)(()=>{q()},[q]);(0,n.useEffect)(()=>{(async()=>{try{const t=(e=>{switch(e){case"field":return"field_staff";case"delivery":return"delivery_staff";case"lab":return"lab_staff";case"accountant":return"accountant";case"company":return"staff";default:return""}})(w);if(!t)return void k([]);const n=await fetch("".concat(e,"/api/user-management/staff?role=").concat(encodeURIComponent(t),"&status=active&limit=500"),{headers:a});if(!n.ok)return void k([]);const s=await n.json(),r=((null===s||void 0===s?void 0:s.users)||(null===s||void 0===s?void 0:s.records)||[]).map(e=>({value:e._id,label:"".concat(e.name||e.email||e.staffId||e._id).concat(e.staffId?" (".concat(e.staffId,")"):"")}));k(r)}catch(t){k([])}})()},[e,a,w]),(0,n.useEffect)(()=>{const e=o(w);d(t=>(0,i.A)((0,i.A)({},t),e))},[w]),(0,n.useEffect)(()=>{const e=[],t=new Map;u.forEach((a,n)=>{const s=F((a.staff||"").trim());if(s||e.push({type:"empty",message:"Row ".concat(n+1,": Staff ID is required")}),s&&/\s/.test(a.staff)&&e.push({type:"space",message:"Row ".concat(n+1,": Staff ID must not contain spaces")}),s){const e="".concat(s);t.set(e,(t.get(e)||0)+1)}(!a.shiftType||"Morning"!==a.shiftType&&"Evening"!==a.shiftType)&&e.push({type:"shift",message:"Row ".concat(n+1,": Invalid shift type")})});for(const[n,s]of t.entries())s>1&&e.push({type:"duplicate",message:"Staff ".concat(n," appears ").concat(s," times")});O(c.morningStart,c.morningEnd)||e.push({type:"time",message:"Morning End must be after Morning Start"}),O(c.eveningStart,c.eveningEnd)||e.push({type:"time",message:"Evening End must be after Evening Start"});const a=Number(B(v));(!a||a<1||a>12)&&e.push({type:"repeat",message:"Repeat weeks must be a number between 1 and 12"}),j(e)},[u,c,v]);const z=e=>{const{name:t,value:a}=e.target,n=t.includes("Start")||t.includes("End")?a.replace(/\s+/g,""):a;d(e=>(0,i.A)((0,i.A)({},e),{},{[t]:n}))},M=(e,t,a)=>{if("staff"===t&&"__SELECT_ALL__"===a){const t=S.map(t=>{var a;return{staff:t.value,shiftType:(null===(a=u[e])||void 0===a?void 0:a.shiftType)||"Morning"}});return void h(a=>{const n=[...a];return n[e]=t[0],[...n,...t.slice(1)]})}h(n=>n.map((n,s)=>s===e?(0,i.A)((0,i.A)({},n),{},{[t]:"staff"===t?F(a):a}):n))},U=e=>{if(0===S.length)return void g("No staff members available. Please select a Target Group first.");const t=new Set(u.map(e=>e.staff).filter(Boolean)),a=S.filter(e=>!t.has(e.value)).map(t=>({staff:t.value,shiftType:e}));a.length>0?(h(e=>[...e,...a]),P("\u2713 Added ".concat(a.length," staff member(s) to ").concat(e," shift.")),setTimeout(()=>P(""),5e3)):(P("All staff members are already assigned. Remove some to add others."),setTimeout(()=>P(""),5e3))},W=(0,n.useMemo)(()=>new Date(r),[r]),H=(0,n.useMemo)(()=>{const e=new Date(r);return e.setDate(e.getDate()+6),e},[r]),V=e=>{const t=new Date(e);if(Number.isNaN(t.getTime()))return"";const a=new Date(W),n=new Date(H);return je(t<a?a:t>n?n:t)};return(0,x.jsxs)("div",{style:{padding:16},children:[(0,x.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:12},children:[(0,x.jsx)("h2",{style:{margin:0},children:"Shift Planning"}),(0,x.jsxs)("div",{style:{display:"flex",gap:12,flexWrap:"wrap",alignItems:"center"},children:[(0,x.jsxs)("label",{style:{display:"flex",flexDirection:"column",gap:4},children:[(0,x.jsx)("span",{children:"Week of"}),(0,x.jsx)("input",{type:"date",value:r,onChange:e=>l(we(e.target.value)),style:{width:"100%"}})]}),(0,x.jsxs)("label",{style:{display:"flex",flexDirection:"column",gap:4},children:[(0,x.jsx)("span",{children:"Target Group"}),(0,x.jsxs)("select",{value:w,onChange:e=>N(e.target.value),children:[(0,x.jsx)("option",{value:"field",children:"Field Staff"}),(0,x.jsx)("option",{value:"delivery",children:"Delivery Staff"}),(0,x.jsx)("option",{value:"lab",children:"Lab Staff"}),(0,x.jsx)("option",{value:"accountant",children:"Accountant"}),(0,x.jsx)("option",{value:"company",children:"Company Staff"})]})]})]})]}),m&&(0,x.jsx)("div",{style:{color:"tomato",marginTop:8},children:m}),(0,x.jsxs)("form",{onSubmit:async t=>{t.preventDefault();try{if(g(""),f(!0),b.length)throw new Error("Please resolve conflicts before saving");const t=async t=>{const n="lab"===w?"lab":"field",s=(0,i.A)((0,i.A)({weekStart:t},c),{},{assignments:u,group:n}),r=await fetch("".concat(e,"/api/schedules?group=").concat(encodeURIComponent(n)),{method:"POST",headers:a,body:JSON.stringify(s)});if(!r.ok){let e="Save failed for ".concat(t," (").concat(r.status,")");try{const t=await r.json();null!==t&&void 0!==t&&t.message&&(e=t.message)}catch(l){}throw new Error(e)}},n=Math.max(1,Number(v)||1),s=new Date(r);for(let e=0;e<n;e++){const a=new Date(s);a.setDate(a.getDate()+7*e),await t(je(a))}await q()}catch(n){g((null===n||void 0===n?void 0:n.message)||"Save failed")}finally{f(!1)}},style:{display:"grid",gap:12,marginTop:12},children:[(0,x.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(160px, 1fr))",gap:12,alignItems:"end"},children:[(0,x.jsxs)("label",{style:{display:"flex",flexDirection:"column",gap:4},children:[(0,x.jsx)("span",{children:"Morning Start"}),(0,x.jsx)("input",{type:"time",name:"morningStart",value:c.morningStart,onChange:z,required:!0,style:{width:"100%"}})]}),(0,x.jsxs)("label",{style:{display:"flex",flexDirection:"column",gap:4},children:[(0,x.jsx)("span",{children:"Morning End"}),(0,x.jsx)("input",{type:"time",name:"morningEnd",value:c.morningEnd,onChange:z,required:!0,style:{width:"100%"}})]}),(0,x.jsxs)("label",{style:{display:"flex",flexDirection:"column",gap:4},children:[(0,x.jsx)("span",{children:"Evening Start"}),(0,x.jsx)("input",{type:"time",name:"eveningStart",value:c.eveningStart,onChange:z,required:!0,style:{width:"100%"}})]}),(0,x.jsxs)("label",{style:{display:"flex",flexDirection:"column",gap:4},children:[(0,x.jsx)("span",{children:"Evening End"}),(0,x.jsx)("input",{type:"time",name:"eveningEnd",value:c.eveningEnd,onChange:z,required:!0,style:{width:"100%"}})]}),(0,x.jsxs)("label",{style:{display:"flex",flexDirection:"column",gap:4},children:[(0,x.jsx)("span",{children:"Repeat weeks"}),(0,x.jsx)("select",{value:v,onChange:e=>y(B(e.target.value)),style:{width:"100%"},children:[1,2,3,4,6,8,12].map(e=>(0,x.jsx)("option",{value:e,children:e},e))})]}),(0,x.jsxs)("label",{style:{display:"flex",flexDirection:"column",gap:4},children:[(0,x.jsx)("span",{children:"Task"}),(0,x.jsxs)("select",{name:"what",value:c.what,onChange:z,children:[(0,x.jsx)("option",{value:"empty_barrel_pickup",children:"Empty Barrel Pickup"}),(0,x.jsx)("option",{value:"production_support",children:"Production Support"}),(0,x.jsx)("option",{value:"rubber_band_packing",children:"Rubber Band Packing"}),(0,x.jsx)("option",{value:"admin_back_office",children:"Admin / Back Office"})]})]}),(0,x.jsxs)("div",{style:{display:"flex",alignItems:"flex-end",gap:8},children:[(0,x.jsxs)("button",{type:"button",className:"btn btn-outline",onClick:()=>d(o(w)),children:["Reset to ",w.charAt(0).toUpperCase()+w.slice(1)," Standard"]}),(0,x.jsxs)("select",{value:R,onChange:e=>I(e.target.value),style:{fontSize:14},children:[(0,x.jsx)("option",{value:"field",children:"Field Standard"}),(0,x.jsx)("option",{value:"delivery",children:"Delivery Standard"}),(0,x.jsx)("option",{value:"lab",children:"Lab Standard"}),(0,x.jsx)("option",{value:"accountant",children:"Accountant Standard"}),(0,x.jsx)("option",{value:"company",children:"Company Standard"})]}),(0,x.jsx)("button",{type:"button",className:"btn btn-primary",onClick:()=>{const e=o(R);d(e)},children:"Apply Preset"})]})]}),(0,x.jsxs)("div",{children:[(0,x.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:12,marginBottom:12},children:[(0,x.jsxs)("div",{children:[(0,x.jsxs)("h3",{style:{margin:0},children:["Assignments (",u.length,")"]}),S.length>0&&(0,x.jsxs)("div",{style:{fontSize:12,color:"#64748b",marginTop:4},children:[S.length," staff member(s) available for ",w.charAt(0).toUpperCase()+w.slice(1)," group"]})]}),(0,x.jsxs)("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[(0,x.jsxs)("button",{type:"button",className:"btn btn-outline",onClick:()=>U("Morning"),disabled:0===S.length,children:["\u2713 Add All to Morning (",S.length,")"]}),(0,x.jsxs)("button",{type:"button",className:"btn btn-outline",onClick:()=>U("Evening"),disabled:0===S.length,children:["\u2713 Add All to Evening (",S.length,")"]}),(0,x.jsx)("button",{type:"button",className:"btn",onClick:()=>h(e=>[...e,{staff:"",shiftType:"Morning"}]),children:"+ Add Single"})]})]}),(0,x.jsxs)("div",{style:{marginTop:8,overflowX:"auto"},children:[(0,x.jsxs)("table",{className:"dashboard-table",style:{minWidth:680},children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{style:{width:50},children:"#"}),(0,x.jsx)("th",{children:"Staff Member"}),(0,x.jsx)("th",{children:"Shift Type"}),(0,x.jsx)("th",{children:"Actions"})]})}),(0,x.jsxs)("tbody",{children:[u.map((t,n)=>{var s,l;return(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{children:n+1}),(0,x.jsx)("td",{style:{minWidth:200},children:S.length>0?(0,x.jsxs)("div",{children:[(0,x.jsxs)("select",{value:t.staff,onChange:e=>M(n,"staff",e.target.value),style:{width:"100%",padding:"8px 12px",borderRadius:6,border:"1px solid #d1d5db"},children:[(0,x.jsx)("option",{value:"",children:"Select staff..."}),S.length>1&&(0,x.jsxs)("option",{value:"__SELECT_ALL__",style:{fontWeight:"bold",color:"#059669",backgroundColor:"#f0fdf4"},children:["\u2713 Select All Staff (",S.length,")"]}),S.map(e=>(0,x.jsx)("option",{value:e.value,children:e.label},e.value))]}),!!t.staff&&"__SELECT_ALL__"!==t.staff&&(0,x.jsxs)("div",{style:{fontSize:12,color:"#059669",marginTop:6,fontWeight:500},children:["\u2713 ",(null===(s=S.find(e=>e.value===t.staff))||void 0===s?void 0:s.label)||t.staff]})]}):(0,x.jsxs)("div",{children:[(0,x.jsx)("input",{type:"text",placeholder:"User ObjectId or Staff ID (no spaces)",value:t.staff,onChange:e=>M(n,"staff",e.target.value),onKeyDown:e=>{" "===e.key&&e.preventDefault()},style:{width:"100%",padding:"8px 12px",borderRadius:6,border:"1px solid #d1d5db"}}),!!t.staff&&(0,x.jsx)("div",{style:{fontSize:12,color:"#64748b",marginTop:4},children:(null===(l=S.find(e=>e.value===t.staff))||void 0===l?void 0:l.label)||t.staff})]})}),(0,x.jsx)("td",{style:{minWidth:180},children:(0,x.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8,flexWrap:"wrap"},children:[(0,x.jsxs)("select",{value:t.shiftType,onChange:e=>M(n,"shiftType",e.target.value),style:{padding:"8px 12px",borderRadius:6,border:"1px solid #d1d5db",minWidth:120},children:[(0,x.jsx)("option",{children:"Morning"}),(0,x.jsx)("option",{children:"Evening"})]}),(0,x.jsx)("span",{style:{fontSize:12,color:"#64748b",whiteSpace:"nowrap"},children:"Evening"===t.shiftType?"".concat(c.eveningStart," - ").concat(c.eveningEnd):"".concat(c.morningStart," - ").concat(c.morningEnd)})]})}),(0,x.jsx)("td",{style:{minWidth:150},children:(0,x.jsxs)("div",{style:{display:"flex",gap:6,flexWrap:"wrap"},children:[(0,x.jsx)("button",{type:"button",className:"btn btn-primary",disabled:T===n||p||!t.staff||"__SELECT_ALL__"===t.staff,onClick:()=>(async t=>{try{var n;P("");const l=u[t];if(!l||!l.staff)return void g("Select a staff before assigning");if(!l.shiftType||"Morning"!==l.shiftType&&"Evening"!==l.shiftType)return void g("Select a valid shift");if(!O(c.morningStart,c.morningEnd))return void g("Morning time range invalid");if(!O(c.eveningStart,c.eveningEnd))return void g("Evening time range invalid");const o="Morning"===l.shiftType?"".concat(c.morningStart," - ").concat(c.morningEnd):"".concat(c.eveningStart," - ").concat(c.eveningEnd),d=(null===(n=S.find(e=>e.value===l.staff))||void 0===n?void 0:n.label)||l.staff;if(!window.confirm("Assign ".concat(d," to ").concat(l.shiftType," (").concat(o,") for week starting ").concat(r,"?")))return;E(t);const h="lab"===w?"lab":"field",p=(0,i.A)((0,i.A)({weekStart:r},c),{},{assignments:[{staff:l.staff,shiftType:l.shiftType}],group:h}),f=await fetch("".concat(e,"/api/schedules?group=").concat(encodeURIComponent(h)),{method:"POST",headers:a,body:JSON.stringify(p)});if(!f.ok){let e="Assign failed (".concat(f.status,")");try{const t=await f.json();null!==t&&void 0!==t&&t.message&&(e=t.message)}catch(s){}throw new Error(e)}P("Assigned ".concat(d," to ").concat(l.shiftType," (").concat(o,") successfully.")),await q()}catch(l){g((null===l||void 0===l?void 0:l.message)||"Assign failed")}finally{E(-1)}})(n),style:{fontSize:13},children:T===n?"\u23f3 Assigning...":"\u2713 Assign Now"}),(0,x.jsx)("button",{type:"button",className:"btn btn-outline",onClick:()=>(e=>h(t=>t.filter((t,a)=>a!==e)))(n),style:{fontSize:13},children:"\u2715 Remove"})]})})]},n)}),0===u.length&&(0,x.jsx)("tr",{children:(0,x.jsxs)("td",{colSpan:4,style:{textAlign:"center",color:"#9ca3af",padding:"32px",fontSize:14},children:[(0,x.jsx)("div",{children:"No assignments yet"}),(0,x.jsx)("div",{style:{marginTop:8,fontSize:12,color:"#64748b"},children:'Click "Add Single" to add one staff member, or use "Add All to Morning/Evening" for bulk assignment'})]})})]})]}),D&&(0,x.jsxs)("div",{className:"alert success",style:{marginTop:12,padding:12,backgroundColor:"#d1fae5",color:"#065f46",border:"1px solid #6ee7b7",borderRadius:6,display:"flex",alignItems:"center",gap:8},children:[(0,x.jsx)("span",{children:"\u2713"}),(0,x.jsx)("span",{children:D})]}),b.length>0&&(0,x.jsxs)("div",{style:{marginTop:8,color:"#b45309",background:"#fff7ed",border:"1px solid #fed7aa",padding:8,borderRadius:6},children:[(0,x.jsx)("b",{children:"Conflicts detected"}),(0,x.jsx)("ul",{style:{margin:"6px 0 0 16px"},children:b.map((e,t)=>(0,x.jsx)("li",{children:e.message},t))})]})]})]}),(0,x.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:12,flexWrap:"wrap"},children:[(0,x.jsx)("div",{style:{fontSize:12,color:"#64748b"},children:'Tip: Save will upsert the selected week. Use "Repeat weeks" to copy this plan forward. Target Group controls whether assignments apply to Field or Lab staff.'}),(0,x.jsx)("button",{type:"submit",className:"btn btn-primary",disabled:p||b.length>0,children:p?"Saving...":"Save".concat(Number(v)>1?" +".concat(Number(v)-1," weeks"):"")})]})]}),(0,x.jsxs)("div",{className:"dash-card",style:{marginTop:16},children:[(0,x.jsx)("h3",{style:{marginTop:0},children:"Weekly Calendar"}),(0,x.jsx)("div",{style:{fontSize:12,color:"#64748b",marginBottom:8},children:"Assignments repeat each day for the week."}),(0,x.jsx)("div",{style:{overflowX:"auto"},children:(0,x.jsxs)("table",{className:"dashboard-table",style:{minWidth:720},children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{children:"Shift"}),(0,x.jsx)("th",{children:"Sun"}),(0,x.jsx)("th",{children:"Mon"}),(0,x.jsx)("th",{children:"Tue"}),(0,x.jsx)("th",{children:"Wed"}),(0,x.jsx)("th",{children:"Thu"}),(0,x.jsx)("th",{children:"Fri"}),(0,x.jsx)("th",{children:"Sat"})]})}),(0,x.jsx)("tbody",{children:["Morning","Evening"].map(e=>{const t=u.filter(t=>t.shiftType===e),a="Morning"===e?"".concat(c.morningStart," - ").concat(c.morningEnd):"".concat(c.eveningStart," - ").concat(c.eveningEnd),n=(0,x.jsxs)("div",{children:[(0,x.jsx)("div",{style:{fontWeight:600},children:a}),(0,x.jsx)("div",{style:{display:"flex",gap:6,flexWrap:"wrap",marginTop:4},children:t.length?t.map((e,t)=>{const a=S.find(t=>t.value===e.staff),n=a?a.label:e.staff;return(0,x.jsx)("span",{className:"badge",style:{background:"#eef2ff",color:"#3730a3",border:"1px solid #c7d2fe"},children:n},t)}):(0,x.jsx)("span",{style:{color:"#9aa"},children:"No assignments"})})]});return(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{style:{whiteSpace:"nowrap"},children:e}),(0,x.jsx)("td",{children:n}),(0,x.jsx)("td",{children:n}),(0,x.jsx)("td",{children:n}),(0,x.jsx)("td",{children:n}),(0,x.jsx)("td",{children:n}),(0,x.jsx)("td",{children:n}),(0,x.jsx)("td",{children:n})]},e)})})]})})]}),(0,x.jsxs)("div",{className:"dash-card",style:{marginTop:16},children:[(0,x.jsx)("h3",{style:{marginTop:0},children:"Day Overrides"}),(0,x.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(160px, 1fr))",gap:12},children:[(0,x.jsxs)("label",{style:{display:"flex",flexDirection:"column",gap:4},children:[(0,x.jsx)("span",{children:"Date"}),(0,x.jsx)("input",{type:"date",value:_.date,min:je(W),max:je(H),onChange:e=>L(t=>(0,i.A)((0,i.A)({},t),{},{date:V(e.target.value)}))})]}),(0,x.jsxs)("label",{style:{display:"flex",flexDirection:"column",gap:4},children:[(0,x.jsx)("span",{children:"Staff"}),(0,x.jsxs)("select",{value:_.staff,onChange:e=>L(t=>(0,i.A)((0,i.A)({},t),{},{staff:e.target.value})),style:{width:"100%",padding:"8px 12px",borderRadius:6,border:"1px solid #d1d5db"},children:[(0,x.jsx)("option",{value:"",children:"Select staff..."}),S.map(e=>(0,x.jsx)("option",{value:e.value,children:e.label},e.value))]})]}),(0,x.jsxs)("label",{style:{display:"flex",flexDirection:"column",gap:4},children:[(0,x.jsx)("span",{children:"Shift"}),(0,x.jsxs)("select",{value:_.shiftType,onChange:e=>L(t=>(0,i.A)((0,i.A)({},t),{},{shiftType:e.target.value})),children:[(0,x.jsx)("option",{value:"Morning",children:"Morning"}),(0,x.jsx)("option",{value:"Evening",children:"Evening"})]})]}),(0,x.jsx)("div",{style:{display:"flex",alignItems:"flex-end"},children:(0,x.jsx)("button",{type:"button",className:"btn btn-primary",onClick:async()=>{try{if(g(""),!_.date||!_.staff)throw new Error("Select date and staff");const t={weekStart:r,group:w,date:_.date,staff:_.staff,shiftType:_.shiftType},n=await fetch("".concat(e,"/api/schedules/overrides"),{method:"POST",headers:a,body:JSON.stringify(t)});if(!n.ok)throw new Error("Failed to add override (".concat(n.status,")"));const s=await n.json();C(Array.isArray(null===s||void 0===s?void 0:s.overrides)?s.overrides:[])}catch(t){g((null===t||void 0===t?void 0:t.message)||"Failed to add override")}},children:"Add Override"})})]}),(0,x.jsx)("div",{style:{marginTop:12,overflowX:"auto"},children:(0,x.jsxs)("table",{className:"dashboard-table",style:{minWidth:640},children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{children:"Date"}),(0,x.jsx)("th",{children:"Staff"}),(0,x.jsx)("th",{children:"Shift"}),(0,x.jsx)("th",{children:"Actions"})]})}),(0,x.jsxs)("tbody",{children:[(A||[]).map((t,n)=>{var s,i;const l=je(t.date),o=S.find(e=>{var a;return e.value===((null===(a=t.staff)||void 0===a?void 0:a._id)||t.staff)}),c=o?o.label:(null===(s=t.staff)||void 0===s?void 0:s.name)||(null===(i=t.staff)||void 0===i?void 0:i.email)||String(t.staff);return(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{children:l}),(0,x.jsx)("td",{children:c}),(0,x.jsx)("td",{children:t.shiftType}),(0,x.jsx)("td",{children:(0,x.jsx)("button",{className:"btn btn-outline",onClick:()=>(async t=>{try{const n={weekStart:r,group:w,date:t.date,staff:t.staff},s=await fetch("".concat(e,"/api/schedules/overrides"),{method:"DELETE",headers:a,body:JSON.stringify(n)});if(!s.ok)throw new Error("Failed to remove override (".concat(s.status,")"));const i=await s.json();C(Array.isArray(null===i||void 0===i?void 0:i.overrides)?i.overrides:A.filter(e=>!(String(e.staff)===String(t.staff)&&je(e.date)===je(t.date))))}catch(n){g((null===n||void 0===n?void 0:n.message)||"Failed to remove override")}})(t),children:"Remove"})})]},"".concat(l,"-").concat(t.staff,"-").concat(n))}),(!A||0===A.length)&&(0,x.jsx)("tr",{children:(0,x.jsx)("td",{colSpan:4,style:{textAlign:"center",color:"#9aa"},children:"No overrides"})})]})]})})]})]})},Se=n.createContext({confirm:async()=>!1}),ke=e=>{let{children:t}=e;const[a,s]=(0,n.useState)({open:!1,title:"",message:"",resolve:null}),r=(0,n.useCallback)((e,t)=>new Promise(a=>{s({open:!0,title:e,message:t,resolve:a})}),[]),i=e=>{a.resolve&&a.resolve(e),s({open:!1,title:"",message:"",resolve:null})};return(0,x.jsxs)(Se.Provider,{value:{confirm:r},children:[t,a.open&&(0,x.jsx)("div",{className:"confirm-backdrop",children:(0,x.jsxs)("div",{className:"confirm-modal",children:[(0,x.jsx)("div",{className:"confirm-header",children:a.title||"Confirm"}),(0,x.jsx)("div",{className:"confirm-body",children:a.message}),(0,x.jsxs)("div",{className:"confirm-actions",children:[(0,x.jsx)("button",{className:"btn",onClick:()=>i(!1),children:"No"}),(0,x.jsx)("button",{className:"btn primary",onClick:()=>i(!0),children:"Yes"})]})]})}),(0,x.jsx)("style",{children:"\n        .confirm-backdrop{position:fixed;inset:0;background:rgba(0,0,0,.4);display:flex;align-items:center;justify-content:center;z-index:1000}\n        .confirm-modal{background:#0b1220;color:#e5e7eb;border:1px solid #1f2937;border-radius:10px;min-width:320px;max-width:92vw;padding:16px;box-shadow:0 10px 30px rgba(0,0,0,.5)}\n        .confirm-header{font-weight:700;margin-bottom:8px}\n        .confirm-body{opacity:.9;margin-bottom:16px}\n        .confirm-actions{display:flex;justify-content:flex-end;gap:8px}\n        .btn{padding:8px 12px;border-radius:6px;border:1px solid #334155;background:#111827;color:#e5e7eb;cursor:pointer}\n        .btn.primary{background:#4f46e5;border-color:#4f46e5}\n      "})]})};function Ae(){const e=n.useContext(Se);if(!e)throw new Error("useConfirm must be used within ConfirmProvider");return e.confirm}const Ce=()=>{const e="http://localhost:5000",t="undefined"!==typeof window?localStorage.getItem("token"):null,a=(0,n.useMemo)(()=>t?{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"}:{"Content-Type":"application/json"},[t]),[s,r]=(0,n.useState)([]),[i,l]=(0,n.useState)(!1),[o,c]=(0,n.useState)(""),d=Ae(),u=(0,n.useCallback)(async()=>{l(!0),c("");try{const t=await fetch("".concat(e,"/api/latex/admin/requests"),{headers:a});if(!t.ok)throw new Error("Failed to load (".concat(t.status,")"));const n=await t.json(),s=Array.isArray(null===n||void 0===n?void 0:n.records)?n.records:Array.isArray(n)?n:[];r(s)}catch(t){c((null===t||void 0===t?void 0:t.message)||"Failed to load"),r([])}finally{l(!1)}},[e,a]);(0,n.useEffect)(()=>{u()},[u]);const h=async(t,n)=>{try{c("");if(!await d("Confirm action","Are you sure to set status to ".concat(n,"?")))return;const s=await fetch("".concat(e,"/api/latex/admin/requests/").concat(t),{method:"PUT",headers:a,body:JSON.stringify({status:n})});if(!s.ok)throw new Error("".concat(n," failed (").concat(s.status,")"));await u()}catch(s){c((null===s||void 0===s?void 0:s.message)||"".concat(n," failed"))}};return(0,x.jsxs)("div",{style:{padding:16},children:[(0,x.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,x.jsx)("h2",{style:{margin:0},children:"Latex Billing Requests"}),(0,x.jsx)("button",{onClick:u,disabled:i,children:i?"Refreshing...":"Refresh"})]}),o&&(0,x.jsx)("div",{style:{color:"tomato",marginTop:8},children:o}),(0,x.jsx)("div",{style:{marginTop:12,overflowX:"auto"},children:(0,x.jsxs)("table",{className:"dashboard-table",style:{minWidth:820,color:"#0f172a"},children:[(0,x.jsx)("thead",{children:(0,x.jsx)("tr",{children:["Buyer","Qty","DRC%","Est. Pay","Calc Amount","Rate (\u20b9/kg)","Status","Actions"].map(e=>(0,x.jsx)("th",{style:{color:"#0f172a",opacity:1,fontWeight:600},children:e},e))})}),(0,x.jsxs)("tbody",{children:[s.map(n=>{var s,r,i,l,o;return(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{style:{color:"#0f172a",opacity:1},children:(null===(s=n.user)||void 0===s?void 0:s.name)||(null===(r=n.user)||void 0===r?void 0:r.email)||(null===(i=n.user)||void 0===i?void 0:i._id)||"-"}),(0,x.jsx)("td",{style:{color:"#0f172a",opacity:1},children:n.quantity}),(0,x.jsx)("td",{style:{color:"#0f172a",opacity:1},children:n.drcPercentage}),(0,x.jsx)("td",{style:{color:"#0f172a",opacity:1},children:n.estimatedPayment}),(0,x.jsx)("td",{style:{color:"#0f172a",opacity:1},children:null!==(l=n.calculatedAmount)&&void 0!==l?l:"-"}),(0,x.jsx)("td",{style:{color:"#0f172a",opacity:1},children:null!==(o=n.marketRate)&&void 0!==o?o:"-"}),(0,x.jsx)("td",{style:{color:"#0f172a",opacity:1},children:n.status}),(0,x.jsx)("td",{style:{color:"#0f172a",opacity:1},children:"ACCOUNT_CALCULATED"===n.status?(0,x.jsx)("div",{style:{display:"flex",gap:8},children:(0,x.jsx)("button",{className:"btn btn-sm btn-success",onClick:()=>(async n=>{if(await d("Verify & Invoice","Verify this calculation and generate invoice?"))try{c("");const l=await fetch("".concat(e,"/api/latex/admin/verify/").concat(n),{method:"PUT",headers:a});if(!l.ok)throw new Error("Verify failed (".concat(l.status,")"));const o=await fetch("".concat(e,"/api/latex/admin/requests/").concat(n),{headers:a}),d=await o.json();try{var s,r;await fetch("".concat(e,"/api/notifications/staff-trip-event"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify({title:"Invoice Generated",message:"Your latex billing invoice has been generated and is ready for payment",link:"/user/billing",meta:{invoiceId:String(n),customerName:(null===d||void 0===d||null===(s=d.user)||void 0===s?void 0:s.name)||"Customer",calculatedAmount:null===d||void 0===d?void 0:d.calculatedAmount,invoiceNumber:null===d||void 0===d?void 0:d.invoiceNumber,requestId:n},userId:null===d||void 0===d||null===(r=d.user)||void 0===r?void 0:r._id})})}catch(i){console.warn("Failed to notify user:",i)}await u()}catch(i){c((null===i||void 0===i?void 0:i.message)||"Verify failed")}})(n._id),children:"Verify & Invoice"})}):"VERIFIED"===n.status?n.invoiceNumber?(0,x.jsxs)("a",{className:"btn btn-sm",href:"".concat(e,"/api/latex/invoice/").concat(n._id),target:"_blank",rel:"noreferrer",children:["Invoice ",n.invoiceNumber]}):(0,x.jsx)("span",{children:"Verified"}):"pending"===n.status?(0,x.jsxs)("div",{style:{display:"flex",gap:8},children:[(0,x.jsx)("button",{className:"btn btn-sm btn-success",onClick:()=>h(n._id,"approved"),children:"Approve"}),(0,x.jsx)("button",{className:"btn btn-sm btn-outline-danger",onClick:()=>h(n._id,"rejected"),children:"Reject"})]}):(0,x.jsx)("span",{children:"-"})})]},n._id)}),0===s.length&&!i&&(0,x.jsx)("tr",{children:(0,x.jsx)("td",{colSpan:6,style:{textAlign:"center",color:"#6b7280"},children:"No requests."})})]})]})})]})},_e="http://localhost:5000",Le=()=>{const e=localStorage.getItem("token");return e?{Authorization:"Bearer ".concat(e)}:{}},Te=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"latex60";const{data:t}=await m.A.get("".concat(_e,"/api/rates/pending"),{params:{product:e},headers:Le()});return t},Ee=()=>{const[e,t]=(0,n.useState)(!1),[a,s]=(0,n.useState)(""),[r,l]=(0,n.useState)(""),[o,c]=(0,n.useState)({effectiveDate:"",companyRate:"",marketRate:"",notes:""}),[d,u]=(0,n.useState)([]),h=(new Date).toISOString().split("T")[0];(0,n.useEffect)(()=>{const e=(new Date).toISOString().split("T")[0];c(t=>(0,i.A)((0,i.A)({},t),{},{effectiveDate:e})),p()},[]);const p=async()=>{try{const e=await Te("latex60");u(Array.isArray(e)?e:[])}catch(e){console.error("Failed to load submitted rates:",e)}},f=e=>{const{name:t,value:a}=e.target;c(e=>(0,i.A)((0,i.A)({},e),{},{[t]:a}))},g=e=>new Date(e).toLocaleDateString("en-IN",{year:"numeric",month:"short",day:"numeric"}),v=e=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(e);return(0,x.jsxs)("div",{style:{padding:16},children:[(0,x.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:24},children:[(0,x.jsx)("h2",{style:{margin:0},children:"Propose Company & Market Rate"}),(0,x.jsx)("button",{onClick:p,disabled:e,children:e?"Refreshing...":"Refresh"})]}),a&&(0,x.jsx)("div",{style:{color:"tomato",marginBottom:16,padding:12,background:"#fee",borderRadius:4},children:a}),r&&(0,x.jsx)("div",{style:{color:"green",marginBottom:16,padding:12,background:"#efe",borderRadius:4},children:r}),(0,x.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:24},children:[(0,x.jsxs)("div",{className:"dash-card",children:[(0,x.jsx)("h4",{style:{marginTop:0,marginBottom:16},children:"Submit Rate Proposal"}),(0,x.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),o.effectiveDate&&o.companyRate&&o.marketRate)if(o.effectiveDate<h)s("Effective Date cannot be in the past");else{t(!0),s(""),l("");try{await(async e=>{let{companyRate:t,marketRate:a,effectiveDate:n,product:s="latex60",notes:r}=e;const{data:i}=await m.A.post("".concat(_e,"/api/rates/propose"),{companyRate:t,marketRate:a,effectiveDate:n,product:s,notes:r},{headers:Le()});return i})({effectiveDate:o.effectiveDate,companyRate:parseFloat(o.companyRate),marketRate:parseFloat(o.marketRate),product:"latex60",notes:o.notes}),l("Rate proposed for admin verification"),c({effectiveDate:(new Date).toISOString().split("T")[0],companyRate:"",marketRate:"",notes:""}),await p()}catch(e){var a,n;s((null===e||void 0===e||null===(a=e.response)||void 0===a||null===(n=a.data)||void 0===n?void 0:n.message)||(null===e||void 0===e?void 0:e.message)||"Failed to submit rate update")}finally{t(!1)}}else s("Please fill in all required fields")},children:[(0,x.jsxs)("div",{style:{marginBottom:16},children:[(0,x.jsx)("label",{style:{display:"block",marginBottom:4,fontWeight:"bold"},children:"Today Rate *"}),(0,x.jsx)("input",{type:"date",name:"effectiveDate",value:o.effectiveDate,onChange:f,min:h,required:!0,style:{width:"100%",padding:8,border:"1px solid #d1d5db",borderRadius:4}})]}),(0,x.jsxs)("div",{style:{marginBottom:16},children:[(0,x.jsx)("label",{style:{display:"block",marginBottom:4,fontWeight:"bold"},children:"Company Rate (per 100 Kg) *"}),(0,x.jsx)("input",{type:"number",name:"companyRate",value:o.companyRate,onChange:f,required:!0,step:"0.01",min:"0",placeholder:"Enter Company rate (\u20b9)",style:{width:"100%",padding:8,border:"1px solid #d1d5db",borderRadius:4}})]}),(0,x.jsxs)("div",{style:{marginBottom:16},children:[(0,x.jsx)("label",{style:{display:"block",marginBottom:4,fontWeight:"bold"},children:"Official Market Rate (per 100 Kg) *"}),(0,x.jsx)("input",{type:"number",name:"marketRate",value:o.marketRate,onChange:f,required:!0,step:"0.01",min:"0",placeholder:"Enter Market rate (\u20b9)",style:{width:"100%",padding:8,border:"1px solid #d1d5db",borderRadius:4}})]}),(0,x.jsxs)("div",{style:{marginBottom:16},children:[(0,x.jsx)("label",{style:{display:"block",marginBottom:4,fontWeight:"bold"},children:"Notes (Optional)"}),(0,x.jsx)("textarea",{name:"notes",value:o.notes,onChange:f,placeholder:"Add notes for admin review...",rows:3,style:{width:"100%",padding:8,border:"1px solid #d1d5db",borderRadius:4}})]}),(0,x.jsx)("button",{type:"submit",className:"btn btn-primary",disabled:e,style:{width:"100%",padding:12},children:e?"Submitting...":"Submit for Admin Verification"})]})]}),(0,x.jsxs)("div",{className:"dash-card",children:[(0,x.jsx)("h4",{style:{marginTop:0,marginBottom:16},children:"Pending Proposals"}),0===d.length?(0,x.jsx)("div",{style:{textAlign:"center",color:"#6b7280",padding:24},children:"No submitted rates pending approval"}):(0,x.jsx)("div",{style:{maxHeight:400,overflowY:"auto"},children:d.map((e,t)=>(0,x.jsxs)("div",{style:{padding:12,border:"1px solid #e5e7eb",borderRadius:4,marginBottom:8,background:"#f9fafb"},children:[(0,x.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"start",marginBottom:8},children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("div",{style:{fontWeight:"bold",fontSize:16},children:"Latex 60%"}),(0,x.jsxs)("div",{style:{fontSize:12,color:"#6b7280"},children:["Effective: ",g(e.effectiveDate)]})]}),(0,x.jsxs)("div",{style:{textAlign:"right"},children:[(0,x.jsx)("div",{style:{fontWeight:"bold"},children:v(e.companyRate)}),(0,x.jsxs)("div",{style:{fontSize:12,color:"#6b7280"},children:["Market: ",v(e.marketRate)]})]})]}),e.notes&&(0,x.jsxs)("div",{style:{fontSize:12,color:"#6b7280",marginBottom:4},children:[(0,x.jsx)("strong",{children:"Notes:"})," ",e.notes]}),(0,x.jsxs)("div",{style:{fontSize:12,color:"#6b7280"},children:["Submitted: ",g(e.createdAt)]}),(0,x.jsx)("div",{style:{display:"inline-block",padding:"2px 8px",borderRadius:4,background:"#fef3c7",color:"#92400e",fontSize:12,marginTop:4},children:"Pending Admin Verification"})]},t))})]})]}),(0,x.jsxs)("div",{className:"dash-card",style:{marginTop:24},children:[(0,x.jsx)("h4",{style:{marginTop:0},children:"Instructions"}),(0,x.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(300px, 1fr))",gap:16},children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("h5",{children:"Rate Update Process:"}),(0,x.jsxs)("ol",{style:{paddingLeft:20,lineHeight:1.6},children:[(0,x.jsx)("li",{children:"Fill in the rate details for the effective date"}),(0,x.jsx)("li",{children:"Submit the rate update for admin approval"}),(0,x.jsx)("li",{children:"Admin will review and approve/reject the update"}),(0,x.jsx)("li",{children:"Approved rates will be visible to customers"})]})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("h5",{children:"Important Notes:"}),(0,x.jsxs)("ul",{style:{paddingLeft:20,lineHeight:1.6},children:[(0,x.jsx)("li",{children:"Rates are per 100 Kg of product"}),(0,x.jsx)("li",{children:"Both INR and USD rates are required"}),(0,x.jsx)("li",{children:"Effective date cannot be in the past"}),(0,x.jsx)("li",{children:"Admin has final approval authority"})]})]})]})]})]})};var De=a(1389);const Pe=()=>{var e,t,a,s;const r="http://localhost:5000",l="undefined"!==typeof window?localStorage.getItem("token"):null,o=l?{Authorization:"Bearer ".concat(l),"Content-Type":"application/json"}:{"Content-Type":"application/json"},c=(0,n.useMemo)(()=>new Date,[]),[d,u]=(0,n.useState)({workerId:"",year:c.getFullYear(),month:c.getMonth()+1,group:"field"}),[h,p]=(0,n.useState)([]),[f,m]=(0,n.useState)(null),[g,v]=(0,n.useState)(""),[y,b]=(0,n.useState)(!1),[j,w]=(0,n.useState)(0),[N,S]=(0,n.useState)({workingDays:0,dailyWage:0,overtimeHours:0,overtimeRate:0,deductions:0,bonus:0,advance:0}),[k,A]=(0,n.useState)("");(0,n.useEffect)(()=>{const e=setTimeout(async()=>{(async()=>{try{v("");const t="http://localhost:5000",a="undefined"!==typeof window?localStorage.getItem("token"):null,n=a?{Authorization:"Bearer ".concat(a)}:{},s={field:"field_staff",lab:"lab_staff",delivery:"delivery_staff",accountant:"accountant"}[d.group]||"field_staff";let r=[];try{const e=await fetch("".concat(t,"/api/wages/staff?role=").concat(encodeURIComponent(s)),{headers:n,credentials:"include"});if(e.ok){const t=await e.json();r=(null===t||void 0===t?void 0:t.data)||(null===t||void 0===t?void 0:t.users)||(null===t||void 0===t?void 0:t.records)||t||[],Array.isArray(r)||(r=[])}else console.warn("Wages staff endpoint failed: ".concat(e.status))}catch(e){console.warn("Wages staff endpoint error:",e.message)}if(0===r.length)try{const e=await fetch("".concat(t,"/api/user-management/staff?role=").concat(encodeURIComponent(s),"&limit=200&status=active"),{headers:n,credentials:"include"});if(e.ok){const t=await e.json();r=(null===t||void 0===t?void 0:t.users)||(null===t||void 0===t?void 0:t.records)||(null===t||void 0===t?void 0:t.data)||t||[],Array.isArray(r)||(r=[])}else console.warn("User-management endpoint failed: ".concat(e.status))}catch(e){console.warn("User-management endpoint error:",e.message)}if(0===r.length)try{const e=await fetch("".concat(t,"/api/users?role=").concat(encodeURIComponent(s)),{headers:n,credentials:"include"});if(e.ok){const t=await e.json();r=(Array.isArray(t)?t:(null===t||void 0===t?void 0:t.users)||(null===t||void 0===t?void 0:t.records)||(null===t||void 0===t?void 0:t.data)||[]).filter(e=>e.role===s&&("active"===e.status||void 0===e.status))}}catch(e){console.warn("Users endpoint error:",e.message)}if(0===r.length)try{const e=await fetch("".concat(t,"/api/users"),{headers:n,credentials:"include"});if(e.ok){const t=await e.json();r=(Array.isArray(t)?t:(null===t||void 0===t?void 0:t.users)||(null===t||void 0===t?void 0:t.records)||(null===t||void 0===t?void 0:t.data)||[]).filter(e=>{var t;return(null===(t=e.role)||void 0===t?void 0:t.toLowerCase())===s.toLowerCase()&&("active"===e.status||void 0===e.status)})}}catch(e){console.warn("Fallback users endpoint error:",e.message)}if(p(r),0===r.length){const e="lab"===d.group?"Lab Staff":"delivery"===d.group?"Delivery Staff":"accountant"===d.group?"Accountant":"Staff";v("No active ".concat(e,' found. Please add employees with role "').concat(s,'" first.'))}}catch(t){console.error("Error loading employees:",t),v((null===t||void 0===t?void 0:t.message)||"Failed to load employees"),p([])}})()},300);return()=>clearTimeout(e)},[d.group]),(0,n.useEffect)(()=>{"accountant"===d.group&&!d.workerId&&h.length>0&&u(e=>(0,i.A)((0,i.A)({},e),{},{workerId:h[0]._id}))},[h,d.group,d.workerId]);const C=()=>{var e,t,a,n,s,r,i,l,o;const c=Number(null!==(e=null!==(t=null===f||void 0===f||null===(a=f.month)||void 0===a?void 0:a.workingDays)&&void 0!==t?t:null===f||void 0===f?void 0:f.workingDays)&&void 0!==e?e:0)||0,u=Number(null!==(n=null===f||void 0===f||null===(s=f.worker)||void 0===s?void 0:s.dailyWage)&&void 0!==n?n:0)||0,h=Number(null!==(r=null!==(i=null===f||void 0===f||null===(l=f.month)||void 0===l?void 0:l.grossSalary)&&void 0!==i?i:null===f||void 0===f?void 0:f.grossSalary)&&void 0!==r?r:0)||0,p="delivery"===d.group?c*u:h,m=Math.max(0,p-(Number(j)||0));return{workerId:d.workerId,group:d.group,year:Number(d.year),month:Number(d.month),source:"calculated",workingDays:c,dailyWage:u,grossSalary:p,salaryAdvance:Number(j)||0,netPay:m,days:(null===f||void 0===f?void 0:f.days)||(null===f||void 0===f||null===(o=f.month)||void 0===o?void 0:o.days)||[]}},_=()=>{const e=(Number(N.workingDays)||0)*(Number(N.dailyWage)||0),t=(Number(N.overtimeHours)||0)*(Number(N.overtimeRate)||0),a=Number(N.bonus)||0,n=e+("delivery"===d.group?0:t)+("delivery"===d.group?0:a),s=Math.max(0,n-(Number(N.deductions)||0)-(Number(N.advance)||0));return{workerId:d.workerId||null,group:d.group,year:Number(d.year),month:Number(d.month),source:"manual",workingDays:Number(N.workingDays)||0,dailyWage:Number(N.dailyWage)||0,overtimeHours:"delivery"===d.group?0:Number(N.overtimeHours)||0,overtimeRate:"delivery"===d.group?0:Number(N.overtimeRate)||0,bonus:"delivery"===d.group?0:Number(N.bonus)||0,deductions:Number(N.deductions)||0,salaryAdvance:Number(N.advance)||0,grossSalary:n,netPay:s}},L=async e=>{try{A(""),v("");const n=await fetch("".concat(r,"/api/wages/payslips"),{method:"POST",headers:o,body:JSON.stringify(e)});if(!n.ok)throw new Error("Save failed (".concat(n.status,")"));const s=await n.json();A("Payslip saved.");try{var t;const a={staffId:e.workerId,salaryData:{_id:(null===(t=s.data)||void 0===t?void 0:t._id)||s._id,grossSalary:e.grossSalary,netSalary:e.netPay,workingDays:e.workingDays,deductions:(e.grossSalary||0)-(e.netPay||0)},month:e.month,year:e.year};await fetch("".concat(r,"/api/salary-notifications/send"),{method:"POST",headers:o,body:JSON.stringify(a)}),A("Payslip saved and notification sent to staff.")}catch(a){console.warn("Failed to send salary notification:",a),A("Payslip saved (notification failed to send).")}}catch(n){const e=(null===n||void 0===n?void 0:n.message)||"Failed to save payslip";/\(404\)/.test(e)?v("Save failed (404): Missing backend route POST /api/wages/payslips"):v(e)}},T=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"payslip.csv";const a=Object.keys(e[0]||{}),n=[a.join(",")].concat(e.map(e=>a.map(t=>{var a;return JSON.stringify(null!==(a=e[t])&&void 0!==a?a:"")}).join(","))).join("\n"),s=new Blob([n],{type:"text/csv"}),r=URL.createObjectURL(s),i=document.createElement("a");i.href=r,i.download=t,i.click(),URL.revokeObjectURL(r)},E=(e,t)=>{const a=new De.Ay;let n=16;a.setFontSize(16),a.text(e,14,n),n+=8,a.setFontSize(11),Object.entries(t).forEach(e=>{let[t,s]=e;void 0!==s&&(a.text("".concat(t,": ").concat(Array.isArray(s)?JSON.stringify(s).slice(0,80):s),14,n),n+=6,n>280&&(a.addPage(),n=16))}),a.save("".concat(e.replace(/\s+/g,"_").toLowerCase(),".pdf"))};return(0,x.jsxs)("div",{style:{padding:16},children:[(0,x.jsx)("h2",{style:{margin:0},children:"Wages from Attendance"}),(0,x.jsxs)("form",{onSubmit:async e=>{e.preventDefault();try{b(!0),v(""),m(null);const e=await fetch("".concat(r,"/api/daily-wage/calculate/").concat(d.workerId,"?year=").concat(d.year,"&month=").concat(d.month),{headers:o});if(!e.ok)throw new Error("Calculation failed (".concat(e.status,")"));const t=await e.json();m((null===t||void 0===t?void 0:t.data)||t),w(0)}catch(t){v((null===t||void 0===t?void 0:t.message)||"Calculation failed")}finally{b(!1)}},style:{display:"grid",gap:16,gridTemplateColumns:"repeat(auto-fit, minmax(220px, 1fr))",alignItems:"end",marginTop:16},children:[(0,x.jsxs)("label",{style:{display:"flex",flexDirection:"column",gap:6},children:[(0,x.jsx)("span",{style:{color:"#334155",fontWeight:600},children:"Employee Type"}),(0,x.jsxs)("select",{value:d.group,onChange:e=>u(t=>(0,i.A)((0,i.A)({},t),{},{group:e.target.value,workerId:""})),style:{width:"100%",padding:"10px 12px",borderRadius:8,border:"1px solid #e5e7eb",background:"#fff"},children:[(0,x.jsx)("option",{value:"field",children:"Staff"}),(0,x.jsx)("option",{value:"lab",children:"Lab Staff"}),(0,x.jsx)("option",{value:"delivery",children:"Delivery Staff"}),(0,x.jsx)("option",{value:"accountant",children:"Accountant"})]})]}),(0,x.jsxs)("label",{style:{display:"flex",flexDirection:"column",gap:6},children:[(0,x.jsx)("span",{style:{color:"#334155",fontWeight:600},children:"Employee"}),(0,x.jsxs)("select",{value:d.workerId,onChange:e=>u(t=>(0,i.A)((0,i.A)({},t),{},{workerId:e.target.value})),required:!0,style:{width:"100%",padding:"10px 12px",borderRadius:8,border:"1px solid #e5e7eb",background:"#fff"},children:[(0,x.jsx)("option",{value:"",disabled:!0,children:"Select employee"}),h.map(e=>(0,x.jsxs)("option",{value:e._id,children:[(e.staffId||e.staff_id||"").toUpperCase()||""," ",e.name?"- ".concat(e.name):""]},e._id))]})]}),(0,x.jsxs)("label",{style:{display:"flex",flexDirection:"column",gap:6},children:[(0,x.jsx)("span",{style:{color:"#334155",fontWeight:600},children:"Year"}),(0,x.jsx)("input",{type:"number",min:2025,max:2100,value:d.year,onChange:e=>u(t=>(0,i.A)((0,i.A)({},t),{},{year:e.target.value})),required:!0,style:{width:"100%",padding:"10px 12px",borderRadius:8,border:"1px solid #e5e7eb",background:"#fff"}})]}),(0,x.jsxs)("label",{style:{display:"flex",flexDirection:"column",gap:6},children:[(0,x.jsx)("span",{style:{color:"#334155",fontWeight:600},children:"Month"}),(0,x.jsxs)("select",{value:d.month,onChange:e=>u(t=>(0,i.A)((0,i.A)({},t),{},{month:Number(e.target.value)})),required:!0,style:{width:"100%",padding:"10px 12px",borderRadius:8,border:"1px solid #e5e7eb",background:"#fff"},children:[(0,x.jsx)("option",{value:1,children:"January"}),(0,x.jsx)("option",{value:2,children:"February"}),(0,x.jsx)("option",{value:3,children:"March"}),(0,x.jsx)("option",{value:4,children:"April"}),(0,x.jsx)("option",{value:5,children:"May"}),(0,x.jsx)("option",{value:6,children:"June"}),(0,x.jsx)("option",{value:7,children:"July"}),(0,x.jsx)("option",{value:8,children:"August"}),(0,x.jsx)("option",{value:9,children:"September"}),(0,x.jsx)("option",{value:10,children:"October"}),(0,x.jsx)("option",{value:11,children:"November"}),(0,x.jsx)("option",{value:12,children:"December"})]})]}),(0,x.jsx)("div",{style:{display:"flex",alignItems:"flex-end"},children:(0,x.jsx)("button",{type:"submit",className:"btn btn-primary",disabled:y,children:y?"Calculating...":"Calculate"})})]}),g&&(0,x.jsx)("div",{style:{color:"tomato",marginTop:8},children:g}),f&&(0,x.jsx)("div",{style:{marginTop:16},children:(0,x.jsxs)("div",{className:"dash-card",style:{padding:16},children:[(0,x.jsx)("h3",{style:{marginTop:0},children:"Summary"}),((e,t,a,n,s,r,i,l)=>{const o=Number(null!==(e=null!==(t=null===(a=f.month)||void 0===a?void 0:a.workingDays)&&void 0!==t?t:f.workingDays)&&void 0!==e?e:0)||0,c=Number(null!==(n=null===(s=f.worker)||void 0===s?void 0:s.dailyWage)&&void 0!==n?n:0)||0,u=Number(null!==(r=null!==(i=null===(l=f.month)||void 0===l?void 0:l.grossSalary)&&void 0!==i?i:f.grossSalary)&&void 0!==r?r:0)||0,h="delivery"===d.group?o*c:u;return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)("div",{children:["Working Days: ",(0,x.jsx)("b",{children:o})]}),(0,x.jsxs)("div",{children:["Daily Wage: ",(0,x.jsx)("b",{children:c})]}),(0,x.jsxs)("div",{children:["Gross Salary: ",(0,x.jsx)("b",{children:h})]})]})})(),(0,x.jsxs)("div",{style:{marginTop:8},children:[(0,x.jsx)("label",{children:"Salary Advance"}),(0,x.jsx)("br",{}),(0,x.jsx)("input",{type:"number",min:0,step:"0.01",value:j,onChange:e=>w(Number(e.target.value||0))})]}),((e,t,a,n,s,r,i,l)=>{const o=Number(null!==(e=null!==(t=null===(a=f.month)||void 0===a?void 0:a.workingDays)&&void 0!==t?t:f.workingDays)&&void 0!==e?e:0)||0,c=Number(null!==(n=null===(s=f.worker)||void 0===s?void 0:s.dailyWage)&&void 0!==n?n:0)||0,u=Number(null!==(r=null!==(i=null===(l=f.month)||void 0===l?void 0:l.grossSalary)&&void 0!==i?i:f.grossSalary)&&void 0!==r?r:0)||0,h="delivery"===d.group?o*c:u,p=Math.max(0,h-(Number(j)||0));return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)("div",{style:{marginTop:8},children:["Pending Amount: ",(0,x.jsx)("b",{children:p.toFixed(2)})]}),(0,x.jsxs)("div",{style:{marginTop:12,display:"flex",gap:8,flexWrap:"wrap"},children:[(0,x.jsx)("button",{type:"button",className:"btn",onClick:()=>L(C()),children:"Save Payslip"}),(0,x.jsx)("button",{type:"button",className:"btn btn-outline",onClick:()=>T([C()],"calculated_payslip.csv"),children:"Export CSV"}),(0,x.jsx)("button",{type:"button",className:"btn btn-outline",onClick:()=>E("Calculated Payslip",C()),children:"Export PDF"})]})]})})()]})}),(0,x.jsx)("div",{style:{marginTop:16},children:(0,x.jsxs)("div",{className:"dash-card",style:{padding:16},children:[(0,x.jsx)("h3",{style:{marginTop:0},children:"Manual Calculator"}),(0,x.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(220px, 1fr))",gap:12},children:[(0,x.jsxs)("label",{style:{display:"flex",flexDirection:"column",gap:6},children:[(0,x.jsx)("span",{style:{color:"#334155",fontWeight:600},children:"Working Days"}),(0,x.jsx)("input",{type:"number",min:0,step:"1",value:N.workingDays,onChange:e=>S(t=>(0,i.A)((0,i.A)({},t),{},{workingDays:Number(e.target.value||0)})),style:{width:"100%",padding:"10px 12px",borderRadius:8,border:"1px solid #e5e7eb",background:"#fff"}})]}),(0,x.jsxs)("label",{style:{display:"flex",flexDirection:"column",gap:6},children:[(0,x.jsx)("span",{style:{color:"#334155",fontWeight:600},children:"Daily Wage"}),(0,x.jsx)("input",{type:"number",min:0,step:"0.01",value:N.dailyWage,onChange:e=>S(t=>(0,i.A)((0,i.A)({},t),{},{dailyWage:Number(e.target.value||0)})),style:{width:"100%",padding:"10px 12px",borderRadius:8,border:"1px solid #e5e7eb",background:"#fff"}})]}),(0,x.jsxs)("label",{style:{display:"flex",flexDirection:"column",gap:6},children:[(0,x.jsx)("span",{style:{color:"#334155",fontWeight:600},children:"Overtime Hours"}),(0,x.jsx)("input",{type:"number",min:0,step:"0.1",value:N.overtimeHours,onChange:e=>S(t=>(0,i.A)((0,i.A)({},t),{},{overtimeHours:Number(e.target.value||0)})),disabled:"delivery"===d.group,title:"delivery"===d.group?"Overtime disabled for Delivery Staff":"",style:{width:"100%",padding:"10px 12px",borderRadius:8,border:"1px solid #e5e7eb",background:"#f9fafb"}})]}),(0,x.jsxs)("label",{style:{display:"flex",flexDirection:"column",gap:6},children:[(0,x.jsx)("span",{style:{color:"#334155",fontWeight:600},children:"Overtime Rate (per hour)"}),(0,x.jsx)("input",{type:"number",min:0,step:"0.01",value:N.overtimeRate,onChange:e=>S(t=>(0,i.A)((0,i.A)({},t),{},{overtimeRate:Number(e.target.value||0)})),disabled:"delivery"===d.group,title:"delivery"===d.group?"Overtime disabled for Delivery Staff":"",style:{width:"100%",padding:"10px 12px",borderRadius:8,border:"1px solid #e5e7eb",background:"#f9fafb"}})]}),(0,x.jsxs)("label",{style:{display:"flex",flexDirection:"column",gap:6},children:[(0,x.jsx)("span",{style:{color:"#334155",fontWeight:600},children:"Bonus"}),(0,x.jsx)("input",{type:"number",min:0,step:"0.01",value:N.bonus,onChange:e=>S(t=>(0,i.A)((0,i.A)({},t),{},{bonus:Number(e.target.value||0)})),disabled:"delivery"===d.group,title:"delivery"===d.group?"Bonus disabled for Delivery Staff":"",style:{width:"100%",padding:"10px 12px",borderRadius:8,border:"1px solid #e5e7eb",background:"#f9fafb"}})]}),(0,x.jsxs)("label",{style:{display:"flex",flexDirection:"column",gap:6},children:[(0,x.jsx)("span",{style:{color:"#334155",fontWeight:600},children:"Deductions"}),(0,x.jsx)("input",{type:"number",min:0,step:"0.01",value:N.deductions,onChange:e=>S(t=>(0,i.A)((0,i.A)({},t),{},{deductions:Number(e.target.value||0)})),style:{width:"100%",padding:"10px 12px",borderRadius:8,border:"1px solid #e5e7eb",background:"#fff"}})]}),(0,x.jsxs)("label",{style:{display:"flex",flexDirection:"column",gap:6},children:[(0,x.jsx)("span",{style:{color:"#334155",fontWeight:600},children:"Salary Advance"}),(0,x.jsx)("input",{type:"number",min:0,step:"0.01",value:N.advance,onChange:e=>S(t=>(0,i.A)((0,i.A)({},t),{},{advance:Number(e.target.value||0)})),style:{width:"100%",padding:"10px 12px",borderRadius:8,border:"1px solid #e5e7eb",background:"#fff"}})]})]}),(()=>{const e=(Number(N.workingDays)||0)*(Number(N.dailyWage)||0),t="delivery"===d.group?0:(Number(N.overtimeHours)||0)*(Number(N.overtimeRate)||0),a=e+t+("delivery"===d.group?0:Number(N.bonus)||0),n=Math.max(0,a-(Number(N.deductions)||0)-(Number(N.advance)||0));return(0,x.jsxs)("div",{style:{marginTop:12,display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(220px, 1fr))",gap:12},children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("div",{style:{color:"#64748b",fontSize:12},children:"Base Pay"}),(0,x.jsx)("div",{style:{fontWeight:700},children:e.toFixed(2)})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("div",{style:{color:"#64748b",fontSize:12},children:"Overtime Pay"}),(0,x.jsx)("div",{style:{fontWeight:700},children:t.toFixed(2)})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("div",{style:{color:"#64748b",fontSize:12},children:"Gross"}),(0,x.jsx)("div",{style:{fontWeight:700},children:a.toFixed(2)})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("div",{style:{color:"#64748b",fontSize:12},children:"Net Pay"}),(0,x.jsx)("div",{style:{fontWeight:700},children:n.toFixed(2)})]}),(0,x.jsxs)("div",{style:{gridColumn:"1 / -1",display:"flex",gap:8,flexWrap:"wrap"},children:[(0,x.jsx)("button",{type:"button",className:"btn",onClick:()=>L(_()),children:"Save Payslip"}),(0,x.jsx)("button",{type:"button",className:"btn btn-outline",onClick:()=>T([_()],"manual_payslip.csv"),children:"Export CSV"}),(0,x.jsx)("button",{type:"button",className:"btn btn-outline",onClick:()=>E("Manual Payslip",_()),children:"Export PDF"})]})]})})()]})}),k&&(0,x.jsx)("div",{style:{color:"limegreen",marginTop:8},children:k}),null!==f&&void 0!==f&&null!==(e=f.days)&&void 0!==e&&e.length||null!==f&&void 0!==f&&null!==(t=f.month)&&void 0!==t&&null!==(a=t.days)&&void 0!==a&&a.length?(0,x.jsx)("div",{style:{marginTop:16,overflowX:"auto"},children:(0,x.jsxs)("div",{className:"dash-card",style:{padding:16},children:[(0,x.jsx)("h3",{style:{marginTop:0},children:"Day-level Breakdown"}),(0,x.jsxs)("table",{className:"dashboard-table",style:{minWidth:640},children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{children:"Date"}),(0,x.jsx)("th",{children:"Status"}),(0,x.jsx)("th",{children:"Hours"}),(0,x.jsx)("th",{children:"OT Hours"})]})}),(0,x.jsx)("tbody",{children:(f.days||(null===(s=f.month)||void 0===s?void 0:s.days)||[]).map((e,t)=>{var a,n;return(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{children:e.date?new Date(e.date).toLocaleDateString():"-"}),(0,x.jsx)("td",{children:e.status||e.type||"-"}),(0,x.jsx)("td",{children:null!==(a=e.hours)&&void 0!==a?a:"-"}),(0,x.jsx)("td",{children:null!==(n=e.overtimeHours)&&void 0!==n?n:"-"})]},t)})})]})]})}):null]})};!function(e){if(!e||"undefined"==typeof document)return;let t=document.head||document.getElementsByTagName("head")[0],a=document.createElement("style");a.type="text/css",t.firstChild?t.insertBefore(a,t.firstChild):t.appendChild(a),a.styleSheet?a.styleSheet.cssText=e:a.appendChild(document.createTextNode(e))}(':root{--toastify-color-light: #fff;--toastify-color-dark: #121212;--toastify-color-info: #3498db;--toastify-color-success: #07bc0c;--toastify-color-warning: #f1c40f;--toastify-color-error: hsl(6, 78%, 57%);--toastify-color-transparent: rgba(255, 255, 255, .7);--toastify-icon-color-info: var(--toastify-color-info);--toastify-icon-color-success: var(--toastify-color-success);--toastify-icon-color-warning: var(--toastify-color-warning);--toastify-icon-color-error: var(--toastify-color-error);--toastify-container-width: fit-content;--toastify-toast-width: 320px;--toastify-toast-offset: 16px;--toastify-toast-top: max(var(--toastify-toast-offset), env(safe-area-inset-top));--toastify-toast-right: max(var(--toastify-toast-offset), env(safe-area-inset-right));--toastify-toast-left: max(var(--toastify-toast-offset), env(safe-area-inset-left));--toastify-toast-bottom: max(var(--toastify-toast-offset), env(safe-area-inset-bottom));--toastify-toast-background: #fff;--toastify-toast-padding: 14px;--toastify-toast-min-height: 64px;--toastify-toast-max-height: 800px;--toastify-toast-bd-radius: 6px;--toastify-toast-shadow: 0px 4px 12px rgba(0, 0, 0, .1);--toastify-font-family: sans-serif;--toastify-z-index: 9999;--toastify-text-color-light: #757575;--toastify-text-color-dark: #fff;--toastify-text-color-info: #fff;--toastify-text-color-success: #fff;--toastify-text-color-warning: #fff;--toastify-text-color-error: #fff;--toastify-spinner-color: #616161;--toastify-spinner-color-empty-area: #e0e0e0;--toastify-color-progress-light: linear-gradient(to right, #4cd964, #5ac8fa, #007aff, #34aadc, #5856d6, #ff2d55);--toastify-color-progress-dark: #bb86fc;--toastify-color-progress-info: var(--toastify-color-info);--toastify-color-progress-success: var(--toastify-color-success);--toastify-color-progress-warning: var(--toastify-color-warning);--toastify-color-progress-error: var(--toastify-color-error);--toastify-color-progress-bgo: .2}.Toastify__toast-container{z-index:var(--toastify-z-index);-webkit-transform:translate3d(0,0,var(--toastify-z-index));position:fixed;width:var(--toastify-container-width);box-sizing:border-box;color:#fff;display:flex;flex-direction:column}.Toastify__toast-container--top-left{top:var(--toastify-toast-top);left:var(--toastify-toast-left)}.Toastify__toast-container--top-center{top:var(--toastify-toast-top);left:50%;transform:translate(-50%);align-items:center}.Toastify__toast-container--top-right{top:var(--toastify-toast-top);right:var(--toastify-toast-right);align-items:end}.Toastify__toast-container--bottom-left{bottom:var(--toastify-toast-bottom);left:var(--toastify-toast-left)}.Toastify__toast-container--bottom-center{bottom:var(--toastify-toast-bottom);left:50%;transform:translate(-50%);align-items:center}.Toastify__toast-container--bottom-right{bottom:var(--toastify-toast-bottom);right:var(--toastify-toast-right);align-items:end}.Toastify__toast{--y: 0;position:relative;touch-action:none;width:var(--toastify-toast-width);min-height:var(--toastify-toast-min-height);box-sizing:border-box;margin-bottom:1rem;padding:var(--toastify-toast-padding);border-radius:var(--toastify-toast-bd-radius);box-shadow:var(--toastify-toast-shadow);max-height:var(--toastify-toast-max-height);font-family:var(--toastify-font-family);z-index:0;display:flex;flex:1 auto;align-items:center;word-break:break-word}@media only screen and (max-width: 480px){.Toastify__toast-container{width:100vw;left:env(safe-area-inset-left);margin:0}.Toastify__toast-container--top-left,.Toastify__toast-container--top-center,.Toastify__toast-container--top-right{top:env(safe-area-inset-top);transform:translate(0)}.Toastify__toast-container--bottom-left,.Toastify__toast-container--bottom-center,.Toastify__toast-container--bottom-right{bottom:env(safe-area-inset-bottom);transform:translate(0)}.Toastify__toast-container--rtl{right:env(safe-area-inset-right);left:initial}.Toastify__toast{--toastify-toast-width: 100%;margin-bottom:0;border-radius:0}}.Toastify__toast-container[data-stacked=true]{width:var(--toastify-toast-width)}.Toastify__toast--stacked{position:absolute;width:100%;transform:translate3d(0,var(--y),0) scale(var(--s));transition:transform .3s}.Toastify__toast--stacked[data-collapsed] .Toastify__toast-body,.Toastify__toast--stacked[data-collapsed] .Toastify__close-button{transition:opacity .1s}.Toastify__toast--stacked[data-collapsed=false]{overflow:visible}.Toastify__toast--stacked[data-collapsed=true]:not(:last-child)>*{opacity:0}.Toastify__toast--stacked:after{content:"";position:absolute;left:0;right:0;height:calc(var(--g) * 1px);bottom:100%}.Toastify__toast--stacked[data-pos=top]{top:0}.Toastify__toast--stacked[data-pos=bot]{bottom:0}.Toastify__toast--stacked[data-pos=bot].Toastify__toast--stacked:before{transform-origin:top}.Toastify__toast--stacked[data-pos=top].Toastify__toast--stacked:before{transform-origin:bottom}.Toastify__toast--stacked:before{content:"";position:absolute;left:0;right:0;bottom:0;height:100%;transform:scaleY(3);z-index:-1}.Toastify__toast--rtl{direction:rtl}.Toastify__toast--close-on-click{cursor:pointer}.Toastify__toast-icon{margin-inline-end:10px;width:22px;flex-shrink:0;display:flex}.Toastify--animate{animation-fill-mode:both;animation-duration:.5s}.Toastify--animate-icon{animation-fill-mode:both;animation-duration:.3s}.Toastify__toast-theme--dark{background:var(--toastify-color-dark);color:var(--toastify-text-color-dark)}.Toastify__toast-theme--light,.Toastify__toast-theme--colored.Toastify__toast--default{background:var(--toastify-color-light);color:var(--toastify-text-color-light)}.Toastify__toast-theme--colored.Toastify__toast--info{color:var(--toastify-text-color-info);background:var(--toastify-color-info)}.Toastify__toast-theme--colored.Toastify__toast--success{color:var(--toastify-text-color-success);background:var(--toastify-color-success)}.Toastify__toast-theme--colored.Toastify__toast--warning{color:var(--toastify-text-color-warning);background:var(--toastify-color-warning)}.Toastify__toast-theme--colored.Toastify__toast--error{color:var(--toastify-text-color-error);background:var(--toastify-color-error)}.Toastify__progress-bar-theme--light{background:var(--toastify-color-progress-light)}.Toastify__progress-bar-theme--dark{background:var(--toastify-color-progress-dark)}.Toastify__progress-bar--info{background:var(--toastify-color-progress-info)}.Toastify__progress-bar--success{background:var(--toastify-color-progress-success)}.Toastify__progress-bar--warning{background:var(--toastify-color-progress-warning)}.Toastify__progress-bar--error{background:var(--toastify-color-progress-error)}.Toastify__progress-bar-theme--colored.Toastify__progress-bar--info,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--success,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--warning,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--error{background:var(--toastify-color-transparent)}.Toastify__close-button{color:#fff;position:absolute;top:6px;right:6px;background:transparent;outline:none;border:none;padding:0;cursor:pointer;opacity:.7;transition:.3s ease;z-index:1}.Toastify__toast--rtl .Toastify__close-button{left:6px;right:unset}.Toastify__close-button--light{color:#000;opacity:.3}.Toastify__close-button>svg{fill:currentColor;height:16px;width:14px}.Toastify__close-button:hover,.Toastify__close-button:focus{opacity:1}@keyframes Toastify__trackProgress{0%{transform:scaleX(1)}to{transform:scaleX(0)}}.Toastify__progress-bar{position:absolute;bottom:0;left:0;width:100%;height:100%;z-index:1;opacity:.7;transform-origin:left}.Toastify__progress-bar--animated{animation:Toastify__trackProgress linear 1 forwards}.Toastify__progress-bar--controlled{transition:transform .2s}.Toastify__progress-bar--rtl{right:0;left:initial;transform-origin:right;border-bottom-left-radius:initial}.Toastify__progress-bar--wrp{position:absolute;overflow:hidden;bottom:0;left:0;width:100%;height:5px;border-bottom-left-radius:var(--toastify-toast-bd-radius);border-bottom-right-radius:var(--toastify-toast-bd-radius)}.Toastify__progress-bar--wrp[data-hidden=true]{opacity:0}.Toastify__progress-bar--bg{opacity:var(--toastify-color-progress-bgo);width:100%;height:100%}.Toastify__spinner{width:20px;height:20px;box-sizing:border-box;border:2px solid;border-radius:100%;border-color:var(--toastify-spinner-color-empty-area);border-right-color:var(--toastify-spinner-color);animation:Toastify__spin .65s linear infinite}@keyframes Toastify__bounceInRight{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(3000px,0,0)}60%{opacity:1;transform:translate3d(-25px,0,0)}75%{transform:translate3d(10px,0,0)}90%{transform:translate3d(-5px,0,0)}to{transform:none}}@keyframes Toastify__bounceOutRight{20%{opacity:1;transform:translate3d(-20px,var(--y),0)}to{opacity:0;transform:translate3d(2000px,var(--y),0)}}@keyframes Toastify__bounceInLeft{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(-3000px,0,0)}60%{opacity:1;transform:translate3d(25px,0,0)}75%{transform:translate3d(-10px,0,0)}90%{transform:translate3d(5px,0,0)}to{transform:none}}@keyframes Toastify__bounceOutLeft{20%{opacity:1;transform:translate3d(20px,var(--y),0)}to{opacity:0;transform:translate3d(-2000px,var(--y),0)}}@keyframes Toastify__bounceInUp{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(0,3000px,0)}60%{opacity:1;transform:translate3d(0,-20px,0)}75%{transform:translate3d(0,10px,0)}90%{transform:translate3d(0,-5px,0)}to{transform:translateZ(0)}}@keyframes Toastify__bounceOutUp{20%{transform:translate3d(0,calc(var(--y) - 10px),0)}40%,45%{opacity:1;transform:translate3d(0,calc(var(--y) + 20px),0)}to{opacity:0;transform:translate3d(0,-2000px,0)}}@keyframes Toastify__bounceInDown{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(0,-3000px,0)}60%{opacity:1;transform:translate3d(0,25px,0)}75%{transform:translate3d(0,-10px,0)}90%{transform:translate3d(0,5px,0)}to{transform:none}}@keyframes Toastify__bounceOutDown{20%{transform:translate3d(0,calc(var(--y) - 10px),0)}40%,45%{opacity:1;transform:translate3d(0,calc(var(--y) + 20px),0)}to{opacity:0;transform:translate3d(0,2000px,0)}}.Toastify__bounce-enter--top-left,.Toastify__bounce-enter--bottom-left{animation-name:Toastify__bounceInLeft}.Toastify__bounce-enter--top-right,.Toastify__bounce-enter--bottom-right{animation-name:Toastify__bounceInRight}.Toastify__bounce-enter--top-center{animation-name:Toastify__bounceInDown}.Toastify__bounce-enter--bottom-center{animation-name:Toastify__bounceInUp}.Toastify__bounce-exit--top-left,.Toastify__bounce-exit--bottom-left{animation-name:Toastify__bounceOutLeft}.Toastify__bounce-exit--top-right,.Toastify__bounce-exit--bottom-right{animation-name:Toastify__bounceOutRight}.Toastify__bounce-exit--top-center{animation-name:Toastify__bounceOutUp}.Toastify__bounce-exit--bottom-center{animation-name:Toastify__bounceOutDown}@keyframes Toastify__zoomIn{0%{opacity:0;transform:scale3d(.3,.3,.3)}50%{opacity:1}}@keyframes Toastify__zoomOut{0%{opacity:1}50%{opacity:0;transform:translate3d(0,var(--y),0) scale3d(.3,.3,.3)}to{opacity:0}}.Toastify__zoom-enter{animation-name:Toastify__zoomIn}.Toastify__zoom-exit{animation-name:Toastify__zoomOut}@keyframes Toastify__flipIn{0%{transform:perspective(400px) rotateX(90deg);animation-timing-function:ease-in;opacity:0}40%{transform:perspective(400px) rotateX(-20deg);animation-timing-function:ease-in}60%{transform:perspective(400px) rotateX(10deg);opacity:1}80%{transform:perspective(400px) rotateX(-5deg)}to{transform:perspective(400px)}}@keyframes Toastify__flipOut{0%{transform:translate3d(0,var(--y),0) perspective(400px)}30%{transform:translate3d(0,var(--y),0) perspective(400px) rotateX(-20deg);opacity:1}to{transform:translate3d(0,var(--y),0) perspective(400px) rotateX(90deg);opacity:0}}.Toastify__flip-enter{animation-name:Toastify__flipIn}.Toastify__flip-exit{animation-name:Toastify__flipOut}@keyframes Toastify__slideInRight{0%{transform:translate3d(110%,0,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInLeft{0%{transform:translate3d(-110%,0,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInUp{0%{transform:translate3d(0,110%,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInDown{0%{transform:translate3d(0,-110%,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideOutRight{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(110%,var(--y),0)}}@keyframes Toastify__slideOutLeft{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(-110%,var(--y),0)}}@keyframes Toastify__slideOutDown{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(0,500px,0)}}@keyframes Toastify__slideOutUp{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(0,-500px,0)}}.Toastify__slide-enter--top-left,.Toastify__slide-enter--bottom-left{animation-name:Toastify__slideInLeft}.Toastify__slide-enter--top-right,.Toastify__slide-enter--bottom-right{animation-name:Toastify__slideInRight}.Toastify__slide-enter--top-center{animation-name:Toastify__slideInDown}.Toastify__slide-enter--bottom-center{animation-name:Toastify__slideInUp}.Toastify__slide-exit--top-left,.Toastify__slide-exit--bottom-left{animation-name:Toastify__slideOutLeft;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--top-right,.Toastify__slide-exit--bottom-right{animation-name:Toastify__slideOutRight;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--top-center{animation-name:Toastify__slideOutUp;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--bottom-center{animation-name:Toastify__slideOutDown;animation-timing-function:ease-in;animation-duration:.3s}@keyframes Toastify__spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}\n');var Re=e=>"number"==typeof e&&!isNaN(e),Ie=e=>"string"==typeof e,Be=e=>"function"==typeof e,Fe=e=>(0,n.isValidElement)(e)||Ie(e)||Be(e)||Re(e);function Oe(e){let{enter:t,exit:a,appendPosition:s=!1,collapse:r=!0,collapseDuration:i=300}=e;return function(e){let{children:l,position:o,preventExitTransition:c,done:d,nodeRef:u,isIn:h,playToast:p}=e,f=s?"".concat(t,"--").concat(o):t,m=s?"".concat(a,"--").concat(o):a,x=(0,n.useRef)(0);return(0,n.useLayoutEffect)(()=>{let e=u.current,t=f.split(" "),a=n=>{n.target===u.current&&(p(),e.removeEventListener("animationend",a),e.removeEventListener("animationcancel",a),0===x.current&&"animationcancel"!==n.type&&e.classList.remove(...t))};e.classList.add(...t),e.addEventListener("animationend",a),e.addEventListener("animationcancel",a)},[]),(0,n.useEffect)(()=>{let e=u.current,t=()=>{e.removeEventListener("animationend",t),r?function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:300,{scrollHeight:n,style:s}=e;requestAnimationFrame(()=>{s.minHeight="initial",s.height=n+"px",s.transition="all ".concat(a,"ms"),requestAnimationFrame(()=>{s.height="0",s.padding="0",s.margin="0",setTimeout(t,a)})})}(e,d,i):d()};h||(c?t():(x.current=1,e.className+=" ".concat(m),e.addEventListener("animationend",t)))},[h]),n.createElement(n.Fragment,null,l)}}var qe=1,ze=()=>"".concat(qe++);var Me=new Map,Ue=[],We=new Set,He=()=>Me.size>0;function Ve(e,t){var a;if(t)return!(null==(a=Me.get(t))||!a.isToastActive(e));let n=!1;return Me.forEach(t=>{t.isToastActive(e)&&(n=!0)}),n}function Ge(e){if(He()){if(null==e||(e=>Ie(e)||Re(e))(e))Me.forEach(t=>{t.removeToast(e)});else if(e&&("containerId"in e||"id"in e)){let t=Me.get(e.containerId);t?t.removeToast(e.id):Me.forEach(t=>{t.removeToast(e.id)})}}else Ue=Ue.filter(t=>null!=e&&t.options.toastId!==e)}function Je(e,t){Fe(e)&&(He()||Ue.push({content:e,options:t}),Me.forEach(a=>{a.buildToast(e,t)}))}function Ye(e,t){Me.forEach(a=>{(null==t||null==t||!t.containerId||(null==t?void 0:t.containerId)===a.id)&&a.toggle(e,null==t?void 0:t.id)})}function Ke(e){return e&&(Ie(e.toastId)||Re(e.toastId))?e.toastId:ze()}function Qe(e,t){return Je(e,t),t.toastId}function $e(e,t){return(0,i.A)((0,i.A)({},t),{},{type:t&&t.type||e,toastId:Ke(t)})}function Xe(e){return(t,a)=>Qe(t,$e(e,a))}function Ze(e,t){return Qe(e,$e("default",t))}Ze.loading=(e,t)=>Qe(e,$e("default",(0,i.A)({isLoading:!0,autoClose:!1,closeOnClick:!1,closeButton:!1,draggable:!1},t))),Ze.promise=function(e,t,a){let n,{pending:s,error:r,success:l}=t;s&&(n=Ie(s)?Ze.loading(s,a):Ze.loading(s.render,(0,i.A)((0,i.A)({},a),s)));let o={isLoading:null,autoClose:null,closeOnClick:null,closeButton:null,draggable:null},c=(e,t,s)=>{if(null==t)return void Ze.dismiss(n);let r=(0,i.A)((0,i.A)((0,i.A)({type:e},o),a),{},{data:s}),l=Ie(t)?{render:t}:t;return n?Ze.update(n,(0,i.A)((0,i.A)({},r),l)):Ze(l.render,(0,i.A)((0,i.A)({},r),l)),s},d=Be(e)?e():e;return d.then(e=>c("success",l,e)).catch(e=>c("error",r,e)),d},Ze.success=Xe("success"),Ze.info=Xe("info"),Ze.error=Xe("error"),Ze.warning=Xe("warning"),Ze.warn=Ze.warning,Ze.dark=(e,t)=>Qe(e,$e("default",(0,i.A)({theme:"dark"},t))),Ze.dismiss=function(e){Ge(e)},Ze.clearWaitingQueue=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Me.forEach(t=>{t.props.limit&&(!e.containerId||t.id===e.containerId)&&t.clearQueue()})},Ze.isActive=Ve,Ze.update=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=((e,t)=>{let{containerId:a}=t;var n;return null==(n=Me.get(a||1))?void 0:n.toasts.get(e)})(e,t);if(a){let{props:n,content:s}=a,r=(0,i.A)((0,i.A)((0,i.A)({delay:100},n),t),{},{toastId:t.toastId||e,updateId:ze()});r.toastId!==e&&(r.staleId=e);let l=r.render||s;delete r.render,Qe(l,r)}},Ze.done=e=>{Ze.update(e,{progress:1})},Ze.onChange=function(e){return We.add(e),()=>{We.delete(e)}},Ze.play=e=>Ye(!0,e),Ze.pause=e=>Ye(!1,e);"undefined"!=typeof window?n.useLayoutEffect:n.useEffect;var et=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return{enter:"Toastify--animate Toastify__".concat(e,"-enter"),exit:"Toastify--animate Toastify__".concat(e,"-exit"),appendPosition:t}};Oe(et("bounce",!0)),Oe(et("slide",!0)),Oe(et("zoom")),Oe(et("flip"));const tt=()=>{const e="http://localhost:5000",t=localStorage.getItem("token"),a={"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},[s,r]=(0,n.useState)(!1),[l,o]=(0,n.useState)(""),[c,d]=(0,n.useState)(""),[u,h]=(0,n.useState)([]),[p,f]=(0,n.useState)(""),[m,g]=(0,n.useState)([]),[v,y]=(0,n.useState)({}),[b,j]=(0,n.useState)({year:(new Date).getFullYear(),month:(new Date).getMonth()+1,wageType:"daily",dailyWage:"",monthlySalary:"",overtimeHours:0,overtimeRate:1.5,allowances:{transport:0,food:0,housing:0,other:0},deductions:{providentFund:0,professionalTax:0,incomeTax:0,other:0},bonuses:{attendance:0,performance:0,productivity:0}}),[w,N]=(0,n.useState)([]),[S,k]=(0,n.useState)(!1),A={daily:{title:"Daily Wages Staff",description:"Variable pay based on attendance",roles:["delivery_staff","field_staff","staff"],defaultWage:500,wageType:"daily",icon:"\ud83d\udc77"},monthly:{title:"Monthly Salary Staff",description:"Fixed monthly compensation",roles:["lab","lab_staff","lab_manager","accountant"],defaultWage:25e3,wageType:"monthly",icon:"\ud83d\udc68\u200d\ud83d\udcbc"}},C=(0,n.useCallback)(async()=>{try{r(!0);const t=await fetch("".concat(e,"/api/user-management/staff?status=active&limit=500"),{headers:a});if(t.ok){const e=await t.json(),a=(null===e||void 0===e?void 0:e.users)||(null===e||void 0===e?void 0:e.records)||[];h(a);const n={};a.forEach(e=>{const t=e.role||"staff";n[t]||(n[t]=[]),n[t].push(e)}),y(n)}}catch(t){o("Failed to load staff data")}finally{r(!1)}},[e,a]),_=async t=>{try{const{wageType:n,dailyWage:s,monthlySalary:r,overtimeHours:i,overtimeRate:l,allowances:o,deductions:c,bonuses:d}=b;let u=0,h=0;if("daily"===n){const n=await fetch("".concat(e,"/api/attendance/staff/").concat(t._id,"?year=").concat(b.year,"&month=").concat(b.month),{headers:a});if(n.ok){const e=await n.json();h=(null===e||void 0===e?void 0:e.workingDays)||0}u=h*Number(s)}else u=Number(r);const p=Number(i)*(u/("daily"===n?8:240))*Number(l),f=Object.values(o).reduce((e,t)=>e+Number(t),0),m=Object.values(d).reduce((e,t)=>e+Number(t),0),x=Object.values(c).reduce((e,t)=>e+Number(t),0),g=u+p+f+m;return{staff:t,baseSalary:u,overtimePay:p,totalAllowances:f,totalBonuses:m,totalDeductions:x,grossSalary:g,netSalary:g-x,workingDays:h,wageType:n}}catch(n){return null}};return(0,n.useEffect)(()=>{C()},[C]),(0,x.jsxs)("div",{style:{padding:"24px",maxWidth:"1400px",margin:"0 auto",fontFamily:"'Inter', sans-serif"},children:[(0,x.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"32px"},children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("h2",{style:{margin:0,fontSize:"24px",fontWeight:"700",color:"#0f172a"},children:"Salary Verification"}),(0,x.jsx)("p",{style:{margin:"8px 0 0 0",color:"#64748b",fontSize:"14px"},children:"Manager Dashboard \u2022 Staff Salary Processing"})]}),(0,x.jsxs)("div",{style:{display:"flex",gap:"12px"},children:[(0,x.jsx)("button",{onClick:()=>{g([]),N([]),k(!1)},style:{padding:"10px 16px",borderRadius:"8px",border:"1px solid #e2e8f0",background:"white",color:"#475569",cursor:"pointer",fontWeight:"500"},children:"Reset"}),(0,x.jsx)("button",{onClick:C,style:{padding:"10px 16px",borderRadius:"8px",background:"#0f172a",color:"white",border:"none",cursor:"pointer",fontWeight:"500"},children:"Refresh Data"})]})]}),(0,x.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(300px, 1fr))",gap:"20px",marginBottom:"32px"},children:Object.entries(A).map(e=>{let[t,a]=e;return(0,x.jsxs)("div",{onClick:()=>(e=>{f(e),g([]);const t=A[e];j(e=>(0,i.A)((0,i.A)({},e),{},{wageType:t.wageType,dailyWage:"daily"===t.wageType?t.defaultWage:"",monthlySalary:"monthly"===t.wageType?t.defaultWage:""}))})(t),style:{padding:"24px",borderRadius:"16px",border:p===t?"2px solid #3b82f6":"1px solid #e2e8f0",background:p===t?"#eff6ff":"white",cursor:"pointer",transition:"all 0.2s ease",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.05)"},children:[(0,x.jsx)("div",{style:{fontSize:"32px",marginBottom:"16px"},children:a.icon}),(0,x.jsx)("h3",{style:{margin:"0 0 8px 0",fontSize:"18px",fontWeight:"600",color:"#1e293b"},children:a.title}),(0,x.jsx)("p",{style:{margin:0,fontSize:"14px",color:"#64748b",lineHeight:"1.5"},children:a.description})]},t)})}),p&&(0,x.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 2fr",gap:"24px"},children:[(0,x.jsxs)("div",{className:"dash-card",style:{background:"white",padding:"24px",borderRadius:"16px",border:"1px solid #e2e8f0",height:"fit-content"},children:[(0,x.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[(0,x.jsx)("h3",{style:{margin:0,fontSize:"16px",fontWeight:"600",color:"#334155"},children:"Select Staff"}),(0,x.jsx)("button",{onClick:()=>{const e=Object.values(v).flat().filter(e=>{var t;return null===(t=A[p])||void 0===t?void 0:t.roles.includes(e.role)});g(e)},style:{fontSize:"13px",color:"#3b82f6",background:"none",border:"none",cursor:"pointer",fontWeight:"500"},children:"Select All"})]}),(0,x.jsx)("div",{style:{maxHeight:"400px",overflowY:"auto",paddingRight:"8px"},children:Object.entries(v).filter(e=>{var t;let[a]=e;return null===(t=A[p])||void 0===t?void 0:t.roles.includes(a)}).map(e=>{let[t,a]=e;return(0,x.jsxs)("div",{style:{marginBottom:"24px"},children:[(0,x.jsx)("div",{style:{fontSize:"12px",fontWeight:"600",color:"#94a3b8",textTransform:"uppercase",marginBottom:"12px",letterSpacing:"0.05em"},children:t.replace("_"," ")}),(0,x.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:a.map(e=>(0,x.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:"12px",padding:"10px",borderRadius:"8px",backgroundColor:m.some(t=>t._id===e._id)?"#eff6ff":"#f8fafc",cursor:"pointer",transition:"all 0.1s"},children:[(0,x.jsx)("input",{type:"checkbox",checked:m.some(t=>t._id===e._id),onChange:t=>{return a=e,n=t.target.checked,void g(n?e=>[...e,a]:e=>e.filter(e=>e._id!==a._id));var a,n},style:{width:"16px",height:"16px"}}),(0,x.jsx)("span",{style:{fontSize:"14px",fontWeight:"500",color:"#334155"},children:e.name})]},e._id))})]},t)})})]}),(0,x.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"24px"},children:[(0,x.jsxs)("div",{className:"dash-card",style:{background:"white",padding:"24px",borderRadius:"16px",border:"1px solid #e2e8f0"},children:[(0,x.jsx)("h3",{style:{margin:"0 0 20px 0",fontSize:"16px",fontWeight:"600",color:"#334155"},children:"Payroll Configuration"}),(0,x.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(140px, 1fr))",gap:"16px",marginBottom:"24px"},children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{style:{display:"block",fontSize:"13px",fontWeight:"500",color:"#64748b",marginBottom:"6px"},children:"Year"}),(0,x.jsx)("input",{type:"number",value:b.year,onChange:e=>j((0,i.A)((0,i.A)({},b),{},{year:Number(e.target.value)})),style:{width:"100%",padding:"10px",borderRadius:"8px",border:"1px solid #cbd5e1"}})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{style:{display:"block",fontSize:"13px",fontWeight:"500",color:"#64748b",marginBottom:"6px"},children:"Month"}),(0,x.jsx)("select",{value:b.month,onChange:e=>j((0,i.A)((0,i.A)({},b),{},{month:Number(e.target.value)})),style:{width:"100%",padding:"10px",borderRadius:"8px",border:"1px solid #cbd5e1"},children:Array.from({length:12},(e,t)=>(0,x.jsx)("option",{value:t+1,children:new Date(0,t).toLocaleString("default",{month:"long"})},t+1))})]}),"daily"===b.wageType?(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{style:{display:"block",fontSize:"13px",fontWeight:"500",color:"#64748b",marginBottom:"6px"},children:"Daily Wage"}),(0,x.jsx)("input",{type:"number",value:b.dailyWage,onChange:e=>j((0,i.A)((0,i.A)({},b),{},{dailyWage:Number(e.target.value)})),style:{width:"100%",padding:"10px",borderRadius:"8px",border:"1px solid #cbd5e1"}})]}):(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{style:{display:"block",fontSize:"13px",fontWeight:"500",color:"#64748b",marginBottom:"6px"},children:"Monthly Salary"}),(0,x.jsx)("input",{type:"number",value:b.monthlySalary,onChange:e=>j((0,i.A)((0,i.A)({},b),{},{monthlySalary:Number(e.target.value)})),style:{width:"100%",padding:"10px",borderRadius:"8px",border:"1px solid #cbd5e1"}})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{style:{display:"block",fontSize:"13px",fontWeight:"500",color:"#64748b",marginBottom:"6px"},children:"OT Hours"}),(0,x.jsx)("input",{type:"number",value:b.overtimeHours,onChange:e=>j((0,i.A)((0,i.A)({},b),{},{overtimeHours:Number(e.target.value)})),style:{width:"100%",padding:"10px",borderRadius:"8px",border:"1px solid #cbd5e1"}})]})]}),(0,x.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"24px"},children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("h4",{style:{fontSize:"13px",fontWeight:"600",color:"#334155",marginBottom:"12px"},children:"Allowances"}),Object.keys(b.allowances).map(e=>(0,x.jsx)("div",{style:{marginBottom:"8px"},children:(0,x.jsx)("input",{type:"number",placeholder:e,value:b.allowances[e],onChange:t=>j((0,i.A)((0,i.A)({},b),{},{allowances:(0,i.A)((0,i.A)({},b.allowances),{},{[e]:Number(t.target.value)})})),style:{width:"100%",padding:"8px",borderRadius:"6px",border:"1px solid #e2e8f0",fontSize:"13px"}})},e))]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("h4",{style:{fontSize:"13px",fontWeight:"600",color:"#334155",marginBottom:"12px"},children:"Deductions"}),Object.keys(b.deductions).map(e=>(0,x.jsx)("div",{style:{marginBottom:"8px"},children:(0,x.jsx)("input",{type:"number",placeholder:e,value:b.deductions[e],onChange:t=>j((0,i.A)((0,i.A)({},b),{},{deductions:(0,i.A)((0,i.A)({},b.deductions),{},{[e]:Number(t.target.value)})})),style:{width:"100%",padding:"8px",borderRadius:"6px",border:"1px solid #e2e8f0",fontSize:"13px"}})},e))]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("h4",{style:{fontSize:"13px",fontWeight:"600",color:"#334155",marginBottom:"12px"},children:"Bonuses"}),Object.keys(b.bonuses).map(e=>(0,x.jsx)("div",{style:{marginBottom:"8px"},children:(0,x.jsx)("input",{type:"number",placeholder:e,value:b.bonuses[e],onChange:t=>j((0,i.A)((0,i.A)({},b),{},{bonuses:(0,i.A)((0,i.A)({},b.bonuses),{},{[e]:Number(t.target.value)})})),style:{width:"100%",padding:"8px",borderRadius:"6px",border:"1px solid #e2e8f0",fontSize:"13px"}})},e))]})]}),(0,x.jsx)("div",{style:{marginTop:"24px"},children:(0,x.jsx)("button",{onClick:async()=>{if(0===m.length)return void Ze.error("Select staff members first");r(!0);const e=[];for(const t of m){const a=await _(t);a&&e.push(a)}N(e),k(!0),r(!1),Ze.success("Calculation Complete")},disabled:s||0===m.length,style:{width:"100%",padding:"12px",background:"#3b82f6",color:"white",border:"none",borderRadius:"8px",fontWeight:"600",fontSize:"16px",cursor:"pointer"},children:s?"Processing...":"Calculate All Salaries"})})]}),S&&(0,x.jsxs)("div",{className:"dash-card",style:{background:"white",padding:"24px",borderRadius:"16px",border:"1px solid #e2e8f0"},children:[(0,x.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"16px"},children:[(0,x.jsx)("h3",{style:{margin:0,fontSize:"16px",fontWeight:"600",color:"#334155"},children:"Payroll Review"}),(0,x.jsxs)("div",{style:{display:"flex",gap:"8px"},children:[(0,x.jsx)("button",{onClick:async()=>Ze.success("Records Saved (Mock)"),style:{padding:"8px 16px",borderRadius:"6px",background:"#10b981",color:"white",border:"none",fontSize:"13px",fontWeight:"500",cursor:"pointer"},children:"Save & Approve"}),(0,x.jsx)("button",{onClick:async()=>Ze.success("Notifications Sent (Mock)"),style:{padding:"8px 16px",borderRadius:"6px",background:"#8b5cf6",color:"white",border:"none",fontSize:"13px",fontWeight:"500",cursor:"pointer"},children:"Notify Staff"})]})]}),(0,x.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"14px"},children:[(0,x.jsx)("thead",{style:{background:"#f8fafc",color:"#475569"},children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{style:{padding:"12px",textAlign:"left"},children:"Staff"}),(0,x.jsx)("th",{style:{padding:"12px",textAlign:"right"},children:"Base"}),(0,x.jsx)("th",{style:{padding:"12px",textAlign:"right"},children:"Additions"}),(0,x.jsx)("th",{style:{padding:"12px",textAlign:"right"},children:"Deductions"}),(0,x.jsx)("th",{style:{padding:"12px",textAlign:"right"},children:"Net Pay"})]})}),(0,x.jsx)("tbody",{children:w.map((e,t)=>(0,x.jsxs)("tr",{style:{borderBottom:"1px solid #f1f5f9"},children:[(0,x.jsx)("td",{style:{padding:"12px",fontWeight:"500"},children:e.staff.name}),(0,x.jsx)("td",{style:{padding:"12px",textAlign:"right"},children:e.baseSalary.toFixed(2)}),(0,x.jsxs)("td",{style:{padding:"12px",textAlign:"right",color:"#16a34a"},children:["+",(e.overtimePay+e.totalAllowances+e.totalBonuses).toFixed(2)]}),(0,x.jsxs)("td",{style:{padding:"12px",textAlign:"right",color:"#dc2626"},children:["-",e.totalDeductions.toFixed(2)]}),(0,x.jsx)("td",{style:{padding:"12px",textAlign:"right",fontWeight:"700",color:"#0f172a"},children:e.netSalary.toFixed(2)})]},t))})]})]})]})]})]})};async function at(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;const n="".concat("http://localhost:5000").concat(e);try{const s=await fetch(n,(0,i.A)({cache:"no-store"},t));return!s.ok&&[502,503,504,429].includes(s.status)&&a>0?(await new Promise(e=>setTimeout(e,500*(3-a))),at(e,t,a-1)):s}catch(s){if(a>0)return await new Promise(e=>setTimeout(e,500*(3-a))),at(e,t,a-1);throw s}}const nt=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e)return"-";try{const a=new Date(e);if(isNaN(a.getTime()))return"-";const n={day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!0},s=(0,i.A)((0,i.A)({},n),t);return a.toLocaleString("en-GB",s)}catch(a){return console.error("Error formatting date:",a),"-"}},st=e=>{if(!e)return"-";try{const t=new Date(e);return isNaN(t.getTime())?"-":t.toLocaleString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",hour12:!0})}catch(t){return console.error("Error formatting table date:",t),"-"}},rt=e=>{var t;let{productName:a=null}=e;const s="http://localhost:5000",r=localStorage.getItem("token"),[l,o]=(0,n.useState)([]),[c,d]=(0,n.useState)(!0),[u,h]=(0,n.useState)(""),[p,f]=(0,n.useState)("checking"),[m,g]=(0,n.useState)({fromDate:"",toDate:"",transactionType:"all",performedBy:"",location:""}),[v,y]=(0,n.useState)(!1),[b,j]=(0,n.useState)({current:1,pages:1,total:0}),[w,N]=(0,n.useState)(null),S=(0,n.useCallback)(async()=>{try{const e=await fetch("".concat(s,"/"),{method:"GET",signal:AbortSignal.timeout(5e3)});f(e.ok?"connected":"error")}catch(e){f("disconnected")}},[s]),k=(0,n.useCallback)(async()=>{try{d(!0),h("");const e=new URLSearchParams;m.fromDate&&e.append("fromDate",m.fromDate),m.toDate&&e.append("toDate",m.toDate),"all"!==m.transactionType&&e.append("transactionType",m.transactionType),m.performedBy&&e.append("performedBy",m.performedBy),m.location&&e.append("location",m.location),e.append("page",b.current),e.append("limit","20");const t=e.toString(),n=a?"".concat(s,"/api/stock-history/product/").concat(a).concat(t?"?".concat(t):""):"".concat(s,"/api/stock-history/all").concat(t?"?".concat(t):""),i=await fetch(n,{headers:{Authorization:"Bearer ".concat(r)}});if(i.ok){const e=await i.json();o(e.transactions||[]),j(e.pagination||{current:1,pages:1,total:0})}else{const e=await i.json().catch(()=>({}));h(e.message||"Failed to load stock history")}}catch(e){console.error("Error loading stock history:",e),h("Failed to load stock history. Please try again.")}finally{d(!1)}},[s,r,m,b.current,a]),A=(0,n.useCallback)(async()=>{try{const e=new URLSearchParams;m.fromDate&&e.append("fromDate",m.fromDate),m.toDate&&e.append("toDate",m.toDate),a&&e.append("productName",a);const t=e.toString(),n="".concat(s,"/api/stock-history/analytics").concat(t?"?".concat(t):""),i=await fetch(n,{headers:{Authorization:"Bearer ".concat(r)}});if(i.ok){const e=await i.json();N(e.analytics)}}catch(e){console.error("Error loading analytics:",e)}},[s,r,a]);(0,n.useEffect)(()=>{r&&S()},[r,S]),(0,n.useEffect)(()=>{r&&(k(),A())},[r,a,b.current]);const C=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"L";return null===e||void 0===e?"-":"".concat(parseFloat(e).toFixed(2)," ").concat(t)},_=e=>{j(t=>(0,i.A)((0,i.A)({},t),{},{current:e}))};return r?(0,x.jsxs)("div",{style:{padding:16},children:[(0,x.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[(0,x.jsx)("h3",{children:a?"Stock History - ".concat(a):"Stock History"}),(0,x.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12},children:[(0,x.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8},children:[(0,x.jsx)("div",{style:{width:8,height:8,borderRadius:"50%",backgroundColor:"connected"===p?"#28a745":"disconnected"===p?"#dc3545":"#ffc107"}}),(0,x.jsx)("span",{style:{fontSize:12,color:"#666"},children:"connected"===p?"Connected":"disconnected"===p?"Disconnected":"Checking..."})]}),(0,x.jsx)("button",{className:"btn btn-sm btn-outline-primary",onClick:()=>y(!v),children:v?"Hide Filters":"Show Filters"}),(0,x.jsx)("button",{className:"btn btn-sm btn-outline-secondary",onClick:()=>k(),disabled:c,children:c?"Loading...":"Refresh"})]})]}),u&&(0,x.jsx)("div",{style:{color:"crimson",marginBottom:16,padding:12,backgroundColor:"#f8d7da",borderRadius:4},children:u}),w&&(0,x.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:16,marginBottom:20},children:null===(t=w.transactionSummary)||void 0===t?void 0:t.map((e,t)=>(0,x.jsxs)("div",{style:{padding:16,backgroundColor:"#e3f2fd",borderRadius:8,textAlign:"center"},children:[(0,x.jsx)("div",{style:{fontSize:24,fontWeight:"bold",color:"#1976d2"},children:e.count}),(0,x.jsxs)("div",{style:{fontSize:14,color:"#666",textTransform:"capitalize"},children:[e._id," Transactions"]}),(0,x.jsxs)("div",{style:{fontSize:12,color:"#666",marginTop:4},children:["Total: ",C(e.totalQuantity)]})]},t))}),v&&(0,x.jsxs)("div",{style:{marginBottom:20,padding:16,backgroundColor:"#f8f9fa",borderRadius:8,border:"1px solid #dee2e6"},children:[(0,x.jsx)("h5",{style:{marginBottom:16},children:"Filter Stock History"}),(0,x.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:16},children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{style:{display:"block",marginBottom:4,fontWeight:"bold"},children:"From Date"}),(0,x.jsx)("input",{type:"date",className:"form-control",value:m.fromDate,onChange:e=>g(t=>(0,i.A)((0,i.A)({},t),{},{fromDate:e.target.value}))})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{style:{display:"block",marginBottom:4,fontWeight:"bold"},children:"To Date"}),(0,x.jsx)("input",{type:"date",className:"form-control",value:m.toDate,onChange:e=>g(t=>(0,i.A)((0,i.A)({},t),{},{toDate:e.target.value})),min:m.fromDate||void 0})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{style:{display:"block",marginBottom:4,fontWeight:"bold"},children:"Transaction Type"}),(0,x.jsxs)("select",{className:"form-control",value:m.transactionType,onChange:e=>g(t=>(0,i.A)((0,i.A)({},t),{},{transactionType:e.target.value})),children:[(0,x.jsx)("option",{value:"all",children:"All Types"}),(0,x.jsx)("option",{value:"in",children:"In"}),(0,x.jsx)("option",{value:"out",children:"Out"}),(0,x.jsx)("option",{value:"adjustment",children:"Adjustment"}),(0,x.jsx)("option",{value:"transfer",children:"Transfer"}),(0,x.jsx)("option",{value:"return",children:"Return"}),(0,x.jsx)("option",{value:"waste",children:"Waste"}),(0,x.jsx)("option",{value:"production",children:"Production"})]})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{style:{display:"block",marginBottom:4,fontWeight:"bold"},children:"Location"}),(0,x.jsx)("input",{type:"text",className:"form-control",value:m.location,onChange:e=>g(t=>(0,i.A)((0,i.A)({},t),{},{location:e.target.value})),placeholder:"Filter by location"})]})]}),(0,x.jsxs)("div",{style:{marginTop:16,display:"flex",gap:8},children:[(0,x.jsx)("button",{className:"btn btn-sm btn-primary",onClick:()=>{j(e=>(0,i.A)((0,i.A)({},e),{},{current:1})),k(),A()},children:"Apply Filters"}),(0,x.jsx)("button",{className:"btn btn-sm btn-outline-secondary",onClick:()=>{g({fromDate:"",toDate:"",transactionType:"all",performedBy:"",location:""}),setTimeout(()=>{k(),A()},100)},children:"Clear Filters"})]})]}),(0,x.jsx)("div",{style:{overflowX:"auto"},children:c?(0,x.jsx)("div",{style:{textAlign:"center",padding:40},children:(0,x.jsx)("div",{children:"Loading stock history..."})}):(0,x.jsxs)("table",{className:"table table-striped table-hover",style:{minWidth:1e3},children:[(0,x.jsx)("thead",{className:"table-dark",children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{children:"Date"}),(0,x.jsx)("th",{children:"Type"}),(0,x.jsx)("th",{children:"Product"}),(0,x.jsx)("th",{children:"Quantity"}),(0,x.jsx)("th",{children:"Before"}),(0,x.jsx)("th",{children:"After"}),(0,x.jsx)("th",{children:"Reason"}),(0,x.jsx)("th",{children:"Performed By"}),(0,x.jsx)("th",{children:"Location"}),(0,x.jsx)("th",{children:"Status"})]})}),(0,x.jsxs)("tbody",{children:[l.map((e,t)=>{return(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{children:(n=e.transactionDate,st(n))}),(0,x.jsx)("td",{children:(a=e.transactionType,(0,x.jsx)("span",{style:{padding:"4px 8px",borderRadius:"4px",fontSize:"12px",fontWeight:"bold",backgroundColor:{in:"#28a745",out:"#dc3545",adjustment:"#ffc107",transfer:"#17a2b8",return:"#6f42c1",waste:"#fd7e14",production:"#20c997"}[a]||"#6c757d",color:"white",textTransform:"capitalize"},children:a}))}),(0,x.jsx)("td",{children:e.productName}),(0,x.jsx)("td",{children:C(e.quantity,e.unit)}),(0,x.jsx)("td",{children:C(e.quantityBefore,e.unit)}),(0,x.jsx)("td",{children:C(e.quantityAfter,e.unit)}),(0,x.jsx)("td",{style:{maxWidth:200,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:e.reason||"-"}),(0,x.jsx)("td",{children:e.performedByName||"-"}),(0,x.jsx)("td",{children:e.location||"-"}),(0,x.jsx)("td",{children:e.isReversed?(0,x.jsx)("span",{style:{color:"#dc3545",fontSize:"12px"},children:"Reversed"}):e.requiresApproval&&!e.approvedBy?(0,x.jsx)("span",{style:{color:"#ffc107",fontSize:"12px"},children:"Pending Approval"}):(0,x.jsx)("span",{style:{color:"#28a745",fontSize:"12px"},children:"Completed"})})]},e._id||t);var a,n}),0===l.length&&!c&&(0,x.jsx)("tr",{children:(0,x.jsx)("td",{colSpan:10,style:{textAlign:"center",padding:40,color:"#6c757d"},children:"No stock transactions found."})})]})]})}),b.pages>1&&(0,x.jsxs)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",gap:8,marginTop:20},children:[(0,x.jsx)("button",{className:"btn btn-sm btn-outline-primary",onClick:()=>_(b.current-1),disabled:b.current<=1,children:"Previous"}),(0,x.jsxs)("span",{style:{padding:"0 16px"},children:["Page ",b.current," of ",b.pages," (",b.total," total)"]}),(0,x.jsx)("button",{className:"btn btn-sm btn-outline-primary",onClick:()=>_(b.current+1),disabled:b.current>=b.pages,children:"Next"})]})]}):(0,x.jsxs)("div",{style:{padding:16},children:[(0,x.jsx)("h3",{children:"Stock History"}),(0,x.jsx)("div",{style:{color:"crimson",marginTop:8},children:"Please log in to access stock history."})]})},it=e=>{let{onSubmit:t,onCancel:a,initialData:s={},productName:r=null}=e;const[l,o]=(0,n.useState)({productName:s.productName||r||"",transactionType:s.transactionType||"in",quantity:s.quantity||"",unit:s.unit||"L",reason:s.reason||"",reference:s.reference||"",batchNumber:s.batchNumber||"",location:s.location||"",department:s.department||"",unitCost:s.unitCost||"",supplier:s.supplier||"",qualityGrade:s.qualityGrade||"A",qualityNotes:s.qualityNotes||"",tags:s.tags||"",requiresApproval:s.requiresApproval||!1}),[c,d]=(0,n.useState)({}),[u,h]=(0,n.useState)(!1),[p,f]=(0,n.useState)(null);(0,n.useEffect)(()=>{l.productName&&m()},[l.productName]);const m=async()=>{try{const e="http://localhost:5000",t=localStorage.getItem("token"),a=await fetch("".concat(e,"/api/stock"),{headers:{Authorization:"Bearer ".concat(t)}});if(a.ok){const e=await a.json();f(e)}}catch(e){console.error("Error loading current stock:",e)}},g=(e,t)=>{o(a=>(0,i.A)((0,i.A)({},a),{},{[e]:t})),c[e]&&d(t=>(0,i.A)((0,i.A)({},t),{},{[e]:""}))},v=e=>({in:"#28a745",out:"#dc3545",adjustment:"#ffc107",transfer:"#17a2b8",return:"#6f42c1",waste:"#fd7e14",production:"#20c997"}[e]||"#6c757d");return(0,x.jsxs)("div",{style:{padding:20,backgroundColor:"#f8f9fa",borderRadius:8,border:"1px solid #dee2e6"},children:[(0,x.jsx)("h4",{style:{marginBottom:20,color:"#495057"},children:"Stock Transaction"}),p&&(0,x.jsxs)("div",{style:{marginBottom:16,padding:12,backgroundColor:"#e3f2fd",borderRadius:4,border:"1px solid #bbdefb"},children:[(0,x.jsx)("strong",{children:"Current Stock:"})," ",p.quantityInLiters," ",l.unit,(0,x.jsx)("br",{}),(0,x.jsxs)("small",{style:{color:"#666"},children:["Last updated: ",nt(p.lastUpdated)]})]}),(0,x.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),(()=>{const e={};if(l.productName.trim()||(e.productName="Product name is required"),(!l.quantity||isNaN(l.quantity)||parseFloat(l.quantity)<=0)&&(e.quantity="Quantity must be a positive number"),l.reason.trim()?l.reason.trim().length<5&&(e.reason="Reason must be at least 5 characters"):e.reason="Reason is required",l.unitCost&&(isNaN(l.unitCost)||parseFloat(l.unitCost)<0)&&(e.unitCost="Unit cost must be a positive number"),"out"===l.transactionType&&p&&l.quantity){const t=p.quantityInLiters||0;parseFloat(l.quantity)>t&&(e.quantity="Insufficient stock. Available: ".concat(t," ").concat(l.unit))}return d(e),0===Object.keys(e).length})()){h(!0);try{await t(l)}catch(a){console.error("Error submitting transaction:",a)}finally{h(!1)}}},children:[(0,x.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16,marginBottom:16},children:[(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{style:{display:"block",marginBottom:4,fontWeight:"bold"},children:"Product Name *"}),(0,x.jsx)("input",{type:"text",className:"form-control",value:l.productName,onChange:e=>g("productName",e.target.value),placeholder:"Enter product name",style:{borderColor:c.productName?"#dc3545":""},disabled:!!r}),c.productName&&(0,x.jsx)("div",{style:{color:"#dc3545",fontSize:12,marginTop:4},children:c.productName})]}),(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{style:{display:"block",marginBottom:4,fontWeight:"bold"},children:"Transaction Type *"}),(0,x.jsxs)("select",{className:"form-control",value:l.transactionType,onChange:e=>g("transactionType",e.target.value),style:{borderColor:c.transactionType?"#dc3545":"",color:v(l.transactionType)},children:[(0,x.jsx)("option",{value:"in",children:"Stock In"}),(0,x.jsx)("option",{value:"out",children:"Stock Out"}),(0,x.jsx)("option",{value:"adjustment",children:"Adjustment"}),(0,x.jsx)("option",{value:"transfer",children:"Transfer"}),(0,x.jsx)("option",{value:"return",children:"Return"}),(0,x.jsx)("option",{value:"waste",children:"Waste"}),(0,x.jsx)("option",{value:"production",children:"Production"})]})]})]}),(0,x.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16,marginBottom:16},children:[(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{style:{display:"block",marginBottom:4,fontWeight:"bold"},children:"Quantity *"}),(0,x.jsx)("input",{type:"number",className:"form-control",value:l.quantity,onChange:e=>g("quantity",e.target.value),placeholder:"Enter quantity",min:"0",step:"0.01",style:{borderColor:c.quantity?"#dc3545":""}}),c.quantity&&(0,x.jsx)("div",{style:{color:"#dc3545",fontSize:12,marginTop:4},children:c.quantity})]}),(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{style:{display:"block",marginBottom:4,fontWeight:"bold"},children:"Unit"}),(0,x.jsxs)("select",{className:"form-control",value:l.unit,onChange:e=>g("unit",e.target.value),children:[(0,x.jsx)("option",{value:"L",children:"Liters (L)"}),(0,x.jsx)("option",{value:"kg",children:"Kilograms (kg)"}),(0,x.jsx)("option",{value:"ml",children:"Milliliters (ml)"}),(0,x.jsx)("option",{value:"units",children:"Units"}),(0,x.jsx)("option",{value:"pieces",children:"Pieces"})]})]})]}),(0,x.jsxs)("div",{className:"form-group",style:{marginBottom:16},children:[(0,x.jsx)("label",{style:{display:"block",marginBottom:4,fontWeight:"bold"},children:"Reason *"}),(0,x.jsx)("textarea",{className:"form-control",rows:3,value:l.reason,onChange:e=>g("reason",e.target.value),placeholder:"Describe the reason for this transaction...",style:{borderColor:c.reason?"#dc3545":""}}),c.reason&&(0,x.jsx)("div",{style:{color:"#dc3545",fontSize:12,marginTop:4},children:c.reason})]}),(0,x.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16,marginBottom:16},children:[(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{style:{display:"block",marginBottom:4,fontWeight:"bold"},children:"Reference"}),(0,x.jsx)("input",{type:"text",className:"form-control",value:l.reference,onChange:e=>g("reference",e.target.value),placeholder:"Reference number or code"})]}),(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{style:{display:"block",marginBottom:4,fontWeight:"bold"},children:"Batch Number"}),(0,x.jsx)("input",{type:"text",className:"form-control",value:l.batchNumber,onChange:e=>g("batchNumber",e.target.value),placeholder:"Batch or lot number"})]})]}),(0,x.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16,marginBottom:16},children:[(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{style:{display:"block",marginBottom:4,fontWeight:"bold"},children:"Location"}),(0,x.jsx)("input",{type:"text",className:"form-control",value:l.location,onChange:e=>g("location",e.target.value),placeholder:"Where is this transaction taking place?"})]}),(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{style:{display:"block",marginBottom:4,fontWeight:"bold"},children:"Department"}),(0,x.jsx)("input",{type:"text",className:"form-control",value:l.department,onChange:e=>g("department",e.target.value),placeholder:"Which department?"})]})]}),(0,x.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16,marginBottom:16},children:[(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{style:{display:"block",marginBottom:4,fontWeight:"bold"},children:"Unit Cost"}),(0,x.jsx)("input",{type:"number",className:"form-control",value:l.unitCost,onChange:e=>g("unitCost",e.target.value),placeholder:"Cost per unit",min:"0",step:"0.01",style:{borderColor:c.unitCost?"#dc3545":""}}),c.unitCost&&(0,x.jsx)("div",{style:{color:"#dc3545",fontSize:12,marginTop:4},children:c.unitCost})]}),(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{style:{display:"block",marginBottom:4,fontWeight:"bold"},children:"Supplier"}),(0,x.jsx)("input",{type:"text",className:"form-control",value:l.supplier,onChange:e=>g("supplier",e.target.value),placeholder:"Supplier name"})]})]}),(0,x.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16,marginBottom:16},children:[(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{style:{display:"block",marginBottom:4,fontWeight:"bold"},children:"Quality Grade"}),(0,x.jsxs)("select",{className:"form-control",value:l.qualityGrade,onChange:e=>g("qualityGrade",e.target.value),children:[(0,x.jsx)("option",{value:"A",children:"Grade A"}),(0,x.jsx)("option",{value:"B",children:"Grade B"}),(0,x.jsx)("option",{value:"C",children:"Grade C"}),(0,x.jsx)("option",{value:"D",children:"Grade D"}),(0,x.jsx)("option",{value:"rejected",children:"Rejected"})]})]}),(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{style:{display:"block",marginBottom:4,fontWeight:"bold"},children:"Tags"}),(0,x.jsx)("input",{type:"text",className:"form-control",value:l.tags,onChange:e=>g("tags",e.target.value),placeholder:"Comma-separated tags"})]})]}),(0,x.jsxs)("div",{className:"form-group",style:{marginBottom:16},children:[(0,x.jsx)("label",{style:{display:"block",marginBottom:4,fontWeight:"bold"},children:"Quality Notes"}),(0,x.jsx)("textarea",{className:"form-control",rows:2,value:l.qualityNotes,onChange:e=>g("qualityNotes",e.target.value),placeholder:"Any quality-related notes..."})]}),(0,x.jsxs)("div",{className:"form-group",style:{marginBottom:20},children:[(0,x.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:8},children:[(0,x.jsx)("input",{type:"checkbox",checked:l.requiresApproval,onChange:e=>g("requiresApproval",e.target.checked)}),(0,x.jsx)("span",{style:{fontWeight:"bold"},children:"Requires Manager Approval"})]}),(0,x.jsx)("small",{style:{color:"#666",marginLeft:24},children:"Check this for high-value or sensitive transactions"})]}),(0,x.jsxs)("div",{style:{display:"flex",gap:12,justifyContent:"flex-end"},children:[a&&(0,x.jsx)("button",{type:"button",className:"btn btn-secondary",onClick:a,disabled:u,children:"Cancel"}),(0,x.jsx)("button",{type:"submit",className:"btn btn-primary",disabled:u||Object.keys(c).length>0,style:{backgroundColor:v(l.transactionType),borderColor:v(l.transactionType)},children:u?"Processing...":"Record ".concat(l.transactionType.toUpperCase()," Transaction")})]})]})]})},lt=()=>{var e,t;const a="undefined"!==typeof window?localStorage.getItem("token"):null,s=(0,n.useMemo)(()=>a?{Authorization:"Bearer ".concat(a),"Content-Type":"application/json"}:{"Content-Type":"application/json"},[a]),[r,l]=(0,n.useState)(null),[o,c]=(0,n.useState)([]),[d,u]=(0,n.useState)({productName:"",quantityInLiters:""}),[h,p]=(0,n.useState)(""),[f,m]=(0,n.useState)(!1),[g,v]=(0,n.useState)(!1),[y,b]=(0,n.useState)(null),j=(0,n.useCallback)(async()=>{m(!0),p("");try{const e=await at("/api/stock/summary?_t=".concat(Date.now()),{headers:s,cache:"no-store"});if(!e.ok)throw new Error("Failed to load (".concat(e.status,")"));const t=await e.json();l((null===t||void 0===t?void 0:t.data)||t);const a=await at("/api/stock/items?_t=".concat(Date.now()),{headers:s,cache:"no-store"});a.ok&&c(await a.json())}catch(e){p((null===e||void 0===e?void 0:e.message)||"Failed to load")}finally{m(!1)}},["http://localhost:5000",s]);(0,n.useEffect)(()=>{j()},[j]);return(0,x.jsxs)("div",{style:{padding:16,color:"var(--text-default)"},children:[(0,x.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,x.jsx)("h2",{style:{margin:0,color:"var(--text-strong)"},children:"Stock Overview"}),(0,x.jsxs)("div",{style:{display:"flex",gap:8},children:[(0,x.jsx)("button",{className:"btn btn-primary",onClick:()=>v(!0),children:"Record Transaction"}),(0,x.jsx)("button",{className:"btn",onClick:j,disabled:f,children:f?"Refreshing...":"Refresh"})]})]}),h&&(0,x.jsx)("div",{style:{color:"var(--danger)",marginTop:8},children:h}),r&&(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)("div",{className:"dash-card",style:{marginTop:12,padding:12},children:[(0,x.jsx)("h3",{style:{marginTop:0,marginBottom:8,color:"var(--text-strong)"},children:"Yard: Raw Rubber"}),(0,x.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(220px, 1fr))",gap:12},children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("div",{style:{fontSize:12,color:"var(--text-subtle)"},children:"Current Quantity (Liters)"}),(0,x.jsx)("div",{style:{fontSize:26,fontWeight:700,color:"var(--text-strong)"},children:null!==(e=r.latexLiters)&&void 0!==e?e:"\u2014"})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("div",{style:{fontSize:12,color:"var(--text-subtle)"},children:"Updated At"}),(0,x.jsx)("div",{children:nt(r.updatedAt)})]})]})]}),(0,x.jsxs)("div",{className:"dash-card",style:{marginTop:12,padding:12},children:[(0,x.jsx)("h3",{style:{marginTop:0,marginBottom:8,color:"var(--text-strong)"},children:"Godown: Finished Goods (Rubber Bands)"}),(0,x.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(220px, 1fr))",gap:12},children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("div",{style:{fontSize:12,color:"var(--text-subtle)"},children:"Inventory (Units)"}),(0,x.jsx)("div",{style:{fontSize:26,fontWeight:700,color:"var(--text-strong)"},children:null!==(t=r.rubberBandUnits)&&void 0!==t?t:"\u2014"})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("div",{style:{fontSize:12,color:"var(--text-subtle)"},children:"Updated At"}),(0,x.jsx)("div",{children:nt(r.updatedAt)})]})]})]}),(0,x.jsx)("div",{style:{overflowX:"auto"},children:(0,x.jsxs)("table",{className:"dashboard-table",style:{minWidth:640,color:"#0f172a"},children:[(0,x.jsx)("thead",{children:(0,x.jsx)("tr",{children:["Name","Quantity","Updated","Actions"].map(e=>(0,x.jsx)("th",{style:{color:"#0f172a",opacity:1,fontWeight:600},children:e},e))})}),(0,x.jsxs)("tbody",{children:[o.map(e=>(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{style:{color:"#0f172a"},children:e.productName}),(0,x.jsx)("td",{style:{color:"#0f172a"},children:e.quantityInLiters}),(0,x.jsx)("td",{style:{color:"#0f172a"},children:st(e.updatedAt)}),(0,x.jsxs)("td",{style:{color:"#0f172a"},children:[(0,x.jsx)("button",{className:"btn btn-sm btn-outline-primary",onClick:()=>b(e.productName),children:"View History"}),(0,x.jsx)("button",{className:"btn btn-sm",onClick:async()=>{try{p("");const t=prompt("Set quantity for "+e.productName,e.quantityInLiters);if(null===t)return;const a=Number(t);if(isNaN(a)||a<0)return p("Quantity must be a non-negative number"),void alert("Invalid quantity. Please enter a non-negative number.");const n=await at("/api/stock/items/".concat(e._id),{method:"PUT",headers:s,body:JSON.stringify({quantityInLiters:a})});if(!n.ok){const e=await n.json().catch(()=>({}));throw new Error(e.message||"Update failed (".concat(n.status,")"))}await new Promise(e=>setTimeout(e,200)),await j(),alert("Successfully updated ".concat(e.productName," to ").concat(a))}catch(t){const e=(null===t||void 0===t?void 0:t.message)||"Network error while updating";p(e),alert("Failed to update: "+e)}},children:"Set Qty"}),(0,x.jsx)("button",{className:"btn btn-sm btn-outline",style:{marginLeft:8},onClick:async()=>{try{if(p(""),!window.confirm("Delete ".concat(e.productName,"?")))return;const t=await at("/api/stock/items/".concat(e._id),{method:"DELETE",headers:s});if(!t.ok){const e=await t.json().catch(()=>({}));throw new Error(e.message||"Delete failed (".concat(t.status,")"))}await new Promise(e=>setTimeout(e,200)),await j(),alert("Successfully deleted ".concat(e.productName))}catch(t){const e=(null===t||void 0===t?void 0:t.message)||"Network error while deleting";p(e),alert("Failed to delete: "+e)}},children:"Delete"})]})]},e._id)),0===o.length&&(0,x.jsx)("tr",{children:(0,x.jsx)("td",{colSpan:4,style:{textAlign:"center",color:"#6b7280"},children:"No items"})})]})]})}),(0,x.jsxs)("form",{className:"dash-card",style:{padding:12,color:"#0f172a"},onSubmit:async e=>{e.preventDefault(),p("");try{const e={productName:d.productName.trim(),quantityInLiters:Number(d.quantityInLiters||0)},t=await at("/api/stock/items",{method:"POST",headers:s,body:JSON.stringify(e)});if(!t.ok){const e=await t.json().catch(()=>({}));throw new Error(e.message||"Create failed (".concat(t.status,")"))}u({productName:"",quantityInLiters:""}),await j(),alert("Item added successfully!")}catch(t){const e=(null===t||void 0===t?void 0:t.message)||"Network error while creating";p(e),alert("Failed to add item: "+e)}},children:[(0,x.jsx)("div",{style:{fontWeight:600,marginBottom:8},children:"Add New Item"}),(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{children:"Name"}),(0,x.jsx)("input",{value:d.productName,onChange:e=>u((0,i.A)((0,i.A)({},d),{},{productName:e.target.value})),className:"form-control",required:!0})]}),(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{children:"Quantity"}),(0,x.jsx)("input",{type:"number",min:"0",step:"0.01",value:d.quantityInLiters,onChange:e=>u((0,i.A)((0,i.A)({},d),{},{quantityInLiters:e.target.value})),className:"form-control",placeholder:"0"})]}),(0,x.jsx)("button",{className:"btn",type:"submit",children:"Add Item"})]}),y&&(0,x.jsx)("div",{style:{marginTop:40},children:(0,x.jsx)(rt,{productName:y})}),g&&(0,x.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:(0,x.jsx)("div",{style:{backgroundColor:"white",borderRadius:8,maxWidth:800,width:"90%",maxHeight:"90%",overflow:"auto"},children:(0,x.jsx)("div",{style:{padding:20},children:(0,x.jsx)(it,{onSubmit:async e=>{try{const t=await at("/api/stock-history/create",{method:"POST",headers:s,body:JSON.stringify(e)});if(t.ok)v(!1),b(null),await j(),alert("Stock transaction recorded successfully!");else{const e=await t.json().catch(()=>({}));alert(e.message||"Failed to record transaction")}}catch(t){console.error("Error recording transaction:",t),alert("Failed to record transaction. Please try again.")}},onCancel:()=>v(!1)})})})})]})]})},ot=()=>{var e,t;const[a,s]=(0,n.useState)([]),[r,i]=(0,n.useState)(!1),[l,o]=(0,n.useState)(""),[c,d]=(0,n.useState)(""),[u,h]=(0,n.useState)({low:[],expiring:[]}),p=(0,n.useMemo)(()=>a.filter(e=>!c||e.name.toLowerCase().includes(c.toLowerCase())),[a,c]),f=async()=>{i(!0),o("");try{s(await he()),h(await pe())}catch(e){o((null===e||void 0===e?void 0:e.message)||"Failed to load")}finally{i(!1)}};return(0,n.useEffect)(()=>{f()},[]),(0,x.jsxs)("div",{style:{padding:16},children:[(0,x.jsx)("h2",{style:{marginTop:0},children:"Chemical Stock History"}),(0,x.jsxs)("div",{style:{display:"flex",gap:12,flexWrap:"wrap",marginBottom:8},children:[(0,x.jsx)("input",{placeholder:"Filter by name",value:c,onChange:e=>d(e.target.value)}),(0,x.jsx)("button",{onClick:()=>function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"chemicals.csv";const a=[["name","unit","onHand","lotNo","quantity","unitCost","receivedAt","expiresAt"].join(",")].concat(e.flatMap(e=>{var t;return(null!==(t=e.lots)&&void 0!==t&&t.length?e.lots:[{lotNo:"",quantity:"",unitCost:"",receivedAt:"",expiresAt:""}]).map(t=>{var a,n,s;return[e.name,e.unit||"",null!==(a=e.onHand)&&void 0!==a?a:"",t.lotNo||"",null!==(n=t.quantity)&&void 0!==n?n:"",null!==(s=t.unitCost)&&void 0!==s?s:"",t.receivedAt||"",t.expiresAt||""].join(",")})})).join("\n"),n=new Blob([a],{type:"text/csv"}),s=URL.createObjectURL(n),r=document.createElement("a");r.href=s,r.download=t,r.click(),URL.revokeObjectURL(s)}(p),children:"Export CSV"}),(0,x.jsx)("button",{onClick:f,disabled:r,children:r?"Refreshing...":"Refresh"})]}),l&&(0,x.jsx)("div",{style:{color:"tomato"},children:l}),(0,x.jsxs)("div",{style:{display:"grid",gap:12},children:[(null===u||void 0===u||null===(e=u.low)||void 0===e?void 0:e.length)>0&&(0,x.jsxs)("div",{style:{background:"#fff8e1",padding:8,border:"1px solid #ffe082"},children:[(0,x.jsx)("strong",{children:"Low stock:"})," ",u.low.map(e=>"".concat(e.name," (").concat(e.onHand,")")).join(", ")]}),(null===u||void 0===u||null===(t=u.expiring)||void 0===t?void 0:t.length)>0&&(0,x.jsxs)("div",{style:{background:"#fce4ec",padding:8,border:"1px solid #f48fb1"},children:[(0,x.jsx)("strong",{children:"Expiring soon:"})," ",u.expiring.map(e=>"".concat(e.name," lot ").concat(e.lotNo)).join(", ")]})]}),r?"Loading...":(0,x.jsx)("div",{style:{overflowX:"auto",marginTop:12},children:(0,x.jsxs)("table",{className:"dashboard-table",style:{minWidth:720},children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{children:"Name"}),(0,x.jsx)("th",{children:"Unit"}),(0,x.jsx)("th",{children:"On Hand"}),(0,x.jsx)("th",{children:"Lots"})]})}),(0,x.jsxs)("tbody",{children:[p.map(e=>{var t;return(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{children:e.name}),(0,x.jsx)("td",{children:e.unit}),(0,x.jsx)("td",{children:e.onHand}),(0,x.jsx)("td",{children:null!==(t=e.lots)&&void 0!==t&&t.length?e.lots.map(e=>(0,x.jsxs)("div",{style:{display:"flex",gap:8},children:[(0,x.jsxs)("span",{children:["#",e.lotNo]}),(0,x.jsxs)("span",{children:["Qty: ",e.quantity]}),(0,x.jsxs)("span",{children:["Unit Cost: ",e.unitCost]}),(0,x.jsxs)("span",{children:["Recv: ",e.receivedAt?new Date(e.receivedAt).toLocaleDateString():"-"]}),(0,x.jsxs)("span",{children:["Exp: ",e.expiresAt?new Date(e.expiresAt).toLocaleDateString():"-"]})]},e.lotNo)):"\u2014"})]},e._id)}),!p.length&&(0,x.jsx)("tr",{children:(0,x.jsx)("td",{colSpan:4,style:{textAlign:"center",color:"#9aa"},children:"No chemicals"})})]})]})})]})},ct="http://localhost:5000",dt=()=>{const e=localStorage.getItem("token");return e?{Authorization:"Bearer ".concat(e)}:{}},ut=async e=>{const{data:t}=await m.A.post("".concat(ct,"/api/delivery"),e,{headers:dt()});return t},ht=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{data:t}=await m.A.get("".concat(ct,"/api/delivery/my"),{params:e,headers:dt()});return t},pt=async(e,t)=>{const{data:a}=await m.A.put("".concat(ct,"/api/delivery/").concat(e,"/status"),t,{headers:dt()});return a},ft="http://localhost:5000";function mt(){const e=localStorage.getItem("token");return e?{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}:{"Content-Type":"application/json"}}const xt=()=>{const[e,t]=(0,n.useState)([]),[a,s]=(0,n.useState)(!1),[r,l]=(0,n.useState)(""),[o,c]=(0,n.useState)({status:"PENDING"}),[d,u]=(0,n.useState)("ALL"),[h,p]=(0,n.useState)(null),[f,m]=(0,n.useState)(!1),[g,v]=(0,n.useState)(""),[b,j]=(0,n.useState)([]),[N,S]=(0,n.useState)(!1),[k,A]=(0,n.useState)(""),[C,_]=(0,n.useState)(new Set),[L,T]=(0,n.useState)(new Set),[E,D]=(0,n.useState)(0),[P,R]=(0,n.useState)(0),[I,B]=(0,n.useState)(!1),[F]=(0,n.useState)(3),O=(0,w.Zp)(),{user:q}=y(),[z,M]=(0,n.useState)(!1),[U,W]=(0,n.useState)(!1),[H,V]=(0,n.useState)([]),G=async()=>{W(!0);try{const e="".concat(ft,"/api/sell-requests/admin/all?limit=200"),t=await fetch(e,{headers:mt(),cache:"no-cache"});if(!t.ok)throw new Error("Failed to load (".concat(t.status,")"));const a=await t.json(),n=(Array.isArray(null===a||void 0===a?void 0:a.records)?a.records:Array.isArray(a)?a:[]).map(e=>{var t,a,n,s,r;return{id:e._id,user:(null===(t=e.farmerId)||void 0===t?void 0:t.name)||(null===(a=e.farmerId)||void 0===a?void 0:a.email)||e.name||(null===(n=e.user)||void 0===n?void 0:n.name)||"-",staff:(null===(s=e.assignedDeliveryStaffId)||void 0===s?void 0:s.name)||(null===(r=e.assignedDeliveryStaffId)||void 0===r?void 0:r.email)||"-",date:e.updatedAt||e.createdAt,status:e.status||"-"}}).sort((e,t)=>new Date(t.date||0)-new Date(e.date||0));V(n)}catch(e){l((null===e||void 0===e?void 0:e.message)||"Failed to load history"),V([])}finally{W(!1)}},J=(0,n.useMemo)(()=>["PENDING","REQUESTED","FIELD_ASSIGNED","COLLECTED","DELIVER_ASSIGNED","DELIVERED_TO_LAB","TESTED","ACCOUNT_CALCULATED","VERIFIED","INVOICED"],[]),Y=async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(a&&!e)return;const n=Date.now();if(e||!(n-E<1e4)){s(!0),l(""),D(n);try{const e=["/api/sell-requests/admin/all","/api/latex/admin/requests","/api/barrel-requests/admin/all","/api/delivery/barrels/intake"];let a=[],n="";for(const t of e)try{const s="".concat(ft).concat(t),r=await fetch(s,{headers:mt(),cache:"no-cache"});if(429===r.status){const e=r.headers.get("Retry-After")||5;console.warn("Rate limited on ".concat(t,", waiting ").concat(e,"s...")),await new Promise(t=>setTimeout(t,1e3*e));const l=await fetch(s,{headers:mt(),cache:"no-cache"});if(!l.ok){n="Failed to load from ".concat(t," (").concat(l.status,")");continue}const o=await l.json(),c=(null===o||void 0===o?void 0:o.records)||(null===o||void 0===o?void 0:o.items)||(null===o||void 0===o?void 0:o.results)||(null===o||void 0===o?void 0:o.data)||(Array.isArray(o)?o:[]);if(c&&c.length>0){const e=c.map(e=>(0,i.A)((0,i.A)({},e),{},{_source:t,_type:t.includes("latex")?"LATEX":t.includes("delivery/barrels")?"SELL_BARRELS":t.includes("barrel")?"BARREL":t.includes("chemical")?"CHEMICAL":"SELL"}));a=a.concat(e)}continue}if(!r.ok){n="Failed to load from ".concat(t," (").concat(r.status,")");continue}const l=await r.json(),o=(null===l||void 0===l?void 0:l.records)||(null===l||void 0===l?void 0:l.items)||(null===l||void 0===l?void 0:l.results)||(null===l||void 0===l?void 0:l.data)||(Array.isArray(l)?l:[]);if(o&&o.length>0){const e=o.map(e=>(0,i.A)((0,i.A)({},e),{},{_source:t,_type:t.includes("latex")?"LATEX":t.includes("delivery/barrels")?"SELL_BARRELS":t.includes("barrel")?"BARREL":t.includes("chemical")?"CHEMICAL":"SELL"}));a=a.concat(e)}t!==e[e.length-1]&&await new Promise(e=>setTimeout(e,200))}catch(r){console.log("Error fetching ".concat(t,":"),r.message);continue}if(0===a.length)return l("No user requests found in any category"),void t([]);a.sort((e,t)=>{const a=new Date(e.createdAt||e.requestedAt||e.submittedAt||0);return new Date(t.createdAt||t.requestedAt||t.submittedAt||0)-a});const s=a.map(e=>{var t,a,n,s,r,l,o,c,d;const u=null!==(t=null!==(a=null!==(n=e.status)&&void 0!==n?n:e.requestStatus)&&void 0!==a?a:e.state)&&void 0!==t?t:e.currentStatus;return(0,i.A)((0,i.A)({},e),{},{_statusUpper:"string"===typeof u?u.toUpperCase():"",_createdAt:e.createdAt||e.requestedAt||e.submittedAt||e.created_on||e.date||e.timestamp,_type:e._type||e.type||e.requestType||e.category||"USER REQUEST",_notes:e.notes||e.subject||e.description||e.remark||e.message||(e.barrelCount?"Sell ".concat(e.barrelCount," barrel(s)"):void 0)||(e.quantity?"".concat(e.quantity,"kg latex"):void 0)||(e.chemicalName?"Chemical: ".concat(e.chemicalName):void 0),_farmer:e.name||e.contactName||e.farmerName||(null===(s=e.user)||void 0===s?void 0:s.name)||e.userName||(null===(r=e.farmerId)||void 0===r?void 0:r.name)||(null===(l=e.farmerId)||void 0===l?void 0:l.email)||(null===(o=e.user)||void 0===o?void 0:o.email)||e.email||(null===(c=e.requestedBy)||void 0===c?void 0:c.name)||(null===(d=e.createdBy)||void 0===d?void 0:d.name)||"Unknown User"})});t(s),R(0),B(!1)}catch(r){l("Failed to load user requests: ".concat((null===r||void 0===r?void 0:r.message)||"Network error")),t([])}finally{s(!1)}}};(0,n.useEffect)(()=>{Y()},[o.status]);const K=async e=>{p(e),m(!0),l(""),te(""),A(""),S(!0);try{let e=[];try{const t=await fetch("".concat(ft,"/api/user-management/staff?role=delivery_staff&status=active&limit=100"),{headers:mt()});if(t.ok){const a=await t.json();e=(Array.isArray(null===a||void 0===a?void 0:a.users)?a.users:Array.isArray(null===a||void 0===a?void 0:a.records)?a.records:[]).filter(e=>"delivery_staff"===(e.role||"").toLowerCase())}}catch(t){console.log("User-management endpoint failed, trying shifts endpoint")}if(0===e.length)try{const t=await fetch("".concat(ft,"/api/shifts/staff"),{headers:mt()});if(t.ok){const a=await t.json();e=(Array.isArray(null===a||void 0===a?void 0:a.staff)?a.staff:Array.isArray(a)?a:[]).filter(e=>"delivery_staff"===(e.role||"").toLowerCase())}}catch(t){console.log("Shifts endpoint failed, trying fallback")}if(0===e.length)try{const t=await fetch("".concat(ft,"/api/users"),{headers:mt()});if(t.ok){const a=await t.json();e=(Array.isArray(null===a||void 0===a?void 0:a.users)?a.users:Array.isArray(a)?a:[]).filter(e=>"delivery_staff"===(e.role||"").toLowerCase())}}catch(t){console.log("All endpoints failed")}j(e),0===e.length&&A("No delivery staff found. Please ensure delivery staff are registered in the system.")}catch(t){A("Failed to load delivery staff"),j([])}finally{S(!1)}},[Q,$]=(0,n.useState)(""),[X,Z]=(0,n.useState)(""),[ee,te]=(0,n.useState)(""),[ae,ne]=(0,n.useState)(""),[se,re]=(0,n.useState)(""),[ie,le]=(0,n.useState)(""),[oe,ce]=(0,n.useState)(""),de=e.filter(e=>{let t=!0;if("BARRELS"===d?t="BARREL"===e._type:"EMPTY"===d?t="SELL_BARRELS"===e._type:"PRODUCTION"===d&&(t="LATEX"===e._type),!o.status)return t;const a=o.status.toUpperCase();return"PENDING"===a?t&&("PENDING"===e._statusUpper||"REQUESTED"===e._statusUpper):t&&e._statusUpper===a}),ue=e=>{if(!e)return"-";try{const t=new Date(e);return Number.isNaN(t.getTime())?"-":t.toLocaleString()}catch(t){return"-"}},he=e=>{var t,a,n,s,r,i,l,o,c,d,u,h,p,f;const m=e=>{if(null==e)return"";if("string"===typeof e||"number"===typeof e)return String(e);if("object"===typeof e){const t=e.name||e.fullName||e.email||e.phone||e.mobile||e._id;return t?String(t):""}return""},x=m(e._farmer)||m(e.farmerName)||m(e.userName)||m(e.name)||m(e.customerName)||m(e.contactName)||m(null===(t=e.farmer)||void 0===t?void 0:t.name)||m(null===(a=e.requestedBy)||void 0===a?void 0:a.name)||m(null===(n=e.createdBy)||void 0===n?void 0:n.name)||m(null===(s=e.requester)||void 0===s?void 0:s.name)||m(e.ownerName)||m(null===(r=e.profile)||void 0===r?void 0:r.name)||m(null===(i=e.user)||void 0===i?void 0:i.fullName)||m(null===(l=e.user)||void 0===l?void 0:l.name)||m(null===(o=e.customer)||void 0===o?void 0:o.name),g=m(e.phone)||m(e.mobile)||m(e.contact)||m(null===(c=e.user)||void 0===c?void 0:c.phone)||m(null===(d=e.user)||void 0===d?void 0:d.mobile)||m(null===(u=e.customer)||void 0===u?void 0:u.phone),v=m(e.email)||m(null===(h=e.user)||void 0===h?void 0:h.email)||m(null===(p=e.customer)||void 0===p?void 0:p.email)||m(null===(f=e.farmerId)||void 0===f?void 0:f.email);return x&&g?"".concat(x," (").concat(g,")"):x||(g||(v||"-"))};return(0,x.jsxs)("div",{style:{padding:16},children:[(0,x.jsx)("h2",{children:"Sell Requests"}),r&&(0,x.jsx)("div",{style:{color:"tomato",marginBottom:8},children:r}),ee&&(0,x.jsx)("div",{className:"alert success",style:{marginBottom:8},children:ee}),(0,x.jsxs)("div",{style:{display:"flex",gap:12,alignItems:"center",marginBottom:12,flexWrap:"wrap"},children:[(0,x.jsx)("label",{children:"Status"}),(0,x.jsxs)("select",{value:o.status,onChange:e=>c(t=>(0,i.A)((0,i.A)({},t),{},{status:e.target.value})),children:[(0,x.jsx)("option",{value:"",children:"All"}),J.map(e=>(0,x.jsx)("option",{value:e,children:e},e))]}),(0,x.jsx)("button",{onClick:()=>Y(!0),disabled:a,children:a?"Loading...":"Refresh"}),(0,x.jsx)("button",{onClick:()=>O("/manager/live-locations"),style:{marginLeft:8},children:"Live Staff Map"}),(0,x.jsx)("button",{onClick:()=>{M(!0),G()},style:{marginLeft:8},children:"History"}),(0,x.jsxs)("div",{style:{display:"flex",gap:6,alignItems:"center",marginLeft:"auto"},children:[(0,x.jsx)("span",{style:{color:"#64748b",fontSize:12},children:"View:"}),[{key:"ALL",label:"All"},{key:"BARRELS",label:"Barrels"},{key:"EMPTY",label:"Empty Barrels"},{key:"PRODUCTION",label:"Production"}].map(e=>(0,x.jsx)("button",{onClick:()=>u(e.key),style:{padding:"6px 10px",borderRadius:6,border:"1px solid "+(d===e.key?"#2563eb":"#e2e8f0"),background:d===e.key?"#eff6ff":"white",color:d===e.key?"#2563eb":"#334155",fontSize:12},children:e.label},e.key))]}),z&&(0,x.jsx)("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:(0,x.jsxs)("div",{style:{background:"#fff",width:"min(980px, 96%)",maxHeight:"84vh",borderRadius:8,overflow:"hidden",display:"flex",flexDirection:"column"},children:[(0,x.jsxs)("div",{style:{padding:12,borderBottom:"1px solid #eee",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,x.jsx)("div",{style:{fontWeight:600},children:"Sell Requests History"}),(0,x.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[(0,x.jsx)("button",{onClick:G,disabled:U,children:U?"Loading...":"Refresh"}),(0,x.jsx)("button",{onClick:()=>M(!1),children:"Close"})]})]}),(0,x.jsx)("div",{style:{padding:12,overflow:"auto"},children:(0,x.jsxs)("table",{className:"dashboard-table",style:{minWidth:720},children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{children:"User"}),(0,x.jsx)("th",{children:"Delivery Staff"}),(0,x.jsx)("th",{children:"Date"}),(0,x.jsx)("th",{children:"Status"})]})}),(0,x.jsxs)("tbody",{children:[H.map(e=>(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{children:e.user}),(0,x.jsx)("td",{children:e.staff}),(0,x.jsx)("td",{children:e.date?new Date(e.date).toLocaleString():"-"}),(0,x.jsx)("td",{children:e.status})]},e.id)),0===H.length&&(0,x.jsx)("tr",{children:(0,x.jsx)("td",{colSpan:4,style:{textAlign:"center",color:"#6b7280"},children:U?"Loading...":"No history found"})})]})]})})]})})]}),(0,x.jsx)("div",{style:{overflowX:"auto"},children:(0,x.jsxs)("table",{className:"dashboard-table",style:{minWidth:700,tableLayout:"fixed",width:"100%"},children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{style:{width:"28%"},children:"User"}),(0,x.jsx)("th",{style:{width:"10%"},children:"Type"}),(0,x.jsx)("th",{children:"Status"}),(0,x.jsx)("th",{children:"Requested"}),(0,x.jsx)("th",{children:"Barrels"}),(0,x.jsx)("th",{children:"Actions"})]})}),(0,x.jsxs)("tbody",{children:[de.map(a=>{var n;return(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:he(a)}),(0,x.jsx)("td",{style:{whiteSpace:"nowrap"},children:(0,x.jsx)("span",{style:{padding:"4px 8px",borderRadius:"4px",fontSize:"12px",backgroundColor:"LATEX"===a._type?"#e3f2fd":"BARREL"===a._type?"#f3e5f5":"SELL_BARRELS"===a._type?"#e8f5e8":"CHEMICAL"===a._type?"#fff3e0":"#e8f5e8",color:"LATEX"===a._type?"#1976d2":"BARREL"===a._type?"#7b1fa2":"SELL_BARRELS"===a._type?"#388e3c":"CHEMICAL"===a._type?"#f57c00":"#388e3c"},children:a._type})}),(0,x.jsx)("td",{children:a.status}),(0,x.jsx)("td",{children:ue(a._createdAt||a.requestedAt||a.createdAt)}),(0,x.jsx)("td",{children:"SELL_BARRELS"===a._type?(0,x.jsxs)("span",{children:["BC: ",null!==(n=a.barrelCount)&&void 0!==n?n:"-"]}):(0,x.jsx)("span",{children:"-"})}),(0,x.jsx)("td",{children:(0,x.jsxs)("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:["SELL"===a._type&&(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("button",{onClick:()=>K(a._id),children:"Assign Delivery"}),(0,x.jsx)("button",{disabled:Q===a._id,onClick:()=>(async e=>{if(!Q&&window.confirm("Mark this request as verified?"))try{$(e),l(""),te("");const a="".concat(ft,"/api/sell-requests/").concat(e,"/verify"),n=await fetch(a,{method:"PUT",headers:mt()});if(!n.ok)throw new Error("Verify failed ".concat(n.status," @ ").concat(a));te("Verified successfully."),t(t=>t.map(t=>t._id===e?(0,i.A)((0,i.A)({},t),{},{status:"approved",_statusUpper:"APPROVED"}):t)),await Y()}catch(a){l(((null===a||void 0===a?void 0:a.message)||"Verify failed").replace(/<[^>]*>/g,""))}finally{$("")}})(a._id),children:Q===a._id?"Verifying...":"Mark Verified"})]}),"SELL_BARRELS"===a._type&&(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)("span",{style:{alignSelf:"center",color:"#2563eb"},children:["CB: ",a.companyBarrel||"-"]}),(0,x.jsx)("button",{disabled:X===a._id||C.has(a._id),onClick:()=>(async a=>{_(e=>new Set([...e,a])),te("Approved! \u2705"),l("");try{const n=e.find(e=>e._id===a)||{};if(String(n._source||"").includes("/delivery/barrels/intake")){const e="".concat(ft,"/api/delivery/barrels/intake/").concat(a);await fetch(e,{method:"PUT",headers:mt(),body:JSON.stringify({status:"approved"})})}t(e=>e.map(e=>e._id===a?(0,i.A)((0,i.A)({},e),{},{status:"approved",_statusUpper:"APPROVED"}):e))}catch(n){}K(a)})(a._id),style:{backgroundColor:C.has(a._id)?"#ccc":"#4CAF50",color:C.has(a._id)?"#666":"white",cursor:C.has(a._id)?"not-allowed":"pointer"},children:C.has(a._id)?"Approved \u2705":X===a._id?"Approving...":"Approve"}),(0,x.jsx)("button",{disabled:L.has(a._id),onClick:()=>K(a._id),style:{backgroundColor:L.has(a._id)?"#ccc":"#4CAF50",color:L.has(a._id)?"#666":"white",cursor:L.has(a._id)?"not-allowed":"pointer"},children:L.has(a._id)?"Assigned \ud83d\ude9a":"Assign Delivery"})]}),"SELL"!==a._type&&"SELL_BARRELS"!==a._type&&(0,x.jsx)("button",{onClick:()=>alert("View ".concat(a._type," request details")),children:"View Details"})]})})]},a._id)}),0===de.length&&(0,x.jsx)("tr",{children:(0,x.jsx)("td",{colSpan:5,style:{textAlign:"center",color:"#6b7280"},children:"No user requests found. Use Refresh. If issue persists, check API route permissions."})})]})]})}),f&&(0,x.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:(0,x.jsxs)("div",{style:{backgroundColor:"white",padding:"20px",borderRadius:"8px",minWidth:"300px",maxWidth:"500px"},children:[(0,x.jsx)("h3",{children:"Assign Delivery Staff"}),(0,x.jsx)("p",{children:"Select a delivery staff member:"}),(0,x.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,x.jsxs)("select",{value:g,onChange:e=>v(e.target.value),style:{width:"100%",padding:"8px",border:"1px solid #ccc",borderRadius:"4px"},children:[(0,x.jsx)("option",{value:"",children:"Choose delivery staff..."}),N&&(0,x.jsx)("option",{value:"",disabled:!0,children:"Loading..."}),!N&&b.map(e=>(0,x.jsx)("option",{value:e._id,children:e.name||e.email},e._id)),!N&&!b.length&&(0,x.jsx)("option",{value:"",disabled:!0,children:"No delivery staff found"})]}),k&&(0,x.jsx)("div",{style:{color:"tomato",marginTop:6},children:k})]}),(0,x.jsxs)("div",{style:{display:"flex",gap:"10px",justifyContent:"flex-end"},children:[(0,x.jsx)("button",{onClick:()=>{m(!1),v(""),p(null)},style:{padding:"8px 16px",border:"1px solid #ccc",backgroundColor:"white",borderRadius:"4px",cursor:"pointer"},children:"Cancel"}),(0,x.jsx)("button",{onClick:async()=>{if(g){T(e=>new Set([...e,h]));try{var a,n;const s=e.find(e=>e._id===h)||{};if("SELL"===s._type){const e=await fetch("".concat(ft,"/api/sell-requests/").concat(h,"/assign-delivery"),{method:"PUT",headers:mt(),body:JSON.stringify({deliveryStaffId:g})});if(!e.ok)throw new Error("Failed to assign delivery staff: ".concat(e.status))}const r=s.pickupAddress||s.address||s.capturedAddress||s.location,l="string"===typeof r?r:r&&"object"===typeof r&&(r.label||r.name||r.address)?r.label||r.name||r.address:"Customer pickup location",o={title:s._type?"".concat(s._type," Pickup"):"Pickup Task",customerUserId:s.createdBy||(null===(a=s.user)||void 0===a?void 0:a._id)||s.userId||void 0,assignedTo:g,pickupAddress:l,dropAddress:"HFP Lab / Yard",scheduledAt:(new Date).toISOString(),notes:s._notes||void 0,meta:{barrelCount:null!==(n=s.barrelCount)&&void 0!==n?n:void 0,sellRequestId:"SELL"===s._type?s._id:void 0,intakeId:"SELL_BARRELS"===s._type?s._id:void 0}};await ut(o),te("Assigned successfully"),t(e=>e.map(e=>e._id===h?(0,i.A)((0,i.A)({},e),{},{status:"assigned",_statusUpper:"ASSIGNED"}):e)),T(e=>new Set([...e,h]))}catch(s){l("Failed to assign delivery staff: "+((null===s||void 0===s?void 0:s.message)||"Unknown error")),console.error("Assignment error:",s)}m(!1),v(""),p(null),l("")}else l("Please select a delivery staff member")},style:{padding:"8px 16px",backgroundColor:"#4CAF50",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"Assign"})]})]})})]})},gt=(e,t)=>{const a=[],n=[];if(e.assignedTo&&e.assignedTo!==t)return a.push("Barrel ".concat(e.barrelId," is already assigned to another user and cannot be reassigned")),{isValid:!1,errors:a,warnings:n,isAssignedToOther:!0};if("disposed"===e.status&&a.push("Barrel is disposed and cannot be assigned"),"in-use"===e.status&&a.push("Barrel is already in use"),e.assignedTo===t&&"assigned"===e.status&&a.push("Barrel is already assigned to this user"),e.expiryDate){const t=new Date(e.expiryDate),s=new Date,r=Math.ceil((t-s)/864e5);r<0?a.push("Barrel has expired"):r<30&&n.push("Barrel expires in ".concat(r," days"))}if(e.manufactureDate){const t=new Date(e.manufactureDate),n=new Date;Math.ceil((n-t)/864e5)<0&&a.push("Invalid manufacture date")}return e.condition&&["faulty","damaged","scrap"].includes(e.condition)&&a.push("Barrel is ".concat(e.condition," and cannot be assigned")),"repair"===e.condition&&n.push("Barrel is under repair"),{isValid:0===a.length,errors:a,warnings:n,isAssignedToOther:!1}},vt=(e,t,a)=>{const n=[],s=[],r=a.filter(e=>e.assignedTo===t).length;r+e.length>50&&n.push("User already has ".concat(r," barrels. Maximum limit is ").concat(50));a.filter(e=>e.assignedTo===t&&e.updatedAt&&new Date(e.updatedAt)>new Date(Date.now()-6048e5)).length>10&&s.push("User has received many barrel assignments recently");const i=a.filter(t=>e.includes(t.barrelId));return 1===new Set(i.map(e=>e.batchNo).filter(Boolean)).size&&e.length>5&&s.push("All selected barrels are from the same batch"),{isValid:0===n.length,errors:n,warnings:s}},yt="http://localhost:5000";function bt(){const e=localStorage.getItem("token");return e?{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}:{"Content-Type":"application/json"}}const jt=()=>{const[e,t]=(0,n.useState)([]),[a,s]=(0,n.useState)([]),[r,i]=(0,n.useState)([]),[l,o]=(0,n.useState)(""),[c,d]=(0,n.useState)(""),[u,h]=(0,n.useState)(!1),[p,f]=(0,n.useState)(!1),[m,g]=(0,n.useState)(""),[v,y]=(0,n.useState)(""),[b,j]=(0,n.useState)(null),[w,N]=(0,n.useState)(()=>(new Date).toISOString().slice(0,10)),[S,k]=(0,n.useState)(""),[A,C]=(0,n.useState)(!1),[_,L]=(0,n.useState)(!1),[T,E]=(0,n.useState)([]),[D,P]=(0,n.useState)({}),[R,I]=(0,n.useState)({}),[B,F]=(0,n.useState)(!1),[O,q]=(0,n.useState)([]),z=async()=>{h(!0),y(""),g("");try{const[e,a,n]=await Promise.all([fetch("".concat(yt,"/api/barrels"),{headers:bt()}),fetch("".concat(yt,"/api/user-management/staff?role=user&status=active&limit=500"),{headers:bt()}),fetch("".concat(yt,"/api/requests/barrels/manager/all"),{headers:bt()}).catch(()=>({ok:!1}))]);if(!e.ok)throw new Error("Failed to load barrels (".concat(e.status,")"));const r=await e.json(),i=a.ok?await a.json():{users:[]},l=(null===i||void 0===i?void 0:i.users)||(null===i||void 0===i?void 0:i.records)||[],o=n.ok?await n.json():[],c=Array.isArray(o)?o.filter(e=>"approved"===e.status):[];t(Array.isArray(r)?r:[]),s(Array.isArray(l)?l:[]),q(c)}catch(e){y((null===e||void 0===e?void 0:e.message)||"Failed to load data"),t([]),s([])}finally{h(!1)}},M=async()=>{L(!0);try{const e=await fetch("".concat(yt,"/api/barrels/dispatch-history?limit=200"),{headers:bt()});if(!e.ok)throw new Error("Failed to load history (".concat(e.status,")"));const t=await e.json(),a=Array.isArray(null===t||void 0===t?void 0:t.records)?t.records:[],n=new Map;for(const r of a){const e=r.recipient||"",t=r.dispatchDate?new Date(r.dispatchDate).toISOString().slice(0,10):"",a="".concat(e,"|").concat(t);n.has(a)||n.set(a,{user:e,date:t,ids:[]}),n.get(a).ids.push(r.barrelId)}const s=Array.from(n.values()).sort((e,t)=>t.date>e.date?1:-1);E(s)}catch(e){y((null===e||void 0===e?void 0:e.message)||"Failed to load history")}finally{L(!1)}};(0,n.useEffect)(()=>{const e=new URLSearchParams(window.location.search),t=e.get("barrelId"),a=e.get("mfg"),n=e.get("exp");t&&(j({barrelId:t,mfg:a||"",exp:n||""}),d(t)),z()},[]);const U=(0,n.useMemo)(()=>e.filter(e=>"disposed"!==e.status&&String(e.barrelId||"").toLowerCase().includes(c.toLowerCase())),[e,c]),W=e=>{if(!l)return!1;return gt(e,l).isValid},H=(0,n.useMemo)(()=>U.filter(W),[U,l]),V=(0,n.useMemo)(()=>{if(!l||0===r.length)return{isValid:!0,errors:[],warnings:[]};const t=[],a=[];return r.forEach(n=>{const s=e.find(e=>e.barrelId===n);if(s){const e=gt(s,l);e.isValid||t.push(...e.errors),a.push(...e.warnings)}}),{isValid:0===t.length,errors:t,warnings:a}},[r,l,e]),G=(0,n.useMemo)(()=>{const e=[...U];return e.sort((e,t)=>(e.expiryDate?new Date(e.expiryDate).getTime():Number.POSITIVE_INFINITY)-(t.expiryDate?new Date(t.expiryDate).getTime():Number.POSITIVE_INFINITY)),e.filter(W)},[U,l]);(0,n.useEffect)(()=>{if(!r.length)return;const e=new Set(H.map(e=>e.barrelId)),t=r.filter(t=>e.has(t));t.length!==r.length&&i(t)},[l,H,r]),(0,n.useEffect)(()=>{if(!b||!b.barrelId||r.length)return;const t=e.find(e=>String(e.barrelId).toLowerCase()===String(b.barrelId).toLowerCase());t&&i([t.barrelId])},[e,b,r.length]);return(0,x.jsxs)("div",{style:{padding:16},children:[(0,x.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:12,flexWrap:"wrap"},children:[(0,x.jsx)("h2",{style:{margin:0},children:"Barrel Allocation"}),(0,x.jsxs)("div",{style:{display:"flex",gap:8},children:[(0,x.jsx)("button",{onClick:z,disabled:u,children:u?"Refreshing...":"Refresh"}),(0,x.jsx)("button",{onClick:()=>{C(!0),M()},children:"History"})]})]}),v&&(0,x.jsx)("div",{style:{color:"tomato",marginTop:8,padding:12,backgroundColor:"#fee",border:"1px solid #fcc",borderRadius:4},children:v}),m&&(0,x.jsx)("div",{style:{color:"seagreen",marginTop:8,padding:12,backgroundColor:"#efe",border:"1px solid #cfc",borderRadius:4},children:m}),O.length>0&&(0,x.jsxs)("div",{style:{marginTop:16,padding:16,backgroundColor:"#f0f9ff",border:"2px solid #3b82f6",borderRadius:8},children:[(0,x.jsxs)("h3",{style:{margin:"0 0 12px 0",color:"#1e40af",display:"flex",alignItems:"center",gap:8},children:["\ud83d\udccb Approved Barrel Requests Waiting for Assignment",(0,x.jsxs)("span",{style:{fontSize:14,fontWeight:"normal",color:"#64748b"},children:["(",O.length," ",1===O.length?"request":"requests",")"]})]}),(0,x.jsx)("div",{style:{display:"grid",gap:12},children:O.map(e=>{var t,a,n;return(0,x.jsxs)("div",{style:{background:"white",padding:12,borderRadius:6,border:"1px solid #bfdbfe",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,x.jsxs)("div",{style:{display:"flex",gap:16,alignItems:"center",flex:1},children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("div",{style:{fontWeight:600,fontSize:15,color:"#1e293b"},children:(null===(t=e.user)||void 0===t?void 0:t.name)||(null===(a=e.user)||void 0===a?void 0:a.email)||"Unknown User"}),(0,x.jsxs)("div",{style:{fontSize:12,color:"#64748b",marginTop:2},children:["User ID: ",null===(n=e.user)||void 0===n?void 0:n._id]})]}),(0,x.jsxs)("div",{style:{background:"#dbeafe",color:"#1e40af",padding:"6px 12px",borderRadius:20,fontWeight:700,fontSize:16},children:[e.quantity," ",1===e.quantity?"Barrel":"Barrels"," Needed"]}),e.notes&&(0,x.jsxs)("div",{style:{fontSize:13,color:"#475569",fontStyle:"italic"},children:["Note: ",e.notes]}),(0,x.jsxs)("div",{style:{fontSize:12,color:"#94a3b8"},children:["Approved: ",new Date(e.createdAt).toLocaleDateString()]})]}),(0,x.jsx)("button",{onClick:()=>{var t;o((null===(t=e.user)||void 0===t?void 0:t._id)||""),k(String(e.quantity||""))},style:{background:"#3b82f6",color:"white",border:"none",padding:"8px 16px",borderRadius:6,fontWeight:600,cursor:"pointer"},children:"Assign Barrels \u2192"})]},e._id)})})]}),!V.isValid&&r.length>0&&(0,x.jsxs)("div",{style:{color:"tomato",marginTop:8,padding:12,backgroundColor:"#fee",border:"1px solid #fcc",borderRadius:4},children:[(0,x.jsx)("strong",{children:"\u26a0\ufe0f Assignment Blocked:"})," ",V.errors.join(", ")]}),(V.warnings.length>0||vt(r,l,e).warnings.length>0)&&r.length>0&&(0,x.jsxs)("div",{style:{color:"orange",marginTop:8,padding:12,backgroundColor:"#fff3cd",border:"1px solid #ffeaa7",borderRadius:4},children:[(0,x.jsx)("strong",{children:"\u26a0\ufe0f Warnings:"})," ",[...V.warnings,...vt(r,l,e).warnings].join(", ")]}),(0,x.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(220px, 1fr))",gap:12,marginTop:12},children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("div",{style:{fontSize:12,color:"#6b7280",marginBottom:6},children:"Recipient"}),(0,x.jsxs)("select",{value:l,onChange:e=>o(e.target.value),style:{width:"100%"},children:[(0,x.jsx)("option",{value:"",children:"Select user"}),a.map(e=>(0,x.jsx)("option",{value:e._id,children:e.name||e.email||e.staffId||e._id},e._id))]})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("div",{style:{fontSize:12,color:"#6b7280",marginBottom:6},children:"Search Barrels"}),(0,x.jsx)("input",{value:c,onChange:e=>d(e.target.value),placeholder:"Search by ID"})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("div",{style:{fontSize:12,color:"#6b7280",marginBottom:6},children:"Sending Date"}),(0,x.jsx)("input",{type:"date",value:w,onChange:e=>N(e.target.value)})]}),(0,x.jsxs)("div",{style:{display:"flex",alignItems:"flex-end",gap:8},children:[(0,x.jsx)("button",{type:"button",onClick:()=>i(H.map(e=>e.barrelId)),children:"Select All"}),(0,x.jsx)("button",{type:"button",onClick:()=>i([]),children:"Clear"})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("div",{style:{fontSize:12,color:"#6b7280",marginBottom:6},children:"Assign by Count"}),(0,x.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[(0,x.jsx)("input",{type:"number",min:"1",step:"1",inputMode:"numeric",value:S,onChange:e=>k(e.target.value.replace(/^-/,"")),placeholder:"e.g. 3",style:{width:120},onKeyDown:e=>["e","E","+","-","."].includes(e.key)&&e.preventDefault()}),(0,x.jsx)("button",{type:"button",onClick:()=>{y(""),g("");const e=Number(S);if(!Number.isFinite(e)||e<1)return void y("Enter a valid barrel count");const t=G.slice(0,e).map(e=>e.barrelId);0!==t.length?(i(t),g("Selected ".concat(t.length," barrel(s)"))):y("No barrels available")},children:"Select"})]}),(0,x.jsxs)("div",{style:{fontSize:12,color:"#6b7280",marginTop:4},children:["Available: ",U.length]})]}),r.length>0&&(0,x.jsxs)("div",{className:"card",style:{padding:12},children:[(0,x.jsxs)("div",{style:{fontSize:12,color:"#6b7280"},children:["Selected (",r.length,")"]}),(0,x.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(96px, 1fr))",gap:12,marginTop:8},children:r.slice(0,6).map(e=>(0,x.jsxs)("div",{style:{textAlign:"center"},children:[(0,x.jsx)("div",{style:{fontSize:12,marginBottom:6,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:e}),(0,x.jsx)("img",{alt:"QR ".concat(e),src:"https://api.qrserver.com/v1/create-qr-code/?size=128x128&data=".concat(encodeURIComponent(e)),width:96,height:96})]},e))}),r.length>6&&(0,x.jsxs)("div",{style:{fontSize:12,color:"#6b7280",marginTop:8},children:["+",r.length-6," more"]})]})]}),(0,x.jsx)("div",{style:{marginTop:12,overflowX:"auto"},children:(0,x.jsxs)("table",{className:"dashboard-table",style:{minWidth:860},children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{}),(0,x.jsx)("th",{children:"Barrel"}),(0,x.jsx)("th",{children:"Status"}),(0,x.jsx)("th",{children:"Manufacture"}),(0,x.jsx)("th",{children:"Expiry"})]})}),(0,x.jsxs)("tbody",{children:[U.map(e=>{const t=gt(e,l),n=e.assignedTo&&e.assignedTo!==l,s=n?a.find(t=>t._id===e.assignedTo):null;return(0,x.jsxs)("tr",{style:{backgroundColor:n?"#fff3cd":t.isValid?"inherit":"#fee",opacity:W(e)?1:.6},children:[(0,x.jsx)("td",{children:(0,x.jsx)("input",{type:"checkbox",checked:r.includes(e.barrelId),onChange:()=>{return t=e.barrelId,i(e=>e.includes(t)?e.filter(e=>e!==t):[...e,t]);var t},disabled:!W(e)})}),(0,x.jsxs)("td",{children:[e.barrelId,n&&(0,x.jsxs)("div",{style:{fontSize:10,color:"red",marginTop:2},children:["Assigned to: ",(null===s||void 0===s?void 0:s.name)||"Unknown"]})]}),(0,x.jsx)("td",{children:(0,x.jsx)("span",{style:{padding:"2px 6px",borderRadius:"3px",fontSize:"11px",backgroundColor:"in-storage"===e.status?"#d4edda":"in-use"===e.status?"#fff3cd":"#f8d7da",color:"in-storage"===e.status?"#155724":"in-use"===e.status?"#856404":"#721c24"},children:e.status})}),(0,x.jsx)("td",{children:e.manufactureDate?st(e.manufactureDate):"-"}),(0,x.jsx)("td",{children:e.expiryDate?st(e.expiryDate):"-"})]},e._id)}),0===U.length&&(0,x.jsx)("tr",{children:(0,x.jsx)("td",{colSpan:6,style:{textAlign:"center",color:"#6b7280"},children:"No barrels found"})})]})]})}),(0,x.jsx)("div",{style:{marginTop:12,display:"flex",justifyContent:"flex-end"},children:(0,x.jsx)("button",{className:"btn btn-primary",disabled:p||!l||0===r.length,onClick:async()=>{var t;y(""),g("");const n=(e=>{const t={},{recipient:a,selectedBarrels:n,sendDate:s,count:r}=e;if(a&&""!==a.trim()||(t.recipient="Recipient is required"),n&&0!==n.length||(t.barrels="At least one barrel must be selected"),s){const e=new Date(s),a=new Date;a.setHours(0,0,0,0),isNaN(e.getTime())?t.sendDate="Invalid date format":e<a&&(t.sendDate="Sending date cannot be in the past")}else t.sendDate="Sending date is required";if(void 0!==r&&null!==r){const e=Number(r);(!Number.isInteger(e)||e<1)&&(t.count="Count must be a positive integer")}return{isValid:0===Object.keys(t).length,errors:t}})({recipient:l,selectedBarrels:r,sendDate:w,count:S});if(!n.isValid)return void y("Validation failed: ".concat(Object.values(n.errors).join(", ")));if(!V.isValid)return void y("Barrel validation failed: ".concat(V.errors.join(", ")));const s=vt(r,l,e);if(!s.isValid)return void y("Business rules validation failed: ".concat(s.errors.join(", ")));if(V.warnings.length>0||s.warnings.length>0){const e=[...V.warnings,...s.warnings];if(!window.confirm("Warnings:\n".concat(e.join("\n"),"\n\nDo you want to proceed?")))return}const o=(null===(t=a.find(e=>e._id===l))||void 0===t?void 0:t.name)||"user",c=r[0],d=r.length>1?" and ".concat(r.length-1," more"):"";if(window.confirm("Assign ".concat(c).concat(d," to ").concat(o," on ").concat(w,"?\n\nThis action cannot be undone. Barrels will be locked to this user until returned."))){f(!0);try{var u;const e=await fetch("".concat(yt,"/api/barrels/assign-batch"),{method:"POST",headers:bt(),body:JSON.stringify({barrelIds:r,userId:l,dispatchDate:w})});if(!e.ok){let t="Dispatch failed (".concat(e.status,")");try{const a=await e.json();null!==a&&void 0!==a&&a.message?t=a.message:null!==a&&void 0!==a&&a.error&&(t=a.error)}catch(h){}let a=0,n=0;for(const e of r)try{if(!(await fetch("".concat(yt,"/api/staff-barrels/dispatch"),{method:"POST",headers:bt(),body:JSON.stringify({barrelId:e,type:"out",volumeDelta:0,toLocation:"dispatched",notes:"Manager dispatch to ".concat(l," on ").concat(w),recipientUserId:l})})).ok){n++;continue}a++}catch(h){n++}if(a>0)return g("Assigned ".concat(a," barrel(s) via fallback. ").concat(n?"Failed ".concat(n,"."):"")),i([]),void await z();throw new Error(t)}const t=await e.json();g("Assigned ".concat((null===t||void 0===t?void 0:t.count)||r.length," barrel(s) to ").concat((null===t||void 0===t||null===(u=t.assignedTo)||void 0===u?void 0:u.name)||"user")),i([]),await z()}catch(p){y((null===p||void 0===p?void 0:p.message)||"Dispatch failed")}finally{f(!1)}}},children:p?"Assigning...":"Assign ".concat(r.length||"")})}),A&&(0,x.jsx)("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:(0,x.jsxs)("div",{style:{background:"#fff",width:"min(980px, 96%)",maxHeight:"84vh",borderRadius:8,overflow:"hidden",display:"flex",flexDirection:"column"},children:[(0,x.jsxs)("div",{style:{padding:12,borderBottom:"1px solid #eee",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,x.jsx)("div",{style:{fontWeight:600},children:"Barrel Dispatch History"}),(0,x.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[(0,x.jsx)("button",{onClick:M,disabled:_,children:_?"Loading...":"Refresh"}),(0,x.jsx)("button",{onClick:()=>C(!1),children:"Close"})]})]}),(0,x.jsx)("div",{style:{padding:12,overflow:"auto"},children:(0,x.jsxs)("table",{className:"dashboard-table",style:{minWidth:720},children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{children:"User"}),(0,x.jsx)("th",{children:"Count"}),(0,x.jsx)("th",{children:"Barrel IDs"}),(0,x.jsx)("th",{children:"Assigned Date"}),(0,x.jsx)("th",{children:"Status"}),(0,x.jsx)("th",{children:"Actions"})]})}),(0,x.jsxs)("tbody",{children:[T.map((e,t)=>{var a;return(0,x.jsxs)("tr",{children:[(0,x.jsxs)("td",{children:[(0,x.jsx)("div",{style:{fontWeight:"bold"},children:e.user||"-"}),e.userEmail&&(0,x.jsx)("div",{style:{fontSize:"11px",color:"#666"},children:e.userEmail})]}),(0,x.jsx)("td",{children:(0,x.jsx)("span",{style:{padding:"2px 6px",borderRadius:"3px",backgroundColor:"#e3f2fd",color:"#1976d2",fontSize:"12px",fontWeight:"bold"},children:(null===(a=e.ids)||void 0===a?void 0:a.length)||0})}),(0,x.jsx)("td",{style:{whiteSpace:"nowrap",maxWidth:480,overflow:"hidden",textOverflow:"ellipsis"},children:(e.ids||[]).map((e,t)=>(0,x.jsx)("span",{style:{display:"inline-block",margin:"1px",padding:"1px 4px",backgroundColor:"#f5f5f5",borderRadius:"2px",fontSize:"10px"},children:e},t))}),(0,x.jsx)("td",{children:st(e.date)||"-"}),(0,x.jsx)("td",{children:(0,x.jsx)("span",{style:{padding:"2px 6px",borderRadius:"3px",fontSize:"11px",backgroundColor:"assigned"===e.status?"#d4edda":"returned"===e.status?"#fff3cd":"#f8d7da",color:"assigned"===e.status?"#155724":"returned"===e.status?"#856404":"#721c24"},children:e.status||"assigned"})}),(0,x.jsx)("td",{children:(0,x.jsx)("button",{style:{padding:"2px 6px",fontSize:"10px",backgroundColor:"#007bff",color:"white",border:"none",borderRadius:"2px",cursor:"pointer"},onClick:()=>{alert("Assignment Details:\nUser: ".concat(e.user,"\nDate: ").concat(e.date,"\nBarrels: ").concat((e.ids||[]).join(", "),"\nStatus: ").concat(e.status||"assigned"))},children:"Details"})})]},t)}),0===T.length&&(0,x.jsx)("tr",{children:(0,x.jsx)("td",{colSpan:6,style:{textAlign:"center",color:"#6b7280"},children:_?"Loading...":"No history found"})})]})]})})]})})]})},wt="http://localhost:5000";function Nt(){const e=localStorage.getItem("token");return e?{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}:{"Content-Type":"application/json"}}const St=()=>{const[e,t]=(0,n.useState)([]),[a,s]=(0,n.useState)(!1),[r,i]=(0,n.useState)(""),[l,o]=(0,n.useState)(""),[c,d]=(0,n.useState)("pending"),[u,h]=(0,n.useState)(()=>{const e=localStorage.getItem("barrelRequestsToAdmin");return e?JSON.parse(e):[]}),p=async()=>{s(!0),i("");try{const e=await fetch("".concat(wt,"/api/requests/barrels/manager/all"),{headers:Nt()});if(!e.ok)throw new Error("Failed to load requests (".concat(e.status,")"));const a=await e.json();t(Array.isArray(a)?a:[])}catch(e){i((null===e||void 0===e?void 0:e.message)||"Failed to load barrel requests"),t([])}finally{s(!1)}};(0,n.useEffect)(()=>{p()},[]);const f=e.filter(e=>{var t;return"all"===c||(null===(t=e.status)||void 0===t?void 0:t.toLowerCase())===c});return(0,x.jsxs)("div",{style:{padding:16},children:[(0,x.jsx)("h2",{children:"Barrel Requests"}),(0,x.jsx)("p",{style:{color:"#64748b"},children:"View and manage barrel requests from users"}),r&&(0,x.jsx)("div",{style:{background:"#fee",color:"#c00",padding:12,borderRadius:8,marginBottom:16},children:r}),l&&(0,x.jsx)("div",{style:{background:"#efe",color:"#070",padding:12,borderRadius:8,marginBottom:16},children:l}),(0,x.jsxs)("div",{style:{marginBottom:16,display:"flex",gap:8},children:[(0,x.jsxs)("button",{className:"pending"===c?"btn":"btn-secondary",onClick:()=>d("pending"),children:["Pending (",e.filter(e=>{var t;return"pending"===(null===(t=e.status)||void 0===t?void 0:t.toLowerCase())}).length,")"]}),(0,x.jsxs)("button",{className:"approved"===c?"btn":"btn-secondary",onClick:()=>d("approved"),children:["Approved (",e.filter(e=>{var t;return"approved"===(null===(t=e.status)||void 0===t?void 0:t.toLowerCase())}).length,")"]}),(0,x.jsxs)("button",{className:"rejected"===c?"btn":"btn-secondary",onClick:()=>d("rejected"),children:["Rejected (",e.filter(e=>{var t;return"rejected"===(null===(t=e.status)||void 0===t?void 0:t.toLowerCase())}).length,")"]}),(0,x.jsxs)("button",{className:"all"===c?"btn":"btn-secondary",onClick:()=>d("all"),children:["All (",e.length,")"]})]}),a?(0,x.jsx)("div",{children:"Loading..."}):0===f.length?(0,x.jsxs)("div",{style:{textAlign:"center",color:"#94a3b8",padding:40},children:["No ","all"!==c?c:""," barrel requests found"]}):(0,x.jsx)("div",{style:{overflowX:"auto"},children:(0,x.jsxs)("table",{className:"table",children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{children:"User"}),(0,x.jsx)("th",{children:"Quantity"}),(0,x.jsx)("th",{children:"Notes"}),(0,x.jsx)("th",{children:"Requested On"}),(0,x.jsx)("th",{children:"Status"}),(0,x.jsx)("th",{children:"Actions"})]})}),(0,x.jsx)("tbody",{children:f.map(e=>{var t,a,n,s,r,l,c,d,f,m;return(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{children:(null===(t=e.user)||void 0===t?void 0:t.name)||(null===(a=e.user)||void 0===a?void 0:a.email)||"Unknown User"}),(0,x.jsx)("td",{style:{fontWeight:700,fontSize:18},children:e.quantity||1}),(0,x.jsx)("td",{children:e.notes||"-"}),(0,x.jsx)("td",{children:new Date(e.createdAt).toLocaleString()}),(0,x.jsx)("td",{children:(0,x.jsx)("span",{className:"badge status-".concat((null===(n=e.status)||void 0===n?void 0:n.toLowerCase())||"pending"),style:{padding:"4px 12px",borderRadius:12,fontSize:12,fontWeight:600,backgroundColor:"approved"===(null===(s=e.status)||void 0===s?void 0:s.toLowerCase())?"#d4edda":"rejected"===(null===(r=e.status)||void 0===r?void 0:r.toLowerCase())?"#f8d7da":"#fff3cd",color:"approved"===(null===(l=e.status)||void 0===l?void 0:l.toLowerCase())?"#155724":"rejected"===(null===(c=e.status)||void 0===c?void 0:c.toLowerCase())?"#721c24":"#856404"},children:e.status||"Pending"})}),(0,x.jsxs)("td",{children:["pending"===(null===(d=e.status)||void 0===d?void 0:d.toLowerCase())&&(0,x.jsxs)("div",{style:{display:"flex",gap:8},children:[(0,x.jsx)("button",{className:"btn",style:{background:"#28a745",color:"white",padding:"6px 12px",fontSize:13},onClick:()=>(async e=>{try{const t=await fetch("".concat(wt,"/api/requests/barrels/").concat(e,"/approve"),{method:"PUT",headers:Nt()});if(!t.ok)throw new Error("Failed to approve (".concat(t.status,")"));o("Request approved successfully!"),setTimeout(()=>o(""),3e3),await p()}catch(t){i((null===t||void 0===t?void 0:t.message)||"Failed to approve request")}})(e._id),children:"Approve"}),(0,x.jsx)("button",{className:"btn-secondary",style:{background:"#dc3545",color:"white",padding:"6px 12px",fontSize:13},onClick:()=>(async e=>{const t=window.prompt("Rejection reason (optional):");try{const a=await fetch("".concat(wt,"/api/requests/barrels/").concat(e,"/reject"),{method:"PUT",headers:Nt(),body:JSON.stringify({reason:t||"Rejected by manager"})});if(!a.ok)throw new Error("Failed to reject (".concat(a.status,")"));o("Request rejected."),setTimeout(()=>o(""),3e3),await p()}catch(a){i((null===a||void 0===a?void 0:a.message)||"Failed to reject request")}})(e._id),children:"Reject"})]}),"approved"===(null===(f=e.status)||void 0===f?void 0:f.toLowerCase())&&(u.includes(e._id)?(0,x.jsx)("button",{className:"btn",style:{background:"#10b981",color:"white",padding:"6px 12px",fontSize:13,cursor:"not-allowed"},disabled:!0,title:"Already requested from Admin",children:"\u2713 Requested from Admin"}):(0,x.jsx)("button",{className:"btn",style:{background:"#3b82f6",color:"white",padding:"6px 12px",fontSize:13},onClick:()=>{var t,a;return(async(e,t,a,n)=>{try{const s=await fetch("".concat(wt,"/api/barrel-creation-requests"),{method:"POST",headers:Nt(),body:JSON.stringify({userBarrelRequestId:e,quantity:t,notes:"Request to create ".concat(t," barrel(s) for ").concat(a||n||"user")})});if(!s.ok)throw new Error("Failed to request barrels (".concat(s.status,")"));o("Barrel creation request sent to Admin! (".concat(t," barrels)")),setTimeout(()=>o(""),4e3),h(t=>{const a=[...t,e];return localStorage.setItem("barrelRequestsToAdmin",JSON.stringify(a)),a})}catch(s){i((null===s||void 0===s?void 0:s.message)||"Failed to send request to admin")}})(e._id,e.quantity,null===(t=e.user)||void 0===t?void 0:t.name,null===(a=e.user)||void 0===a?void 0:a.email)},title:"Request Admin to create barrels",children:"\ud83d\udce6 Request Barrels from Admin"})),"rejected"===(null===(m=e.status)||void 0===m?void 0:m.toLowerCase())&&(0,x.jsx)("span",{style:{color:"#94a3b8"},children:"-"})]})]},e._id)})})]})})]})},kt=()=>{const e="http://localhost:5000",t=localStorage.getItem("token"),[a,s]=(0,n.useState)({title:"",message:"",link:"",targetType:"all",role:"accountant",userIds:[]}),[r,l]=(0,n.useState)(!1),[o,c]=(0,n.useState)(""),[d,u]=(0,n.useState)(""),[h,p]=(0,n.useState)(null);(0,n.useEffect)(()=>{f()},[]);const f=async()=>{try{const a=await fetch("".concat(e,"/api/bulk-notifications/stats"),{headers:{Authorization:"Bearer ".concat(t)}});if(a.ok){const e=await a.json();p(e.stats)}}catch(a){console.error("Failed to load stats:",a)}};return(0,x.jsxs)("div",{className:"manager-notifications-container",children:[(0,x.jsxs)("div",{className:"page-header",children:[(0,x.jsx)("h2",{children:"\ud83d\udce2 Send Notifications to Staff"}),(0,x.jsx)("p",{children:"Send important announcements and reminders to your team"})]}),o&&(0,x.jsxs)("div",{className:"alert alert-success",children:["\u2705 ",o]}),d&&(0,x.jsxs)("div",{className:"alert alert-error",children:["\u274c ",d]}),h&&(0,x.jsxs)("div",{className:"stats-section",children:[(0,x.jsx)("h3",{children:"\ud83d\udcca Notification Statistics"}),(0,x.jsxs)("div",{className:"stats-grid",children:[(0,x.jsxs)("div",{className:"stat-card",children:[(0,x.jsx)("div",{className:"stat-value",children:h.totalSent}),(0,x.jsx)("div",{className:"stat-label",children:"Total Sent"})]}),(0,x.jsxs)("div",{className:"stat-card",children:[(0,x.jsx)("div",{className:"stat-value",children:h.totalRead}),(0,x.jsx)("div",{className:"stat-label",children:"Read"})]}),(0,x.jsxs)("div",{className:"stat-card",children:[(0,x.jsx)("div",{className:"stat-value",children:h.totalUnread}),(0,x.jsx)("div",{className:"stat-label",children:"Unread"})]}),(0,x.jsxs)("div",{className:"stat-card",children:[(0,x.jsx)("div",{className:"stat-value",children:h.readRate}),(0,x.jsx)("div",{className:"stat-label",children:"Read Rate"})]})]})]}),(0,x.jsxs)("div",{className:"quick-actions",children:[(0,x.jsx)("h3",{children:"\u26a1 Quick Actions"}),(0,x.jsx)("div",{className:"action-buttons",children:(0,x.jsxs)("div",{className:"action-card",children:[(0,x.jsx)("h4",{children:"\u23f0 Attendance Reminder"}),(0,x.jsx)("p",{children:"Send attendance reminder to a specific role"}),(0,x.jsxs)("select",{value:a.role,onChange:e=>s((0,i.A)((0,i.A)({},a),{},{role:e.target.value})),className:"role-select",children:[(0,x.jsx)("option",{value:"accountant",children:"Accountant"}),(0,x.jsx)("option",{value:"lab_staff",children:"Lab Staff"}),(0,x.jsx)("option",{value:"field_worker",children:"Field Workers"}),(0,x.jsx)("option",{value:"delivery_staff",children:"Delivery Staff"}),(0,x.jsx)("option",{value:"staff",children:"All Staff"})]}),(0,x.jsx)("button",{className:"btn btn-primary",onClick:async()=>{if(a.role){l(!0),c(""),u("");try{const n=await fetch("".concat(e,"/api/bulk-notifications/attendance-reminder"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify({role:a.role})}),s=await n.json();n.ok?(c(s.message||"Attendance reminder sent successfully!"),f()):u(s.message||"Failed to send reminder")}catch(n){u("Failed to send reminder. Please try again.")}finally{l(!1)}}else u("Please select a role")},disabled:r,children:r?"Sending...":"\ud83d\udce4 Send Reminder"})]})})]}),(0,x.jsxs)("div",{className:"notification-form-section",children:[(0,x.jsx)("h3",{children:"\u2709\ufe0f Custom Notification"}),(0,x.jsxs)("form",{onSubmit:async n=>{n.preventDefault(),l(!0),c(""),u("");try{let n="",r={title:a.title,message:a.message,link:a.link};"all"===a.targetType?n="/api/bulk-notifications/all":"role"===a.targetType?(n="/api/bulk-notifications/role",r.role=a.role):"users"===a.targetType&&(n="/api/bulk-notifications/users",r.userIds=a.userIds);const i=await fetch("".concat(e).concat(n),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify(r)}),l=await i.json();i.ok?(c(l.message||"Notification sent successfully!"),s({title:"",message:"",link:"",targetType:"all",role:"accountant",userIds:[]}),f()):u(l.message||"Failed to send notification")}catch(r){u("Failed to send notification. Please try again.")}finally{l(!1)}},className:"notification-form",children:[(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{children:"Target Audience *"}),(0,x.jsxs)("select",{value:a.targetType,onChange:e=>s((0,i.A)((0,i.A)({},a),{},{targetType:e.target.value})),required:!0,children:[(0,x.jsx)("option",{value:"all",children:"All Staff"}),(0,x.jsx)("option",{value:"role",children:"Specific Role"})]})]}),"role"===a.targetType&&(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{children:"Select Role *"}),(0,x.jsxs)("select",{value:a.role,onChange:e=>s((0,i.A)((0,i.A)({},a),{},{role:e.target.value})),required:!0,children:[(0,x.jsx)("option",{value:"accountant",children:"Accountant"}),(0,x.jsx)("option",{value:"lab_staff",children:"Lab Staff"}),(0,x.jsx)("option",{value:"field_worker",children:"Field Workers"}),(0,x.jsx)("option",{value:"delivery_staff",children:"Delivery Staff"}),(0,x.jsx)("option",{value:"staff",children:"General Staff"})]})]}),(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{children:"Notification Title *"}),(0,x.jsx)("input",{type:"text",value:a.title,onChange:e=>s((0,i.A)((0,i.A)({},a),{},{title:e.target.value})),placeholder:"e.g., Important Announcement",required:!0,maxLength:100}),(0,x.jsxs)("span",{className:"char-count",children:[a.title.length,"/100"]})]}),(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{children:"Message *"}),(0,x.jsx)("textarea",{value:a.message,onChange:e=>s((0,i.A)((0,i.A)({},a),{},{message:e.target.value})),placeholder:"Enter your message here...",required:!0,rows:5,maxLength:500}),(0,x.jsxs)("span",{className:"char-count",children:[a.message.length,"/500"]})]}),(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{children:"Link (Optional)"}),(0,x.jsx)("input",{type:"text",value:a.link,onChange:e=>s((0,i.A)((0,i.A)({},a),{},{link:e.target.value})),placeholder:"/staff/attendance"}),(0,x.jsx)("small",{children:"Relative path where notification should redirect"})]}),(0,x.jsxs)("div",{className:"form-actions",children:[(0,x.jsx)("button",{type:"submit",className:"btn btn-success",disabled:r,children:r?"Sending...":"\ud83d\udce4 Send Notification"}),(0,x.jsx)("button",{type:"button",className:"btn btn-secondary",onClick:()=>s({title:"",message:"",link:"",targetType:"all",role:"accountant",userIds:[]}),children:"\ud83d\udd04 Reset"})]})]})]}),(0,x.jsxs)("div",{className:"examples-section",children:[(0,x.jsx)("h3",{children:"\ud83d\udca1 Example Notifications"}),(0,x.jsxs)("div",{className:"examples-grid",children:[(0,x.jsxs)("div",{className:"example-card",onClick:()=>s((0,i.A)((0,i.A)({},a),{},{title:"\u26a0\ufe0f Office Closed Tomorrow",message:"The office will be closed tomorrow due to a public holiday. Enjoy your day off!",link:""})),children:[(0,x.jsx)("div",{className:"example-title",children:"\ud83c\udfe2 Office Closure"}),(0,x.jsx)("div",{className:"example-preview",children:"Office will be closed tomorrow..."})]}),(0,x.jsxs)("div",{className:"example-card",onClick:()=>s((0,i.A)((0,i.A)({},a),{},{title:"\ud83d\udccb Submit Monthly Reports",message:"Please submit your monthly reports by end of this week. Thank you!",link:"/staff/reports"})),children:[(0,x.jsx)("div",{className:"example-title",children:"\ud83d\udcca Report Reminder"}),(0,x.jsx)("div",{className:"example-preview",children:"Submit monthly reports by..."})]}),(0,x.jsxs)("div",{className:"example-card",onClick:()=>s((0,i.A)((0,i.A)({},a),{},{title:"\ud83c\udf89 Team Meeting Tomorrow",message:"Team meeting scheduled for tomorrow at 10:00 AM. Please be on time!",link:""})),children:[(0,x.jsx)("div",{className:"example-title",children:"\ud83d\udcc5 Meeting Notice"}),(0,x.jsx)("div",{className:"example-preview",children:"Team meeting tomorrow at..."})]})]}),(0,x.jsx)("small",{children:"Click on an example to use it as a template"})]})]})},At="http://localhost:5000";function Ct(){const e=localStorage.getItem("token");return e?{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}:{"Content-Type":"application/json"}}const _t=()=>{const[e,t]=(0,n.useState)([]),[a,s]=(0,n.useState)(""),[r,i]=(0,n.useState)(!1),[l,o]=(0,n.useState)([]),[c,d]=(0,n.useState)(""),[u,h]=(0,n.useState)(!1),[p,f]=(0,n.useState)(""),m=async()=>{i(!0),s("");try{const e=await fetch("".concat(At,"/api/chem-requests/manager/pending"),{headers:Ct()});if(!e.ok)throw new Error("Failed to load (".concat(e.status,")"));const a=await e.json();t(Array.isArray(null===a||void 0===a?void 0:a.records)?a.records:[])}catch(e){s((null===e||void 0===e?void 0:e.message)||"Failed to load"),t([])}finally{i(!1)}};(0,n.useEffect)(()=>{m()},[]);const g=async()=>{h(!0),d("");try{const e=p?"?status=".concat(encodeURIComponent(p)):"",t=await fetch("".concat(At,"/api/chem-requests/admin/history").concat(e),{headers:Ct()});if(!t.ok)throw new Error("Failed to load history (".concat(t.status,")"));const a=await t.json();o(Array.isArray(null===a||void 0===a?void 0:a.records)?a.records:[])}catch(e){d((null===e||void 0===e?void 0:e.message)||"Failed to load history"),o([])}finally{h(!1)}};return(0,n.useEffect)(()=>{g()},[p]),(0,x.jsxs)("div",{style:{padding:16},children:[(0,x.jsx)("h2",{children:"Manager: Chemical Requests"}),a&&(0,x.jsx)("div",{style:{color:"tomato"},children:a}),r?(0,x.jsx)("div",{children:"Loading..."}):(0,x.jsx)("div",{style:{overflowX:"auto"},children:(0,x.jsxs)("table",{className:"dashboard-table",style:{minWidth:700},children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{children:"Chemical"}),(0,x.jsx)("th",{children:"Qty"}),(0,x.jsx)("th",{children:"Priority"}),(0,x.jsx)("th",{children:"Requested By"}),(0,x.jsx)("th",{children:"Created"}),(0,x.jsx)("th",{children:"Verify"}),(0,x.jsx)("th",{children:"Reject"})]})}),(0,x.jsxs)("tbody",{children:[e.map(e=>{var t,a;return(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{children:e.chemicalName}),(0,x.jsx)("td",{children:e.quantity}),(0,x.jsx)("td",{style:{textTransform:"capitalize"},children:e.priority}),(0,x.jsx)("td",{children:(null===(t=e.requestedBy)||void 0===t?void 0:t.name)||(null===(a=e.requestedBy)||void 0===a?void 0:a.email)||"-"}),(0,x.jsx)("td",{children:new Date(e.createdAt).toLocaleString()}),(0,x.jsx)("td",{children:(0,x.jsx)("button",{onClick:()=>(async e=>{try{const t=window.prompt("Manager note (optional)")||"",a=await fetch("".concat(At,"/api/chem-requests/").concat(e,"/verify"),{method:"PUT",headers:Ct(),body:JSON.stringify({note:t})});if(!a.ok)throw new Error("Verify failed (".concat(a.status,")"));await m(),await g()}catch(t){s((null===t||void 0===t?void 0:t.message)||"Verify failed")}})(e._id),children:"Verify"})}),(0,x.jsx)("td",{children:(0,x.jsx)("button",{onClick:()=>(async e=>{try{const t=window.prompt("Rejection reason (optional)")||"",a=await fetch("".concat(At,"/api/chem-requests/").concat(e,"/reject"),{method:"PUT",headers:Ct(),body:JSON.stringify({note:t})});if(!a.ok)throw new Error("Reject failed (".concat(a.status,")"));await m(),await g()}catch(t){s((null===t||void 0===t?void 0:t.message)||"Reject failed")}})(e._id),children:"Reject"})})]},e._id)}),0===e.length&&(0,x.jsx)("tr",{children:(0,x.jsx)("td",{colSpan:7,style:{textAlign:"center",color:"#6b7280"},children:"No pending requests."})})]})]})}),(0,x.jsxs)("div",{style:{marginTop:24},children:[(0,x.jsx)("h3",{children:"Chemical History"}),c&&(0,x.jsx)("div",{style:{color:"tomato"},children:c}),(0,x.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:12},children:[(0,x.jsx)("label",{children:"Status:"}),(0,x.jsxs)("select",{value:p,onChange:e=>f(e.target.value),children:[(0,x.jsx)("option",{value:"",children:"All"}),(0,x.jsx)("option",{value:"PENDING",children:"PENDING"}),(0,x.jsx)("option",{value:"MANAGER_VERIFIED",children:"MANAGER_VERIFIED"}),(0,x.jsx)("option",{value:"SENT_FOR_PURCHASE",children:"SENT_FOR_PURCHASE"}),(0,x.jsx)("option",{value:"PURCHASE_IN_PROGRESS",children:"PURCHASE_IN_PROGRESS"}),(0,x.jsx)("option",{value:"PURCHASED",children:"PURCHASED"}),(0,x.jsx)("option",{value:"COMPLETED",children:"COMPLETED"}),(0,x.jsx)("option",{value:"REJECTED_BY_MANAGER",children:"REJECTED_BY_MANAGER"})]}),(0,x.jsx)("button",{onClick:g,children:"Refresh"})]}),u?(0,x.jsx)("div",{children:"Loading history..."}):(0,x.jsx)("div",{style:{overflowX:"auto"},children:(0,x.jsxs)("table",{className:"dashboard-table",style:{minWidth:800},children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{children:"Chemical"}),(0,x.jsx)("th",{children:"Qty"}),(0,x.jsx)("th",{children:"Priority"}),(0,x.jsx)("th",{children:"Status"}),(0,x.jsx)("th",{children:"Requested By"}),(0,x.jsx)("th",{children:"Created"}),(0,x.jsx)("th",{children:"Updated"})]})}),(0,x.jsxs)("tbody",{children:[l.map(e=>{var t,a;return(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{children:e.chemicalName}),(0,x.jsx)("td",{children:e.quantity}),(0,x.jsx)("td",{style:{textTransform:"capitalize"},children:e.priority}),(0,x.jsx)("td",{children:e.status}),(0,x.jsx)("td",{children:(null===(t=e.requestedBy)||void 0===t?void 0:t.name)||(null===(a=e.requestedBy)||void 0===a?void 0:a.email)||"-"}),(0,x.jsx)("td",{children:e.createdAt?new Date(e.createdAt).toLocaleString():"-"}),(0,x.jsx)("td",{children:e.updatedAt?new Date(e.updatedAt).toLocaleString():"-"})]},e._id)}),0===l.length&&(0,x.jsx)("tr",{children:(0,x.jsx)("td",{colSpan:7,style:{textAlign:"center",color:"#6b7280"},children:"No history records."})})]})]})})]})]})};const Lt=function(){const[e,t]=(0,n.useState)([]),[a,s]=(0,n.useState)(!0),[r,i]=(0,n.useState)(""),l=localStorage.getItem("token");(0,n.useEffect)(()=>{(async()=>{try{const e=await fetch("/api/damages?status=open",{headers:{Authorization:l?"Bearer ".concat(l):void 0}}),a=await e.json();if(!e.ok)throw new Error((null===a||void 0===a?void 0:a.message)||"Failed to load");t(a)}catch(e){i(e.message)}finally{s(!1)}})()},[l]);const o=async(e,a)=>{try{const n=await fetch("/api/damages/".concat(e,"/assign"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:l?"Bearer ".concat(l):void 0},body:JSON.stringify({assignedTo:a})}),s=await n.json();if(!n.ok)throw new Error((null===s||void 0===s?void 0:s.message)||"Failed to assign");t(t=>t.filter(t=>t._id!==e))}catch(n){alert(n.message)}};return(0,x.jsx)("div",{className:"card",children:(0,x.jsxs)("div",{className:"card-body",children:[(0,x.jsx)("h2",{children:"Manager: Faulty/Damaged Barrels"}),(0,x.jsx)("p",{className:"text-muted",children:"Review open damage tickets and assign next steps."}),a&&(0,x.jsx)("div",{children:"Loading..."}),r&&(0,x.jsx)("div",{className:"alert alert-danger",children:r}),!a&&!e.length&&(0,x.jsx)("div",{className:"text-muted",children:"No open damages."}),(0,x.jsx)("div",{className:"table-responsive",children:(0,x.jsxs)("table",{className:"table",children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{children:"Barrel"}),(0,x.jsx)("th",{children:"Type"}),(0,x.jsx)("th",{children:"Lumb %"}),(0,x.jsx)("th",{children:"Remarks"}),(0,x.jsx)("th",{children:"Reported"}),(0,x.jsx)("th",{children:"Action"})]})}),(0,x.jsx)("tbody",{children:e.map(e=>{var t;return(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{children:e.barrelId}),(0,x.jsx)("td",{children:e.damageType}),(0,x.jsx)("td",{children:null!==(t=e.lumbPercent)&&void 0!==t?t:"-"}),(0,x.jsx)("td",{children:e.remarks||"-"}),(0,x.jsx)("td",{children:new Date(e.createdAt).toLocaleString()}),(0,x.jsx)("td",{children:(0,x.jsxs)("div",{className:"btn-group",children:[(0,x.jsx)("button",{className:"btn btn-sm",onClick:()=>o(e._id,"lumb-removal"),children:"Lumb Removal"}),(0,x.jsx)("button",{className:"btn btn-sm",onClick:()=>o(e._id,"repair"),children:"Repair"}),(0,x.jsx)("button",{className:"btn btn-sm",onClick:()=>o(e._id,"scrap"),children:"Scrap"}),(0,x.jsx)("button",{className:"btn btn-sm",onClick:()=>o(e._id,"inspection"),children:"Inspection"})]})})]},e._id)})})]})})]})})},Tt="http://localhost:5000";function Et(){const e=localStorage.getItem("token");return e?{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}:{"Content-Type":"application/json"}}const Dt=()=>{const[e,t]=(0,n.useState)("staff"),[a,s]=(0,n.useState)(!1),[r,i]=(0,n.useState)(""),[l,o]=(0,n.useState)({pending:[],verified:[]}),[c,d]=(0,n.useState)({pending:[],recent:[]}),[u,h]=(0,n.useState)([]),[p,f]=(0,n.useState)([]),m=(0,n.useMemo)(()=>[{id:"staff",label:"Staff"},{id:"users",label:"Users"}],[]),g=async()=>{s(!0),i("");try{const[e,t,a]=await Promise.all([fetch("".concat(Tt,"/api/manager-dashboard/attendance/verification?verified=false"),{headers:Et()}).then(e=>e.ok?e.json():Promise.reject(e)),fetch("".concat(Tt,"/api/manager-dashboard/attendance/verification?verified=true"),{headers:Et()}).then(e=>e.ok?e.json():Promise.reject(e)),fetch("".concat(Tt,"/api/leave/pending"),{headers:Et()}).then(e=>e.ok?e.json():Promise.reject(e))]);o({pending:Array.isArray(null===e||void 0===e?void 0:e.data)?e.data:Array.isArray(e)?e:[],verified:Array.isArray(null===t||void 0===t?void 0:t.data)?t.data:Array.isArray(t)?t:[]}),d({pending:Array.isArray(null===a||void 0===a?void 0:a.data)?a.data:Array.isArray(a)?a:[],recent:[]});let n=[],s=[];const r=async e=>(e.headers.get("content-type")||"").includes("application/json")?e.json():e.text().then(()=>[]);let i=await fetch("".concat(Tt,"/api/requests/issues/pending?role=staff"),{headers:Et()});i.ok||(i=await fetch("".concat(Tt,"/api/requests/issues?status=pending&role=staff"),{headers:Et()})),i.ok||(i=await fetch("".concat(Tt,"/api/requests/issues/admin/pending?role=staff"),{headers:Et()}));const l=await r(i);n=Array.isArray(null===l||void 0===l?void 0:l.data)?l.data:Array.isArray(null===l||void 0===l?void 0:l.items)?l.items:Array.isArray(l)?l:[];let c=await fetch("".concat(Tt,"/api/requests/issues/pending?role=customer"),{headers:Et()});c.ok||(c=await fetch("".concat(Tt,"/api/requests/issues?status=pending&role=customer"),{headers:Et()})),c.ok||(c=await fetch("".concat(Tt,"/api/requests/issues/admin/pending?role=customer"),{headers:Et()}));const u=await r(c);s=Array.isArray(null===u||void 0===u?void 0:u.data)?u.data:Array.isArray(null===u||void 0===u?void 0:u.items)?u.items:Array.isArray(u)?u:[],h(n),f(s)}catch(e){i("Failed to load data.")}finally{s(!1)}};(0,n.useEffect)(()=>{g()},[]);const v=async(e,t)=>{try{i("");let n=await fetch("".concat(Tt,"/api/manager-dashboard/attendance/verify"),{method:"POST",headers:Et(),body:JSON.stringify({attendanceId:e,verified:t})});if(n.ok||404!==n.status&&405!==n.status||(n=await fetch("".concat(Tt,"/api/manager-dashboard/attendance/verify/").concat(e),{method:"POST",headers:Et(),body:JSON.stringify({verified:t})})),!n.ok){var a;const e=(n.headers.get("content-type")||"").includes("application/json")?null===(a=await n.json())||void 0===a?void 0:a.message:await n.text();throw new Error(e||"Verify failed (".concat(n.status,")"))}await g()}catch(n){i(((null===n||void 0===n?void 0:n.message)||"Failed to update attendance").replace(/<[^>]*>/g,""))}};return(0,x.jsxs)("div",{style:{padding:16},children:[(0,x.jsx)("h2",{children:"Complaint & action"}),r&&(0,x.jsx)("div",{className:"alert error",children:r}),(0,x.jsxs)("div",{style:{display:"flex",gap:8,marginBottom:12},children:[m.map(a=>(0,x.jsx)("button",{className:"btn-secondary ".concat(e===a.id?"active":""),onClick:()=>t(a.id),children:a.label},a.id)),(0,x.jsx)("button",{onClick:g,disabled:a,children:a?"Refreshing...":"Refresh"})]}),"staff"===e?(0,x.jsxs)("div",{className:"dash-card",style:{display:"grid",gap:16},children:[(0,x.jsx)("h3",{style:{margin:0},children:"Staff"}),(0,x.jsxs)("div",{children:[(0,x.jsx)("h4",{style:{margin:"8px 0"},children:"Attendance - Pending Verification"}),0===l.pending.length?(0,x.jsx)("div",{className:"no-data",children:"No pending records"}):(0,x.jsxs)("table",{className:"dashboard-table",children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{children:"Staff"}),(0,x.jsx)("th",{children:"Date"}),(0,x.jsx)("th",{children:"Check-In"}),(0,x.jsx)("th",{children:"Actions"})]})}),(0,x.jsx)("tbody",{children:l.pending.map(e=>{var t;return(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{children:(null===(t=e.staff)||void 0===t?void 0:t.name)||"-"}),(0,x.jsx)("td",{children:e.date?new Date(e.date).toLocaleDateString("en-IN"):"-"}),(0,x.jsx)("td",{children:e.checkInAt?new Date(e.checkInAt).toLocaleTimeString("en-IN"):"-"}),(0,x.jsxs)("td",{children:[(0,x.jsx)("button",{onClick:()=>v(e._id,!0),children:"Verify"}),(0,x.jsx)("button",{onClick:()=>v(e._id,!1),style:{marginLeft:8},children:"Reject"})]})]},e._id)})})]})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("h4",{style:{margin:"8px 0"},children:"Attendance - Recently Verified"}),0===l.verified.length?(0,x.jsx)("div",{className:"no-data",children:"No verified records"}):(0,x.jsxs)("table",{className:"dashboard-table",children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{children:"Staff"}),(0,x.jsx)("th",{children:"Date"}),(0,x.jsx)("th",{children:"Verified At"})]})}),(0,x.jsx)("tbody",{children:l.verified.slice(0,20).map(e=>{var t;return(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{children:(null===(t=e.staff)||void 0===t?void 0:t.name)||"-"}),(0,x.jsx)("td",{children:e.date?new Date(e.date).toLocaleDateString("en-IN"):"-"}),(0,x.jsx)("td",{children:e.verifiedAt?new Date(e.verifiedAt).toLocaleString("en-IN"):"-"})]},e._id)})})]})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("h4",{style:{margin:"8px 0"},children:"Leaves - Pending"}),0===c.pending.length?(0,x.jsx)("div",{className:"no-data",children:"No pending leaves"}):(0,x.jsxs)("table",{className:"dashboard-table",children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{children:"Staff"}),(0,x.jsx)("th",{children:"Dates"}),(0,x.jsx)("th",{children:"Reason"}),(0,x.jsx)("th",{children:"Actions"})]})}),(0,x.jsx)("tbody",{children:c.pending.map(e=>{var t;return(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{children:(null===(t=e.staff)||void 0===t?void 0:t.name)||"-"}),(0,x.jsxs)("td",{children:[e.startDate?new Date(e.startDate).toLocaleDateString("en-IN"):"-"," \u2192 ",e.endDate?new Date(e.endDate).toLocaleDateString("en-IN"):"-"]}),(0,x.jsx)("td",{children:e.reason||"-"}),(0,x.jsxs)("td",{children:[(0,x.jsx)("button",{onClick:()=>(async e=>{try{await fetch("".concat(Tt,"/api/leave/approve/").concat(e),{method:"POST",headers:Et()}).then(e=>{if(!e.ok)throw new Error("approve failed")}),await g()}catch(t){alert("Failed to approve leave")}})(e._id),children:"Approve"}),(0,x.jsx)("button",{onClick:()=>(async e=>{try{await fetch("".concat(Tt,"/api/leave/reject/").concat(e),{method:"POST",headers:Et()}).then(e=>{if(!e.ok)throw new Error("reject failed")}),await g()}catch(t){alert("Failed to reject leave")}})(e._id),style:{marginLeft:8},children:"Reject"})]})]},e._id)})})]})]})]}):(0,x.jsxs)("div",{className:"dash-card",style:{display:"grid",gap:12},children:[(0,x.jsx)("h3",{style:{margin:0},children:"Users"}),(0,x.jsx)("div",{className:"no-data",children:"User issues/requests view coming soon. Tell me which items to include."})]})]})};const Pt=function(){const[e,t]=(0,n.useState)([]),[a,s]=(0,n.useState)(!0),[r,i]=(0,n.useState)(""),l=localStorage.getItem("token");(0,n.useEffect)(()=>{(async()=>{s(!0),i("");try{const e=await fetch("/api/repairs?status=awaiting-approval",{headers:{Authorization:l?"Bearer ".concat(l):void 0}}),a=await e.json();if(!e.ok)throw new Error((null===a||void 0===a?void 0:a.message)||"Failed to load");t(a)}catch(e){i(e.message)}finally{s(!1)}})()},[]);const o=async(e,a)=>{try{const n=await fetch("/api/repairs/".concat(e,"/").concat(a),{method:"POST",headers:{Authorization:l?"Bearer ".concat(l):void 0}}),s=await n.json();if(!n.ok)throw new Error((null===s||void 0===s?void 0:s.message)||"Action failed");t(t=>t.filter(t=>t._id!==e))}catch(n){alert(n.message)}};return(0,x.jsx)("div",{className:"card",children:(0,x.jsxs)("div",{className:"card-body",children:[(0,x.jsx)("h2",{children:"Manager: Repair Approvals"}),(0,x.jsx)("p",{className:"text-muted",children:"Approve or reject completed lumb removal/repair jobs."}),a&&(0,x.jsx)("div",{children:"Loading..."}),r&&(0,x.jsx)("div",{className:"alert alert-danger",children:r}),!a&&!e.length&&(0,x.jsx)("div",{className:"text-muted",children:"No jobs awaiting approval."}),(0,x.jsx)("div",{className:"table-responsive",children:(0,x.jsxs)("table",{className:"table",children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{children:"Job"}),(0,x.jsx)("th",{children:"Barrel"}),(0,x.jsx)("th",{children:"Type"}),(0,x.jsx)("th",{children:"Completed"}),(0,x.jsx)("th",{children:"Action"})]})}),(0,x.jsx)("tbody",{children:e.map(e=>(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{children:e._id}),(0,x.jsx)("td",{children:e.barrelId}),(0,x.jsx)("td",{children:e.type}),(0,x.jsx)("td",{children:new Date(e.updatedAt).toLocaleString()}),(0,x.jsx)("td",{children:(0,x.jsxs)("div",{className:"btn-group",children:[(0,x.jsx)("button",{className:"btn btn-sm btn-success",onClick:()=>o(e._id,"approve"),children:"Approve"}),(0,x.jsx)("button",{className:"btn btn-sm btn-outline-danger",onClick:()=>o(e._id,"reject"),children:"Reject"})]})})]},e._id))})]})})]})})},Rt=()=>{const e="http://localhost:5000",t="undefined"!==typeof window?localStorage.getItem("token"):null,a=(0,n.useMemo)(()=>t?{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"}:{"Content-Type":"application/json"},[t]),[s,r]=(0,n.useState)([]),[i,l]=(0,n.useState)(!1),[o,c]=(0,n.useState)(""),[d,u]=(0,n.useState)(""),[h,p]=(0,n.useState)(""),[f,m]=(0,n.useState)(""),[g,v]=(0,n.useState)(""),[y,b]=(0,n.useState)(""),j=e=>{if(!e)return"-";try{const t=new Date(e);return Number.isNaN(t.getTime())?"-":t.toLocaleDateString("en-IN")}catch(t){return"-"}},w=(0,n.useCallback)(async()=>{l(!0),c("");try{const n=new URLSearchParams({status:d||"",from:f||"",to:g||""}),s=["".concat(e,"/api/leave/history?").concat(n),"".concat(e,"/api/leave/admin/all?").concat(n),"".concat(e,"/api/leave/all?").concat(n),"".concat(e,"/api/leave/manager/history?").concat(n)];let i=[];for(const e of s)try{const t=await fetch(e,{headers:a});if(!t.ok)continue;const n=await t.json(),s=Array.isArray(null===n||void 0===n?void 0:n.data)?n.data:Array.isArray(null===n||void 0===n?void 0:n.records)?n.records:Array.isArray(null===n||void 0===n?void 0:n.items)?n.items:Array.isArray(n)?n:[];if(s.length){i=s;break}}catch(t){}r(i)}catch(n){c((null===n||void 0===n?void 0:n.message)||"Failed to load"),r([])}finally{l(!1)}},[e,a,d,f,g]);(0,n.useEffect)(()=>{w()},[w]);const N=s.filter(e=>{var t,a,n,s;const r=!d||String(e.status||"").toLowerCase()===String(d).toLowerCase(),i=[e.staffName,null===(t=e.staff)||void 0===t?void 0:t.name,null===(a=e.staff)||void 0===a?void 0:a.fullName,null===(n=e.staff)||void 0===n?void 0:n.email,null===(s=e.staff)||void 0===s?void 0:s.staffId,e.staffId].filter(Boolean).join(" ").toLowerCase(),l=!h||i.includes(h.toLowerCase()),o=new Date(e.startDate||e.fromDate||e.from).getTime(),c=new Date(e.endDate||e.toDate||e.to).getTime(),u=!f||o>=new Date(f).getTime(),p=!g||c<=new Date(g).getTime();return r&&l&&u&&p});return(0,x.jsxs)("div",{style:{padding:16},children:[(0,x.jsx)("h2",{style:{margin:0},children:"Staff Leave History"}),o&&(0,x.jsx)("div",{style:{color:"tomato",marginTop:8},children:o}),(0,x.jsxs)("div",{style:{display:"flex",gap:12,alignItems:"end",flexWrap:"wrap",marginTop:12},children:[(0,x.jsxs)("label",{style:{display:"grid"},children:[(0,x.jsx)("span",{children:"Search (name/email)"}),(0,x.jsx)("input",{value:h,onChange:e=>p(e.target.value),placeholder:"e.g. John"})]}),(0,x.jsxs)("label",{style:{display:"grid"},children:[(0,x.jsx)("span",{children:"Status"}),(0,x.jsxs)("select",{value:d,onChange:e=>u(e.target.value),children:[(0,x.jsx)("option",{value:"",children:"All"}),(0,x.jsx)("option",{value:"pending",children:"Pending"}),(0,x.jsx)("option",{value:"approved",children:"Approved"}),(0,x.jsx)("option",{value:"rejected",children:"Rejected"})]})]}),(0,x.jsxs)("label",{style:{display:"grid"},children:[(0,x.jsx)("span",{children:"From"}),(0,x.jsx)("input",{type:"date",value:f,onChange:e=>{const t=e.target.value;g&&g<t&&v(t),m(t),b("")}})]}),(0,x.jsxs)("label",{style:{display:"grid"},children:[(0,x.jsx)("span",{children:"To"}),(0,x.jsx)("input",{type:"date",value:g,min:f,onChange:e=>{const t=e.target.value;if(f&&t<f)return b("To date cannot be earlier than From date"),void v(f);b(""),v(t)}})]}),(0,x.jsx)("button",{className:"btn",onClick:w,disabled:i,children:i?"Loading...":"Refresh"})]}),y&&(0,x.jsx)("div",{style:{color:"tomato",marginTop:6},children:y}),(0,x.jsx)("div",{className:"dash-card",style:{marginTop:12,overflowX:"auto"},children:(0,x.jsxs)("table",{className:"dashboard-table",style:{minWidth:900},children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{children:"Staff"}),(0,x.jsx)("th",{children:"Staff ID"}),(0,x.jsx)("th",{children:"Type"}),(0,x.jsx)("th",{children:"Status"}),(0,x.jsx)("th",{children:"Start"}),(0,x.jsx)("th",{children:"End"}),(0,x.jsx)("th",{children:"Reason"})]})}),(0,x.jsxs)("tbody",{children:[N.map(e=>{var t,a,n;return(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{children:(null===(t=e.staff)||void 0===t?void 0:t.name)||(null===(a=e.staff)||void 0===a?void 0:a.email)||e.staffName||"-"}),(0,x.jsx)("td",{children:(null===(n=e.staff)||void 0===n?void 0:n.staffId)||e.staffId||"-"}),(0,x.jsx)("td",{children:e.leaveType||e.type||"-"}),(0,x.jsx)("td",{children:e.status||"-"}),(0,x.jsx)("td",{children:j(e.startDate||e.fromDate||e.from)}),(0,x.jsx)("td",{children:j(e.endDate||e.toDate||e.to)}),(0,x.jsx)("td",{title:e.reason,children:e.reason||"-"})]},e._id||"".concat(e.staffId,"-").concat(e.startDate,"-").concat(e.endDate))}),!i&&0===N.length&&(0,x.jsx)("tr",{children:(0,x.jsx)("td",{colSpan:7,style:{textAlign:"center",color:"#6b7280"},children:"No leave records"})})]})]})})]})},It=()=>{var e;const{user:t}=y(),[a,s]=(0,n.useState)([]),[r,l]=(0,n.useState)([]),[o,c]=(0,n.useState)(!1),[d,u]=(0,n.useState)(""),[h,p]=(0,n.useState)(null),[f,m]=(0,n.useState)({reassignTo:"",reassignReason:""});(0,n.useEffect)(()=>{g(),v()},[]);const g=async()=>{try{const e=await fetch("/api/barrels/returned",{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}});if(e.ok){const t=await e.json();s(t.returnedBarrels)}}catch(e){console.error("Error fetching returned barrels:",e)}},v=async()=>{try{const e=await fetch("/api/users",{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}});if(e.ok){const t=(await e.json()).filter(e=>"staff"===e.role&&"active"===e.status);l(t)}}catch(e){console.error("Error fetching users:",e)}},b=e=>new Date(e).toLocaleString();return(0,x.jsxs)("div",{className:"manager-return-barrels-container",children:[(0,x.jsxs)("div",{className:"page-header",children:[(0,x.jsx)("h1",{children:"Returned Barrels Management"}),(0,x.jsx)("p",{children:"Manage and reassign returned barrels to staff members"})]}),d&&(0,x.jsx)("div",{className:"message ".concat(d.includes("Error")?"error":"success"),children:d}),(0,x.jsxs)("div",{className:"returned-barrels-list",children:[(0,x.jsxs)("h3",{children:["Returned Barrels (",a.length,")"]}),0===a.length?(0,x.jsx)("div",{className:"no-returns",children:(0,x.jsx)("p",{children:"No returned barrels at the moment"})}):(0,x.jsx)("div",{className:"returns-grid",children:a.map(e=>{var t,a,n;return(0,x.jsxs)("div",{className:"return-item",children:[(0,x.jsxs)("div",{className:"return-header",children:[(0,x.jsxs)("h4",{children:["Return #",e._id.slice(-6)]}),(n=e.status,(0,x.jsx)("span",{className:"status-badge ".concat({returned:"status-returned",reassigned:"status-reassigned",completed:"status-completed"}[n]),children:n.charAt(0).toUpperCase()+n.slice(1)}))]}),(0,x.jsxs)("div",{className:"return-details",children:[(0,x.jsxs)("div",{className:"detail-row",children:[(0,x.jsx)("span",{className:"label",children:"Returned By:"}),(0,x.jsx)("span",{className:"value",children:(null===(t=e.returnedBy)||void 0===t?void 0:t.name)||"Unknown"})]}),(0,x.jsxs)("div",{className:"detail-row",children:[(0,x.jsx)("span",{className:"label",children:"Returned At:"}),(0,x.jsx)("span",{className:"value",children:b(e.returnedAt)})]}),(0,x.jsxs)("div",{className:"detail-row",children:[(0,x.jsx)("span",{className:"label",children:"Barrel Count:"}),(0,x.jsx)("span",{className:"value",children:e.barrels.length})]}),"reassigned"===e.status&&(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)("div",{className:"detail-row",children:[(0,x.jsx)("span",{className:"label",children:"Reassigned To:"}),(0,x.jsx)("span",{className:"value",children:(null===(a=e.reassignedTo)||void 0===a?void 0:a.name)||"Unknown"})]}),(0,x.jsxs)("div",{className:"detail-row",children:[(0,x.jsx)("span",{className:"label",children:"Reassigned At:"}),(0,x.jsx)("span",{className:"value",children:b(e.reassignedAt)})]})]})]}),(0,x.jsxs)("div",{className:"barrels-list",children:[(0,x.jsx)("h5",{children:"Barrel IDs:"}),(0,x.jsx)("div",{className:"barrel-ids",children:e.barrels.map((e,t)=>(0,x.jsx)("span",{className:"barrel-id",children:e.barrelId},t))})]}),"returned"===e.status&&(0,x.jsx)("div",{className:"actions",children:(0,x.jsx)("button",{className:"reassign-btn",onClick:()=>p(e),children:"Reassign Barrels"})})]},e._id)})})]}),h&&(0,x.jsx)("div",{className:"modal-overlay",children:(0,x.jsxs)("div",{className:"modal",children:[(0,x.jsxs)("div",{className:"modal-header",children:[(0,x.jsx)("h3",{children:"Reassign Barrels"}),(0,x.jsx)("button",{className:"close-btn",onClick:()=>p(null),children:"\u2715"})]}),(0,x.jsxs)("div",{className:"modal-body",children:[(0,x.jsxs)("div",{className:"reassign-info",children:[(0,x.jsxs)("p",{children:[(0,x.jsx)("strong",{children:"Return ID:"})," #",h._id.slice(-6)]}),(0,x.jsxs)("p",{children:[(0,x.jsx)("strong",{children:"Barrel Count:"})," ",h.barrels.length]}),(0,x.jsxs)("p",{children:[(0,x.jsx)("strong",{children:"Returned By:"})," ",null===(e=h.returnedBy)||void 0===e?void 0:e.name]})]}),(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{htmlFor:"reassignTo",children:"Reassign To:"}),(0,x.jsxs)("select",{id:"reassignTo",value:f.reassignTo,onChange:e=>m(t=>(0,i.A)((0,i.A)({},t),{},{reassignTo:e.target.value})),children:[(0,x.jsx)("option",{value:"",children:"Select a staff member"}),r.map(e=>(0,x.jsxs)("option",{value:e._id,children:[e.name," (",e.email,")"]},e._id))]})]}),(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{htmlFor:"reassignReason",children:"Reason (Optional):"}),(0,x.jsx)("textarea",{id:"reassignReason",value:f.reassignReason,onChange:e=>m(t=>(0,i.A)((0,i.A)({},t),{},{reassignReason:e.target.value})),placeholder:"Enter reason for reassignment...",rows:"3"})]})]}),(0,x.jsxs)("div",{className:"modal-footer",children:[(0,x.jsx)("button",{className:"cancel-btn",onClick:()=>p(null),children:"Cancel"}),(0,x.jsx)("button",{className:"confirm-btn",onClick:async()=>{if(!h||!f.reassignTo)return u("Please select a user to reassign barrels to"),void setTimeout(()=>u(""),3e3);c(!0);try{if(!(await fetch("/api/barrels/reassign",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("token"))},body:JSON.stringify({returnId:h._id,reassignTo:f.reassignTo,reassignReason:f.reassignReason})})).ok)throw new Error("Failed to reassign barrels");u("Barrels reassigned successfully!"),p(null),m({reassignTo:"",reassignReason:""}),g()}catch(e){u("Error reassigning barrels")}finally{c(!1),setTimeout(()=>u(""),5e3)}},disabled:o||!f.reassignTo,children:o?"Reassigning...":"Reassign Barrels"})]})]})})]})},Bt=e=>{let{children:t}=e;const{isAuthenticated:a,user:n,loading:s}=y(),r=(0,w.zy)();return s?(0,x.jsx)("div",{children:"Loading..."}):a&&n?"lab"!==String(n.role||"").toLowerCase()?(0,x.jsx)(w.C5,{to:"/login",state:{from:"".concat(r.pathname).concat(r.search),reason:"lab_only"},replace:!0}):t:(0,x.jsx)(w.C5,{to:"/login",state:{from:"".concat(r.pathname).concat(r.search)},replace:!0})},Ft=()=>{var e,t,a;const s="http://localhost:5000",i="undefined"!==typeof window?localStorage.getItem("token"):null,l=(0,n.useMemo)(()=>({Authorization:"Bearer ".concat(i)}),[i]),[o,c]=(0,n.useState)(null),[d,u]=(0,n.useState)("");return(0,n.useEffect)(()=>{(async()=>{u("");try{const e=await fetch("".concat(s,"/api/lab/summary"),{headers:l});if(e.ok){const t=await e.json();c(t)}else c(null)}catch(e){u((null===e||void 0===e?void 0:e.message)||"Failed to load"),c(null)}})()},[s,l]),(0,x.jsxs)("div",{className:"lab-dashboard",children:[(0,x.jsx)("div",{className:"dashboard-header",children:(0,x.jsxs)("div",{children:[(0,x.jsx)("h1",{className:"dashboard-title",children:"Lab Dashboard"}),(0,x.jsx)("p",{className:"dashboard-subtitle",children:"Welcome back! Here's what's happening in the lab today."})]})}),d&&(0,x.jsx)("div",{className:"error-banner",children:d}),(0,x.jsxs)("div",{className:"kpi-grid",children:[(0,x.jsxs)("div",{className:"kpi-card kpi-pending",children:[(0,x.jsx)("div",{className:"kpi-icon",children:"\u23f3"}),(0,x.jsxs)("div",{className:"kpi-content",children:[(0,x.jsx)("div",{className:"kpi-label",children:"Samples Pending"}),(0,x.jsx)("div",{className:"kpi-value",children:null!==(e=null===o||void 0===o?void 0:o.pendingCount)&&void 0!==e?e:0})]})]}),(0,x.jsxs)("div",{className:"kpi-card kpi-completed",children:[(0,x.jsx)("div",{className:"kpi-icon",children:"\u2705"}),(0,x.jsxs)("div",{className:"kpi-content",children:[(0,x.jsx)("div",{className:"kpi-label",children:"Analyzed Today"}),(0,x.jsx)("div",{className:"kpi-value",children:null!==(t=null===o||void 0===o?void 0:o.doneToday)&&void 0!==t?t:0})]})]}),(0,x.jsxs)("div",{className:"kpi-card kpi-average",children:[(0,x.jsx)("div",{className:"kpi-icon",children:"\ud83d\udcca"}),(0,x.jsxs)("div",{className:"kpi-content",children:[(0,x.jsx)("div",{className:"kpi-label",children:"Avg DRC Today"}),(0,x.jsx)("div",{className:"kpi-value",children:null!==(a=null===o||void 0===o?void 0:o.avgDrcToday)&&void 0!==a?a:0})]})]})]}),(0,x.jsxs)("div",{className:"quick-actions-card",children:[(0,x.jsx)("h2",{className:"section-title",children:"Quick Actions"}),(0,x.jsxs)("div",{className:"quick-actions-grid",children:[(0,x.jsxs)(r.N_,{className:"action-button action-primary",to:"/lab/check-in",children:[(0,x.jsx)("span",{className:"action-icon",children:"\ud83d\udd2c"}),(0,x.jsx)("span",{className:"action-text",children:"Sample Check-In"})]}),(0,x.jsxs)(r.N_,{className:"action-button action-secondary",to:"/lab/drc-update",children:[(0,x.jsx)("span",{className:"action-icon",children:"\ud83d\udcdd"}),(0,x.jsx)("span",{className:"action-text",children:"Update DRC"})]}),(0,x.jsxs)(r.N_,{className:"action-button action-tertiary",to:"/lab/queue",children:[(0,x.jsx)("span",{className:"action-icon",children:"\ud83d\udccb"}),(0,x.jsx)("span",{className:"action-text",children:"View Queue"})]}),(0,x.jsxs)(r.N_,{className:"action-button action-info",to:"/lab/reports",children:[(0,x.jsx)("span",{className:"action-icon",children:"\ud83d\udcca"}),(0,x.jsx)("span",{className:"action-text",children:"Reports"})]})]})]})]})},Ot=e=>{let{children:t}=e;const a=(0,w.Zp)(),{logout:s,user:i}=y(),[l,o]=(0,n.useState)(!0),[c,d]=(0,n.useState)(!1),[u,h]=(0,n.useState)(0),[p,f]=(0,n.useState)(!1),[m,g]=(0,n.useState)([]),v=(0,n.useRef)(null),b=(0,n.useRef)(null),j="http://localhost:5000",N=localStorage.getItem("token");return(0,n.useEffect)(()=>{const e=async()=>{try{if(!N)return h(0),void g([]);const e=await fetch("".concat(j,"/api/notifications?limit=5"),{headers:{Authorization:"Bearer ".concat(N)}});if(e.ok){const t=await e.json(),a=Array.isArray(null===t||void 0===t?void 0:t.notifications)?t.notifications:Array.isArray(t)?t:[];g(a),h(Number((null===t||void 0===t?void 0:t.unread)||a.filter(e=>!e.read).length))}else h(0),g([])}catch(e){h(0),g([])}};e();const t=setInterval(e,6e4);return()=>clearInterval(t)},[j,N]),(0,n.useEffect)(()=>{const e=e=>{v.current&&!v.current.contains(e.target)&&d(!1),b.current&&!b.current.contains(e.target)&&f(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),(0,x.jsxs)("div",{className:"dashboard-container",children:[(0,x.jsxs)("aside",{className:"sidebar sidebar--flush-left ".concat(l?"":"sidebar--hidden"),children:[(0,x.jsx)("div",{className:"sidebar-header",children:"Lab"}),(0,x.jsxs)("ul",{className:"sidebar-nav",children:[(0,x.jsx)("li",{className:"nav-item",children:(0,x.jsx)(r.k2,{to:"/lab/dashboard",children:"Overview"})}),(0,x.jsx)("li",{className:"nav-item",children:(0,x.jsx)(r.k2,{to:"/lab/attendance",children:"My Attendance"})}),(0,x.jsx)("li",{className:"nav-item",children:(0,x.jsx)(r.k2,{to:"/lab/leave",children:"My Leave"})}),(0,x.jsx)("li",{className:"nav-item",children:(0,x.jsx)(r.k2,{to:"/lab/shift-schedule",children:"Shift Schedule"})}),(0,x.jsx)("li",{className:"nav-item",children:(0,x.jsx)(r.k2,{to:"/lab/check-in",children:"Sample Check-In"})}),(0,x.jsx)("li",{className:"nav-item",children:(0,x.jsx)(r.k2,{to:"/lab/drc-update",children:"DRC Test"})}),(0,x.jsx)("li",{className:"nav-item",children:(0,x.jsx)(r.k2,{to:"/lab/quality-classifier",children:"\ud83e\udd16 AI Quality Classifier"})}),(0,x.jsx)("li",{className:"nav-item",children:(0,x.jsx)(r.k2,{to:"/lab/quality-comparison",children:"\u2696\ufe0f Compare Algorithms"})}),(0,x.jsx)("li",{className:"nav-item",children:(0,x.jsx)(r.k2,{to:"/lab/chem-requests",children:"Chemical Requests"})}),(0,x.jsx)("li",{className:"nav-item",children:(0,x.jsx)(r.k2,{to:"/lab/salary",children:"My Salary"})}),(0,x.jsx)("li",{className:"nav-item",children:(0,x.jsx)(r.k2,{to:"/lab/reports",children:"Reports"})})]})]}),(0,x.jsxs)("div",{className:"main-content-wrapper",children:[(0,x.jsxs)("header",{className:"dashboard-header",children:[(0,x.jsx)("button",{className:"hamburger",onClick:()=>o(e=>!e),title:"Toggle sidebar",children:(0,x.jsx)("i",{className:"fas fa-bars"})}),(0,x.jsx)("div",{style:{marginLeft:8,fontWeight:700},children:"HFP Lab"}),(0,x.jsxs)("div",{className:"user-header-actions",style:{marginLeft:"auto"},children:[(0,x.jsxs)("div",{className:"notification-bell",ref:b,style:{position:"relative",marginRight:"16px"},children:[(0,x.jsxs)("button",{type:"button",className:"bell-button",onClick:()=>f(!p),style:{position:"relative",background:"transparent",border:"none",cursor:"pointer",padding:"8px",fontSize:"20px",color:"#333"},title:"Notifications",children:[(0,x.jsx)("i",{className:"fas fa-bell"}),u>0&&(0,x.jsx)("span",{style:{position:"absolute",top:"4px",right:"4px",backgroundColor:"#ef4444",color:"white",borderRadius:"50%",minWidth:"18px",height:"18px",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"11px",fontWeight:"bold",padding:"0 4px"},children:u>99?"99+":u})]}),p&&(0,x.jsxs)("div",{style:{position:"absolute",top:"100%",right:0,marginTop:"8px",width:"320px",maxHeight:"400px",backgroundColor:"white",borderRadius:"8px",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)",border:"1px solid #e5e7eb",zIndex:1e3,overflow:"hidden"},children:[(0,x.jsxs)("div",{style:{padding:"12px 16px",borderBottom:"1px solid #e5e7eb",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,x.jsx)("h3",{style:{margin:0,fontSize:"16px",fontWeight:"600"},children:"Notifications"}),u>0&&(0,x.jsxs)("span",{style:{backgroundColor:"#ef4444",color:"white",borderRadius:"12px",padding:"2px 8px",fontSize:"12px",fontWeight:"600"},children:[u," new"]})]}),(0,x.jsx)("div",{style:{maxHeight:"300px",overflowY:"auto"},children:0===m.length?(0,x.jsxs)("div",{style:{padding:"32px 16px",textAlign:"center",color:"#6b7280"},children:[(0,x.jsx)("i",{className:"fas fa-bell-slash",style:{fontSize:"32px",marginBottom:"8px",display:"block"}}),(0,x.jsx)("p",{style:{margin:0},children:"No notifications"})]}):m.map(e=>(0,x.jsx)("div",{style:{padding:"12px 16px",borderBottom:"1px solid #f3f4f6",backgroundColor:e.read?"white":"#eff6ff",cursor:"pointer",transition:"background-color 0.2s"},onMouseEnter:e=>e.currentTarget.style.backgroundColor="#f9fafb",onMouseLeave:t=>t.currentTarget.style.backgroundColor=e.read?"white":"#eff6ff",onClick:()=>{e.link&&a(e.link),f(!1)},children:(0,x.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"start"},children:[(0,x.jsxs)("div",{style:{flex:1},children:[(0,x.jsx)("div",{style:{fontWeight:e.read?"400":"600",fontSize:"14px",marginBottom:"4px"},children:e.title}),(0,x.jsx)("div",{style:{fontSize:"13px",color:"#6b7280"},children:e.message}),(0,x.jsx)("div",{style:{fontSize:"11px",color:"#9ca3af",marginTop:"4px"},children:new Date(e.createdAt).toLocaleString()})]}),!e.read&&(0,x.jsx)("div",{style:{width:"8px",height:"8px",borderRadius:"50%",backgroundColor:"#3b82f6",marginLeft:"8px",marginTop:"6px"}})]})},e._id))}),(0,x.jsx)("div",{style:{padding:"12px 16px",borderTop:"1px solid #e5e7eb",textAlign:"center"},children:(0,x.jsx)("button",{onClick:()=>{a("/lab/notifications"),f(!1)},style:{background:"transparent",border:"none",color:"#3b82f6",cursor:"pointer",fontSize:"14px",fontWeight:"500",padding:"4px",width:"100%"},children:"View All Notifications"})})]})]}),(0,x.jsxs)("div",{className:"profile-menu",ref:v,children:[(0,x.jsxs)("button",{type:"button",className:"profile-link",title:"Account",onClick:()=>d(e=>!e),children:[(0,x.jsx)("i",{className:"fas fa-user-circle"}),(0,x.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",marginLeft:"8px"},children:[(0,x.jsx)("span",{style:{fontWeight:"600",fontSize:"14px"},children:i&&(i.name||"Lab Staff")||"Lab Staff"}),(0,x.jsx)("span",{style:{fontSize:"12px",color:"#64748b",textTransform:"uppercase"},children:null!==i&&void 0!==i&&i.role?i.role.replace("_"," "):"Lab Staff"})]})]}),c&&(0,x.jsxs)("div",{className:"profile-dropdown",children:[(0,x.jsxs)(r.k2,{to:"/lab/dashboard",className:"dropdown-item",onClick:()=>d(!1),children:[(0,x.jsx)("i",{className:"fas fa-home"}),(0,x.jsx)("span",{children:"Dashboard"})]}),(0,x.jsxs)("button",{className:"dropdown-item",onClick:async()=>{try{await s(),a("/login")}catch(e){a("/login")}},children:[(0,x.jsx)("i",{className:"fas fa-sign-out-alt"}),(0,x.jsx)("span",{children:"Logout"})]})]})]})]})]}),(0,x.jsx)("main",{className:"dashboard-content",children:t})]})]})},qt=()=>{const e="undefined"!==typeof window?localStorage.getItem("token"):null,[t,a]=(0,n.useState)({sampleId:"",customerName:"",quantityLiters:"",receivedAt:"",notes:"",barrelCount:0}),[s,r]=(0,n.useState)([]),[l,o]=(0,n.useState)(!1),[c,d]=(0,n.useState)(""),[u,h]=(0,n.useState)(""),[p,f]=(0,n.useState)({}),m=(0,w.Zp)(),g=e=>{const{name:t,value:n}=e.target;a(e=>(0,i.A)((0,i.A)({},e),{},{[t]:n}))};(0,n.useEffect)(()=>{try{const e=new URLSearchParams(window.location.search);console.log("LabCheckIn URL params:",window.location.search),console.log("All URL params:",Object.fromEntries(e.entries()));const t=e.get("sampleId"),n=e.get("customerName"),s=e.get("barrelCount"),l=e.get("receivedAt");console.log("Parsed params:",{sampleId:t,customerName:n,barrelCount:s,receivedAt:l});const o={};t&&t.trim()&&(o.sampleId=t.trim()),n&&n.trim()&&(o.customerName=n.trim()),null!=s&&(o.barrelCount=Number(s)||0),l&&(o.receivedAt=l),Object.keys(o).length&&a(e=>(0,i.A)((0,i.A)({},e),o));const c=[];for(let a=0;e.has("barrel_".concat(a));a++){const t=e.get("barrel_".concat(a)),n=e.get("liters_".concat(a));t&&c.push({barrelId:t,liters:n?Number(n):""})}c.length&&(r(c),a(e=>(0,i.A)((0,i.A)({},e),{},{barrelCount:c.length})))}catch(e){}},[]),(0,n.useEffect)(()=>{const e=Number(t.barrelCount)||0;r(t=>{const a=[...t];if(a.length>e)return a.slice(0,e);for(;a.length<e;)a.push({barrelId:"",liters:""});return a})},[t.barrelCount]);const v=(0,n.useMemo)(()=>{var e;if(l)return!1;if(null===(e=t.sampleId)||void 0===e||!e.trim())return!1;if(!(Number(t.quantityLiters)>0))return!1;return!((Number(t.barrelCount)||0)>0&&s.some(e=>!String(e.barrelId||"").trim()))},[l,t,s]);return(0,x.jsxs)("div",{className:"dash-card",style:{padding:16},children:[(0,x.jsx)("h3",{style:{marginTop:0},children:"Sample Check-In"}),c&&(0,x.jsx)("div",{className:"success-message",children:c}),u&&(0,x.jsx)("div",{className:"error-message",children:u}),(0,x.jsxs)("form",{onSubmit:async n=>{var l;n.preventDefault(),d(""),h(""),f({});const c={};null!==(l=t.sampleId)&&void 0!==l&&l.trim()||(c.sampleId="Required");Number(t.quantityLiters)>0||(c.quantityLiters="Enter a positive quantity");if((Number(t.barrelCount)||0)>0&&s.forEach((e,t)=>{String(e.barrelId||"").trim()||(c["barrel_".concat(t)]="Barrel ID required")}),Object.keys(c).length)f(c);else try{o(!0);const n=await fetch("".concat("http://localhost:5000","/api/lab/samples/checkin"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify((0,i.A)((0,i.A)({},t),{},{barrelCount:Number(t.barrelCount)||0,barrels:s.map(e=>({barrelId:e.barrelId,liters:""!==e.liters?Number(e.liters):void 0}))}))});if(!n.ok)throw new Error("Check-in failed (".concat(n.status,")"));d("Sample checked in successfully - Redirecting to DRC test..."),a({sampleId:"",customerName:"",batch:"",quantityLiters:"",receivedAt:"",notes:"",barrelCount:0}),r([]),setTimeout(()=>{m("/lab/drc-update?sampleId=".concat(encodeURIComponent(t.sampleId)))},1e3)}catch(u){h((null===u||void 0===u?void 0:u.message)||"Failed to check in")}finally{o(!1)}},style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(240px, 1fr))",gap:12},children:[(0,x.jsxs)("label",{children:["Barrel ID",(0,x.jsx)("input",{name:"sampleId",placeholder:"Enter Barrel/Sample ID",value:t.sampleId,onChange:g,style:{borderColor:p.sampleId?"#dc3545":""}})]}),(0,x.jsxs)("label",{children:["Customer Name",(0,x.jsx)("input",{name:"customerName",placeholder:"Buyer/Customer name",value:t.customerName,onChange:g})]}),(0,x.jsxs)("label",{children:["Quantity (Liters)",(0,x.jsx)("input",{type:"number",step:"any",min:.01,name:"quantityLiters",placeholder:"e.g. 120",value:t.quantityLiters,onChange:g,style:{borderColor:p.quantityLiters?"#dc3545":""}})]}),(0,x.jsxs)("label",{children:["Received At",(0,x.jsx)("input",{type:"datetime-local",name:"receivedAt",value:t.receivedAt,onChange:g})]}),(0,x.jsxs)("label",{style:{gridColumn:"1 / -1"},children:["Notes",(0,x.jsx)("textarea",{name:"notes",placeholder:"Optional notes",value:t.notes,onChange:g,rows:3})]}),(0,x.jsxs)("div",{style:{gridColumn:"1 / -1",display:"grid",gap:8},children:[(0,x.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[(0,x.jsx)("label",{style:{margin:0},children:"No. of Barrels"}),(0,x.jsx)("input",{type:"number",min:0,name:"barrelCount",value:t.barrelCount,onChange:g,style:{width:120}})]}),s.map((e,t)=>(0,x.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[(0,x.jsxs)("span",{style:{width:80},children:["Barrel ",t+1]}),(0,x.jsx)("input",{placeholder:"Barrel ID",value:e.barrelId,onChange:e=>{const a=e.target.value;r(e=>{const n=[...e];return n[t]=(0,i.A)((0,i.A)({},n[t]),{},{barrelId:a}),n})},style:{width:220,borderColor:p["barrel_".concat(t)]?"#dc3545":""}}),(0,x.jsx)("input",{type:"number",step:"any",min:0,placeholder:"Liters (optional)",value:e.liters,onChange:e=>{const a=e.target.value;r(e=>{const n=[...e];return n[t]=(0,i.A)((0,i.A)({},n[t]),{},{liters:a}),n})},style:{width:160}})]},t))]}),(0,x.jsx)("div",{style:{gridColumn:"1 / -1"},children:(0,x.jsx)("button",{className:"btn primary",type:"submit",disabled:!v,children:l?"Saving...":"Check In"})})]})]})},zt=e=>{var t,a,s,r,i,l,o,c,d;let{s:u,onSubmit:h,saving:p}=e;const[f,m]=(0,n.useState)(""),[g,v]=(0,n.useState)((null===(t=u.user)||void 0===t?void 0:t.name)||(null===(a=u.user)||void 0===a?void 0:a.email)||""),[y,b]=(0,n.useState)(null!=u.barrelCount?String(u.barrelCount):""),j=u._id||u.id,w=((null===(s=u.user)||void 0===s?void 0:s.name)||u.userName||u.buyerName,null!==(r=null!==(i=u.quantity)&&void 0!==i?i:u.quantityLiters)&&void 0!==r?r:"-"),N=null!=u.drcPercentage?Number(u.drcPercentage).toFixed(2):"-";l=null!==(o=null!==(c=u.barrelCount)&&void 0!==c?c:null===(d=u.meta)||void 0===d?void 0:d.barrels)&&void 0!==o?o:u.barrels;return(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{children:j}),(0,x.jsx)("td",{children:(0,x.jsx)("input",{value:g,onChange:e=>v(e.target.value),placeholder:"Buyer name"})}),(0,x.jsx)("td",{children:w}),(0,x.jsx)("td",{children:N}),(0,x.jsx)("td",{children:(0,x.jsx)("input",{type:"number",min:"0",step:"1",value:y,onChange:e=>b(e.target.value),placeholder:"#",style:{width:90}})}),(0,x.jsx)("td",{children:u.status||"Testing"}),(0,x.jsx)("td",{children:(0,x.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[(0,x.jsx)("input",{type:"number",step:"any",placeholder:"DRC %",value:f,onChange:e=>m(e.target.value),style:{width:100,borderColor:f?"":"#dc3545"}}),(0,x.jsx)("button",{className:"btn",onClick:()=>h(j,f,null,{overrideBuyerName:g,barrelCount:y?Number(y):void 0}),disabled:p||!f,children:p?"Saving...":"Save"}),(0,x.jsx)("button",{className:"btn btn-success",onClick:async()=>{if(!f)return void alert("Enter DRC%");if(!g.trim())return void alert("Enter buyer name");if(window.confirm("Mark test complete and send to Accounts?")){await h(j,f,null,{overrideBuyerName:g.trim(),barrelCount:y?Number(y):void 0});try{const e="http://localhost:5000",t=localStorage.getItem("token");await fetch("".concat(e,"/api/notifications/staff-trip-event"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify({title:"DRC Test Completed",message:"Sample ".concat(j," DRC test completed by lab staff"),link:"/accountant/latex-verify",meta:{sampleId:String(j),customerName:g.trim(),drcPercentage:Number(f),barrelCount:y?Number(y):void 0,quantity:w,requestId:j},targetRole:"accountant"})})}catch(e){console.warn("Failed to notify accountant:",e)}}},disabled:p,children:p?"Submitting...":"Complete & Send to Accounts"})]})})]})},Mt=()=>{var e;const t="http://localhost:5000",a="undefined"!==typeof window?localStorage.getItem("token"):null,[s,r]=(0,n.useState)([]),[l,o]=(0,n.useState)(!1),[c,d]=(0,n.useState)(!1),[u,h]=(0,n.useState)(""),[p,f]=(0,n.useState)(""),[m,g]=(0,n.useState)(""),[v,y]=(0,n.useState)(null),[b,j]=(0,n.useState)(0),[w,N]=(0,n.useState)([]),[S,k]=(0,n.useState)({barrelId:"",buyer:"",qty:"",drc:"",barrels:""}),[A,C]=(0,n.useState)([]),_=(0,n.useMemo)(()=>({"Content-Type":"application/json",Authorization:"Bearer ".concat(a)}),[a]),L=async()=>{o(!0),h("");try{const e=await fetch("".concat(t,"/api/latex/pending-tests"),{headers:_});if(!e.ok)throw new Error("Failed to load queue (".concat(e.status,")"));const a=await e.json(),n=Array.isArray(null===a||void 0===a?void 0:a.items)?a.items:Array.isArray(a)?a:[];r(n)}catch(e){h((null===e||void 0===e?void 0:e.message)||"Failed to load"),r([])}finally{o(!1)}},T=(0,n.useMemo)(()=>{if(!S.barrelId.trim())return!1;if(!S.buyer.trim())return!1;if(!(Number(S.qty)>0))return!1;const e=Number(S.drc);return e>=0&&e<=100&&!(""!==S.barrels&&(!Number.isInteger(Number(S.barrels))||Number(S.barrels)<0))},[S]),E=async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(T){f(""),h("");try{if(e){if(!window.confirm("Create test record and send to Accounts?"))return}d(!0);const a=await fetch("".concat(t,"/api/latex/manual-test"),{method:"POST",headers:_,body:JSON.stringify({externalSampleId:S.barrelId.trim(),buyerName:S.buyer.trim(),quantityLiters:Number(S.qty),drcPercentage:Number(S.drc),barrelCount:""===S.barrels?void 0:Number(S.barrels)})});if(!a.ok)throw new Error("Create failed (".concat(a.status,")"));f("Manual DRC test recorded"),k({barrelId:"",buyer:"",qty:"",drc:"",barrels:""}),await Promise.all([L(),D()])}catch(a){h((null===a||void 0===a?void 0:a.message)||"Failed to create manual test")}finally{d(!1)}}},D=async()=>{try{const e=await fetch("".concat(t,"/api/latex/reports/drc"),{headers:_});if(!e.ok)return;const a=await e.json(),n=Array.isArray(null===a||void 0===a?void 0:a.items)?a.items:Array.isArray(a)?a:[];C(n.slice(0,50))}catch(e){}};(0,n.useEffect)(()=>{L(),D()},[]),(0,n.useEffect)(()=>{try{const e=new URLSearchParams(window.location.search),t=e.get("customer"),a=e.get("sampleId");t&&g(t),a&&console.log("Sample ID from check-in:",a)}catch(e){}},[]);const P=async function(e,a,n){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};f(""),h("");try{d(!0);const r=n&&n.length?{barrels:n.map(e=>({drc:Number(e.drc),liters:null!=e.liters&&""!==e.liters?Number(e.liters):void 0}))}:{drcPercentage:Number(a)},l=(0,i.A)((0,i.A)((0,i.A)({},r),void 0!==s.overrideBuyerName?{overrideBuyerName:s.overrideBuyerName}:{}),void 0!==s.barrelCount?{barrelCount:s.barrelCount}:{}),o=await fetch("".concat(t,"/api/latex/test/").concat(e),{method:"PUT",headers:_,body:JSON.stringify(l)});if(!o.ok)throw new Error("Update failed (".concat(o.status,")"));f("DRC updated for ".concat(e)),await L()}catch(r){h((null===r||void 0===r?void 0:r.message)||"Failed to update DRC")}finally{d(!1)}},R=(0,n.useMemo)(()=>{const e=m.trim().toLowerCase();return e?s.filter(t=>{var a;return((null===(a=t.user)||void 0===a?void 0:a.name)||"").toLowerCase().includes(e)}).slice(0,10):[]},[m,s]);return(0,n.useEffect)(()=>{const e=Number(b)||0;N(t=>{const a=[...t];if(a.length>e)return a.slice(0,e);for(;a.length<e;)a.push({drc:"",liters:""});return a})},[b]),(0,x.jsxs)("div",{className:"dash-card",style:{padding:16},children:[(0,x.jsx)("h3",{style:{marginTop:0},children:"DRC Test"}),(0,x.jsx)("p",{style:{color:"#64748b"},children:"Record Dry Rubber Content for samples currently under testing."}),p&&(0,x.jsx)("div",{className:"success-message",children:p}),u&&(0,x.jsx)("div",{className:"error-message",children:u}),(0,x.jsxs)("div",{style:{display:"grid",gap:8,marginBottom:12,background:"#F9FAFB",border:"1px solid #E5E7EB",borderRadius:6,padding:10},children:[(0,x.jsx)("div",{style:{fontWeight:600},children:"Manual Entry"}),(0,x.jsxs)("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[(0,x.jsx)("input",{placeholder:"Barrel/Sample ID",value:S.barrelId,onChange:e=>k(t=>(0,i.A)((0,i.A)({},t),{},{barrelId:e.target.value})),style:{width:180,borderColor:!S.barrelId&&"#dc3545"}}),(0,x.jsx)("input",{placeholder:"Buyer name",value:S.buyer,onChange:e=>k(t=>(0,i.A)((0,i.A)({},t),{},{buyer:e.target.value})),style:{width:220,borderColor:!S.buyer&&"#dc3545"}}),(0,x.jsx)("input",{type:"number",step:"any",min:.01,placeholder:"Qty (L)",value:S.qty,onChange:e=>k(t=>(0,i.A)((0,i.A)({},t),{},{qty:e.target.value})),style:{width:140}}),(0,x.jsx)("input",{type:"number",step:"any",min:0,max:100,placeholder:"DRC %",value:S.drc,onChange:e=>k(t=>(0,i.A)((0,i.A)({},t),{},{drc:e.target.value})),style:{width:120}}),(0,x.jsx)("input",{type:"number",step:"1",min:0,placeholder:"# Barrels (opt)",value:S.barrels,onChange:e=>k(t=>(0,i.A)((0,i.A)({},t),{},{barrels:e.target.value})),style:{width:160}}),(0,x.jsx)("button",{className:"btn",type:"button",disabled:!T||c,onClick:()=>E(!1),children:c?"Saving...":"Save"}),(0,x.jsx)("button",{className:"btn btn-success",type:"button",disabled:!T||c,onClick:async()=>{await E(!0);try{const e="http://localhost:5000",t=localStorage.getItem("token");await fetch("".concat(e,"/api/notifications/staff-trip-event"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify({title:"DRC Test Completed",message:"Manual sample ".concat(S.barrelId.trim()," DRC test completed by lab staff"),link:"/accountant/latex-verify",meta:{sampleId:S.barrelId.trim(),customerName:S.buyer.trim(),drcPercentage:Number(S.drc),barrelCount:""===S.barrels?void 0:Number(S.barrels),quantity:Number(S.qty),requestId:S.barrelId.trim()},targetRole:"accountant"})})}catch(e){console.warn("Failed to notify accountant:",e)}},children:c?"Submitting...":"Complete & Send"})]})]}),(0,x.jsxs)("div",{style:{display:"grid",gap:8,marginBottom:12},children:[(0,x.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[(0,x.jsx)("input",{placeholder:"Search Customer Name",value:m,onChange:e=>g(e.target.value),style:{width:260}}),(0,x.jsx)("button",{type:"button",className:"btn",onClick:()=>g(m),disabled:l,children:"Find"}),v&&(0,x.jsxs)("span",{style:{color:"#059669"},children:["Selected: ",v._id]})]}),!!m&&!v&&R.length>0&&(0,x.jsx)("div",{style:{background:"#f9fafb",border:"1px solid #e5e7eb",borderRadius:6,padding:8},children:R.map(e=>{var t,a,n;return(0,x.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",padding:"6px 0",borderBottom:"1px dashed #eee"},children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("div",{style:{fontWeight:600},children:null===(t=e.user)||void 0===t?void 0:t.name}),(0,x.jsxs)("div",{style:{fontSize:12,color:"#6b7280"},children:["Qty: ",null!==(a=null!==(n=e.quantity)&&void 0!==n?n:e.quantityLiters)&&void 0!==a?a:"-"," \u2022 ID: ",e._id]})]}),(0,x.jsx)("button",{className:"btn",type:"button",onClick:()=>(e=>{var t;y(e),g((null===(t=e.user)||void 0===t?void 0:t.name)||"")})(e),disabled:c,children:"Select"})]},e._id)})}),!!m&&!v&&0===R.length&&!l&&(0,x.jsx)("div",{style:{color:"#6b7280"},children:"No matching customers found."}),v&&(0,x.jsxs)("div",{style:{display:"grid",gap:8},children:[(0,x.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[(0,x.jsx)("input",{type:"number",min:0,placeholder:"# Barrels",value:b,onChange:e=>j(e.target.value),style:{width:140}}),(0,x.jsxs)("span",{style:{color:"#6b7280"},children:["Enter DRC for each barrel"," (customer: ".concat((null===(e=v.user)||void 0===e?void 0:e.name)||"-",")")]})]}),w.map((e,t)=>(0,x.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[(0,x.jsxs)("span",{style:{width:70},children:["Barrel ",t+1]}),(0,x.jsx)("input",{type:"number",step:"any",placeholder:"DRC %",value:e.drc,onChange:e=>{const a=e.target.value;N(e=>{const n=[...e];return n[t]=(0,i.A)((0,i.A)({},n[t]),{},{drc:a}),n})},style:{width:120,borderColor:e.drc||0===e.drc?"":"#dc3545"}}),(0,x.jsx)("input",{type:"number",step:"any",placeholder:"Liters (optional)",value:e.liters,onChange:e=>{const a=e.target.value;N(e=>{const n=[...e];return n[t]=(0,i.A)((0,i.A)({},n[t]),{},{liters:a}),n})},style:{width:160}})]},t)),(0,x.jsx)("div",{children:(0,x.jsx)("button",{className:"btn",type:"button",disabled:c||!v||0===w.length||w.some(e=>!e.drc),onClick:async()=>{await P(v._id,null,w),y(null),g(""),j(0),N([])},children:c?"Saving...":"Save"})})]})]}),l?(0,x.jsx)("div",{children:"Loading..."}):(0,x.jsx)("div",{style:{overflowX:"auto"},children:(0,x.jsxs)("table",{className:"dashboard-table",style:{minWidth:840},children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{children:"Request ID"}),(0,x.jsx)("th",{children:"Buyer"}),(0,x.jsx)("th",{children:"Qty (L)"}),(0,x.jsx)("th",{children:"DRC (%)"}),(0,x.jsx)("th",{children:"Barrels"}),(0,x.jsx)("th",{children:"Status"}),(0,x.jsx)("th",{children:"Action"})]})}),(0,x.jsx)("tbody",{children:s.length?s.map((e,t)=>(0,x.jsx)(zt,{s:e,onSubmit:P,saving:c},t)):(0,x.jsx)("tr",{children:(0,x.jsx)("td",{colSpan:7,style:{color:"#6b7280",textAlign:"center",padding:12},children:"No pending samples."})})})]})}),(0,x.jsxs)("div",{style:{marginTop:16},children:[(0,x.jsx)("h4",{style:{margin:"8px 0"},children:"Recent DRC History"}),(0,x.jsx)("div",{style:{overflowX:"auto"},children:(0,x.jsxs)("table",{className:"dashboard-table",style:{minWidth:820},children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{children:"Date"}),(0,x.jsx)("th",{children:"Sample ID"}),(0,x.jsx)("th",{children:"Supplier"}),(0,x.jsx)("th",{children:"Batch"}),(0,x.jsx)("th",{children:"Qty (L)"}),(0,x.jsx)("th",{children:"DRC %"})]})}),(0,x.jsx)("tbody",{children:A.length?A.map((e,t)=>{var a,n;return(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{children:e.analyzedAt?new Date(e.analyzedAt).toLocaleDateString():"-"}),(0,x.jsx)("td",{children:e.sampleId||"-"}),(0,x.jsx)("td",{children:e.supplier||"-"}),(0,x.jsx)("td",{children:e.batch||"-"}),(0,x.jsx)("td",{children:null!==(a=e.quantityLiters)&&void 0!==a?a:"-"}),(0,x.jsx)("td",{children:null!==(n=e.drc)&&void 0!==n?n:"-"})]},t)}):(0,x.jsx)("tr",{children:(0,x.jsx)("td",{colSpan:6,style:{color:"#9aa"},children:"No recent history"})})})]})})]})]})},Ut=()=>{const e="http://localhost:5000",t="undefined"!==typeof window?localStorage.getItem("token"):null,a=(0,n.useMemo)(()=>({Authorization:"Bearer ".concat(t)}),[t]),[s,r]=(0,n.useState)([]),[i,l]=(0,n.useState)([]),[o,c]=(0,n.useState)(!1),[d,u]=(0,n.useState)("");return(0,n.useEffect)(()=>{(async()=>{c(!0),u("");try{const[t,n]=await Promise.all([fetch("".concat(e,"/api/lab/samples/pending"),{headers:a}),fetch("".concat(e,"/api/lab/samples/today"),{headers:a})]),s=t.ok?await t.json():[],i=n.ok?await n.json():[];r(Array.isArray(s)?s:Array.isArray(null===s||void 0===s?void 0:s.items)?s.items:[]),l(Array.isArray(i)?i:Array.isArray(null===i||void 0===i?void 0:i.items)?i.items:[])}catch(t){u((null===t||void 0===t?void 0:t.message)||"Failed to load"),r([]),l([])}finally{c(!1)}})()},[]),(0,x.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr",gap:16},children:[(0,x.jsxs)("div",{className:"dash-card",style:{padding:16},children:[(0,x.jsx)("h3",{style:{marginTop:0},children:"Queue / Worklist"}),(0,x.jsx)("p",{style:{color:"#64748b"},children:"Samples pending analysis"}),d&&(0,x.jsx)("div",{className:"error-message",children:d}),o?(0,x.jsx)("div",{children:"Loading..."}):(0,x.jsx)("div",{style:{overflowX:"auto"},children:(0,x.jsxs)("table",{className:"dashboard-table",style:{minWidth:640},children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{children:"Sample ID"}),(0,x.jsx)("th",{children:"Supplier"}),(0,x.jsx)("th",{children:"Batch"}),(0,x.jsx)("th",{children:"Qty (L)"}),(0,x.jsx)("th",{children:"Received"})]})}),(0,x.jsx)("tbody",{children:s.length?s.map((e,t)=>{var a;return(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{children:e.sampleId||"-"}),(0,x.jsx)("td",{children:e.supplier||"-"}),(0,x.jsx)("td",{children:e.batch||"-"}),(0,x.jsx)("td",{children:null!==(a=e.quantityLiters)&&void 0!==a?a:"-"}),(0,x.jsx)("td",{children:e.receivedAt?new Date(e.receivedAt).toLocaleString():"-"})]},t)}):(0,x.jsx)("tr",{children:(0,x.jsx)("td",{colSpan:5,style:{color:"#9aa"},children:"Queue is empty"})})})]})})]}),(0,x.jsxs)("div",{className:"dash-card",style:{padding:16},children:[(0,x.jsx)("h3",{style:{marginTop:0},children:"Samples Analyzed Today"}),o?(0,x.jsx)("div",{children:"Loading..."}):(0,x.jsx)("div",{style:{overflowX:"auto"},children:(0,x.jsxs)("table",{className:"dashboard-table",style:{minWidth:640},children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{children:"Sample ID"}),(0,x.jsx)("th",{children:"DRC %"}),(0,x.jsx)("th",{children:"Analyzed At"})]})}),(0,x.jsx)("tbody",{children:i.length?i.map((e,t)=>{var a;return(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{children:e.sampleId||"-"}),(0,x.jsx)("td",{children:null!==(a=e.drc)&&void 0!==a?a:"-"}),(0,x.jsx)("td",{children:e.analyzedAt?new Date(e.analyzedAt).toLocaleString():"-"})]},t)}):(0,x.jsx)("tr",{children:(0,x.jsx)("td",{colSpan:3,style:{color:"#9aa"},children:"No samples analyzed yet"})})})]})})]})]})},Wt=()=>{const e="undefined"!==typeof window?localStorage.getItem("token"):null,t=(0,n.useMemo)(()=>({Authorization:"Bearer ".concat(e)}),[e]),[a,s]=(0,n.useState)(""),[r,l]=(0,n.useState)(""),[o,c]=(0,n.useState)([]),[d,u]=(0,n.useState)(!1),[h,p]=(0,n.useState)(""),[f,m]=(0,n.useState)(!1),[g,v]=(0,n.useState)({date:"",sampleId:"",supplier:"",drc:"",barrels:""});(0,n.useEffect)(()=>{},[]);return(0,x.jsxs)("div",{className:"lab-dashboard",style:{position:"relative"},children:[(0,x.jsxs)("div",{className:"dashboard-header",style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("h1",{className:"dashboard-title",children:"Reports"}),(0,x.jsx)("p",{className:"dashboard-subtitle",children:"Generate and manage lab analysis reports."})]}),(0,x.jsxs)("button",{className:"btn-secondary",style:{display:"flex",alignItems:"center",gap:"8px"},onClick:()=>m(!0),children:[(0,x.jsx)("i",{className:"fas fa-plus"})," Add"]})]}),h&&(0,x.jsx)("div",{className:"error-banner",children:h}),(0,x.jsxs)("div",{className:"dash-card",style:{background:"white",borderRadius:"16px",padding:"24px",boxShadow:"0 4px 6px -1px rgba(0,0,0,0.05)",marginBottom:"24px"},children:[(0,x.jsx)("h2",{className:"section-title",style:{fontSize:"18px",marginBottom:"16px",borderBottom:"1px solid #e2e8f0",paddingBottom:"12px"},children:"Report Configuration"}),(0,x.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",gap:"20px",alignItems:"end"},children:[(0,x.jsxs)("div",{style:{display:"flex",border:"1px solid #e2e8f0",borderRadius:"8px",overflow:"hidden"},children:[(0,x.jsx)("div",{style:{background:"#f8fafc",padding:"10px 16px",borderRight:"1px solid #e2e8f0",color:"#64748b",fontWeight:"500",display:"flex",alignItems:"center"},children:"From Date"}),(0,x.jsx)("input",{type:"date",value:a,onChange:e=>s(e.target.value),style:{border:"none",padding:"10px 16px",outline:"none",width:"100%",color:"#1e293b"}})]}),(0,x.jsxs)("div",{style:{display:"flex",border:"1px solid #e2e8f0",borderRadius:"8px",overflow:"hidden"},children:[(0,x.jsx)("div",{style:{background:"#f8fafc",padding:"10px 16px",borderRight:"1px solid #e2e8f0",color:"#64748b",fontWeight:"500",display:"flex",alignItems:"center"},children:"To Date"}),(0,x.jsx)("input",{type:"date",value:r,onChange:e=>l(e.target.value),style:{border:"none",padding:"10px 16px",outline:"none",width:"100%",color:"#1e293b"}})]}),(0,x.jsx)("button",{className:"action-button action-primary",onClick:async()=>{u(!0),p("");try{const e=new URLSearchParams;a&&e.set("from",a),r&&e.set("to",r);const n=await fetch("".concat("http://localhost:5000","/api/latex/reports/drc?").concat(e.toString()),{headers:t});if(!n.ok)throw new Error("Report failed (".concat(n.status,")"));const s=await n.json();c(Array.isArray(s)?s:Array.isArray(null===s||void 0===s?void 0:s.items)?s.items:[])}catch(e){p((null===e||void 0===e?void 0:e.message)||"Failed to load report"),c([])}finally{u(!1)}},disabled:d,style:{border:"none",cursor:"pointer",justifyContent:"center",height:"42px"},children:d?(0,x.jsxs)("span",{children:[(0,x.jsx)("i",{className:"fas fa-spinner fa-spin"})," Processing..."]}):(0,x.jsx)("span",{children:"Click Me"})})]})]}),(0,x.jsxs)("div",{className:"dash-card",style:{background:"white",borderRadius:"16px",padding:"24px",boxShadow:"0 4px 6px -1px rgba(0,0,0,0.05)",overflow:"hidden"},children:[(0,x.jsx)("h3",{className:"section-title",style:{fontSize:"18px",marginBottom:"16px"},children:"Generated Results"}),(0,x.jsx)("div",{style:{overflowX:"auto"},children:(0,x.jsxs)("table",{className:"table",style:{width:"100%",borderCollapse:"separate",borderSpacing:"0"},children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{style:{background:"#f8fafc"},children:[(0,x.jsx)("th",{style:{padding:"12px 16px",textAlign:"left",color:"#64748b",fontWeight:"600",fontSize:"13px",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Date"}),(0,x.jsx)("th",{style:{padding:"12px 16px",textAlign:"left",color:"#64748b",fontWeight:"600",fontSize:"13px",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Sample ID"}),(0,x.jsx)("th",{style:{padding:"12px 16px",textAlign:"left",color:"#64748b",fontWeight:"600",fontSize:"13px",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Supplier"}),(0,x.jsx)("th",{style:{padding:"12px 16px",textAlign:"left",color:"#64748b",fontWeight:"600",fontSize:"13px",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Batch"}),(0,x.jsx)("th",{style:{padding:"12px 16px",textAlign:"left",color:"#64748b",fontWeight:"600",fontSize:"13px",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Qty (L)"}),(0,x.jsx)("th",{style:{padding:"12px 16px",textAlign:"left",color:"#64748b",fontWeight:"600",fontSize:"13px",textTransform:"uppercase",letterSpacing:"0.5px"},children:"DRC %"})]})}),(0,x.jsx)("tbody",{children:o.length?o.map((e,t)=>{var a;return(0,x.jsxs)("tr",{style:{borderBottom:"1px solid #f1f5f9"},children:[(0,x.jsx)("td",{style:{padding:"14px 16px",borderTop:"1px solid #f1f5f9",color:"#334155"},children:e.analyzedAt?new Date(e.analyzedAt).toLocaleDateString():"-"}),(0,x.jsx)("td",{style:{padding:"14px 16px",borderTop:"1px solid #f1f5f9",fontWeight:"500",color:"#0f172a"},children:e.sampleId||"-"}),(0,x.jsx)("td",{style:{padding:"14px 16px",borderTop:"1px solid #f1f5f9",color:"#64748b"},children:e.supplier||"-"}),(0,x.jsx)("td",{style:{padding:"14px 16px",borderTop:"1px solid #f1f5f9"},children:(0,x.jsx)("span",{className:"badge",style:{background:"#f1f5f9",color:"#475569",padding:"4px 8px",borderRadius:"4px",fontSize:"12px"},children:e.batch||"-"})}),(0,x.jsx)("td",{style:{padding:"14px 16px",borderTop:"1px solid #f1f5f9",fontWeight:"600",color:"#334155"},children:null!==(a=e.quantityLiters)&&void 0!==a?a:"-"}),(0,x.jsx)("td",{style:{padding:"14px 16px",borderTop:"1px solid #f1f5f9"},children:e.drc?(0,x.jsxs)("span",{style:{color:e.drc>30?"#16a34a":"#ea580c",fontWeight:"700"},children:[e.drc,"%"]}):"-"})]},t)}):(0,x.jsx)("tr",{children:(0,x.jsxs)("td",{colSpan:6,style:{padding:"40px",textAlign:"center",color:"#94a3b8"},children:[(0,x.jsx)("div",{style:{fontSize:"48px",marginBottom:"16px",opacity:.5},children:"\ud83d\udcca"}),(0,x.jsx)("div",{children:"No data found for the selected range"})]})})})]})})]}),f&&(0,x.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:(0,x.jsxs)("div",{style:{background:"white",padding:"24px",borderRadius:"16px",width:"100%",maxWidth:"400px",maxHeight:"90vh",overflowY:"auto",boxShadow:"0 20px 25px -5px rgba(0,0,0,0.1)"},children:[(0,x.jsx)("h3",{style:{margin:"0 0 20px 0",fontSize:"20px",color:"#1e293b"},children:"Create New Report"}),(0,x.jsxs)("div",{style:{marginBottom:"16px"},children:[(0,x.jsx)("label",{style:{display:"block",marginBottom:"8px",color:"#64748b",fontSize:"14px",fontWeight:"500"},children:"Date"}),(0,x.jsx)("input",{type:"date",value:g.date,onChange:e=>v((0,i.A)((0,i.A)({},g),{},{date:e.target.value})),style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1px solid #e2e8f0",outline:"none"}})]}),(0,x.jsxs)("div",{style:{marginBottom:"16px"},children:[(0,x.jsx)("label",{style:{display:"block",marginBottom:"8px",color:"#64748b",fontSize:"14px",fontWeight:"500"},children:"Sample ID"}),(0,x.jsx)("input",{type:"text",placeholder:"Enter Sample ID",value:g.sampleId,onChange:e=>v((0,i.A)((0,i.A)({},g),{},{sampleId:e.target.value})),style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1px solid #e2e8f0",outline:"none"}})]}),(0,x.jsxs)("div",{style:{marginBottom:"16px"},children:[(0,x.jsx)("label",{style:{display:"block",marginBottom:"8px",color:"#64748b",fontSize:"14px",fontWeight:"500"},children:"Supplier Name"}),(0,x.jsx)("input",{type:"text",placeholder:"Enter Supplier Name",value:g.supplier,onChange:e=>v((0,i.A)((0,i.A)({},g),{},{supplier:e.target.value})),style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1px solid #e2e8f0",outline:"none"}})]}),(0,x.jsxs)("div",{style:{marginBottom:"16px"},children:[(0,x.jsx)("label",{style:{display:"block",marginBottom:"8px",color:"#64748b",fontSize:"14px",fontWeight:"500"},children:"DRC %"}),(0,x.jsx)("input",{type:"number",placeholder:"Enter DRC Rate",value:g.drc,onChange:e=>v((0,i.A)((0,i.A)({},g),{},{drc:e.target.value})),style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1px solid #e2e8f0",outline:"none"}})]}),(0,x.jsxs)("div",{style:{marginBottom:"24px"},children:[(0,x.jsx)("label",{style:{display:"block",marginBottom:"8px",color:"#64748b",fontSize:"14px",fontWeight:"500"},children:"Number of Barrels"}),(0,x.jsx)("input",{type:"number",placeholder:"Enter Number of Barrels",value:g.barrels,onChange:e=>v((0,i.A)((0,i.A)({},g),{},{barrels:e.target.value})),style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1px solid #e2e8f0",outline:"none"}})]}),(0,x.jsxs)("div",{style:{display:"flex",gap:"12px",justifyContent:"flex-end"},children:[(0,x.jsx)("button",{onClick:()=>m(!1),style:{padding:"10px 20px",borderRadius:"8px",border:"1px solid #e2e8f0",background:"white",cursor:"pointer",fontWeight:"500",color:"#64748b"},children:"Cancel"}),(0,x.jsx)("button",{onClick:async()=>{console.log("Creating Report",g),m(!1),alert("Report Created (Simulation)")},style:{padding:"10px 20px",borderRadius:"8px",border:"none",background:"linear-gradient(135deg, #0f766e 0%, #14b8a6 100%)",cursor:"pointer",fontWeight:"600",color:"white"},children:"Create"})]})]})})]})},Ht=()=>{const e="http://localhost:5000",t=localStorage.getItem("token"),[a,s]=(0,n.useState)({leaveType:"casual",dayType:"full",startDate:"",endDate:"",reason:""}),[r,l]=(0,n.useState)([]),[o,c]=(0,n.useState)(!0),[d,u]=(0,n.useState)(!1),[h,p]=(0,n.useState)(""),[f,m]=(0,n.useState)({}),[g,v]=(0,n.useState)(!1),y=(new Date).toISOString().split("T")[0],b=new Date;b.setFullYear(b.getFullYear()+2);const j=b.toISOString().split("T")[0],w=async()=>{try{c(!0);const a=await fetch("".concat(e,"/api/leave/my-leaves"),{headers:{Authorization:"Bearer ".concat(t)}});if(a.ok){const e=await a.json(),t=Array.isArray(null===e||void 0===e?void 0:e.items)?e.items:Array.isArray(null===e||void 0===e?void 0:e.records)?e.records:Array.isArray(e)?e:[];l(t)}else l([])}finally{c(!1)}};(0,n.useEffect)(()=>{w()},[]);return(0,x.jsxs)("div",{style:{padding:16},children:[(0,x.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[(0,x.jsx)("h2",{style:{margin:0},children:"Lab Leave Management"}),(0,x.jsx)("button",{className:"btn btn-outline-primary",onClick:()=>v(!0),children:"\ud83d\udccb View Leave History"})]}),h&&(0,x.jsx)("div",{style:{color:"crimson",marginTop:8},children:h}),(0,x.jsxs)("form",{onSubmit:async n=>{if(n.preventDefault(),p(""),m({}),(()=>{const e={},t=new Date;if(t.setHours(0,0,0,0),a.startDate){const n=new Date(a.startDate);n<t&&(e.startDate="Start date cannot be in the past");const s=new Date;s.setFullYear(s.getFullYear()+2),n>s&&(e.startDate="Start date too far in future")}else e.startDate="Start date is required";if(a.endDate){const n=new Date(a.endDate);n<t&&(e.endDate="End date cannot be in the past");const s=new Date;s.setFullYear(s.getFullYear()+2),n>s&&(e.endDate="End date too far in future")}else e.endDate="End date is required";if(a.startDate&&a.endDate){const t=new Date(a.startDate);new Date(a.endDate)<t&&(e.endDate="End date cannot be earlier than start date")}return m(e),0===Object.keys(e).length})())try{u(!0);const n=await fetch("".concat(e,"/api/leave/apply"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify(a)});if(n.ok)s({leaveType:"casual",dayType:"full",startDate:"",endDate:"",reason:""}),await w();else{const e=await n.json().catch(()=>({}));p(e.message||"Failed to apply leave")}}catch(r){p("Failed to apply leave. Please try again.")}finally{u(!1)}},style:{maxWidth:640,marginTop:12},children:[(0,x.jsxs)("div",{className:"form-row",style:{display:"flex",gap:12},children:[(0,x.jsxs)("div",{className:"form-group",style:{flex:1},children:[(0,x.jsx)("label",{children:"Leave Type"}),(0,x.jsxs)("select",{className:"form-control",value:a.leaveType,onChange:e=>s((0,i.A)((0,i.A)({},a),{},{leaveType:e.target.value})),children:[(0,x.jsx)("option",{value:"casual",children:"Casual"}),(0,x.jsx)("option",{value:"sick",children:"Sick"}),(0,x.jsx)("option",{value:"earned",children:"Earned"})]})]}),(0,x.jsxs)("div",{className:"form-group",style:{flex:1},children:[(0,x.jsx)("label",{children:"Day Type"}),(0,x.jsxs)("select",{className:"form-control",value:a.dayType,onChange:e=>s((0,i.A)((0,i.A)({},a),{},{dayType:e.target.value})),children:[(0,x.jsx)("option",{value:"full",children:"Full Day"}),(0,x.jsx)("option",{value:"half",children:"Half Day"})]})]}),(0,x.jsxs)("div",{className:"form-group",style:{flex:1},children:[(0,x.jsx)("label",{children:"Start Date *"}),(0,x.jsx)("input",{type:"date",className:"form-control",value:a.startDate,min:y,max:j,onChange:e=>{const t=e.target.value;s(e=>{let a=e.endDate;return a&&t&&new Date(a)<new Date(t)&&(a=t),(0,i.A)((0,i.A)({},e),{},{startDate:t,endDate:a})}),f.startDate&&m(e=>(0,i.A)((0,i.A)({},e),{},{startDate:""}))},style:{borderColor:f.startDate?"#dc3545":""}}),f.startDate&&(0,x.jsx)("div",{style:{color:"#dc3545",fontSize:12},children:f.startDate})]}),(0,x.jsxs)("div",{className:"form-group",style:{flex:1},children:[(0,x.jsx)("label",{children:"End Date *"}),(0,x.jsx)("input",{type:"date",className:"form-control",value:a.endDate,min:a.startDate||y,max:j,onChange:e=>{s(t=>(0,i.A)((0,i.A)({},t),{},{endDate:e.target.value})),f.endDate&&m(e=>(0,i.A)((0,i.A)({},e),{},{endDate:""}))},style:{borderColor:f.endDate?"#dc3545":""}}),f.endDate&&(0,x.jsx)("div",{style:{color:"#dc3545",fontSize:12},children:f.endDate})]})]}),(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{children:"Reason"}),(0,x.jsx)("textarea",{className:"form-control",value:a.reason,onChange:e=>s((0,i.A)((0,i.A)({},a),{},{reason:e.target.value}))})]}),(0,x.jsx)("button",{className:"btn btn-primary",type:"submit",disabled:d,children:d?"Submitting...":"Apply"})]}),(0,x.jsxs)("div",{style:{marginTop:24},children:[(0,x.jsx)("h4",{children:"My Leave Requests"}),o?(0,x.jsx)("div",{children:"Loading..."}):(0,x.jsxs)("table",{className:"table table-sm",children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{children:"Type"}),(0,x.jsx)("th",{children:"Start"}),(0,x.jsx)("th",{children:"End"}),(0,x.jsx)("th",{children:"Day Type"}),(0,x.jsx)("th",{children:"Status"}),(0,x.jsx)("th",{children:"Actions"})]})}),(0,x.jsxs)("tbody",{children:[(Array.isArray(r)?r:[]).map(a=>(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{children:a.leaveType}),(0,x.jsx)("td",{children:a.startDate?new Date(a.startDate).toLocaleDateString():"-"}),(0,x.jsx)("td",{children:a.endDate?new Date(a.endDate).toLocaleDateString():"-"}),(0,x.jsx)("td",{children:a.dayType||"full"}),(0,x.jsx)("td",{children:a.status}),(0,x.jsx)("td",{children:"pending"===a.status&&(0,x.jsx)("button",{className:"btn btn-sm btn-outline-danger",onClick:()=>(async a=>{await fetch("".concat(e,"/api/leave/cancel/").concat(a),{method:"DELETE",headers:{Authorization:"Bearer ".concat(t)}}),await w()})(a._id),children:"Cancel"})})]},a._id)),Array.isArray(r)&&0===r.length&&(0,x.jsx)("tr",{children:(0,x.jsx)("td",{colSpan:5,children:"No leave requests"})})]})]})]}),(0,x.jsx)(me,{isOpen:g,onClose:()=>v(!1)})]})},Vt=()=>{const[e,t]=(0,n.useState)(null),[a,s]=(0,n.useState)(!0),[r,i]=(0,n.useState)(""),l="http://localhost:5000",o="undefined"!==typeof window?localStorage.getItem("token"):null,c=(0,n.useCallback)(async()=>{try{s(!0),i("");const e="".concat(l,"/api/workers/lab/shift-schedule"),a=await fetch(e,{headers:{Authorization:"Bearer ".concat(o)}}),n=(a.headers.get("content-type")||"").includes("application/json")?await a.json():null;a.ok?t(n):i(n&&n.message||"Failed to load shift schedule (".concat(a.status,")"))}catch(e){i((null===e||void 0===e?void 0:e.message)||"Failed to load shift schedule")}finally{s(!1)}},[l,o]);(0,n.useEffect)(()=>{c()},[c]);if(a)return(0,x.jsx)("div",{className:"staff-shift-schedule",children:(0,x.jsx)("div",{className:"loading",children:"Loading shift schedule..."})});if(r)return(0,x.jsxs)("div",{className:"staff-shift-schedule",children:[(0,x.jsx)("div",{className:"header",children:(0,x.jsx)("h2",{children:"My Lab Shift Schedule"})}),(0,x.jsx)("div",{className:"error",style:{marginTop:8},children:r}),(0,x.jsxs)("div",{className:"no-schedule",style:{marginTop:12},children:[(0,x.jsx)("h3",{children:"No schedule available"}),(0,x.jsxs)("p",{children:["Ask your manager to create Lab Staff shifts in ",(0,x.jsx)("code",{children:"/manager/shifts"})," with Target Group = Lab."]}),(0,x.jsx)("button",{onClick:c,className:"retry-btn",style:{marginTop:8},children:"Retry"})]})]});const d=e&&e.morningStart||"09:00",u=e&&e.morningEnd||"17:00",h=e&&e.eveningStart||"17:00",p=e&&e.eveningEnd||"17:00",f=e&&e.myAssignment||{shiftType:"Morning",startTime:d,endTime:u};return(0,x.jsxs)("div",{className:"staff-shift-schedule",children:[(0,x.jsxs)("div",{className:"header",children:[(0,x.jsx)("h2",{children:"My Lab Shift Schedule"}),(0,x.jsxs)("button",{onClick:c,className:"refresh-btn",children:[(0,x.jsx)("i",{className:"fas fa-sync-alt"})," Refresh"]})]}),(0,x.jsxs)("div",{className:"schedule-content",children:[(0,x.jsxs)("div",{className:"week-info",children:[(0,x.jsxs)("h3",{children:["Week of ",(m=e&&e.weekStart||new Date,new Date(m).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}))]}),(0,x.jsx)("div",{className:"week-dates",children:(e=>{const t=new Date(e),a=[];for(let n=0;n<7;n++){const e=new Date(t);e.setDate(t.getDate()+n),a.push(e)}return a})(e&&e.weekStart||new Date).map((e,t)=>(0,x.jsxs)("div",{className:"day ".concat(e.toDateString()===(new Date).toDateString()?"today":""),children:[(0,x.jsx)("div",{className:"day-name",children:e.toLocaleDateString("en-US",{weekday:"short"})}),(0,x.jsx)("div",{className:"day-number",children:e.getDate()})]},t))})]}),(0,x.jsxs)("div",{className:"my-assignment",children:[(0,x.jsx)("h3",{children:"My Shift Assignment"}),(0,x.jsxs)("div",{className:"assignment-card",children:[(0,x.jsxs)("div",{className:"shift-type",children:[(0,x.jsx)("i",{className:"fas ".concat("Morning"===f.shiftType?"fa-sun":"fa-moon")}),(0,x.jsxs)("span",{className:"shift-name",children:[f.shiftType," Shift"]})]}),(0,x.jsxs)("div",{className:"shift-times",children:[(0,x.jsxs)("div",{className:"time-slot",children:[(0,x.jsx)("span",{className:"time-label",children:"Start Time:"}),(0,x.jsx)("span",{className:"time-value",children:f.startTime||d})]}),(0,x.jsxs)("div",{className:"time-slot",children:[(0,x.jsx)("span",{className:"time-label",children:"End Time:"}),(0,x.jsx)("span",{className:"time-value",children:f.endTime||u})]})]})]})]}),(0,x.jsxs)("div",{className:"all-shifts",children:[(0,x.jsx)("h3",{children:"All Shift Times This Week"}),(0,x.jsxs)("div",{className:"shifts-grid",children:[(0,x.jsxs)("div",{className:"shift-info",children:[(0,x.jsxs)("div",{className:"shift-header",children:[(0,x.jsx)("i",{className:"fas fa-sun"}),(0,x.jsx)("span",{children:"Morning Shift"})]}),(0,x.jsxs)("div",{className:"shift-time",children:[d," - ",u]})]}),(0,x.jsxs)("div",{className:"shift-info",children:[(0,x.jsxs)("div",{className:"shift-header",children:[(0,x.jsx)("i",{className:"fas fa-moon"}),(0,x.jsx)("span",{children:"Evening Shift"})]}),(0,x.jsxs)("div",{className:"shift-time",children:[h," - ",p]})]})]})]})]})]});var m},Gt=()=>{var e,t,s;const r="http://localhost:5000",i="undefined"!==typeof window?localStorage.getItem("token"):null,l=(0,n.useMemo)(()=>{try{return JSON.parse(localStorage.getItem("user")||"{}")}catch(e){return{}}},[]),o=new Date,[c,d]=(0,n.useState)(o.getFullYear()),[u,h]=(0,n.useState)(o.getMonth()+1),[p,f]=(0,n.useState)(null),[m,g]=(0,n.useState)(!1),[v,y]=(0,n.useState)(""),b=(0,n.useCallback)(async()=>{if(null!==l&&void 0!==l&&l._id){g(!0),y(""),f(null);try{const e=await fetch("".concat(r,"/api/salary/history/").concat(l._id,"?year=").concat(c,"&limit=12"),{headers:{Authorization:"Bearer ".concat(i)},credentials:"include"});if(!e.ok)throw new Error("Load failed (".concat(e.status,")"));const t=await e.json(),a=((null===t||void 0===t?void 0:t.data)||[]).find(e=>Number(e.month)===Number(u));f(a||null)}catch(e){y((null===e||void 0===e?void 0:e.message)||"Failed to load salary")}finally{g(!1)}}},[r,i,l,c,u]);(0,n.useEffect)(()=>{b()},[b]);return(0,x.jsxs)("div",{style:{padding:16},children:[(0,x.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:12},children:[(0,x.jsx)("h2",{style:{margin:0},children:"My Salary (Lab)"}),(0,x.jsx)("button",{className:"btn",onClick:b,disabled:m,children:m?"Refreshing...":"Refresh"})]}),(0,x.jsxs)("form",{onSubmit:e=>{e.preventDefault(),b()},style:{display:"grid",gap:12,gridTemplateColumns:"repeat(auto-fit, minmax(160px, 1fr))",marginTop:12},children:[(0,x.jsxs)("label",{style:{display:"flex",flexDirection:"column",gap:6},children:[(0,x.jsx)("span",{style:{color:"#334155",fontWeight:600},children:"Year"}),(0,x.jsx)("input",{type:"number",min:2e3,max:2100,value:c,onChange:e=>d(Number(e.target.value||o.getFullYear())),style:{padding:"10px 12px",border:"1px solid #e5e7eb",borderRadius:8}})]}),(0,x.jsxs)("label",{style:{display:"flex",flexDirection:"column",gap:6},children:[(0,x.jsx)("span",{style:{color:"#334155",fontWeight:600},children:"Month"}),(0,x.jsx)("input",{type:"number",min:1,max:12,value:u,onChange:e=>h(Number(e.target.value||o.getMonth()+1)),style:{padding:"10px 12px",border:"1px solid #e5e7eb",borderRadius:8}})]}),(0,x.jsx)("div",{style:{display:"flex",alignItems:"flex-end"},children:(0,x.jsx)("button",{type:"submit",className:"btn btn-primary",children:"View"})})]}),v&&(0,x.jsx)("div",{style:{color:"tomato",marginTop:8},children:v}),(0,x.jsxs)("div",{style:{marginTop:16},children:[p||m?null:(0,x.jsx)("div",{className:"dash-card",style:{padding:16},children:(0,x.jsx)("div",{style:{color:"#64748b"},children:"No salary record found for the selected month."})}),p&&(0,x.jsxs)("div",{className:"dash-card",style:{padding:16},children:[(0,x.jsx)("h3",{style:{marginTop:0},children:new Date(p.year,p.month-1).toLocaleString("default",{month:"long",year:"numeric"})}),(0,x.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(180px, 1fr))",gap:12},children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("div",{style:{color:"#64748b",fontSize:12},children:"Basic Salary"}),(0,x.jsx)("div",{style:{fontWeight:700},children:null!==(e=p.basicSalary)&&void 0!==e?e:"-"})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("div",{style:{color:"#64748b",fontSize:12},children:"Gross Salary"}),(0,x.jsx)("div",{style:{fontWeight:700},children:null!==(t=p.grossSalary)&&void 0!==t?t:"-"})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("div",{style:{color:"#64748b",fontSize:12},children:"Net Salary"}),(0,x.jsx)("div",{style:{fontWeight:700},children:null!==(s=p.netSalary)&&void 0!==s?s:"-"})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("div",{style:{color:"#64748b",fontSize:12},children:"Status"}),(0,x.jsx)("div",{style:{fontWeight:700},children:(p.status||"").toUpperCase()})]})]}),(0,x.jsx)("div",{style:{marginTop:12,display:"flex",gap:8,flexWrap:"wrap"},children:(0,x.jsx)("button",{type:"button",className:"btn btn-outline",onClick:()=>(async e=>{var t,n;if(!e)return;const{jsPDF:s}=await Promise.resolve().then(a.bind(a,1389)),r=new s;let i=16;r.setFontSize(16),r.text("HOLY FAMILY POLYMERS",14,i),i+=8,r.setFontSize(14),r.text("Lab Staff Salary Slip",14,i),i+=12,r.setFontSize(10),r.text("Employee: ".concat((null===(t=e.staff)||void 0===t?void 0:t.name)||(null===l||void 0===l?void 0:l.name)||""),14,i),i+=6,r.text("ID: ".concat((null===(n=e.staff)||void 0===n?void 0:n.staffId)||(null===l||void 0===l?void 0:l.staffId)||""),14,i),i+=6,r.text("Month: ".concat(new Date(e.year,e.month-1).toLocaleString("default",{month:"long",year:"numeric"})),14,i),i+=10,r.setFontSize(12),r.text("Summary",14,i),i+=8,r.setFontSize(10),[["Basic",e.basicSalary],["Gross",e.grossSalary],["Net",e.netSalary],["Status",(e.status||"").toUpperCase()]].forEach(e=>{let[t,a]=e;r.text("".concat(t,":"),20,i),r.text("".concat(null!==a&&void 0!==a?a:"-"),80,i),i+=6}),r.save("lab_salary_".concat(e.year,"_").concat(e.month,".pdf"))})(p),children:"Download PDF"})})]})]})]})},Jt="http://localhost:5000";function Yt(){const e=localStorage.getItem("token");return e?{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}:{"Content-Type":"application/json"}}const Kt=()=>{const[e,t]=(0,n.useState)([]),[a,s]=(0,n.useState)(!1),[r,l]=(0,n.useState)(""),[o,c]=(0,n.useState)({}),[d,u]=(0,n.useState)({}),[h,p]=(0,n.useState)({}),[f,m]=(0,n.useState)(null),g=async()=>{s(!0),l("");try{const e=await fetch("".concat(Jt,"/api/sell-requests/lab/pending"),{headers:Yt()});if(!e.ok)throw new Error("Failed to load (".concat(e.status,")"));const a=await e.json(),n=Array.isArray(null===a||void 0===a?void 0:a.records)?a.records:[];t(n);const s={},r={},i={};n.forEach(e=>{var t,a,n,l;s[e._id]=(null===(t=e.farmerId)||void 0===t?void 0:t.name)||(null===(a=e.farmerId)||void 0===a?void 0:a.email)||"",r[e._id]=null!==(n=e.barrelCount)&&void 0!==n?n:"",i[e._id]=null!==(l=e.drcPct)&&void 0!==l?l:""}),u(s),p(r),c(i)}catch(e){l((null===e||void 0===e?void 0:e.message)||"Failed to load"),t([])}finally{s(!1)}};(0,n.useEffect)(()=>{g()},[]);return(0,x.jsxs)("div",{style:{padding:16},children:[(0,x.jsx)("h2",{children:"Pending DRC Tests"}),r&&(0,x.jsx)("div",{style:{color:"tomato"},children:r}),a?(0,x.jsx)("div",{children:"Loading..."}):(0,x.jsx)("div",{style:{overflowX:"auto"},children:(0,x.jsxs)("table",{className:"dashboard-table",style:{minWidth:980},children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{children:"Farmer"}),(0,x.jsx)("th",{children:"Volume (Kg)"}),(0,x.jsx)("th",{children:"Status"}),(0,x.jsx)("th",{children:"DRC%"}),(0,x.jsx)("th",{children:"# Barrels"}),(0,x.jsx)("th",{children:"Action"})]})}),(0,x.jsxs)("tbody",{children:[e.map(e=>{var t,a,n,s;return(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{children:(0,x.jsx)("input",{value:null!==(t=d[e._id])&&void 0!==t?t:"",onChange:t=>u(a=>(0,i.A)((0,i.A)({},a),{},{[e._id]:t.target.value})),placeholder:"Farmer name"})}),(0,x.jsx)("td",{children:null!==(a=e.totalVolumeKg)&&void 0!==a?a:"-"}),(0,x.jsx)("td",{children:e.status}),(0,x.jsx)("td",{children:(0,x.jsx)("input",{type:"number",min:"0",max:"100",step:"0.1",value:null!==(n=o[e._id])&&void 0!==n?n:"",onChange:t=>c(a=>(0,i.A)((0,i.A)({},a),{},{[e._id]:t.target.value})),placeholder:"%"})}),(0,x.jsx)("td",{children:(0,x.jsx)("input",{type:"number",min:"1",step:"1",value:null!==(s=h[e._id])&&void 0!==s?s:"",onChange:t=>p(a=>(0,i.A)((0,i.A)({},a),{},{[e._id]:t.target.value})),placeholder:"#"})}),(0,x.jsx)("td",{children:(0,x.jsxs)("div",{style:{display:"flex",gap:8},children:[(0,x.jsx)("button",{onClick:()=>(async e=>{const t=Number(o[e]);if(Number.isNaN(t)||t<0||t>100)alert("Enter valid DRC% (0-100)");else try{m(e);const a=await fetch("".concat(Jt,"/api/sell-requests/").concat(e,"/drc-test"),{method:"PUT",headers:Yt(),body:JSON.stringify({drcPct:t})});if(!a.ok)throw new Error("Save failed (".concat(a.status,")"));await g()}catch(a){alert((null===a||void 0===a?void 0:a.message)||"Failed to save")}finally{m(null)}})(e._id),disabled:f===e._id,children:f===e._id?"Saving...":"Save"}),(0,x.jsx)("button",{type:"button",onClick:()=>(async e=>{const t=String(d[e]||"").trim(),a=Number(o[e]),n=Number(h[e]);if(t)if(a>=0&&a<=100)if(!Number.isInteger(n)||n<=0)alert("Enter positive whole number for # Barrels");else try{m(e);const s=await fetch("".concat(Jt,"/api/sell-requests/").concat(e,"/submit-for-accounts"),{method:"PUT",headers:Yt(),body:JSON.stringify({farmerName:t,drcPct:a,barrelCount:n})});if(!s.ok)throw new Error("Submit failed (".concat(s.status,")"));await g()}catch(s){alert((null===s||void 0===s?void 0:s.message)||"Failed to submit to Accounts")}finally{m(null)}else alert("Enter valid DRC% (0-100)");else alert("Farmer name is required")})(e._id),disabled:f===e._id,children:f===e._id?"Submitting...":"Send to Accounts"}),(0,x.jsx)("button",{type:"button",onClick:()=>{var t,a;const n=(null===(t=e.farmerId)||void 0===t?void 0:t.name)||(null===(a=e.farmerId)||void 0===a?void 0:a.email)||"",s="/lab/update-drc?customer=".concat(encodeURIComponent(n));window.location.assign(s)},children:"Open in Update DRC"})]})})]},e._id)}),!e.length&&(0,x.jsx)("tr",{children:(0,x.jsx)("td",{colSpan:5,style:{textAlign:"center",color:"#6b7280"},children:"No pending tests."})})]})]})})]})};function Qt(){const e=localStorage.getItem("token");return e?{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}:{"Content-Type":"application/json"}}const $t=()=>{const[e,t]=(0,n.useState)({drcPercentage:"",moistureContent:"",impurities:"",colorScore:""}),[a,s]=(0,n.useState)(null),[r,l]=(0,n.useState)(!1),[o,c]=(0,n.useState)(""),d=e=>{const{name:a,value:n}=e.target;t(e=>(0,i.A)((0,i.A)({},e),{},{[a]:n}))},u=e=>{switch(e){case"A":return"#10b981";case"B":return"#3b82f6";case"C":return"#f59e0b";case"D":return"#ef4444";default:return"#6b7280"}};return(0,x.jsxs)("div",{className:"quality-classifier-container",children:[(0,x.jsxs)("div",{className:"classifier-header",children:[(0,x.jsx)("h2",{children:"\ud83d\udd2c AI Quality Classifier"}),(0,x.jsx)("p",{children:"Auto-classify material quality using K-Nearest Neighbors algorithm"})]}),(0,x.jsxs)("div",{className:"classifier-content",children:[(0,x.jsxs)("form",{onSubmit:async t=>{t.preventDefault(),l(!0),c(""),s(null);try{const t=await fetch("".concat("http://localhost:5000","/api/knn/classify-quality"),{method:"POST",headers:Qt(),body:JSON.stringify({drcPercentage:Number(e.drcPercentage),moistureContent:Number(e.moistureContent),impurities:Number(e.impurities),colorScore:Number(e.colorScore)})}),a=await t.json();if(!t.ok||!a.success)throw new Error(a.message||"Classification failed");s(a.classification)}catch(a){c(a.message||"Failed to classify quality")}finally{l(!1)}},className:"classifier-form",children:[(0,x.jsxs)("div",{className:"form-grid",children:[(0,x.jsxs)("div",{className:"form-field",children:[(0,x.jsxs)("label",{htmlFor:"drcPercentage",children:[(0,x.jsx)("span",{className:"label-icon",children:"\ud83d\udcca"}),"DRC Percentage (%)"]}),(0,x.jsx)("input",{type:"number",id:"drcPercentage",name:"drcPercentage",value:e.drcPercentage,onChange:d,placeholder:"e.g., 32.5",step:"0.1",min:"0",max:"100",required:!0}),(0,x.jsx)("span",{className:"field-hint",children:"Range: 0-100%"})]}),(0,x.jsxs)("div",{className:"form-field",children:[(0,x.jsxs)("label",{htmlFor:"moistureContent",children:[(0,x.jsx)("span",{className:"label-icon",children:"\ud83d\udca7"}),"Moisture Content (%)"]}),(0,x.jsx)("input",{type:"number",id:"moistureContent",name:"moistureContent",value:e.moistureContent,onChange:d,placeholder:"e.g., 2.1",step:"0.1",min:"0",max:"100",required:!0}),(0,x.jsx)("span",{className:"field-hint",children:"Range: 0-100%"})]}),(0,x.jsxs)("div",{className:"form-field",children:[(0,x.jsxs)("label",{htmlFor:"impurities",children:[(0,x.jsx)("span",{className:"label-icon",children:"\ud83e\uddea"}),"Impurities (%)"]}),(0,x.jsx)("input",{type:"number",id:"impurities",name:"impurities",value:e.impurities,onChange:d,placeholder:"e.g., 0.8",step:"0.1",min:"0",max:"100",required:!0}),(0,x.jsx)("span",{className:"field-hint",children:"Range: 0-100%"})]}),(0,x.jsxs)("div",{className:"form-field",children:[(0,x.jsxs)("label",{htmlFor:"colorScore",children:[(0,x.jsx)("span",{className:"label-icon",children:"\ud83c\udfa8"}),"Color Score"]}),(0,x.jsx)("input",{type:"number",id:"colorScore",name:"colorScore",value:e.colorScore,onChange:d,placeholder:"e.g., 7.5",step:"0.1",min:"0",max:"10",required:!0}),(0,x.jsx)("span",{className:"field-hint",children:"Range: 0-10"})]})]}),o&&(0,x.jsxs)("div",{className:"error-message",children:[(0,x.jsx)("span",{className:"error-icon",children:"\u26a0\ufe0f"}),o]}),(0,x.jsxs)("div",{className:"form-actions",children:[(0,x.jsx)("button",{type:"submit",className:"btn-classify",disabled:r,children:r?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("span",{className:"spinner"}),"Classifying..."]}):(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("span",{className:"btn-icon",children:"\ud83e\udd16"}),"Classify Quality"]})}),(0,x.jsx)("button",{type:"button",className:"btn-reset",onClick:()=>{t({drcPercentage:"",moistureContent:"",impurities:"",colorScore:""}),s(null),c("")},disabled:r,children:"\ud83d\udd04 Reset"})]})]}),a&&(0,x.jsxs)("div",{className:"result-container",children:[(0,x.jsx)("div",{className:"result-header",children:(0,x.jsx)("h3",{children:"\ud83c\udfaf Classification Result"})}),(0,x.jsxs)("div",{className:"grade-display",style:{borderColor:u(a.qualityGrade)},children:[(0,x.jsxs)("div",{className:"grade-badge",style:{background:u(a.qualityGrade)},children:["Grade ",a.qualityGrade]}),(0,x.jsx)("div",{className:"grade-description",children:(e=>{switch(e){case"A":return"Excellent Quality - Premium Grade";case"B":return"Good Quality - Standard Grade";case"C":return"Fair Quality - Acceptable Grade";case"D":return"Poor Quality - Low Grade";default:return"Unknown Grade"}})(a.qualityGrade)}),(0,x.jsxs)("div",{className:"confidence-bar-container",children:[(0,x.jsxs)("div",{className:"confidence-label",children:[(0,x.jsx)("span",{children:"Confidence Level"}),(0,x.jsxs)("span",{className:"confidence-value",children:[(100*a.confidence).toFixed(1),"%"]})]}),(0,x.jsx)("div",{className:"confidence-bar",children:(0,x.jsx)("div",{className:"confidence-fill",style:{width:"".concat(100*a.confidence,"%"),background:u(a.qualityGrade)}})})]})]}),a.neighbors&&a.neighbors.length>0&&(0,x.jsxs)("div",{className:"neighbors-section",children:[(0,x.jsx)("h4",{children:"\ud83d\udccc Similar Samples (K-Nearest Neighbors)"}),(0,x.jsx)("div",{className:"neighbors-list",children:a.neighbors.slice(0,3).map((e,t)=>(0,x.jsxs)("div",{className:"neighbor-item",children:[(0,x.jsxs)("div",{className:"neighbor-rank",children:["#",t+1]}),(0,x.jsxs)("div",{className:"neighbor-info",children:[(0,x.jsxs)("span",{className:"neighbor-grade",style:{color:u(e.grade)},children:["Grade ",e.grade]}),(0,x.jsxs)("span",{className:"neighbor-distance",children:["Distance: ",e.distance.toFixed(3)]})]})]},t))})]}),a.modelInfo&&(0,x.jsxs)("div",{className:"model-info",children:[(0,x.jsx)("h4",{children:"\ud83d\udd0d Model Information"}),(0,x.jsxs)("div",{className:"model-stats",children:[(0,x.jsxs)("div",{className:"stat-item",children:[(0,x.jsx)("span",{className:"stat-label",children:"K Value:"}),(0,x.jsx)("span",{className:"stat-value",children:a.modelInfo.k})]}),(0,x.jsxs)("div",{className:"stat-item",children:[(0,x.jsx)("span",{className:"stat-label",children:"Training Samples:"}),(0,x.jsx)("span",{className:"stat-value",children:a.modelInfo.trainingSamples})]})]})]})]})]}),(0,x.jsxs)("div",{className:"info-section",children:[(0,x.jsx)("h4",{children:"\u2139\ufe0f How It Works"}),(0,x.jsxs)("div",{className:"info-content",children:[(0,x.jsxs)("p",{children:["The Quality Classifier uses ",(0,x.jsx)("strong",{children:"K-Nearest Neighbors (KNN)"})," machine learning algorithm to predict quality grades based on your test parameters."]}),(0,x.jsxs)("ul",{children:[(0,x.jsxs)("li",{children:["\u2705 ",(0,x.jsx)("strong",{children:"Grade A:"})," DRC > 30%, Low moisture, Minimal impurities"]}),(0,x.jsxs)("li",{children:["\u2705 ",(0,x.jsx)("strong",{children:"Grade B:"})," DRC 25-30%, Moderate moisture, Low impurities"]}),(0,x.jsxs)("li",{children:["\u2705 ",(0,x.jsx)("strong",{children:"Grade C:"})," DRC 20-25%, Higher moisture, Some impurities"]}),(0,x.jsxs)("li",{children:["\u2705 ",(0,x.jsx)("strong",{children:"Grade D:"})," DRC < 20%, High moisture, High impurities"]})]}),(0,x.jsxs)("p",{className:"info-note",children:[(0,x.jsx)("strong",{children:"Note:"})," This is an AI prediction to assist decision-making. Final classification should be confirmed by lab staff."]})]})]})]})},Xt=()=>{const e="http://localhost:5000",t=()=>{const e=localStorage.getItem("token");return e?{Authorization:"Bearer ".concat(e)}:{}},[a,s]=(0,n.useState)({drcPercentage:"",moistureContent:"",impurities:"",colorScore:"",viscosity:""}),[r,l]=(0,n.useState)("knn"),[o,c]=(0,n.useState)(!1),[d,u]=(0,n.useState)(""),[h,p]=(0,n.useState)(null),[f,g]=(0,n.useState)(null),v=e=>{const{name:t,value:a}=e.target;s(e=>(0,i.A)((0,i.A)({},e),{},{[t]:a}))},y=e=>({A:"\ud83c\udfc6",B:"\u2b50",C:"\ud83d\udcca",D:"\ud83d\udcc9"}[e]||"\ud83d\udccb"),b=e=>({A:"Excellent Quality",B:"Good Quality",C:"Average Quality",D:"Below Average"}[e]||"Quality Grade"),j=e=>({A:"#10b981",B:"#3b82f6",C:"#f59e0b",D:"#ef4444"}[e]||"#6b7280");return(0,x.jsxs)("div",{className:"quality-comparison-container",children:[(0,x.jsxs)("div",{className:"page-header",children:[(0,x.jsx)("h2",{children:"\ud83e\udd16 AI Quality Classifier"}),(0,x.jsx)("p",{children:"Compare KNN vs Decision Tree algorithms for quality classification"})]}),(0,x.jsxs)("div",{className:"algorithm-selector",children:[(0,x.jsx)("h3",{children:"Select Algorithm"}),(0,x.jsxs)("div",{className:"algorithm-options",children:[(0,x.jsxs)("button",{className:"algo-btn ".concat("knn"===r?"active":""),onClick:()=>l("knn"),children:[(0,x.jsx)("span",{className:"algo-icon",children:"\ud83c\udfaf"}),(0,x.jsx)("span",{children:"K-Nearest Neighbors"})]}),(0,x.jsxs)("button",{className:"algo-btn ".concat("decision-tree"===r?"active":""),onClick:()=>l("decision-tree"),children:[(0,x.jsx)("span",{className:"algo-icon",children:"\ud83c\udf33"}),(0,x.jsx)("span",{children:"Decision Tree"})]}),(0,x.jsxs)("button",{className:"algo-btn ".concat("both"===r?"active":""),onClick:()=>l("both"),children:[(0,x.jsx)("span",{className:"algo-icon",children:"\u2696\ufe0f"}),(0,x.jsx)("span",{children:"Compare Both"})]})]})]}),(0,x.jsxs)("div",{className:"input-section",children:[(0,x.jsx)("h3",{children:"\ud83d\udcca Input Parameters"}),(0,x.jsxs)("div",{className:"input-grid",children:[(0,x.jsxs)("div",{className:"input-field",children:[(0,x.jsx)("label",{children:"\ud83d\udcca DRC Percentage (%)"}),(0,x.jsx)("input",{type:"number",name:"drcPercentage",value:a.drcPercentage,onChange:v,placeholder:"e.g., 60",min:"0",max:"100",step:"0.1"}),(0,x.jsx)("small",{children:"Range: 0-100%"})]}),(0,x.jsxs)("div",{className:"input-field",children:[(0,x.jsx)("label",{children:"\ud83d\udca7 Moisture Content (%)"}),(0,x.jsx)("input",{type:"number",name:"moistureContent",value:a.moistureContent,onChange:v,placeholder:"e.g., 0.5",min:"0",max:"100",step:"0.1"}),(0,x.jsx)("small",{children:"Range: 0-100%"})]}),(0,x.jsxs)("div",{className:"input-field",children:[(0,x.jsx)("label",{children:"\ud83e\uddea Impurities (%)"}),(0,x.jsx)("input",{type:"number",name:"impurities",value:a.impurities,onChange:v,placeholder:"e.g., 1.0",min:"0",max:"100",step:"0.1"}),(0,x.jsx)("small",{children:"Range: 0-100%"})]}),(0,x.jsxs)("div",{className:"input-field",children:[(0,x.jsx)("label",{children:"\ud83c\udfa8 Color Score"}),(0,x.jsx)("input",{type:"number",name:"colorScore",value:a.colorScore,onChange:v,placeholder:"e.g., 7",min:"0",max:"10",step:"0.1"}),(0,x.jsx)("small",{children:"Range: 0-10"})]}),(0,x.jsxs)("div",{className:"input-field",children:[(0,x.jsx)("label",{children:"\ud83d\udca7 Viscosity (cP)"}),(0,x.jsx)("input",{type:"number",name:"viscosity",value:a.viscosity,onChange:v,placeholder:"e.g., 5",min:"0",step:"0.1"}),(0,x.jsx)("small",{children:"Centipoise units"})]})]}),(0,x.jsx)("button",{className:"classify-btn",onClick:async()=>{c(!0),u(""),p(null),g(null);try{const n={drcPercentage:Number(a.drcPercentage),moistureContent:Number(a.moistureContent),impurities:Number(a.impurities),colorScore:Number(a.colorScore),viscosity:Number(a.viscosity)};if("knn"===r||"both"===r){const a=await m.A.post("".concat(e,"/api/knn/classify-quality"),n,{headers:t()});a.data.success&&p(a.data.classification)}if("decision-tree"===r||"both"===r){const a=await m.A.post("".concat(e,"/api/decision-tree/classify-quality"),n,{headers:t()});a.data.success&&g(a.data.classification)}}catch(i){var n,s;console.error("Classification error:",i),u((null===(n=i.response)||void 0===n||null===(s=n.data)||void 0===s?void 0:s.message)||"Error classifying quality. Please check inputs.")}finally{c(!1)}},disabled:o||!a.drcPercentage||!a.moistureContent,children:o?"\ud83d\udd04 Classifying...":"\ud83c\udfaf Classify Quality"}),d&&(0,x.jsxs)("div",{className:"error-message",children:["\u274c ",d]})]}),(0,x.jsxs)("div",{className:"results-section",children:[h&&(0,x.jsxs)("div",{className:"result-card knn-result",children:[(0,x.jsx)("div",{className:"result-header",children:(0,x.jsx)("h3",{children:"\ud83c\udfaf K-Nearest Neighbors Result"})}),(0,x.jsxs)("div",{className:"grade-badge",style:{background:"linear-gradient(135deg, ".concat(j(h.qualityGrade),", ").concat(j(h.qualityGrade),"dd)")},children:[(0,x.jsx)("span",{className:"grade-icon",children:y(h.qualityGrade)}),(0,x.jsxs)("span",{className:"grade-text",children:["Grade ",h.qualityGrade]}),(0,x.jsx)("span",{className:"grade-desc",children:b(h.qualityGrade)})]}),(0,x.jsxs)("div",{className:"confidence-section",children:[(0,x.jsx)("div",{className:"confidence-label",children:"Confidence"}),(0,x.jsx)("div",{className:"confidence-bar",children:(0,x.jsx)("div",{className:"confidence-fill",style:{width:"".concat((100*h.confidence).toFixed(0),"%"),background:j(h.qualityGrade)}})}),(0,x.jsxs)("div",{className:"confidence-value",children:[(100*h.confidence).toFixed(1),"%"]})]}),h.neighbors&&h.neighbors.length>0&&(0,x.jsxs)("div",{className:"neighbors-section",children:[(0,x.jsx)("h4",{children:"\ud83d\udccc Nearest Neighbors:"}),(0,x.jsx)("div",{className:"neighbors-list",children:h.neighbors.map((e,t)=>(0,x.jsxs)("div",{className:"neighbor-item",children:[(0,x.jsxs)("span",{className:"neighbor-number",children:["#",t+1]}),(0,x.jsxs)("span",{className:"neighbor-grade",children:["Grade ",e.grade]}),(0,x.jsxs)("span",{className:"neighbor-distance",children:["Distance: ",e.distance.toFixed(3)]})]},t))})]}),(0,x.jsxs)("div",{className:"model-info",children:["\ud83d\udd0d K=",h.modelInfo.k," | ",h.modelInfo.trainingSamples," training samples"]})]}),f&&(0,x.jsxs)("div",{className:"result-card dt-result",children:[(0,x.jsx)("div",{className:"result-header",children:(0,x.jsx)("h3",{children:"\ud83c\udf33 Decision Tree Result"})}),(0,x.jsxs)("div",{className:"grade-badge",style:{background:"linear-gradient(135deg, ".concat(j(f.qualityGrade),", ").concat(j(f.qualityGrade),"dd)")},children:[(0,x.jsx)("span",{className:"grade-icon",children:y(f.qualityGrade)}),(0,x.jsxs)("span",{className:"grade-text",children:["Grade ",f.qualityGrade]}),(0,x.jsx)("span",{className:"grade-desc",children:b(f.qualityGrade)})]}),(0,x.jsxs)("div",{className:"confidence-section",children:[(0,x.jsx)("div",{className:"confidence-label",children:"Confidence"}),(0,x.jsx)("div",{className:"confidence-bar",children:(0,x.jsx)("div",{className:"confidence-fill",style:{width:"".concat((100*f.confidence).toFixed(0),"%"),background:j(f.qualityGrade)}})}),(0,x.jsxs)("div",{className:"confidence-value",children:[(100*f.confidence).toFixed(1),"%"]})]}),f.decisionPath&&f.decisionPath.length>0&&(0,x.jsxs)("div",{className:"decision-path-section",children:[(0,x.jsx)("h4",{children:"\ud83c\udf33 Decision Path:"}),(0,x.jsx)("div",{className:"decision-tree",children:f.decisionPath.map((e,t)=>(0,x.jsxs)("div",{className:"decision-step",children:[(0,x.jsx)("div",{className:"step-number",children:t+1}),(0,x.jsxs)("div",{className:"step-content",children:[(0,x.jsx)("div",{className:"step-feature",children:e.feature}),(0,x.jsxs)("div",{className:"step-comparison",children:[e.value.toFixed(2)," ",e.comparison," ",e.threshold.toFixed(2)]}),(0,x.jsxs)("div",{className:"step-arrow",children:["\u2192 ","left"===e.decision?"Left Branch":"Right Branch"]})]})]},t))})]}),(0,x.jsxs)("div",{className:"model-info",children:["\ud83d\udd0d Max Depth: 5 | ",f.modelInfo.trainingSamples," training samples"]})]}),h&&f&&(0,x.jsxs)("div",{className:"comparison-summary",children:[(0,x.jsx)("h3",{children:"\u2696\ufe0f Algorithm Comparison"}),(0,x.jsx)("div",{className:"comparison-table",children:(0,x.jsxs)("table",{children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{children:"Metric"}),(0,x.jsx)("th",{children:"K-NN"}),(0,x.jsx)("th",{children:"Decision Tree"})]})}),(0,x.jsxs)("tbody",{children:[(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{children:"Prediction"}),(0,x.jsx)("td",{children:(0,x.jsxs)("span",{className:"grade-pill",style:{background:j(h.qualityGrade)},children:["Grade ",h.qualityGrade]})}),(0,x.jsx)("td",{children:(0,x.jsxs)("span",{className:"grade-pill",style:{background:j(f.qualityGrade)},children:["Grade ",f.qualityGrade]})})]}),(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{children:"Confidence"}),(0,x.jsxs)("td",{children:[(100*h.confidence).toFixed(1),"%"]}),(0,x.jsxs)("td",{children:[(100*f.confidence).toFixed(1),"%"]})]}),(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{children:"Agreement"}),(0,x.jsx)("td",{colSpan:"2",style:{textAlign:"center",fontWeight:"bold"},children:h.qualityGrade===f.qualityGrade?(0,x.jsx)("span",{style:{color:"#10b981"},children:"\u2705 Both Agree"}):(0,x.jsx)("span",{style:{color:"#f59e0b"},children:"\u26a0\ufe0f Different Results"})})]})]})]})})]})]})]})},Zt="http://localhost:5000";function ea(){const e=localStorage.getItem("token");return e?{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}:{"Content-Type":"application/json"}}const ta=()=>{const[e,t]=(0,n.useState)([]),[a,s]=(0,n.useState)(!1),[r,l]=(0,n.useState)(""),[o,c]=(0,n.useState)(""),[d,u]=(0,n.useState)({chemicalName:"",quantity:"",purpose:"",priority:"normal"}),[h,p]=(0,n.useState)([]),[f,m]=(0,n.useState)(!1),g=async()=>{s(!0),l("");try{const e=await fetch("".concat(Zt,"/api/chem-requests/my"),{headers:ea()});if(!e.ok){const a=await e.text();if(404===e.status)return t([]),void c("");if(500===e.status)return l("Unable to load requests right now (server error). Please try again later."),void t([]);throw new Error("Failed to load (".concat(e.status,") ").concat(String(a).slice(0,80)))}const a=await e.json();t(Array.isArray(null===a||void 0===a?void 0:a.records)?a.records:[])}catch(e){const a=((null===e||void 0===e?void 0:e.message)||"Failed to load").replace(/<[^>]*>/g,""),n=/\(500\)/.test(a)?"Unable to load requests right now (server error). Please try again later.":a;l(n),t([])}finally{s(!1)}};(0,n.useEffect)(()=>{g(),(async()=>{try{const e=await fetch("".concat(Zt,"/api/chem-requests/catalog"),{headers:ea()});if(!e.ok)return;const t=await e.json();p(Array.isArray(null===t||void 0===t?void 0:t.records)?t.records:[])}catch(e){}})()},[]);return(0,x.jsxs)("div",{style:{padding:16},children:[(0,x.jsx)("h2",{children:"Chemical Requests"}),r&&(0,x.jsx)("div",{style:{color:"tomato",marginBottom:8},children:r}),o&&(0,x.jsx)("div",{style:{color:"#0a7",marginBottom:8},children:o}),(0,x.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),l(""),c("");const t=Number(d.quantity);if(!d.chemicalName.trim()||!Number.isInteger(t)||t<=0)l("Chemical name and positive whole number quantity required");else try{const e={chemicalName:d.chemicalName.trim(),quantity:t,purpose:d.purpose||void 0,priority:d.priority||"normal"},a=await fetch("".concat(Zt,"/api/chem-requests"),{method:"POST",headers:ea(),body:JSON.stringify(e)});if(!a.ok)throw new Error("Submit failed (".concat(a.status,")"));u({chemicalName:"",quantity:"",purpose:"",priority:"normal"}),c("Request submitted"),await g()}catch(e){l((null===e||void 0===e?void 0:e.message)||"Failed to submit")}},style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12,maxWidth:800},children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{children:"Chemical"}),h.length>0&&!f?(0,x.jsxs)("div",{style:{display:"flex",gap:8},children:[(0,x.jsxs)("select",{value:d.chemicalName,onChange:e=>u(t=>(0,i.A)((0,i.A)({},t),{},{chemicalName:e.target.value})),required:!0,children:[(0,x.jsx)("option",{value:"",children:"Select chemical"}),h.map(e=>(0,x.jsxs)("option",{value:e.name,children:[e.name," ",e.unit?"(".concat(e.unit,")"):""]},e.name))]}),(0,x.jsx)("button",{type:"button",onClick:()=>{m(!0),u(e=>(0,i.A)((0,i.A)({},e),{},{chemicalName:""}))},title:"Enter custom name",children:"Custom"})]}):(0,x.jsxs)("div",{style:{display:"flex",gap:8},children:[(0,x.jsx)("input",{value:d.chemicalName,onChange:e=>u(t=>(0,i.A)((0,i.A)({},t),{},{chemicalName:e.target.value})),placeholder:"e.g., Ammonia",required:!0}),h.length>0&&(0,x.jsx)("button",{type:"button",onClick:()=>m(!1),title:"Choose from list",children:"Select"})]})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{children:"Quantity"}),(0,x.jsx)("input",{type:"number",min:"1",step:"1",value:d.quantity,onChange:e=>u(t=>(0,i.A)((0,i.A)({},t),{},{quantity:e.target.value})),required:!0})]}),(0,x.jsxs)("div",{style:{gridColumn:"1 / -1"},children:[(0,x.jsx)("label",{children:"Purpose"}),(0,x.jsx)("textarea",{rows:2,value:d.purpose,onChange:e=>u(t=>(0,i.A)((0,i.A)({},t),{},{purpose:e.target.value})),placeholder:"Optional"})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{children:"Priority"}),(0,x.jsxs)("select",{value:d.priority,onChange:e=>u(t=>(0,i.A)((0,i.A)({},t),{},{priority:e.target.value})),children:[(0,x.jsx)("option",{value:"low",children:"Low"}),(0,x.jsx)("option",{value:"normal",children:"Normal"}),(0,x.jsx)("option",{value:"high",children:"High"}),(0,x.jsx)("option",{value:"urgent",children:"Urgent"})]})]}),(0,x.jsx)("div",{style:{gridColumn:"1 / -1"},children:(0,x.jsx)("button",{className:"btn",type:"submit",children:"Submit"})})]}),(0,x.jsx)("div",{style:{marginTop:16,overflowX:"auto"},children:(0,x.jsxs)("table",{className:"dashboard-table",style:{minWidth:820},children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{children:"Chemical"}),(0,x.jsx)("th",{children:"Qty"}),(0,x.jsx)("th",{children:"Priority"}),(0,x.jsx)("th",{children:"Status"}),(0,x.jsx)("th",{children:"Purpose"}),(0,x.jsx)("th",{children:"Created"})]})}),(0,x.jsxs)("tbody",{children:[e.map(e=>(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{children:e.chemicalName}),(0,x.jsx)("td",{children:e.quantity}),(0,x.jsx)("td",{style:{textTransform:"capitalize"},children:e.priority}),(0,x.jsx)("td",{children:e.status}),(0,x.jsx)("td",{title:e.purpose,children:e.purpose||"-"}),(0,x.jsx)("td",{children:new Date(e.createdAt).toLocaleString()})]},e._id)),0===e.length&&!a&&(0,x.jsx)("tr",{children:(0,x.jsx)("td",{colSpan:6,style:{textAlign:"center",color:"#6b7280"},children:"No requests yet."})})]})]})})]})};const aa=function(){var e;const[t,a]=(0,n.useState)(""),[s,r]=(0,n.useState)(""),[i,l]=(0,n.useState)(""),[o,c]=(0,n.useState)(null),[d,u]=(0,n.useState)(!1),[h,p]=(0,n.useState)(""),f=localStorage.getItem("token");return(0,x.jsx)("div",{className:"card",style:{maxWidth:720,margin:"0 auto"},children:(0,x.jsxs)("div",{className:"card-body",children:[(0,x.jsx)("h2",{children:"Lab: Barrel Weights & Lumb Detection"}),(0,x.jsx)("p",{className:"text-muted",children:"Enter base and empty weights. If lumb > 20%, the system will flag and notify Manager/Admin."}),(0,x.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),p(""),c(null),t){u(!0);try{const e=await fetch("/api/barrels/".concat(t,"/weights"),{method:"PUT",headers:{"Content-Type":"application/json",Authorization:f?"Bearer ".concat(f):void 0},body:JSON.stringify({baseWeight:s?Number(s):void 0,emptyWeight:i?Number(i):void 0})}),a=await e.json();if(!e.ok)throw new Error((null===a||void 0===a?void 0:a.message)||"Failed to update weights");c(a)}catch(a){p(a.message)}finally{u(!1)}}else p("Barrel ID is required")},className:"form-grid",children:[(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{children:"Barrel ID (Mongo _id)"}),(0,x.jsx)("input",{value:t,onChange:e=>a(e.target.value),placeholder:"e.g. 670f...",required:!0})]}),(0,x.jsxs)("div",{className:"form-row",children:[(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{children:"Base Weight (kg)"}),(0,x.jsx)("input",{type:"number",value:s,onChange:e=>r(e.target.value)})]}),(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{children:"Empty Weight (kg)"}),(0,x.jsx)("input",{type:"number",value:i,onChange:e=>l(e.target.value)})]})]}),(0,x.jsx)("button",{className:"btn btn-primary",disabled:d,children:d?"Saving...":"Save & Evaluate"})]}),h&&(0,x.jsx)("div",{className:"alert alert-danger",style:{marginTop:12},children:h}),o&&(0,x.jsxs)("div",{className:"alert alert-success",style:{marginTop:12},children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("strong",{children:"Barrel:"})," ",o.barrelId]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("strong",{children:"Lumb %:"})," ",null!==(e=o.lumbPercent)&&void 0!==e?e:0,"%"]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("strong",{children:"Condition:"})," ",o.condition||"ok"]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("strong",{children:"Damage Type:"})," ",o.damageType||"none"]})]})]})})};const na=function(){const[e,t]=(0,n.useState)(""),[a,s]=(0,n.useState)("lumb-removal"),[r,i]=(0,n.useState)([]),[l,o]=(0,n.useState)(!0),[c,d]=(0,n.useState)(""),u=localStorage.getItem("token"),h=async()=>{o(!0),d("");try{const e=await fetch("/api/repairs?status=in-progress",{headers:{Authorization:u?"Bearer ".concat(u):void 0}}),t=await e.json();if(!e.ok)throw new Error((null===t||void 0===t?void 0:t.message)||"Failed to load");i(t)}catch(e){d(e.message)}finally{o(!1)}};return(0,n.useEffect)(()=>{h()},[]),(0,x.jsx)("div",{className:"card",children:(0,x.jsxs)("div",{className:"card-body",children:[(0,x.jsx)("h2",{children:"Lab: Lumb Removal & Repair Jobs"}),(0,x.jsx)("p",{className:"text-muted",children:"Open jobs, append logs, and complete for manager approval."}),(0,x.jsxs)("form",{onSubmit:async n=>{n.preventDefault();try{const n=await fetch("/api/repairs/open",{method:"POST",headers:{"Content-Type":"application/json",Authorization:u?"Bearer ".concat(u):void 0},body:JSON.stringify({barrelId:e,type:a})}),s=await n.json();if(!n.ok)throw new Error((null===s||void 0===s?void 0:s.message)||"Failed to open job");t(""),await h()}catch(n){alert(n.message)}},className:"form-grid",style:{marginBottom:16},children:[(0,x.jsxs)("div",{className:"form-row",children:[(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{children:"Barrel ID (Mongo _id)"}),(0,x.jsx)("input",{value:e,onChange:e=>t(e.target.value),required:!0})]}),(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{children:"Type"}),(0,x.jsxs)("select",{value:a,onChange:e=>s(e.target.value),children:[(0,x.jsx)("option",{value:"lumb-removal",children:"Lumb Removal"}),(0,x.jsx)("option",{value:"repair",children:"Repair"})]})]})]}),(0,x.jsx)("button",{className:"btn btn-primary",children:"Open Job"})]}),l&&(0,x.jsx)("div",{children:"Loading..."}),c&&(0,x.jsx)("div",{className:"alert alert-danger",children:c}),(0,x.jsx)("div",{className:"table-responsive",children:(0,x.jsxs)("table",{className:"table",children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{children:"Job"}),(0,x.jsx)("th",{children:"Barrel"}),(0,x.jsx)("th",{children:"Type"}),(0,x.jsx)("th",{children:"Status"}),(0,x.jsx)("th",{children:"Updated"}),(0,x.jsx)("th",{children:"Actions"})]})}),(0,x.jsx)("tbody",{children:r.map(e=>(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{children:e._id}),(0,x.jsx)("td",{children:e.barrelId}),(0,x.jsx)("td",{children:e.type}),(0,x.jsx)("td",{children:e.status}),(0,x.jsx)("td",{children:new Date(e.updatedAt).toLocaleString()}),(0,x.jsx)("td",{children:(0,x.jsxs)("div",{className:"btn-group",children:[(0,x.jsx)("button",{className:"btn btn-sm",onClick:()=>(async e=>{const t=prompt("Step name"),a=prompt("Note (optional)")||"";if(t)try{const n=await fetch("/api/repairs/".concat(e,"/log"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:u?"Bearer ".concat(u):void 0},body:JSON.stringify({step:t,note:a})}),s=await n.json();if(!n.ok)throw new Error((null===s||void 0===s?void 0:s.message)||"Failed to log");await h()}catch(n){alert(n.message)}})(e._id),children:"Log"}),(0,x.jsx)("button",{className:"btn btn-sm btn-success",onClick:()=>(async e=>{if(window.confirm("Mark job complete and send for approval?"))try{const t=await fetch("/api/repairs/".concat(e,"/complete"),{method:"POST",headers:{Authorization:u?"Bearer ".concat(u):void 0}}),a=await t.json();if(!t.ok)throw new Error((null===a||void 0===a?void 0:a.message)||"Failed to complete");await h()}catch(t){alert(t.message)}})(e._id),children:"Complete"})]})})]},e._id))})]})})]})})},sa=e=>{let{children:t}=e;const{isAuthenticated:a,user:n,loading:s}=y(),r=(0,w.zy)();return s?(0,x.jsx)("div",{children:"Loading..."}):a&&n?"accountant"!==n.role&&"admin"!==n.role?(0,x.jsx)(w.C5,{to:"/user",replace:!0}):t:(0,x.jsx)(w.C5,{to:"/login",state:{from:r.pathname},replace:!0})};var ra={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},ia=n.createContext&&n.createContext(ra),la=["attr","size","title"];function oa(e,t){if(null==e)return{};var a,n,s=function(e,t){if(null==e)return{};var a={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;a[n]=e[n]}return a}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(s[a]=e[a])}return s}function ca(){return ca=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},ca.apply(this,arguments)}function da(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}function ua(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?da(Object(a),!0).forEach(function(t){ha(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):da(Object(a)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}function ha(e,t,a){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function pa(e){return e&&e.map((e,t)=>n.createElement(e.tag,ua({key:t},e.attr),pa(e.child)))}function fa(e){return t=>n.createElement(ma,ca({attr:ua({},e.attr)},t),pa(e.child))}function ma(e){var t=t=>{var a,{attr:s,size:r,title:i}=e,l=oa(e,la),o=r||t.size||"1em";return t.className&&(a=t.className),e.className&&(a=(a?a+" ":"")+e.className),n.createElement("svg",ca({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,s,l,{className:a,style:ua(ua({color:e.color||t.color},t.style),e.style),height:o,width:o,xmlns:"http://www.w3.org/2000/svg"}),i&&n.createElement("title",null,i),e.children)};return void 0!==ia?n.createElement(ia.Consumer,null,e=>t(e)):t(ra)}function xa(e){return fa({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"10"},child:[]},{tag:"line",attr:{x1:"12",y1:"8",x2:"12",y2:"12"},child:[]},{tag:"line",attr:{x1:"12",y1:"16",x2:"12.01",y2:"16"},child:[]}]})(e)}function ga(e){return fa({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"},child:[]},{tag:"line",attr:{x1:"12",y1:"9",x2:"12",y2:"13"},child:[]},{tag:"line",attr:{x1:"12",y1:"17",x2:"12.01",y2:"17"},child:[]}]})(e)}function va(e){return fa({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"5",y1:"12",x2:"19",y2:"12"},child:[]},{tag:"polyline",attr:{points:"12 5 19 12 12 19"},child:[]}]})(e)}function ya(e){return fa({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"18",y1:"20",x2:"18",y2:"10"},child:[]},{tag:"line",attr:{x1:"12",y1:"20",x2:"12",y2:"4"},child:[]},{tag:"line",attr:{x1:"6",y1:"20",x2:"6",y2:"14"},child:[]}]})(e)}function ba(e){return fa({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"},child:[]},{tag:"path",attr:{d:"M13.73 21a2 2 0 0 1-3.46 0"},child:[]}]})(e)}function ja(e){return fa({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"},child:[]},{tag:"path",attr:{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"},child:[]}]})(e)}function wa(e){return fa({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{x:"2",y:"7",width:"20",height:"14",rx:"2",ry:"2"},child:[]},{tag:"path",attr:{d:"M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"},child:[]}]})(e)}function Na(e){return fa({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"},child:[]},{tag:"line",attr:{x1:"16",y1:"2",x2:"16",y2:"6"},child:[]},{tag:"line",attr:{x1:"8",y1:"2",x2:"8",y2:"6"},child:[]},{tag:"line",attr:{x1:"3",y1:"10",x2:"21",y2:"10"},child:[]}]})(e)}function Sa(e){return fa({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"},child:[]},{tag:"polyline",attr:{points:"22 4 12 14.01 9 11.01"},child:[]}]})(e)}function ka(e){return fa({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"9 11 12 14 22 4"},child:[]},{tag:"path",attr:{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"},child:[]}]})(e)}function Aa(e){return fa({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"10"},child:[]},{tag:"polyline",attr:{points:"12 6 12 12 16 14"},child:[]}]})(e)}function Ca(e){return fa({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{x:"1",y:"4",width:"22",height:"16",rx:"2",ry:"2"},child:[]},{tag:"line",attr:{x1:"1",y1:"10",x2:"23",y2:"10"},child:[]}]})(e)}function _a(e){return fa({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"12",y1:"1",x2:"12",y2:"23"},child:[]},{tag:"path",attr:{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"},child:[]}]})(e)}function La(e){return fa({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"},child:[]},{tag:"polyline",attr:{points:"7 10 12 15 17 10"},child:[]},{tag:"line",attr:{x1:"12",y1:"15",x2:"12",y2:"3"},child:[]}]})(e)}function Ta(e){return fa({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"},child:[]}]})(e)}function Ea(e){return fa({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"},child:[]},{tag:"polyline",attr:{points:"14 2 14 8 20 8"},child:[]},{tag:"line",attr:{x1:"16",y1:"13",x2:"8",y2:"13"},child:[]},{tag:"line",attr:{x1:"16",y1:"17",x2:"8",y2:"17"},child:[]},{tag:"polyline",attr:{points:"10 9 9 9 8 9"},child:[]}]})(e)}function Da(e){return fa({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"},child:[]},{tag:"polyline",attr:{points:"13 2 13 9 20 9"},child:[]}]})(e)}function Pa(e){return fa({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polygon",attr:{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"},child:[]}]})(e)}function Ra(e){return fa({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"},child:[]}]})(e)}function Ia(e){return fa({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"},child:[]},{tag:"circle",attr:{cx:"8.5",cy:"8.5",r:"1.5"},child:[]},{tag:"polyline",attr:{points:"21 15 16 10 5 21"},child:[]}]})(e)}function Ba(e){return fa({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polygon",attr:{points:"12 2 2 7 12 12 22 7 12 2"},child:[]},{tag:"polyline",attr:{points:"2 17 12 22 22 17"},child:[]},{tag:"polyline",attr:{points:"2 12 12 17 22 12"},child:[]}]})(e)}function Fa(e){return fa({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"},child:[]},{tag:"circle",attr:{cx:"12",cy:"10",r:"3"},child:[]}]})(e)}function Oa(e){return fa({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"16.5",y1:"9.4",x2:"7.5",y2:"4.21"},child:[]},{tag:"path",attr:{d:"M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"},child:[]},{tag:"polyline",attr:{points:"3.27 6.96 12 12.01 20.73 6.96"},child:[]},{tag:"line",attr:{x1:"12",y1:"22.08",x2:"12",y2:"12"},child:[]}]})(e)}function qa(e){return fa({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M21.21 15.89A10 10 0 1 1 8 2.83"},child:[]},{tag:"path",attr:{d:"M22 12A10 10 0 0 0 12 2v10z"},child:[]}]})(e)}function za(e){return fa({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"12",y1:"5",x2:"12",y2:"19"},child:[]},{tag:"line",attr:{x1:"5",y1:"12",x2:"19",y2:"12"},child:[]}]})(e)}function Ma(e){return fa({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"6 9 6 2 18 2 18 9"},child:[]},{tag:"path",attr:{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"},child:[]},{tag:"rect",attr:{x:"6",y:"14",width:"12",height:"8"},child:[]}]})(e)}function Ua(e){return fa({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"23 4 23 10 17 10"},child:[]},{tag:"polyline",attr:{points:"1 20 1 14 7 14"},child:[]},{tag:"path",attr:{d:"M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"},child:[]}]})(e)}function Wa(e){return fa({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"11",cy:"11",r:"8"},child:[]},{tag:"line",attr:{x1:"21",y1:"21",x2:"16.65",y2:"16.65"},child:[]}]})(e)}function Ha(e){return fa({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"22",y1:"2",x2:"11",y2:"13"},child:[]},{tag:"polygon",attr:{points:"22 2 15 22 11 13 2 9 22 2"},child:[]}]})(e)}function Va(e){return fa({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"3"},child:[]},{tag:"path",attr:{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"},child:[]}]})(e)}function Ga(e){return fa({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"},child:[]}]})(e)}function Ja(e){return fa({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"},child:[]},{tag:"line",attr:{x1:"7",y1:"7",x2:"7.01",y2:"7"},child:[]}]})(e)}function Ya(e){return fa({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"3 6 5 6 21 6"},child:[]},{tag:"path",attr:{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"},child:[]},{tag:"line",attr:{x1:"10",y1:"11",x2:"10",y2:"17"},child:[]},{tag:"line",attr:{x1:"14",y1:"11",x2:"14",y2:"17"},child:[]}]})(e)}function Ka(e){return fa({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"23 18 13.5 8.5 8.5 13.5 1 6"},child:[]},{tag:"polyline",attr:{points:"17 18 23 18 23 12"},child:[]}]})(e)}function Qa(e){return fa({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"23 6 13.5 15.5 8.5 10.5 1 18"},child:[]},{tag:"polyline",attr:{points:"17 6 23 6 23 12"},child:[]}]})(e)}function $a(e){return fa({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"16 16 12 12 8 16"},child:[]},{tag:"line",attr:{x1:"12",y1:"12",x2:"12",y2:"21"},child:[]},{tag:"path",attr:{d:"M20.39 18.39A5 5 0 0 0 18 9h-1.26A8 8 0 1 0 3 16.3"},child:[]},{tag:"polyline",attr:{points:"16 16 12 12 8 16"},child:[]}]})(e)}function Xa(e){return fa({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"},child:[]},{tag:"polyline",attr:{points:"17 8 12 3 7 8"},child:[]},{tag:"line",attr:{x1:"12",y1:"3",x2:"12",y2:"15"},child:[]}]})(e)}function Za(e){return fa({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"},child:[]},{tag:"circle",attr:{cx:"12",cy:"7",r:"4"},child:[]}]})(e)}function en(e){return fa({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"10"},child:[]},{tag:"line",attr:{x1:"15",y1:"9",x2:"9",y2:"15"},child:[]},{tag:"line",attr:{x1:"9",y1:"9",x2:"15",y2:"15"},child:[]}]})(e)}function tn(e){return fa({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"18",y1:"6",x2:"6",y2:"18"},child:[]},{tag:"line",attr:{x1:"6",y1:"6",x2:"18",y2:"18"},child:[]}]})(e)}const an=e=>{let{children:t}=e;const a=(0,w.Zp)(),{logout:s,user:l,updateProfile:o}=y(),[c,d]=(0,n.useState)(!1),[u,h]=(0,n.useState)({name:"",email:""});n.useEffect(()=>{l&&h({name:l.name||"",email:l.email||""})},[l]);const p=[{title:"Financial Operations",items:[{path:"/accountant/latex",icon:Sa,label:"Verify Latex Billing",color:"#10B981"},{path:"/accountant/wages",icon:_a,label:"Auto Wages",color:"#3B82F6"},{path:"/accountant/salaries",icon:Ba,label:"Salaries",color:"#06B6D4"},{path:"/accountant/payments",icon:Ca,label:"Bill Payments",color:"#84CC16"},{path:"/accountant/vendors",icon:ja,label:"Vendor Ledger",color:"#EC4899"}]},{title:"Operations Management",items:[{path:"/accountant/stock",icon:Oa,label:"Stock Monitor",color:"#8B5CF6"},{path:"/accountant/barrels",icon:ka,label:"Delivery Intake/Verify",color:"#F97316"},{path:"/accountant/attendance",icon:Aa,label:"Attendance",color:"#F59E0B"},{path:"/accountant/leave",icon:Na,label:"Leave Management",color:"#EF4444"}]},{title:"Reports & Documentation",items:[{path:"/accountant/reports",icon:ya,label:"Financial Reports",color:"#A855F7"},{path:"/accountant/tax",icon:Ea,label:"Tax Filing",color:"#6366F1"},{path:"/accountant/documents",icon:$a,label:"Documents",color:"#14B8A6"}]}];return(0,x.jsxs)("div",{className:"modern-dashboard",children:[(0,x.jsxs)("aside",{className:"modern-sidebar",children:[(0,x.jsxs)("div",{className:"sidebar-brand",children:[(0,x.jsx)("div",{className:"brand-logo",children:(0,x.jsxs)("svg",{width:"32",height:"32",viewBox:"0 0 32 32",fill:"none",children:[(0,x.jsx)("rect",{width:"32",height:"32",rx:"8",fill:"url(#brandGradient)"}),(0,x.jsx)("path",{d:"M8 16L14 10L24 20L18 26L8 16Z",fill:"white",fillOpacity:"0.9"}),(0,x.jsx)("defs",{children:(0,x.jsxs)("linearGradient",{id:"brandGradient",x1:"0",y1:"0",x2:"32",y2:"32",children:[(0,x.jsx)("stop",{stopColor:"#3B82F6"}),(0,x.jsx)("stop",{offset:"1",stopColor:"#1D4ED8"})]})})]})}),(0,x.jsxs)("div",{className:"brand-text",children:[(0,x.jsx)("h3",{children:"Holy Family Polymers"}),(0,x.jsx)("span",{children:"Accountant Module"})]})]}),(0,x.jsx)("nav",{className:"sidebar-navigation",children:p.map((e,t)=>(0,x.jsxs)("div",{className:"nav-section",children:[(0,x.jsx)("h4",{className:"nav-section-title",children:e.title}),(0,x.jsx)("ul",{className:"nav-list",children:e.items.map(e=>{const t=e.icon,a=e.path.startsWith("/")?e.path:"/".concat(e.path);return(0,x.jsx)("li",{className:"nav-item",children:(0,x.jsxs)(r.k2,{to:a,className:e=>{let{isActive:t}=e;return"nav-link ".concat(t?"active":"")},children:[(0,x.jsx)("div",{className:"nav-icon",style:{"--icon-color":e.color},children:(0,x.jsx)(t,{})}),(0,x.jsx)("span",{className:"nav-label",children:e.label})]})},a)})})]},t))}),(0,x.jsx)("div",{className:"sidebar-footer",children:(0,x.jsxs)("div",{className:"user-card",children:[(0,x.jsx)("div",{className:"user-avatar",children:(0,x.jsx)(Za,{})}),(0,x.jsx)("div",{className:"user-info",children:(0,x.jsx)("span",{className:"user-name",children:(null===l||void 0===l?void 0:l.name)||"Jeffin"})})]})})]}),(0,x.jsxs)("div",{className:"main-wrapper",children:[(0,x.jsx)("header",{className:"modern-header",children:(0,x.jsxs)("div",{className:"header-content",children:[(0,x.jsxs)("div",{className:"header-greeting",children:[(0,x.jsxs)("h1",{children:[(()=>{const e=(new Date).getHours();return e<12?"Good Morning":e<18?"Good Afternoon":"Good Evening"})(),", ",(null===l||void 0===l?void 0:l.name)||"Jeffin","!"]}),(0,x.jsx)("p",{children:"Welcome to your dashboard \ud83d\udc4b"})]}),(0,x.jsxs)("div",{className:"header-actions",children:[(0,x.jsxs)("button",{className:"action-btn notification-btn",onClick:()=>a("/accountant/alerts"),title:"Notifications",children:[(0,x.jsx)(ba,{}),(0,x.jsx)("span",{className:"notification-badge",children:"3"})]}),(0,x.jsx)("button",{className:"action-btn",onClick:()=>d(!0),title:"Settings",children:(0,x.jsx)(Va,{})}),(0,x.jsxs)("div",{className:"header-user-info",children:[(0,x.jsx)("div",{className:"header-user-avatar",children:(0,x.jsx)(Za,{})}),(0,x.jsxs)("div",{className:"header-user-details",children:[(0,x.jsx)("span",{className:"header-user-name",children:(null===l||void 0===l?void 0:l.name)||"Jeffin"}),(0,x.jsx)("span",{className:"header-user-role",children:"Accountant"})]})]})]})]})}),(0,x.jsx)("main",{className:"main-content",children:t})]}),c&&(0,x.jsx)("div",{className:"modal-overlay",children:(0,x.jsxs)("div",{className:"modal-container",children:[(0,x.jsxs)("div",{className:"modal-header",children:[(0,x.jsx)("h2",{children:"Edit Profile"}),(0,x.jsx)("button",{className:"modal-close",onClick:()=>d(!1),children:"\xd7"})]}),(0,x.jsxs)("form",{onSubmit:async e=>{e.preventDefault();try{await o(u),d(!1)}catch(t){console.error("Failed to update profile",t)}},className:"modal-form",children:[(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{htmlFor:"name",children:"Full Name"}),(0,x.jsx)("input",{id:"name",type:"text",value:u.name,onChange:e=>h((0,i.A)((0,i.A)({},u),{},{name:e.target.value})),placeholder:"Enter your full name"})]}),(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{htmlFor:"email",children:"Email Address"}),(0,x.jsx)("input",{id:"email",type:"email",value:u.email,onChange:e=>h((0,i.A)((0,i.A)({},u),{},{email:e.target.value})),placeholder:"Enter your email address"})]}),(0,x.jsxs)("div",{className:"modal-actions",children:[(0,x.jsx)("button",{type:"button",className:"btn-secondary",onClick:()=>d(!1),children:"Cancel"}),(0,x.jsx)("button",{type:"submit",className:"btn-primary",children:"Save Changes"})]})]})]})})]})},nn="http://localhost:5000";function sn(){const e=localStorage.getItem("token");return e?{Authorization:"Bearer ".concat(e)}:{}}async function rn(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=(await m.A.get("".concat(nn,"/api/latex/admin/requests"),{params:e,headers:sn()})).data;return Array.isArray(t)?t:t.records||[]}async function ln(e,t){return(await m.A.put("".concat(nn,"/api/latex/admin/requests/").concat(e),t,{headers:sn()})).data}const on={phone:/^[1-9]\d{9}$/,email:/^[^\s@]+@[^\s@]+\.[^\s@]+$/,indianPhone:/^[6-9]\d{9}$/,positiveNumber:/^[1-9]\d*$/,decimalTwoPlaces:/^\d+(\.\d{1,2})?$/,quantity:/^[1-9]\d*(\.\d{1,2})?$/,drcPercentage:/^(100(\.00)?|[1-9]?\d(\.\d{1,2})?)$/,rate:/^[1-9]\d*(\.\d{1,2})?$/,invoiceNumber:/^[A-Z0-9-]+$/,sampleId:/^[A-Z0-9-]+$/,name:/^[a-zA-Z\s.]+$/,address:/^[a-zA-Z0-9\s,.-]+$/,noLeadingZeros:/^[1-9]\d*$/},cn={required:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Field";return!e||"string"===typeof e&&""===e.trim()?"".concat(t," is required"):null},email:e=>e?on.email.test(e)?null:"Please enter a valid email address":null,phone:e=>e?on.indianPhone.test(e)?null:"Please enter a valid 10-digit phone number starting with 6-9":null,number:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Number";return e?/^0+$/.test(e.toString())?"".concat(t," cannot be all zeros"):e.toString().length>1&&e.toString().startsWith("0")?"".concat(t," cannot start with zero"):on.positiveNumber.test(e.toString())?null:"".concat(t," must be a positive number"):null},decimal:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Amount",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.01,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:999999.99;if(!e)return null;const s=parseFloat(e);if(isNaN(s))return"".concat(t," must be a valid number");if(0===s)return"".concat(t," cannot be zero");if(s<a)return"".concat(t," must be at least ").concat(a);if(s>n)return"".concat(t," cannot exceed ").concat(n);if((e.toString().split(".")[1]||"").length>2)return"".concat(t," can have maximum 2 decimal places");const r=Math.round(100*s)/100;return Math.abs(s-r)>.001?"".concat(t," must be in increments of 0.01"):null},quantity:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Quantity";if(!e)return null;const a=parseFloat(e);return isNaN(a)?"".concat(t," must be a valid number"):a<=0?"".concat(t," must be greater than 0"):a<.01?"".concat(t," must be at least 0.01"):a>1e4?"".concat(t," cannot exceed 10,000 liters"):null},drcPercentage:e=>{if(!e)return null;const t=parseFloat(e);return isNaN(t)?"DRC percentage must be a valid number":t<0||t>100?"DRC percentage must be between 0 and 100":null},rate:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Rate";if(!e)return null;const a=parseFloat(e);return isNaN(a)?"".concat(t," must be a valid number"):a<=0?"".concat(t," must be greater than 0"):a<.01?"".concat(t," must be at least \u20b90.01"):a>1e4?"".concat(t," cannot exceed \u20b910,000 per kg"):null},date:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Date";if(!e)return null;const a=new Date(e);return isNaN(a.getTime())?"".concat(t," must be a valid date"):null},toDate:function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"To Date";if(!e)return null;const n=new Date(e),s=t?new Date(t):new Date;if(isNaN(n.getTime()))return"".concat(a," must be a valid date");if(n<=s)return"".concat(a," must be after the from date");const r=new Date;return r.setFullYear(r.getFullYear()+1),n>r?"".concat(a," cannot be more than 1 year in the future"):null},name:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Name";return e?on.name.test(e)?e.trim().length<2?"".concat(t," must be at least 2 characters long"):e.trim().length>50?"".concat(t," cannot exceed 50 characters"):null:"".concat(t," can only contain letters, spaces, and dots"):null},address:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Address";return e?on.address.test(e)?e.trim().length<5?"".concat(t," must be at least 5 characters long"):e.trim().length>200?"".concat(t," cannot exceed 200 characters"):null:"".concat(t," contains invalid characters"):null},password:e=>e?e.length<8?"Password must be at least 8 characters long":e.length>50?"Password cannot exceed 50 characters":e.includes(" ")?"Password cannot contain spaces":/(?=.*[a-z])/.test(e)?/(?=.*[A-Z])/.test(e)?/(?=.*\d)/.test(e)?/(?=.*[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?])/.test(e)?null:"Password must contain at least one special character (!@#$%^&*()_+-=[]{};':\"|,.<>/?)":"Password must contain at least one number":"Password must contain at least one uppercase letter":"Password must contain at least one lowercase letter":"Password is required",role:e=>{const t=["admin","manager","user","accountant","lab","field_staff","delivery"];return e?t.includes(e.toLowerCase())?null:"Role must be one of: ".concat(t.join(", ")):"Role is required"},barrelCount:e=>{if(!e)return null;const t=parseInt(e);return isNaN(t)?"Barrel count must be a valid number":t<0?"Barrel count cannot be negative":t>1e3?"Barrel count cannot exceed 1000":null},sampleId:e=>e?on.sampleId.test(e)?e.length<3?"Sample ID must be at least 3 characters long":e.length>20?"Sample ID cannot exceed 20 characters":null:"Sample ID can only contain uppercase letters, numbers, and hyphens":null},dn=(e,t)=>{const a={};return Object.keys(t).forEach(n=>{const s=t[n],r=e[n];for(const e of s){const t=e(r,n);if(t){a[n]=t;break}}}),{isValid:0===Object.keys(a).length,errors:a}},un=(e,t,a)=>{for(const n of t){const t=n(e,a);if(t)return t}return null},hn={login:{email:[cn.required,cn.email],password:[cn.required]},userRegistration:{name:[cn.required,cn.name],email:[cn.required,cn.email],phoneNumber:[cn.required,cn.phone],password:[cn.required,cn.password],confirmPassword:[cn.required]},latexRequest:{quantity:[cn.required,cn.quantity],quality:[cn.required],location:[cn.required,cn.address],contactNumber:[cn.required,cn.phone],notes:[]},rateUpdate:{companyRate:[cn.required,cn.rate],marketRate:[cn.required,cn.rate],effectiveDate:[cn.required,cn.date]},dateRange:{fromDate:[cn.required,cn.date],toDate:[cn.required,cn.date,(e,t,a)=>cn.toDate(e,null===a||void 0===a?void 0:a.fromDate,t)]},barrelData:{barrelCount:[cn.required,cn.barrelCount],drcPercentage:[cn.required,cn.drcPercentage],quantity:[cn.required,cn.quantity]}},pn=function(){return dn(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},hn.userRegistration).errors||{}},fn=["name","type","value","onChange","onBlur","placeholder","label","validationRules","fieldName","required","disabled","className","helperText"],mn=e=>{let{name:t,type:a="text",value:s,onChange:r,onBlur:o,placeholder:c="",label:d="",validationRules:u=[],fieldName:h="",required:p=!1,disabled:f=!1,className:m="",helperText:g=""}=e,v=l(e,fn);const[y,b]=(0,n.useState)(""),[j,w]=(0,n.useState)(!1);(0,n.useEffect)(()=>{if(j&&u.length>0){const e=un(s,u,h||t);b(e||"")}},[s,j,u,h,t]);const N="\n    form-input \n    ".concat(y?"error":""," \n    ").concat(!y&&s&&j?"valid":""," \n    ").concat(m,"\n  ").trim(),S="\n    input-group floating has-status \n    ".concat(y?"error":""," \n    ").concat(p?"required":"","\n  ").trim();return(0,x.jsxs)("div",{className:S,children:[!d&&(0,x.jsx)("label",{htmlFor:t,className:"sr-only",children:v["aria-label"]||t}),(0,x.jsx)("input",(0,i.A)({id:t,name:t,type:a,value:s,onChange:e=>{e.target.value;r(e),y&&b("")},onBlur:e=>{if(w(!0),u.length>0){const e=un(s,u,h||t);b(e||"")}o&&o(e)},placeholder:c||void 0,required:p,disabled:f,className:N,"aria-label":v["aria-label"]||(d?void 0:t),title:v["aria-label"]||d||t},v)),d&&(0,x.jsx)("label",{htmlFor:t,children:d}),(0,x.jsx)("div",{className:"helper-text",children:y||g}),!y&&s&&j&&(0,x.jsx)("span",{className:"input-status","aria-hidden":!0,children:(0,x.jsx)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,x.jsx)("path",{d:"M20 6L9 17l-5-5",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})})]})},xn=e=>{let{fromDate:t,toDate:a,onFromDateChange:s,onToDateChange:r,fromDateLabel:i="From Date",toDateLabel:l="To Date",required:o=!1,className:c="",helperText:d=""}=e;const[u,h]=(0,n.useState)(""),[p,f]=(0,n.useState)("");(0,n.useEffect)(()=>{if(t){const e=cn.date(t,i);h(e||"")}else h(o?"".concat(i," is required"):"")},[t,i,o]),(0,n.useEffect)(()=>{if(a){const e=cn.date(a,l),n=cn.toDate(a,t,l);f(e||n||"")}else f(o?"".concat(l," is required"):"")},[a,t,l,o]);const m=()=>{const e=new Date,t=new Date;return t.setFullYear(e.getFullYear()+1),t.toISOString().split("T")[0]};return(0,x.jsxs)("div",{className:"date-range-input ".concat(c),children:[(0,x.jsxs)("div",{className:"date-inputs",children:[(0,x.jsxs)("div",{className:"input-group ".concat(u?"error":""),children:[(0,x.jsxs)("label",{htmlFor:"fromDate",children:[i," ",o&&(0,x.jsx)("span",{className:"required",children:"*"})]}),(0,x.jsx)("input",{id:"fromDate",type:"date",value:t,onChange:e=>{const t=e.target.value;s(e),a&&t&&new Date(a)<=new Date(t)&&r({target:{value:""}})},max:m(),className:"form-input ".concat(u?"error":""),required:o}),u&&(0,x.jsx)("div",{className:"error-message",children:u})]}),(0,x.jsxs)("div",{className:"input-group ".concat(p?"error":""),children:[(0,x.jsxs)("label",{htmlFor:"toDate",children:[l," ",o&&(0,x.jsx)("span",{className:"required",children:"*"})]}),(0,x.jsx)("input",{id:"toDate",type:"date",value:a,onChange:e=>{r(e)},min:(()=>{if(t){const e=new Date(t);return e.setDate(e.getDate()+1),e.toISOString().split("T")[0]}return""})(),max:m(),className:"form-input ".concat(p?"error":""),required:o,disabled:!t}),p&&(0,x.jsx)("div",{className:"error-message",children:p})]})]}),d&&(0,x.jsx)("div",{className:"helper-text",children:d}),(0,x.jsx)("style",{jsx:!0,children:"\n        .date-range-input {\n          display: flex;\n          flex-direction: column;\n          gap: 8px;\n        }\n        \n        .date-inputs {\n          display: flex;\n          gap: 12px;\n          align-items: end;\n        }\n        \n        .input-group {\n          display: flex;\n          flex-direction: column;\n          gap: 4px;\n          flex: 1;\n        }\n        \n        .input-group label {\n          font-size: 14px;\n          font-weight: 500;\n          color: #374151;\n        }\n        \n        .required {\n          color: #ef4444;\n        }\n        \n        .form-input {\n          padding: 8px 12px;\n          border: 1px solid #d1d5db;\n          border-radius: 6px;\n          font-size: 14px;\n          transition: border-color 0.2s;\n        }\n        \n        .form-input:focus {\n          outline: none;\n          border-color: #3b82f6;\n          box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);\n        }\n        \n        .form-input.error {\n          border-color: #ef4444;\n        }\n        \n        .form-input:disabled {\n          background-color: #f9fafb;\n          color: #6b7280;\n          cursor: not-allowed;\n        }\n        \n        .error-message {\n          color: #ef4444;\n          font-size: 12px;\n          margin-top: 2px;\n        }\n        \n        .helper-text {\n          color: #6b7280;\n          font-size: 12px;\n        }\n        \n        @media (max-width: 640px) {\n          .date-inputs {\n            flex-direction: column;\n            gap: 8px;\n          }\n        }\n      "})]})},gn={pending:"#aa8800",approved:"#0b6e4f",rejected:"#b00020",paid:"#2a5bd7",TEST_COMPLETED:"#2563eb",ACCOUNT_CALCULATED:"#7c3aed"};function vn(){const[e,t]=(0,n.useState)([]),[a,s]=(0,n.useState)(!0),[r,i]=(0,n.useState)(1),[l,o]=(0,n.useState)(""),[c,d]=(0,n.useState)("current"),[u,h]=(0,n.useState)(""),[p,f]=(0,n.useState)(""),[g,v]=(0,n.useState)(""),[y,b]=(0,n.useState)(0),[j,w]=(0,n.useState)(!1),[N,S]=(0,n.useState)(""),k=Ae(),A=async()=>{try{const e=await async function(){var e;return(null===(e=(await m.A.get("".concat(nn,"/api/rates/company"),{headers:sn()})).data)||void 0===e?void 0:e.rate)||0}();b(e)}catch(e){console.error("Failed to load company rate:",e),b(0)}},C=async()=>{s(!0);try{const e={page:r,limit:"history"===c?50:20,status:l||void 0};"history"===c&&(u&&(e.dateFrom=u),p&&(e.dateTo=p));const a=await rn(e);t(a)}catch(e){t([])}finally{s(!1)}};(0,n.useEffect)(()=>{C(),A()},[r,l,c,u,p]);const _=(0,n.useMemo)(()=>g?e.filter(e=>{var t,a;return((null===(t=e.user)||void 0===t?void 0:t.name)||"").toLowerCase().includes(g.toLowerCase())||(e.overrideBuyerName||"").toLowerCase().includes(g.toLowerCase())||((null===(a=e.user)||void 0===a?void 0:a.email)||"").toLowerCase().includes(g.toLowerCase())||(e._id||"").toLowerCase().includes(g.toLowerCase())||(e.status||"").toLowerCase().includes(g.toLowerCase())}):e,[e,g]),L=(0,n.useMemo)(()=>{const t={};return e.forEach(e=>{t[e.status]=(t[e.status]||0)+1}),t},[e]),T=async e=>{var t,a;const n={},s=e.overrideBuyerName||(null===(t=e.user)||void 0===t?void 0:t.name);if(s&&"-"!==s){const e=cn.name(s,"Customer Name");e&&(n.userName=e)}else n.userName="Customer name is required. Please set overrideBuyerName or ensure user has a name.";const r=cn.quantity(e.quantity,"Quantity");r&&(n.quantity=r);const i=cn.drcPercentage(e.drcPercentage);i&&(n.drcPercentage=i);const l=cn.rate(y,"Company Rate");return l&&(n.companyRate=l),null!==(a=e.user)&&void 0!==a&&a._id||e.overrideBuyerName||(n.userId="User ID or override buyer name is required"),e._id||(n.requestId="Request ID is required"),n},E=async(t,a)=>{const n=e.find(e=>e._id===t);if(n){const e=await T(n);if(Object.keys(e).length>0)return void alert("Validation failed: ".concat(Object.values(e).join(", ")))}if(await k("Confirm action","Are you sure to set status to ".concat(a,"?")))try{await ln(t,{status:a}),"approved"===a&&await D(t,n),await C()}catch(i){var s,r;const e=(null===i||void 0===i||null===(s=i.response)||void 0===s||null===(r=s.data)||void 0===r?void 0:r.message)||(null===i||void 0===i?void 0:i.message)||"Failed to update status";alert(e)}},D=async(e,t)=>{try{var a;const n="http://localhost:5000",s=localStorage.getItem("token");await fetch("".concat(n,"/api/notifications/staff-trip-event"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(s)},body:JSON.stringify({title:"Latex Billing Ready for Manager Verification",message:"Sample ".concat(e," billing approved by accountant and ready for manager verification"),link:"/manager/latex-billing",meta:{sampleId:String(e),customerName:(null===t||void 0===t||null===(a=t.user)||void 0===a?void 0:a.name)||"Customer",calculatedAmount:null===t||void 0===t?void 0:t.calculatedAmount,companyRate:y,quantity:null===t||void 0===t?void 0:t.quantity,drcPercentage:null===t||void 0===t?void 0:t.drcPercentage,requestId:e},targetRole:"manager"})})}catch(n){console.warn("Failed to notify manager:",n)}},P=async e=>{const t=await T(e);if(Object.keys(t).length>0)return void alert("Validation failed: ".concat(Object.values(t).join(", ")));if(await k("Confirm calculation","Calculate amount using company rate \u20b9".concat(y,"/kg for request ").concat(e._id,"?")))try{await async function(e){return(await m.A.put("".concat(nn,"/api/latex/admin/calc-company-rate/").concat(e),{},{headers:sn()})).data}(e._id),await C(),await D(e._id,e)}catch(s){var a,n;const e=(null===s||void 0===s||null===(a=s.response)||void 0===a||null===(n=a.data)||void 0===n?void 0:n.message)||(null===s||void 0===s?void 0:s.message)||"Failed to calculate";alert(e)}};return(0,x.jsxs)("div",{className:"verify-latex-container",children:[(0,x.jsxs)("div",{className:"verify-header",children:[(0,x.jsx)("h2",{children:"Verify Latex Billing"}),(0,x.jsxs)("div",{className:"view-mode-toggles",children:[(0,x.jsx)("button",{className:"current"===c?"btn":"btn-secondary",onClick:()=>{d("current"),i(1)},children:"Current"}),(0,x.jsx)("button",{className:"history"===c?"btn":"btn-secondary",onClick:()=>{d("history"),i(1)},children:"History"})]})]}),(0,x.jsxs)("div",{className:"company-rate-section",children:[(0,x.jsx)("span",{className:"rate-label",children:"Company Rate:"}),(0,x.jsxs)("span",{className:"rate-badge",children:["\u20b9",y,"/kg"]}),(0,x.jsx)("div",{className:"rate-actions",children:j?(0,x.jsxs)("div",{className:"rate-edit-group",children:[(0,x.jsx)("input",{type:"number",className:"rate-input",value:N,onChange:e=>S(e.target.value),placeholder:"Enter new rate",min:"0",step:"0.01"}),(0,x.jsx)("button",{className:"btn",onClick:async()=>{const e=parseFloat(N);if(!e||e<=0)return void alert("Please enter a valid rate greater than 0");if(await k({title:"Update Company Rate",message:"Are you sure you want to update the company rate from \u20b9".concat(y,"/kg to \u20b9").concat(e,"/kg?"),confirmText:"Update",cancelText:"Cancel"}))try{await async function(e){return(await m.A.put("".concat(nn,"/api/rates/company"),{rate:e},{headers:sn()})).data}(e),await A(),w(!1),S(""),alert("Company rate updated successfully!")}catch(n){var t,a;console.error("Failed to update company rate:",n),alert((null===n||void 0===n||null===(t=n.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.message)||"Failed to update company rate")}},children:"Save"}),(0,x.jsx)("button",{className:"btn-secondary",onClick:()=>{w(!1),S("")},children:"Cancel"})]}):(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("button",{className:"btn-secondary",onClick:A,title:"Refresh current rate",children:"Refresh Rate"}),(0,x.jsx)("button",{className:"btn",onClick:()=>{w(!0),S(y.toString())},children:"Update Rate"})]})})]}),"history"===c&&Object.keys(L).length>0&&(0,x.jsxs)("div",{className:"stats-section",children:[(0,x.jsx)("strong",{children:"Status Summary:"}),Object.entries(L).map(e=>{let[t,a]=e;return(0,x.jsxs)("span",{className:"stat-badge",style:{backgroundColor:gn[t]||"#6b7280"},children:[t,": ",a]},t)})]}),(0,x.jsxs)("div",{className:"controls-toolbar",children:[(0,x.jsx)("label",{htmlFor:"status-filter",className:"sr-only",children:"Filter by status"}),(0,x.jsxs)("select",{id:"status-filter",className:"filter-select",value:l,onChange:e=>{i(1),o(e.target.value)},children:[(0,x.jsx)("option",{value:"",children:"All Status"}),(0,x.jsx)("option",{value:"pending",children:"Pending"}),(0,x.jsx)("option",{value:"TEST_COMPLETED",children:"Test Completed"}),(0,x.jsx)("option",{value:"ACCOUNT_CALCULATED",children:"Account Calculated"}),(0,x.jsx)("option",{value:"approved",children:"Approved"}),(0,x.jsx)("option",{value:"rejected",children:"Rejected"}),(0,x.jsx)("option",{value:"paid",children:"Paid"})]}),"history"===c&&(0,x.jsx)(xn,{fromDate:u,toDate:p,onFromDateChange:e=>{h(e.target.value),i(1)},onToDateChange:e=>{f(e.target.value),i(1)},fromDateLabel:"From Date",toDateLabel:"To Date",helperText:""}),(0,x.jsx)("div",{className:"search-container",children:(0,x.jsx)(mn,{name:"searchTerm",type:"text",value:g,onChange:e=>v(e.target.value),placeholder:"Search customer, ID, or status...",validationRules:[],"aria-label":"Search latex requests"})}),(0,x.jsx)("button",{className:"btn refresh-btn",onClick:()=>{i(1),C()},children:"Refresh"})]}),a?(0,x.jsx)("p",{children:"Loading..."}):0===_.length?(0,x.jsx)("div",{className:"no-data",children:"No requests found"}):(0,x.jsx)("div",{className:"table-wrap",children:(0,x.jsxs)("table",{className:"table",children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{children:"Date"}),(0,x.jsx)("th",{children:"Customer"}),(0,x.jsx)("th",{children:"Qty (Liters)"}),(0,x.jsx)("th",{children:"DRC%"}),(0,x.jsx)("th",{children:"Estimated"}),(0,x.jsx)("th",{children:"Calc Amount"}),(0,x.jsx)("th",{children:"Company Rate (\u20b9/kg)"}),(0,x.jsx)("th",{children:"Status"}),"history"===c&&(0,x.jsx)("th",{children:"Last Updated"}),"current"===c&&(0,x.jsx)("th",{children:"Action"})]})}),(0,x.jsx)("tbody",{children:_.map(e=>{var t,a,n;return(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{children:st(e.submittedAt||e.createdAt)}),(0,x.jsx)("td",{children:((t,a)=>{const n=e.overrideBuyerName||(null===(t=e.user)||void 0===t?void 0:t.name)||(null===(a=e.user)||void 0===a?void 0:a.email)||null,s=n&&"-"!==n;return(0,x.jsx)("span",{style:{color:s?"inherit":"#d32f2f",fontWeight:s?"normal":"bold"},children:n||"\u26a0\ufe0f User Name Missing"})})()}),(0,x.jsx)("td",{children:e.quantity?"".concat(e.quantity,"L"):"-"}),(0,x.jsx)("td",{children:null!==(t=e.drcPercentage)&&void 0!==t?t:"-"}),(0,x.jsx)("td",{children:null!==(a=e.estimatedPayment)&&void 0!==a?a:"-"}),(0,x.jsx)("td",{children:null!==(n=e.calculatedAmount)&&void 0!==n?n:"-"}),(0,x.jsx)("td",{children:(0,x.jsx)("span",{style:{color:e.marketRate?"inherit":"#1976d2",fontWeight:e.marketRate?"normal":"bold"},children:e.marketRate||"\u20b9".concat(y)})}),(0,x.jsx)("td",{children:(0,x.jsx)("span",{style:{color:gn[e.status]||"#333",padding:"2px 6px",borderRadius:4,backgroundColor:"".concat(gn[e.status]||"#333","20"),fontSize:"12px",fontWeight:"500"},children:e.status})}),"history"===c&&(0,x.jsx)("td",{children:st(e.updatedAt||e.createdAt)}),"current"===c&&(0,x.jsxs)("td",{className:"action-buttons",children:["TEST_COMPLETED"===e.status&&(0,x.jsx)("button",{className:"btn",onClick:()=>P(e),children:"Calculate"}),"pending"===e.status&&(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("button",{className:"btn",onClick:()=>E(e._id,"approved"),children:"Approve"}),(0,x.jsx)("button",{className:"btn-secondary",onClick:()=>E(e._id,"rejected"),children:"Reject"})]}),"approved"===e.status&&(0,x.jsx)("button",{className:"btn",onClick:()=>E(e._id,"paid"),children:"Mark Paid"})]})]},e._id)})})]})}),(0,x.jsxs)("div",{className:"pagination",children:[(0,x.jsxs)("div",{className:"pagination-controls",children:[(0,x.jsx)("button",{className:"btn-secondary",disabled:1===r,onClick:()=>i(e=>Math.max(1,e-1)),children:"Prev"}),(0,x.jsxs)("span",{children:["Page ",r]}),(0,x.jsx)("button",{className:"btn-secondary",onClick:()=>i(e=>e+1),children:"Next"})]}),"history"===c&&(0,x.jsxs)("div",{className:"pagination-info",children:["Showing ",_.length," records",g&&" (filtered from ".concat(e.length," total)"),u&&p&&" from ".concat(u," to ").concat(p)]})]})]})}const yn=e=>{let{userId:t}=e;const a=(0,w.Zp)(),{user:s}=y(),[r,i]=(0,n.useState)([]),[l,o]=(0,n.useState)(0),[c,d]=(0,n.useState)(!1),u="http://localhost:5000",h=localStorage.getItem("token"),p=h?{Authorization:"Bearer ".concat(h),"Content-Type":"application/json"}:{"Content-Type":"application/json"};(0,n.useEffect)(()=>{t&&f()},[t]);const f=async()=>{try{d(!0);const t=await fetch("".concat(u,"/api/salary-notifications"),{headers:p});if(t.ok){var e;const a=await t.json();i(a.data||[]),o((null===(e=a.data)||void 0===e?void 0:e.filter(e=>!e.isRead).length)||0)}}catch(t){console.error("Error loading salary notifications:",t)}finally{d(!1)}};return c?(0,x.jsx)("div",{style:{padding:"8px 12px",backgroundColor:"#f8f9fa",borderRadius:"4px",fontSize:"12px",color:"#6c757d"},children:"Loading notifications..."}):0===l?null:(0,x.jsxs)("div",{style:{position:"relative",display:"inline-block"},children:[(0,x.jsxs)("div",{style:{position:"relative",padding:"8px 12px",backgroundColor:"#dc3545",color:"white",borderRadius:"20px",fontSize:"12px",fontWeight:"bold",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px"},onClick:()=>{if(s)switch(s.role){case"accountant":a("/accountant/salary");break;case"admin":a("/admin/home");break;case"manager":a("/manager/home");break;case"staff":case"field_staff":case"delivery_staff":a("/staff/my-salary");break;case"lab":case"lab_staff":case"lab_manager":a("/lab/dashboard");break;default:a("/user")}else console.log("User not found")},children:[(0,x.jsx)("span",{children:"\ud83d\udcb0"}),(0,x.jsx)("span",{children:l}),(0,x.jsx)("span",{children:"Salary Alert"})]}),(0,x.jsx)("div",{style:{position:"absolute",top:"100%",left:"50%",transform:"translateX(-50%)",marginTop:"4px",padding:"8px 12px",backgroundColor:"#333",color:"white",borderRadius:"4px",fontSize:"11px",whiteSpace:"nowrap",zIndex:1e3,opacity:0,transition:"opacity 0.2s",pointerEvents:"none"},onMouseEnter:e=>e.target.style.opacity="1",onMouseLeave:e=>e.target.style.opacity="0",children:"Click to view salary notifications"})]})},bn=()=>{const e="http://localhost:5000",t=localStorage.getItem("token"),a={"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},[s,r]=(0,n.useState)(!1),[i,l]=(0,n.useState)(""),[o,c]=(0,n.useState)(null),[d,u]=(0,n.useState)([]),[h,p]=(0,n.useState)((new Date).getFullYear()),[f,m]=(0,n.useState)((new Date).getMonth()+1),[g,v]=(0,n.useState)([]),[y,b]=(0,n.useState)(0),[j,w]=(0,n.useState)(null);(0,n.useEffect)(()=>{(()=>{try{const e=localStorage.getItem("token");if(!e)return void l("Not logged in. Please login again.");const t=localStorage.getItem("userId")||localStorage.getItem("user_id"),a=localStorage.getItem("user");if(t)return w({userId:t,_id:t}),void l("");if(a){const e=JSON.parse(a);return w(e),void l("")}const n=e.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),s=decodeURIComponent(atob(n).split("").map(e=>"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)).join("")),r=JSON.parse(s);w(r),l("")}catch(e){console.error("Error getting user info:",e),console.log("Continuing without user info...")}})()},[]);const N=async()=>{r(!0),l("");try{const t=await fetch("".concat(e,"/api/unified-salary/unified?year=").concat(h,"&month=").concat(f),{headers:a});if(!t.ok)return void console.error("Salary API response:",t.status,t.statusText);const n=await t.json();c(n)}catch(t){console.error("Error loading salary:",t)}finally{r(!1)}},S=async()=>{try{const t=await fetch("".concat(e,"/api/salary-notifications"),{headers:a});if(t.ok){const e=(await t.json()).data||[];v(e),b(e.filter(e=>!e.isRead).length)}}catch(t){console.error("Error loading salary notifications:",t)}};(0,n.useEffect)(()=>{N(),(async()=>{try{const t=await fetch("".concat(e,"/api/unified-salary/unified/history?limit=12"),{headers:a});if(t.ok){const e=await t.json();u(e.history||e.data||[])}}catch(t){console.error("Error loading salary history:",t)}})(),S()},[h,f]);const k=e=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(e||0),A=e=>["January","February","March","April","May","June","July","August","September","October","November","December"][e-1]||"";return(0,x.jsxs)("div",{style:{padding:16},children:[(0,x.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:24},children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("h2",{style:{margin:0},children:"My Salary"}),(0,x.jsx)("p",{style:{margin:"8px 0 0 0",color:"#666"},children:"View your monthly salary details and history"})]}),(0,x.jsxs)("div",{style:{display:"flex",gap:12,alignItems:"center"},children:[y>0&&j&&(0,x.jsx)(yn,{userId:j.userId||j._id}),(0,x.jsx)("button",{className:"btn",onClick:()=>{N(),S()},disabled:s,children:s?"Loading...":"Refresh"})]})]}),i&&(0,x.jsx)("div",{style:{color:"red",marginBottom:16,padding:12,backgroundColor:"#fee",border:"1px solid #fcc",borderRadius:4},children:i}),g.length>0&&(0,x.jsxs)("div",{style:{marginBottom:24,backgroundColor:"#e3f2fd",padding:16,borderRadius:8,border:"1px solid #90caf9"},children:[(0,x.jsx)("h3",{style:{marginTop:0,marginBottom:12,color:"#1565c0"},children:"\ud83d\udcec Salary Notifications from Manager"}),(0,x.jsx)("div",{style:{maxHeight:200,overflowY:"auto"},children:g.slice(0,5).map((e,t)=>{var a;return(0,x.jsxs)("div",{style:{padding:12,marginBottom:8,backgroundColor:e.isRead?"#f5f5f5":"#fff",border:"1px solid #ddd",borderRadius:4,borderLeft:e.isRead?"4px solid #4caf50":"4px solid #ff9800"},children:[(0,x.jsx)("div",{style:{fontWeight:"bold",marginBottom:4},children:e.title||"Salary Calculated"}),(0,x.jsx)("div",{style:{color:"#666",fontSize:14},children:e.message}),e.data&&(0,x.jsx)("div",{style:{marginTop:8,fontSize:12,color:"#888"},children:e.data.grossSalary&&(0,x.jsxs)("div",{children:["Gross: \u20b9",e.data.grossSalary.toFixed(2)," | Net: \u20b9",null===(a=e.data.netSalary)||void 0===a?void 0:a.toFixed(2)]})}),(0,x.jsxs)("div",{style:{fontSize:11,color:"#999",marginTop:4},children:[nt(e.createdAt),!e.isRead&&(0,x.jsx)("span",{style:{marginLeft:8,color:"#ff9800"},children:"\u25cf Unread"})]})]},e._id||t)})}),g.length>5&&(0,x.jsxs)("div",{style:{textAlign:"center",marginTop:8,fontSize:12,color:"#666"},children:["Showing 5 of ",g.length," notifications"]})]}),(0,x.jsxs)("div",{style:{display:"flex",gap:12,marginBottom:24,flexWrap:"wrap"},children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{style:{display:"block",marginBottom:4,fontWeight:"bold"},children:"Year"}),(0,x.jsx)("input",{type:"number",value:h,onChange:e=>p(Number(e.target.value)),style:{padding:8,borderRadius:4,border:"1px solid #ccc"}})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{style:{display:"block",marginBottom:4,fontWeight:"bold"},children:"Month"}),(0,x.jsx)("select",{value:f,onChange:e=>m(Number(e.target.value)),style:{padding:8,borderRadius:4,border:"1px solid #ccc",minWidth:150},children:[1,2,3,4,5,6,7,8,9,10,11,12].map(e=>(0,x.jsx)("option",{value:e,children:A(e)},e))})]})]}),o&&o.salary&&(0,x.jsxs)("div",{style:{backgroundColor:"#f8f9fa",padding:24,borderRadius:8,marginBottom:24,border:"1px solid #dee2e6"},children:[(0,x.jsxs)("h3",{style:{marginTop:0,marginBottom:16},children:["Salary for ",A(f)," ",h]}),o.salary.paymentDate&&(0,x.jsxs)("div",{style:{marginBottom:16,color:"#666",fontSize:14},children:["Payment Date: ",nt(o.salary.paymentDate)]}),(0,x.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:16},children:[(0,x.jsxs)("div",{style:{backgroundColor:"white",padding:16,borderRadius:4},children:[(0,x.jsx)("div",{style:{fontSize:12,color:"#666",marginBottom:4},children:"Gross Salary"}),(0,x.jsx)("div",{style:{fontSize:24,fontWeight:"bold",color:"#28a745"},children:k(o.salary.grossSalary)})]}),(0,x.jsxs)("div",{style:{backgroundColor:"white",padding:16,borderRadius:4},children:[(0,x.jsx)("div",{style:{fontSize:12,color:"#666",marginBottom:4},children:"Deductions"}),(0,x.jsx)("div",{style:{fontSize:24,fontWeight:"bold",color:"#dc3545"},children:k(o.salary.totalDeductions||o.salary.deductions)})]}),(0,x.jsxs)("div",{style:{backgroundColor:"white",padding:16,borderRadius:4},children:[(0,x.jsx)("div",{style:{fontSize:12,color:"#666",marginBottom:4},children:"Net Salary"}),(0,x.jsx)("div",{style:{fontSize:24,fontWeight:"bold",color:"#007bff"},children:k(o.salary.netSalary)})]})]}),(0,x.jsxs)("div",{style:{marginTop:24},children:[(0,x.jsx)("h4",{style:{marginBottom:12},children:"Salary Breakdown"}),(0,x.jsx)("table",{style:{width:"100%",borderCollapse:"collapse"},children:(0,x.jsxs)("tbody",{children:[(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{style:{padding:"8px 0",color:"#666"},children:"Base Salary"}),(0,x.jsx)("td",{style:{textAlign:"right",fontWeight:"bold"},children:k(o.salary.basicSalary||o.salary.baseSalary)})]}),o.salary.overtimePay>0&&(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{style:{padding:"8px 0",color:"#666"},children:"Overtime Pay"}),(0,x.jsx)("td",{style:{textAlign:"right",fontWeight:"bold"},children:k(o.salary.overtimePay)})]}),o.salary.allowances>0&&(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{style:{padding:"8px 0",color:"#666"},children:"Allowances"}),(0,x.jsx)("td",{style:{textAlign:"right",fontWeight:"bold"},children:k(o.salary.allowances)})]}),o.salary.bonuses>0&&(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{style:{padding:"8px 0",color:"#666"},children:"Bonuses"}),(0,x.jsx)("td",{style:{textAlign:"right",fontWeight:"bold",color:"#28a745"},children:k(o.salary.bonuses)})]})]})})]})]}),!o&&!s&&(0,x.jsxs)("div",{style:{textAlign:"center",padding:40,color:"#666"},children:["No salary data found for ",A(f)," ",h]}),d.length>0&&(0,x.jsxs)("div",{style:{marginTop:24},children:[(0,x.jsx)("h3",{children:"Salary History"}),(0,x.jsx)("div",{style:{overflowX:"auto"},children:(0,x.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",backgroundColor:"white",borderRadius:8},children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{style:{backgroundColor:"#f8f9fa"},children:[(0,x.jsx)("th",{style:{padding:12,textAlign:"left",borderBottom:"2px solid #dee2e6"},children:"Month"}),(0,x.jsx)("th",{style:{padding:12,textAlign:"right",borderBottom:"2px solid #dee2e6"},children:"Gross Salary"}),(0,x.jsx)("th",{style:{padding:12,textAlign:"right",borderBottom:"2px solid #dee2e6"},children:"Deductions"}),(0,x.jsx)("th",{style:{padding:12,textAlign:"right",borderBottom:"2px solid #dee2e6"},children:"Net Salary"}),(0,x.jsx)("th",{style:{padding:12,textAlign:"center",borderBottom:"2px solid #dee2e6"},children:"Status"})]})}),(0,x.jsx)("tbody",{children:d.map((e,t)=>(0,x.jsxs)("tr",{style:{borderBottom:"1px solid #dee2e6"},children:[(0,x.jsxs)("td",{style:{padding:12},children:[A(e.month)," ",e.year]}),(0,x.jsx)("td",{style:{padding:12,textAlign:"right"},children:k(e.grossSalary)}),(0,x.jsx)("td",{style:{padding:12,textAlign:"right"},children:k(e.deductions||e.totalDeductions)}),(0,x.jsx)("td",{style:{padding:12,textAlign:"right",fontWeight:"bold"},children:k(e.netSalary)}),(0,x.jsx)("td",{style:{padding:12,textAlign:"center"},children:(0,x.jsx)("span",{style:{padding:"4px 8px",borderRadius:"4px",fontSize:12,backgroundColor:"paid"===e.status?"#d4edda":"#fff3cd",color:"paid"===e.status?"#155724":"#856404"},children:e.status||"pending"})})]},t))})]})})]})]})};function jn(){const[e,t]=(0,n.useState)(null),[a,s]=(0,n.useState)([]),[r,l]=(0,n.useState)(!0),[o,c]=(0,n.useState)(null),[d,u]=(0,n.useState)(null),[h,p]=(0,n.useState)(""),[f,g]=(0,n.useState)(""),v=async()=>{l(!0);try{const e=await async function(){return(await m.A.get("".concat(nn,"/api/stock/summary"),{headers:sn()})).data}(),a=await async function(){return(await m.A.get("".concat(nn,"/api/stock/items"),{headers:sn()})).data||[]}();t(e),s(a)}catch(e){t(null),s([])}finally{l(!1)}};return(0,n.useEffect)(()=>{v()},[]),(0,x.jsxs)("div",{children:[(0,x.jsx)("h2",{children:"Stock Monitor"}),r?(0,x.jsx)("p",{children:"Loading..."}):(0,x.jsxs)(x.Fragment,{children:[e&&(0,x.jsxs)("div",{style:{display:"flex",gap:24,marginBottom:16},children:[(0,x.jsxs)("div",{className:"stat-card",children:[(0,x.jsx)("div",{className:"stat-title",children:"Latex (L)"}),(0,x.jsx)("div",{className:"stat-value",children:e.latexLiters})]}),(0,x.jsxs)("div",{className:"stat-card",children:[(0,x.jsx)("div",{className:"stat-title",children:"Rubber Bands (units)"}),(0,x.jsx)("div",{className:"stat-value",children:e.rubberBandUnits})]})]}),(0,x.jsx)("div",{className:"table-wrap",children:(0,x.jsxs)("table",{className:"table",children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{children:"Item"}),(0,x.jsx)("th",{children:"Quantity"}),(0,x.jsx)("th",{children:"Last Updated"}),(0,x.jsx)("th",{children:"Action"})]})}),(0,x.jsx)("tbody",{children:a.map(e=>(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{children:e.productName}),(0,x.jsx)("td",{children:(null===d||void 0===d?void 0:d._id)===e._id?(0,x.jsx)("input",{type:"number",step:"any",min:0,value:d.quantityInLiters,onChange:e=>u(t=>(0,i.A)((0,i.A)({},t),{},{quantityInLiters:e.target.value})),style:{width:140}}):e.quantityInLiters}),(0,x.jsx)("td",{children:e.lastUpdated?new Date(e.lastUpdated).toLocaleString():"-"}),(0,x.jsx)("td",{children:(null===d||void 0===d?void 0:d._id)===e._id?(0,x.jsxs)("div",{style:{display:"flex",gap:8},children:[(0,x.jsx)("button",{className:"btn",disabled:o===e._id,onClick:async()=>{try{c(e._id),p(""),g("");const t=Number(d.quantityInLiters);if(!(t>=0))return void p("Enter a non-negative number");await async function(e,t){return(await m.A.put("".concat(nn,"/api/stock/items/").concat(e),t,{headers:sn()})).data}(e._id,{quantityInLiters:t}),g("Updated"),u(null),await v()}catch(t){p((null===t||void 0===t?void 0:t.message)||"Update failed")}finally{c(null)}},children:o===e._id?"Saving...":"Save"}),(0,x.jsx)("button",{className:"btn",onClick:()=>u(null),disabled:o===e._id,children:"Cancel"})]}):(0,x.jsx)("button",{className:"btn",onClick:()=>u({_id:e._id,quantityInLiters:e.quantityInLiters}),children:"Edit"})})]},e._id))})]})}),(0,x.jsx)("div",{style:{marginTop:12},children:(0,x.jsx)("button",{className:"btn",onClick:v,children:"Refresh"})}),f&&(0,x.jsx)("div",{className:"success-message",style:{marginTop:8},children:f}),h&&(0,x.jsx)("div",{className:"error-message",style:{marginTop:8},children:h})]})]})}const wn=()=>{const e="http://localhost:5000",[t,a]=(0,n.useState)([]),[s,r]=(0,n.useState)([]),[i,l]=(0,n.useState)(!0),[o,c]=(0,n.useState)(""),[d,u]=(0,n.useState)((new Date).toISOString().split("T")[0]),[h,p]=(0,n.useState)("all");(0,n.useEffect)(()=>{m(),f()},[d,h]);const f=async()=>{try{const t=localStorage.getItem("token"),a=await fetch("".concat(e,"/api/users?role=staff,delivery_staff,lab"),{headers:{Authorization:"Bearer ".concat(t)}});if(a.ok){const e=await a.json();r(e.users||e||[])}}catch(t){console.error("Error fetching staff:",t)}},m=async()=>{try{l(!0);const t=localStorage.getItem("token"),n=d,s=d,r=await fetch("".concat(e,"/api/workers/attendance?from=").concat(n,"&to=").concat(s),{headers:{Authorization:"Bearer ".concat(t)}});if(r.ok){const e=await r.json();a(Array.isArray(e)?e:[])}}catch(t){console.error("Error fetching attendance:",t)}finally{l(!1)}},g=(0,n.useMemo)(()=>{let e=t;if(o){const t=o.toLowerCase();e=e.filter(e=>{var a,n,s,r;return(null===(a=e.staff)||void 0===a||null===(n=a.name)||void 0===n?void 0:n.toLowerCase().includes(t))||(null===(s=e.staff)||void 0===s||null===(r=s.email)||void 0===r?void 0:r.toLowerCase().includes(t))})}return"all"!==h&&(e=e.filter(e=>e.status===h)),e},[t,o,h]),v=e=>{switch(e){case"present":return"badge-present";case"absent":default:return"badge-absent";case"half-day":return"badge-half-day";case"leave":return"badge-leave"}},y=e=>e?new Date(e).toLocaleTimeString("en-IN",{hour:"2-digit",minute:"2-digit"}):"-";return i?(0,x.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,x.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-sky-600"})}):(0,x.jsxs)("div",{className:"attendance-container",children:[(0,x.jsx)("div",{className:"attendance-header",children:(0,x.jsxs)("div",{className:"header-title",children:[(0,x.jsx)("h1",{children:"Attendance Management"}),(0,x.jsx)("p",{className:"header-subtitle",children:"View and manage staff attendance records"})]})}),(0,x.jsxs)("div",{className:"summary-grid",children:[(0,x.jsxs)("div",{className:"summary-card",children:[(0,x.jsxs)("div",{className:"summary-info",children:[(0,x.jsx)("p",{className:"label",children:"Total Staff"}),(0,x.jsx)("p",{className:"value",children:s.length})]}),(0,x.jsx)("div",{className:"summary-icon icon-blue",children:(0,x.jsx)(Aa,{})})]}),(0,x.jsxs)("div",{className:"summary-card",children:[(0,x.jsxs)("div",{className:"summary-info",children:[(0,x.jsx)("p",{className:"label",children:"Present"}),(0,x.jsx)("p",{className:"value text-green",children:t.filter(e=>"present"===e.status).length})]}),(0,x.jsx)("div",{className:"summary-icon icon-green",children:(0,x.jsx)(Sa,{})})]}),(0,x.jsxs)("div",{className:"summary-card",children:[(0,x.jsxs)("div",{className:"summary-info",children:[(0,x.jsx)("p",{className:"label",children:"Absent"}),(0,x.jsx)("p",{className:"value text-red",children:t.filter(e=>"absent"===e.status).length})]}),(0,x.jsx)("div",{className:"summary-icon icon-red",children:(0,x.jsx)(en,{})})]}),(0,x.jsxs)("div",{className:"summary-card",children:[(0,x.jsxs)("div",{className:"summary-info",children:[(0,x.jsx)("p",{className:"label",children:"On Leave"}),(0,x.jsx)("p",{className:"value text-blue",children:t.filter(e=>"leave"===e.status).length})]}),(0,x.jsx)("div",{className:"summary-icon icon-purple",children:(0,x.jsx)(Na,{})})]})]}),(0,x.jsxs)("div",{className:"filter-section",children:[(0,x.jsxs)("div",{className:"search-wrapper",children:[(0,x.jsx)("label",{htmlFor:"attendance-search",className:"sr-only",children:"Search attendance"}),(0,x.jsx)(Wa,{className:"search-icon"}),(0,x.jsx)("input",{id:"attendance-search",type:"text",placeholder:"Search by name or email...",value:o,onChange:e=>c(e.target.value),className:"search-input"})]}),(0,x.jsx)("input",{type:"date",value:d,onChange:e=>u(e.target.value),className:"filter-date"}),(0,x.jsxs)("select",{value:h,onChange:e=>p(e.target.value),className:"filter-select",children:[(0,x.jsx)("option",{value:"all",children:"All Status"}),(0,x.jsx)("option",{value:"present",children:"Present"}),(0,x.jsx)("option",{value:"absent",children:"Absent"}),(0,x.jsx)("option",{value:"half-day",children:"Half Day"}),(0,x.jsx)("option",{value:"leave",children:"On Leave"})]})]}),(0,x.jsx)("div",{className:"table-container",children:(0,x.jsx)("div",{className:"table-responsive",children:(0,x.jsxs)("table",{children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{children:"Staff"}),(0,x.jsx)("th",{children:"Date"}),(0,x.jsx)("th",{children:"Check In"}),(0,x.jsx)("th",{children:"Check Out"}),(0,x.jsx)("th",{children:"Hours"}),(0,x.jsx)("th",{children:"Status"}),(0,x.jsx)("th",{children:"Verified"})]})}),(0,x.jsx)("tbody",{children:0===g.length?(0,x.jsx)("tr",{children:(0,x.jsx)("td",{colSpan:"7",className:"empty-state",children:"No attendance records found for this date"})}):g.map(e=>{var t,a;return(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{children:(0,x.jsxs)("div",{className:"user-cell",children:[(0,x.jsx)("div",{className:"user-name",children:(null===(t=e.staff)||void 0===t?void 0:t.name)||"Unknown"}),(0,x.jsx)("div",{className:"user-email",children:(null===(a=e.staff)||void 0===a?void 0:a.email)||"-"})]})}),(0,x.jsx)("td",{children:new Date(e.date).toLocaleDateString()}),(0,x.jsx)("td",{children:y(e.checkInAt)}),(0,x.jsx)("td",{children:y(e.checkOutAt)}),(0,x.jsx)("td",{children:e.hoursWorked?"".concat(e.hoursWorked.toFixed(1),"h"):"-"}),(0,x.jsx)("td",{children:(0,x.jsx)("span",{className:"status-badge ".concat(v(e.status)),children:e.status||"absent"})}),(0,x.jsx)("td",{children:e.verified?(0,x.jsx)("span",{className:"status-badge badge-verified",children:"Verified"}):(0,x.jsx)("span",{className:"status-badge badge-pending",children:"Pending"})})]},e._id)})})]})})})]})},Nn=()=>{const e="http://localhost:5000",[t,a]=(0,n.useState)([]),[s,r]=(0,n.useState)(""),[l,o]=(0,n.useState)({date:(new Date).toISOString().split("T")[0],checkInAt:"",checkOutAt:"",status:"present",notes:""}),[c,d]=(0,n.useState)(!1),[u,h]=(0,n.useState)(!1);(0,n.useEffect)(()=>{p()},[]);const p=async()=>{try{d(!0);const t=localStorage.getItem("token"),n=await fetch("".concat(e,"/api/users?role=staff,delivery_staff,lab"),{headers:{Authorization:"Bearer ".concat(t)}});if(n.ok){const e=await n.json();a(e.users||e||[])}}catch(t){console.error("Error fetching staff:",t)}finally{d(!1)}};return c?(0,x.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,x.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-sky-600"})}):(0,x.jsxs)("div",{className:"space-y-6",children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("h1",{className:"text-3xl font-bold text-slate-800",children:"Mark Attendance"}),(0,x.jsx)("p",{className:"text-slate-600 mt-1",children:"Manually mark attendance for staff members"})]}),(0,x.jsx)("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-slate-200",children:(0,x.jsxs)("form",{onSubmit:async t=>{if(t.preventDefault(),s)try{h(!0);const t=localStorage.getItem("token"),a={staffId:s,date:l.date,checkInAt:l.checkInAt?"".concat(l.date,"T").concat(l.checkInAt,":00"):null,checkOutAt:l.checkOutAt?"".concat(l.date,"T").concat(l.checkOutAt,":00"):null,notes:l.notes,verified:!0},n=await fetch("".concat(e,"/api/workers/attendance/admin-mark"),{method:"POST",headers:{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"},body:JSON.stringify(a)});if(n.ok)alert("Attendance marked successfully"),o({date:(new Date).toISOString().split("T")[0],checkInAt:"",checkOutAt:"",status:"present",notes:""}),r("");else{const e=await n.json();alert(e.message||"Failed to mark attendance")}}catch(a){console.error("Error marking attendance:",a),alert("Failed to mark attendance")}finally{h(!1)}else alert("Please select a staff member")},className:"space-y-4",children:[(0,x.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{htmlFor:"attendance-staff-select",className:"block text-sm font-medium text-slate-700 mb-1",children:"Staff Member *"}),(0,x.jsxs)("select",{id:"attendance-staff-select",required:!0,value:s,onChange:e=>r(e.target.value),"aria-label":"Select staff member",className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-sky-500",children:[(0,x.jsx)("option",{value:"",children:"Select staff member"}),t.map(e=>(0,x.jsxs)("option",{value:e._id,children:[e.name," (",e.email,")"]},e._id))]})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{htmlFor:"attendance-date-input",className:"block text-sm font-medium text-slate-700 mb-1",children:"Date *"}),(0,x.jsx)("input",{id:"attendance-date-input",type:"date",required:!0,value:l.date,onChange:e=>o((0,i.A)((0,i.A)({},l),{},{date:e.target.value})),"aria-label":"Select attendance date",className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-sky-500"})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{htmlFor:"attendance-checkin-time",className:"block text-sm font-medium text-slate-700 mb-1",children:"Check In Time"}),(0,x.jsx)("input",{id:"attendance-checkin-time",type:"time",value:l.checkInAt,onChange:e=>o((0,i.A)((0,i.A)({},l),{},{checkInAt:e.target.value})),"aria-label":"Enter check in time",className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-sky-500"})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{htmlFor:"attendance-checkout-time",className:"block text-sm font-medium text-slate-700 mb-1",children:"Check Out Time"}),(0,x.jsx)("input",{id:"attendance-checkout-time",type:"time",value:l.checkOutAt,onChange:e=>o((0,i.A)((0,i.A)({},l),{},{checkOutAt:e.target.value})),"aria-label":"Enter check out time",className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-sky-500"})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{htmlFor:"attendance-status-select",className:"block text-sm font-medium text-slate-700 mb-1",children:"Status *"}),(0,x.jsxs)("select",{id:"attendance-status-select",required:!0,value:l.status,onChange:e=>o((0,i.A)((0,i.A)({},l),{},{status:e.target.value})),"aria-label":"Select attendance status",className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-sky-500",children:[(0,x.jsx)("option",{value:"present",children:"Present"}),(0,x.jsx)("option",{value:"absent",children:"Absent"}),(0,x.jsx)("option",{value:"half-day",children:"Half Day"}),(0,x.jsx)("option",{value:"leave",children:"On Leave"})]})]})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Notes"}),(0,x.jsx)("textarea",{value:l.notes,onChange:e=>o((0,i.A)((0,i.A)({},l),{},{notes:e.target.value})),rows:"3",className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-sky-500",placeholder:"Additional notes or remarks..."})]}),(0,x.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,x.jsx)("button",{type:"submit",disabled:u,className:"px-6 py-2 bg-sky-600 text-white rounded-lg hover:bg-sky-700 disabled:opacity-50",children:u?"Marking...":"Mark Attendance"}),(0,x.jsx)("button",{type:"button",onClick:()=>{o({date:(new Date).toISOString().split("T")[0],checkInAt:"",checkOutAt:"",status:"present",notes:""}),r("")},className:"px-6 py-2 bg-slate-200 text-slate-700 rounded-lg hover:bg-slate-300",children:"Reset"})]})]})})]})},Sn="http://localhost:5000";function kn(){const e=localStorage.getItem("token");return e?{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}:{"Content-Type":"application/json"}}const An=()=>{const e=Ae(),[t,a]=(0,n.useState)([]),[s,r]=(0,n.useState)(!1),[l,o]=(0,n.useState)(""),[c,d]=(0,n.useState)({from:"",to:"",type:"casual",dayType:"full",reason:""}),u=(new Date).toISOString().slice(0,10),[h,p]=(0,n.useState)({}),[f,m]=(0,n.useState)(!1),g=e=>{if(!e)return"-";try{const t=new Date(e);return Number.isNaN(t.getTime())?"-":t.toLocaleDateString()}catch(t){return"-"}},v=e=>null===e||void 0===e?"-":"object"===typeof e?e.name||e.email||"-":String(e),y=async()=>{r(!0),o("");try{const e=await fetch("".concat(Sn,"/api/leave/my-leaves"),{headers:kn()});if(!e.ok){const t=await e.text();if(404===e.status)return o("Leave history is not available yet."),void a([]);if(500===e.status)return o("Unable to load leaves right now (server error). Please try again later."),void a([]);throw new Error("Failed to load (".concat(e.status,") ").concat(t.slice(0,80)))}const t=await e.json(),n=Array.isArray(null===t||void 0===t?void 0:t.leaves)?t.leaves:Array.isArray(t)?t:[];a(n)}catch(e){const t=((null===e||void 0===e?void 0:e.message)||"Failed to load leaves").replace(/<[^>]*>/g,""),n=/\(500\)/.test(t)?"Unable to load leaves right now (server error). Please try again later.":t;o(n),a([])}finally{r(!1)}};(0,n.useEffect)(()=>{y()},[]);return(0,x.jsxs)("div",{style:{padding:16},children:[(0,x.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[(0,x.jsx)("h2",{style:{margin:0},children:"Leave"}),(0,x.jsx)("button",{className:"btn btn-outline-primary",onClick:()=>m(!0),children:"\ud83d\udccb View Leave History"})]}),l&&(0,x.jsx)("div",{style:{color:"tomato",marginBottom:8},children:l}),(0,x.jsxs)("form",{onSubmit:async t=>{t.preventDefault();if(await e("Apply Leave","Submit this leave request?"))try{const{from:e,to:t,type:a,dayType:n,reason:s}=c;if(!e||!t)return void o("Please select both From and To dates.");const r=new Date(e),l=new Date(t);if(Number.isNaN(r.getTime())||Number.isNaN(l.getTime()))return void p(e=>(0,i.A)((0,i.A)({},e),{},{from:"Invalid date",to:"Invalid date"}));const u=new Date;if(u.setHours(0,0,0,0),r<u)return void p(e=>(0,i.A)((0,i.A)({},e),{},{from:"Start date cannot be in the past"}));if(l<u)return void p(e=>(0,i.A)((0,i.A)({},e),{},{to:"End date cannot be in the past"}));if(l<r)return void p(e=>(0,i.A)((0,i.A)({},e),{},{to:"End date cannot be earlier than start date"}));if("half"===n&&r.toDateString()!==l.toDateString())return void p(e=>(0,i.A)((0,i.A)({},e),{},{to:"Half day leave must be a single day"}));const h={startDate:e,endDate:t,leaveType:a,dayType:n,reason:s},f=await fetch("".concat(Sn,"/api/leave/apply"),{method:"POST",headers:kn(),body:JSON.stringify(h)});if(!f.ok){const e=await f.text();if(404===f.status)return void o("Leave application is not available yet.");if(500===f.status)return void o("Unable to submit leave right now (server error). Please try again later.");throw new Error("Apply failed (".concat(f.status,") ").concat(e.slice(0,80)))}d({from:"",to:"",type:"casual",dayType:"full",reason:""}),await y()}catch(t){o(((null===t||void 0===t?void 0:t.message)||"Failed to apply").replace(/<[^>]*>/g,""))}},style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12,maxWidth:720},children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{children:"From"}),(0,x.jsx)("input",{type:"date",value:c.from,min:u,onChange:e=>{const t=e.target.value;d(e=>{let a=e.to;return t&&a&&new Date(a)<new Date(t)&&(a=t),(0,i.A)((0,i.A)({},e),{},{from:t,to:a})})},required:!0}),h.from&&(0,x.jsx)("div",{style:{color:"tomato",fontSize:12},children:h.from})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{children:"To"}),(0,x.jsx)("input",{type:"date",value:c.to,min:c.from||u,onChange:e=>d(t=>(0,i.A)((0,i.A)({},t),{},{to:e.target.value})),required:!0}),h.to&&(0,x.jsx)("div",{style:{color:"tomato",fontSize:12},children:h.to})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{children:"Type"}),(0,x.jsxs)("select",{value:c.type,onChange:e=>d(t=>(0,i.A)((0,i.A)({},t),{},{type:e.target.value})),children:[(0,x.jsx)("option",{value:"casual",children:"Casual"}),(0,x.jsx)("option",{value:"sick",children:"Sick"}),(0,x.jsx)("option",{value:"earned",children:"Earned"})]}),h.type&&(0,x.jsx)("div",{style:{color:"tomato",fontSize:12},children:h.type})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{children:"Day Type"}),(0,x.jsxs)("select",{value:c.dayType,onChange:e=>d(t=>(0,i.A)((0,i.A)({},t),{},{dayType:e.target.value})),children:[(0,x.jsx)("option",{value:"full",children:"Full Day"}),(0,x.jsx)("option",{value:"half",children:"Half Day"})]}),h.dayType&&(0,x.jsx)("div",{style:{color:"tomato",fontSize:12},children:h.dayType})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{children:"Reason"}),(0,x.jsx)("input",{value:c.reason,onChange:e=>d(t=>(0,i.A)((0,i.A)({},t),{},{reason:e.target.value})),required:!0}),h.reason&&(0,x.jsx)("div",{style:{color:"tomato",fontSize:12},children:h.reason})]}),(0,x.jsx)("div",{style:{gridColumn:"1 / -1"},children:(0,x.jsx)("button",{className:"btn",type:"submit",children:"Apply"})})]}),(0,x.jsx)("div",{style:{marginTop:16,overflowX:"auto"},children:(0,x.jsxs)("table",{className:"dashboard-table",style:{minWidth:720},children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{children:"From"}),(0,x.jsx)("th",{children:"To"}),(0,x.jsx)("th",{children:"Type"}),(0,x.jsx)("th",{children:"Day"}),(0,x.jsx)("th",{children:"Status"}),(0,x.jsx)("th",{children:"Applied"})]})}),(0,x.jsxs)("tbody",{children:[t.map((e,t)=>(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{children:g(e.startDate)}),(0,x.jsx)("td",{children:g(e.endDate)}),(0,x.jsx)("td",{children:v(e.leaveType||e.type)}),(0,x.jsx)("td",{style:{textTransform:"capitalize"},children:v(e.dayType||"full")}),(0,x.jsx)("td",{children:v(e.status)}),(0,x.jsx)("td",{children:e.appliedAt?new Date(e.appliedAt).toLocaleString():"-"})]},e._id||t)),0===t.length&&!s&&(0,x.jsx)("tr",{children:(0,x.jsx)("td",{colSpan:6,style:{textAlign:"center",color:"#6b7280"},children:"No leave requests."})})]})]})}),(0,x.jsx)(me,{isOpen:f,onClose:()=>m(!1)})]})},Cn=()=>{const[e,t]=(0,n.useState)([]),[a,s]=(0,n.useState)(!1),[r,i]=(0,n.useState)(""),[l,o]=(0,n.useState)("VERIFIED"),[c,d]=(0,n.useState)(""),[u,h]=(0,n.useState)(""),[p,f]=(0,n.useState)(""),[m,g]=(0,n.useState)(""),[v,y]=(0,n.useState)(!0),b=Ae(),j=async()=>{s(!0),i("");try{const e=await rn({status:"all"===l?void 0:l,limit:200});t(e)}catch(e){i("Failed to load payments")}finally{s(!1)}};(0,n.useEffect)(()=>{j()},[l]);const w=(0,n.useMemo)(()=>{let t=e||[];if(g(""),u&&p){const e=new Date(u);if(new Date(p)<e)return g("To date cannot be earlier than From date."),[]}if(c.trim()){const e=c.trim().toLowerCase();t=t.filter(t=>{var a;return((null===(a=t.user)||void 0===a?void 0:a.name)||"").toLowerCase().includes(e)||(t.overrideBuyerName||"").toLowerCase().includes(e)})}if(u){const e=new Date(u);t=t.filter(t=>new Date(t.verifiedAt||t.updatedAt||t.createdAt)>=e)}if(p){const e=new Date(p+"T23:59:59.999Z");t=t.filter(t=>new Date(t.verifiedAt||t.updatedAt||t.createdAt)<=e)}return t},[e,c,u,p]),N=(0,n.useMemo)(()=>w.reduce((e,t)=>e+(Number(t.finalPayment||t.calculatedAmount)||0),0),[w]),S=(0,n.useMemo)(()=>{const e=w.reduce((e,t)=>e+(Number(t.quantity)||0),0),t=w.length>0?w.reduce((e,t)=>e+(Number(t.drcPercentage)||0),0)/w.length:0,a=w.length>0?w.reduce((e,t)=>e+(Number(t.marketRate)||0),0)/w.length:0,n={};return w.forEach(e=>{var t;const a=e.overrideBuyerName||(null===(t=e.user)||void 0===t?void 0:t.name)||"Unknown";n[a]||(n[a]={count:0,amount:0,qty:0}),n[a].count++,n[a].amount+=Number(e.finalPayment||e.calculatedAmount)||0,n[a].qty+=Number(e.quantity)||0}),{totalQty:e,avgDRC:t,avgRate:a,byBuyer:n}},[w]);return(0,x.jsxs)("div",{className:"bill-payments-container",children:[(0,x.jsxs)("div",{className:"page-header",children:[(0,x.jsxs)("h2",{className:"page-title",children:["Bill Payments ","paid"===l&&(0,x.jsx)("span",{style:{fontSize:"0.6em",fontWeight:400,color:"#64748b"},children:"| Payment History"})]}),(0,x.jsxs)("div",{className:"header-actions",children:[(0,x.jsxs)("button",{className:"btn btn-export",onClick:()=>{if(0===w.length)return void alert("No data to export");const e=[["Date","Buyer","Quantity (L)","DRC %","Rate","Final Amount","Invoice Number","Status"].join(",")];w.forEach(t=>{var a,n,s,r,i,l;const o=[new Date(t.verifiedAt||t.updatedAt||t.createdAt).toLocaleDateString(),'"'.concat(t.overrideBuyerName||(null===(a=t.user)||void 0===a?void 0:a.name)||"-",'"'),null!==(n=t.quantity)&&void 0!==n?n:"",null!==(s=t.drcPercentage)&&void 0!==s?s:"",null!==(r=t.marketRate)&&void 0!==r?r:"",null!==(i=null!==(l=t.finalPayment)&&void 0!==l?l:t.calculatedAmount)&&void 0!==i?i:"",t.invoiceNumber||"",t.status||""];e.push(o.join(","))}),e.push(""),e.push("Summary"),e.push("Total Records,".concat(w.length)),e.push("Total Amount,".concat(N)),e.push("Total Quantity (L),".concat(S.totalQty.toFixed(2))),e.push("Average DRC %,".concat(S.avgDRC.toFixed(2))),e.push("Average Rate,".concat(S.avgRate.toFixed(2)));const t=e.join("\n"),a=new Blob([t],{type:"text/csv"}),n=URL.createObjectURL(a),s=document.createElement("a");s.href=n,s.download="bill-payments-".concat(l,"-").concat((new Date).toISOString().slice(0,10),".csv"),s.click(),URL.revokeObjectURL(n)},disabled:a||0===w.length,children:[(0,x.jsx)(La,{})," Export CSV"]}),(0,x.jsxs)("button",{className:"btn btn-print",onClick:()=>{const e=window.open("","_blank"),t="\n      <!DOCTYPE html>\n      <html>\n      <head>\n        <title>Bill Payments Report - ".concat(l,'</title>\n        <style>\n          body { font-family: Arial, sans-serif; padding: 20px; }\n          h1 { color: #0f4c75; border-bottom: 2px solid #0f4c75; padding-bottom: 10px; }\n          .header { margin-bottom: 20px; }\n          .header p { margin: 5px 0; }\n          table { width: 100%; border-collapse: collapse; margin-top: 20px; }\n          th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }\n          th { background-color: #0f4c75; color: white; }\n          tr:nth-child(even) { background-color: #f2f2f2; }\n          .summary { margin-top: 30px; background: #f9f9f9; padding: 15px; border-radius: 5px; }\n          .summary h3 { margin-top: 0; color: #0f4c75; }\n          .summary-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; }\n          .summary-item { padding: 10px; background: white; border-radius: 3px; }\n          .summary-item strong { display: block; color: #666; font-size: 12px; }\n          .summary-item span { display: block; font-size: 18px; color: #0f4c75; margin-top: 5px; }\n        </style>\n      </head>\n      <body>\n        <h1>Bill Payments Report</h1>\n        <div class="header">\n          <p><strong>Status:</strong> ').concat(l,"</p>\n          <p><strong>Generated:</strong> ").concat((new Date).toLocaleString(),"</p>\n          ").concat(u||p?"<p><strong>Date Range:</strong> ".concat(u||"Beginning"," to ").concat(p||"Present","</p>"):"","\n        </div>\n        \n        <table>\n          <thead>\n            <tr>\n              <th>Date</th>\n              <th>Buyer</th>\n              <th>Qty (L)</th>\n              <th>DRC %</th>\n              <th>Rate</th>\n              <th>Final Amount</th>\n              <th>Invoice</th>\n            </tr>\n          </thead>\n          <tbody>\n            ").concat(w.map(e=>{var t,a,n,s,r,i;return"\n              <tr>\n                <td>".concat(new Date(e.verifiedAt||e.updatedAt||e.createdAt).toLocaleDateString(),"</td>\n                <td>").concat(e.overrideBuyerName||(null===(t=e.user)||void 0===t?void 0:t.name)||"-","</td>\n                <td>").concat(null!==(a=e.quantity)&&void 0!==a?a:"-","</td>\n                <td>").concat(null!==(n=e.drcPercentage)&&void 0!==n?n:"-","</td>\n                <td>").concat(null!==(s=e.marketRate)&&void 0!==s?s:"-","</td>\n                <td>").concat(null!==(r=null!==(i=e.finalPayment)&&void 0!==i?i:e.calculatedAmount)&&void 0!==r?r:"-","</td>\n                <td>").concat(e.invoiceNumber||"-","</td>\n              </tr>\n            ")}).join(""),'\n          </tbody>\n        </table>\n\n        <div class="summary">\n          <h3>Summary</h3>\n          <div class="summary-grid">\n            <div class="summary-item">\n              <strong>Total Records</strong>\n              <span>').concat(w.length,'</span>\n            </div>\n            <div class="summary-item">\n              <strong>Total Amount</strong>\n              <span>\u20b9').concat(N.toFixed(2),'</span>\n            </div>\n            <div class="summary-item">\n              <strong>Total Quantity</strong>\n              <span>').concat(S.totalQty.toFixed(2),' L</span>\n            </div>\n            <div class="summary-item">\n              <strong>Average DRC</strong>\n              <span>').concat(S.avgDRC.toFixed(2),'%</span>\n            </div>\n            <div class="summary-item">\n              <strong>Average Rate</strong>\n              <span>\u20b9').concat(S.avgRate.toFixed(2),"</span>\n            </div>\n          </div>\n        </div>\n\n        <script>\n          window.onload = () => {\n            window.print();\n          };\n        <\/script>\n      </body>\n      </html>\n    ");e.document.write(t),e.document.close()},disabled:a||0===w.length,children:[(0,x.jsx)(Ma,{})," Print"]}),(0,x.jsxs)("button",{className:"btn btn-refresh",onClick:j,disabled:a,children:[(0,x.jsx)(Ua,{className:a?"animate-spin":""})," ",a?"Refreshing...":"Refresh"]})]})]}),r&&(0,x.jsx)("div",{className:"error-alert",children:r}),(0,x.jsxs)("div",{className:"controls-section",children:[(0,x.jsxs)("div",{className:"control-group",children:[(0,x.jsx)("label",{className:"control-label",children:"Status"}),(0,x.jsxs)("select",{className:"control-select",value:l,onChange:e=>o(e.target.value),children:[(0,x.jsx)("option",{value:"VERIFIED",children:"Pending Payment"}),(0,x.jsx)("option",{value:"paid",children:"Paid History"}),(0,x.jsx)("option",{value:"ACCOUNT_CALCULATED",children:"Calculated"}),(0,x.jsx)("option",{value:"TEST_COMPLETED",children:"Test Completed"}),(0,x.jsx)("option",{value:"all",children:"All Records"})]})]}),(0,x.jsxs)("div",{className:"control-group",children:[(0,x.jsx)("label",{className:"control-label",children:"From Date"}),(0,x.jsx)("input",{type:"date",className:"control-input",value:u,max:p||void 0,onChange:e=>{const t=e.target.value;h(t),p&&t&&new Date(p)<new Date(t)&&f(t)}})]}),(0,x.jsxs)("div",{className:"control-group",children:[(0,x.jsx)("label",{className:"control-label",children:"To Date"}),(0,x.jsx)("input",{type:"date",className:"control-input",value:p,min:u||void 0,onChange:e=>{const t=e.target.value;f(t)}})]}),(0,x.jsxs)("div",{className:"control-group",style:{flexGrow:1},children:[(0,x.jsx)("label",{className:"control-label",children:"Search Buyer"}),(0,x.jsxs)("div",{style:{position:"relative"},children:[(0,x.jsx)(Wa,{style:{position:"absolute",left:12,top:12,color:"#94a3b8"}}),(0,x.jsx)("input",{placeholder:"Search by buyer name...",className:"control-input",style:{paddingLeft:36,width:"100%"},value:c,onChange:e=>d(e.target.value)})]})]})]}),m&&(0,x.jsx)("div",{style:{color:"tomato",marginTop:6},children:m}),w.length>0&&v&&(0,x.jsxs)("div",{className:"summary-card",children:[(0,x.jsxs)("div",{className:"summary-header",children:[(0,x.jsxs)("h3",{className:"summary-title",children:[(0,x.jsx)(ya,{})," Summary Statistics"]}),(0,x.jsx)("button",{className:"btn-toggle-summary",onClick:()=>y(!1),children:"Hide"})]}),(0,x.jsxs)("div",{className:"summary-grid",children:[(0,x.jsxs)("div",{className:"stat-box",children:[(0,x.jsx)("div",{className:"stat-label",children:"Total Records"}),(0,x.jsx)("div",{className:"stat-value",children:w.length})]}),(0,x.jsxs)("div",{className:"stat-box",children:[(0,x.jsx)("div",{className:"stat-label",children:"Total Amount"}),(0,x.jsxs)("div",{className:"stat-value",children:["\u20b9",N.toLocaleString("en-IN",{maximumFractionDigits:2})]})]}),(0,x.jsxs)("div",{className:"stat-box",children:[(0,x.jsx)("div",{className:"stat-label",children:"Total Quantity"}),(0,x.jsxs)("div",{className:"stat-value",children:[S.totalQty.toFixed(2)," ",(0,x.jsx)("span",{style:{fontSize:14,fontWeight:400},children:"L"})]})]}),(0,x.jsxs)("div",{className:"stat-box",children:[(0,x.jsx)("div",{className:"stat-label",children:"Avg DRC"}),(0,x.jsxs)("div",{className:"stat-value",children:[S.avgDRC.toFixed(2),(0,x.jsx)("span",{style:{fontSize:14,fontWeight:400},children:"%"})]})]}),(0,x.jsxs)("div",{className:"stat-box",children:[(0,x.jsx)("div",{className:"stat-label",children:"Avg Rate"}),(0,x.jsxs)("div",{className:"stat-value",children:["\u20b9",S.avgRate.toFixed(2)]})]}),(0,x.jsxs)("div",{className:"stat-box",children:[(0,x.jsx)("div",{className:"stat-label",children:"Unique Buyers"}),(0,x.jsx)("div",{className:"stat-value",children:Object.keys(S.byBuyer).length})]})]}),Object.keys(S.byBuyer).length>0&&(0,x.jsxs)("div",{className:"top-buyers-section",children:[(0,x.jsx)("div",{className:"top-buyers-title",children:"Top Buyers (by Amount)"}),(0,x.jsx)("div",{className:"buyers-grid",children:Object.entries(S.byBuyer).sort((e,t)=>t[1].amount-e[1].amount).slice(0,5).map(e=>{let[t,a]=e;return(0,x.jsxs)("div",{className:"buyer-pill",children:[(0,x.jsx)("div",{className:"buyer-name",children:t}),(0,x.jsxs)("div",{className:"buyer-stats",children:["\u20b9",a.amount.toLocaleString("en-IN")," (",a.count," bills)"]})]},t)})})]})]}),w.length>0&&!v&&(0,x.jsxs)("button",{className:"show-summary-btn",onClick:()=>y(!0),children:[(0,x.jsx)(ya,{})," Show Summary Statistics"]}),(0,x.jsx)("div",{className:"table-container",children:(0,x.jsxs)("table",{className:"payments-table",children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{children:"Date"}),(0,x.jsx)("th",{children:"Buyer"}),(0,x.jsx)("th",{children:"Qty (L)"}),(0,x.jsx)("th",{children:"DRC%"}),(0,x.jsx)("th",{children:"Rate"}),(0,x.jsx)("th",{children:"Final Amount"}),(0,x.jsx)("th",{children:"Invoice"}),(0,x.jsx)("th",{children:"Status"}),(0,x.jsx)("th",{children:"Action"})]})}),(0,x.jsxs)("tbody",{children:[w.map(e=>{var t,a,n,s,r,l;return(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{children:new Date(e.verifiedAt||e.updatedAt||e.createdAt).toLocaleString()}),(0,x.jsx)("td",{className:"font-medium",children:e.overrideBuyerName||(null===(t=e.user)||void 0===t?void 0:t.name)||"-"}),(0,x.jsx)("td",{children:null!==(a=e.quantity)&&void 0!==a?a:"-"}),(0,x.jsx)("td",{children:null!==(n=e.drcPercentage)&&void 0!==n?n:"-"}),(0,x.jsxs)("td",{children:["\u20b9",null!==(s=e.marketRate)&&void 0!==s?s:"-"]}),(0,x.jsxs)("td",{className:"font-bold text-primary",children:["\u20b9",null!==(r=null!==(l=e.finalPayment)&&void 0!==l?l:e.calculatedAmount)&&void 0!==r?r:"-"]}),(0,x.jsx)("td",{children:e.invoiceNumber?(0,x.jsxs)("a",{href:"".concat("http://localhost:5000","/api/latex/invoice/").concat(e._id),target:"_blank",rel:"noreferrer",className:"link-invoice",children:[(0,x.jsx)(Ea,{})," ",e.invoiceNumber]}):"-"}),(0,x.jsx)("td",{children:(0,x.jsx)("span",{className:"status-badge ".concat("paid"===e.status?"status-paid":"VERIFIED"===e.status?"status-verified":"ACCOUNT_CALCULATED"===e.status?"status-calculated":"status-tested"),children:"paid"===e.status?"Paid":"VERIFIED"===e.status?"Pending":e.status})}),(0,x.jsx)("td",{children:"VERIFIED"===e.status?(0,x.jsxs)("button",{className:"btn-pay",onClick:()=>(async e=>{if(await b("Confirm Payment","Mark this bill as paid?"))try{await ln(e,{status:"paid"}),await j()}catch(t){i("Failed to mark paid")}})(e._id),children:[(0,x.jsx)(_a,{style:{marginRight:4}})," Mark Paid"]}):"paid"===e.status?(0,x.jsxs)("div",{className:"completed-icon",children:[(0,x.jsx)(Sa,{})," Completed"]}):(0,x.jsx)("span",{style:{color:"#94a3b8"},children:"-"})})]},e._id)}),0===w.length&&!a&&(0,x.jsx)("tr",{children:(0,x.jsx)("td",{colSpan:9,className:"empty-state",children:"paid"===l?(0,x.jsxs)("div",{children:[(0,x.jsx)("div",{className:"empty-icon",children:"\ud83d\udced"}),(0,x.jsx)("div",{className:"empty-text",children:"No payment history found"}),(0,x.jsx)("div",{className:"empty-subtext",children:"Try adjusting your date range"})]}):"VERIFIED"===l?(0,x.jsxs)("div",{children:[(0,x.jsx)("div",{className:"empty-icon",children:"\u2705"}),(0,x.jsx)("div",{className:"empty-text",children:"No verified bills pending"}),(0,x.jsx)("div",{className:"empty-subtext",children:"All bills have been processed"})]}):(0,x.jsxs)("div",{children:[(0,x.jsx)("div",{className:"empty-icon",children:"\ud83d\udcc2"}),(0,x.jsx)("div",{className:"empty-text",children:"No records found"}),(0,x.jsx)("div",{className:"empty-subtext",children:"Check your filters"})]})})})]})]})})]})},_n="http://localhost:5000";function Ln(){const e=localStorage.getItem("token");return e?{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}:{"Content-Type":"application/json"}}const Tn=()=>{const[e,t]=(0,n.useState)([]),[a,s]=(0,n.useState)(""),[r,l]=(0,n.useState)((new Date).getMonth()+1),[o,c]=(0,n.useState)((new Date).getFullYear()),[d,u]=(0,n.useState)([]),[h,p]=(0,n.useState)(!1),[f,m]=(0,n.useState)(""),g=Ae(),[v,y]=(0,n.useState)(!1),[b,j]=(0,n.useState)(null),[w,N]=(0,n.useState)(!1),[S,k]=(0,n.useState)({grossSalary:0,providentFund:0,professionalTax:0,incomeTax:0,otherDeductions:0}),[A,C]=(0,n.useState)({dailyWage:0,days:0,otHours:0,otRate:0,allowance:0,pf:0,profTax:0,incomeTax:0,otherDed:0}),[_,L]=(0,n.useState)({gross:0,deductions:0,net:0});(0,n.useEffect)(()=>{T()},[]),(0,n.useEffect)(()=>{E(a)},[a,o]),(0,n.useEffect)(()=>{const{dailyWage:e,days:t,otHours:a,otRate:n,allowance:s,pf:r,profTax:i,incomeTax:l,otherDed:o}=A,c=(Number(e)||0)*(Number(t)||0)+(Number(a)||0)*(Number(n)||0)+(Number(s)||0),d=(Number(r)||0)+(Number(i)||0)+(Number(l)||0)+(Number(o)||0),u=c-d;L({gross:Number(c.toFixed(2)),deductions:Number(d.toFixed(2)),net:Number(u.toFixed(2))})},[A]);const T=async()=>{try{const e=await fetch("".concat(_n,"/api/users"),{headers:Ln()}),a=await e.json(),n=Array.isArray(null===a||void 0===a?void 0:a.users)?a.users:Array.isArray(a)?a:[];t(n.filter(e=>"admin"!==e.role&&"user"!==e.role))}catch(e){t([])}},E=async e=>{if(e){p(!0),m("");try{let t="".concat(_n,"/api/salary/history/").concat(e,"?year=").concat(o);"all"===e&&(t="".concat(_n,"/api/salary/all?year=").concat(o));const a=await fetch(t,{headers:Ln()});if(!a.ok)throw new Error("Failed to load (".concat(a.status,")"));const n=await a.json();u(Array.isArray(null===n||void 0===n?void 0:n.data)?n.data:Array.isArray(n)?n:[])}catch(t){m((null===t||void 0===t?void 0:t.message)||"Failed to load salaries"),u([])}finally{p(!1)}}else u([])},D=e=>{const{name:t,value:a}=e.target;C(e=>(0,i.A)((0,i.A)({},e),{},{[t]:a}))};return(0,x.jsxs)("div",{className:"salaries-container",children:[(0,x.jsx)("h2",{className:"page-title",children:"Salaries"}),f&&(0,x.jsx)("div",{className:"error-alert",children:f}),(0,x.jsxs)("div",{className:"salary-card",children:[(0,x.jsxs)("div",{className:"card-header",children:[(0,x.jsx)("h3",{className:"card-title",children:"Wage Calculator"}),(0,x.jsxs)("button",{onClick:()=>y(!v),className:"btn-toggle",children:[v?"Hide":"Show"," Calculator"]})]}),v&&(0,x.jsxs)("div",{className:"calculator-content",children:[(0,x.jsxs)("div",{className:"calc-grid",children:[(0,x.jsxs)("div",{className:"calc-column",children:[(0,x.jsx)("h4",{className:"column-header",children:"Earnings"}),(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{className:"form-label",children:"Daily Wage"}),(0,x.jsx)("input",{type:"number",name:"dailyWage",value:A.dailyWage,onChange:D,placeholder:"0.00",className:"form-input"})]}),(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{className:"form-label",children:"Days"}),(0,x.jsx)("input",{type:"number",name:"days",value:A.days,onChange:D,placeholder:"0",className:"form-input"})]}),(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{className:"form-label",children:"OT Hours"}),(0,x.jsx)("input",{type:"number",name:"otHours",value:A.otHours,onChange:D,placeholder:"0",className:"form-input"})]}),(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{className:"form-label",children:"OT Rate"}),(0,x.jsx)("input",{type:"number",name:"otRate",value:A.otRate,onChange:D,placeholder:"0.00",className:"form-input"})]}),(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{className:"form-label",children:"Allowance"}),(0,x.jsx)("input",{type:"number",name:"allowance",value:A.allowance,onChange:D,placeholder:"0.00",className:"form-input"})]})]}),(0,x.jsxs)("div",{className:"calc-column",children:[(0,x.jsx)("h4",{className:"column-header",children:"Deductions"}),(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{className:"form-label",children:"PF"}),(0,x.jsx)("input",{type:"number",name:"pf",value:A.pf,onChange:D,placeholder:"0.00",className:"form-input"})]}),(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{className:"form-label",children:"Professional Tax"}),(0,x.jsx)("input",{type:"number",name:"profTax",value:A.profTax,onChange:D,placeholder:"0.00",className:"form-input"})]}),(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{className:"form-label",children:"Income Tax"}),(0,x.jsx)("input",{type:"number",name:"incomeTax",value:A.incomeTax,onChange:D,placeholder:"0.00",className:"form-input"})]}),(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{className:"form-label",children:"Other Deductions"}),(0,x.jsx)("input",{type:"number",name:"otherDed",value:A.otherDed,onChange:D,placeholder:"0.00",className:"form-input"})]})]})]}),(0,x.jsxs)("div",{className:"totals-section",children:[(0,x.jsxs)("div",{className:"total-card",children:[(0,x.jsx)("span",{className:"total-label",children:"Gross"}),(0,x.jsx)("span",{className:"total-value",children:_.gross.toFixed(2)})]}),(0,x.jsxs)("div",{className:"total-card",children:[(0,x.jsx)("span",{className:"total-label",children:"Deductions"}),(0,x.jsx)("span",{className:"total-value",children:_.deductions.toFixed(2)})]}),(0,x.jsxs)("div",{className:"total-card",children:[(0,x.jsx)("span",{className:"total-label",children:"Net"}),(0,x.jsx)("span",{className:"total-value net-value",children:_.net.toFixed(2)})]}),(0,x.jsxs)("div",{className:"calc-actions",children:[(0,x.jsx)("button",{onClick:()=>{C({dailyWage:0,days:0,otHours:0,otRate:0,allowance:0,pf:0,profTax:0,incomeTax:0,otherDed:0})},className:"btn-secondary",children:"Reset"}),(0,x.jsx)("button",{onClick:()=>{navigator.clipboard.writeText(_.net.toString()),Ze.info("Copied Net Salary: ".concat(_.net))},className:"btn-secondary",children:"Copy Net"})]})]})]})]}),(0,x.jsxs)("div",{className:"salary-card",children:[(0,x.jsx)("h3",{className:"card-title",style:{marginBottom:"16px"},children:"Generate Salary Record"}),(0,x.jsxs)("div",{className:"controls-row",children:[(0,x.jsxs)("div",{className:"control-group",children:[(0,x.jsx)("label",{className:"form-label",children:"Staff Member"}),(0,x.jsxs)("select",{value:a,onChange:e=>s(e.target.value),className:"form-select",children:[(0,x.jsx)("option",{value:"",children:"Select Staff"}),(0,x.jsx)("option",{value:"all",children:"All Staff"}),e.map(e=>{var t;return(0,x.jsxs)("option",{value:e._id,children:[e.name," (",null===(t=e.role)||void 0===t?void 0:t.replace("_"," "),")"]},e._id)})]})]}),(0,x.jsxs)("div",{className:"control-group-sm",children:[(0,x.jsx)("label",{className:"form-label",children:"Month"}),(0,x.jsx)("input",{type:"number",min:"1",max:"12",value:r,onChange:e=>l(Number(e.target.value)),className:"form-input"})]}),(0,x.jsxs)("div",{className:"control-group-md",children:[(0,x.jsx)("label",{className:"form-label",children:"Year"}),(0,x.jsx)("input",{type:"number",min:"2020",max:"2100",value:o,onChange:e=>c(Number(e.target.value)),className:"form-input"})]}),(0,x.jsx)("button",{className:"btn-primary",onClick:async()=>{if(!a)return void m("Select a staff member or All");if("all"===a){if(!await g("Generate All","Generate salaries for ALL staff for ".concat(r,"/").concat(o,"?")))return;p(!0),m("");let a=0,n=0;try{for(const s of e)try{(await fetch("".concat(_n,"/api/salary/generate/").concat(s._id),{method:"POST",headers:Ln(),body:JSON.stringify({month:r,year:o})})).ok?a++:n++}catch(t){n++}await E("all"),Ze.success("Batch complete: ".concat(a," generated, ").concat(n," skipped/failed"))}catch(t){m("Batch generation failed")}finally{p(!1)}return}if(await g("Generate Salary","Generate salary for ".concat(r,"/").concat(o,"?")))try{p(!0),m("");const e=await fetch("".concat(_n,"/api/salary/generate/").concat(a),{method:"POST",headers:Ln(),body:JSON.stringify({month:r,year:o})});if(!e.ok)throw new Error("Generate failed (".concat(e.status,")"));await E(a),Ze.success("Salary generated successfully")}catch(t){m((null===t||void 0===t?void 0:t.message)||"Failed to generate")}finally{p(!1)}},disabled:h,children:h?"Processing...":"all"===a?"Generate for All":"Generate Record"})]})]}),(0,x.jsx)("div",{className:"salary-table-container",children:(0,x.jsxs)("table",{className:"salary-table",children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{children:"Period"}),(0,x.jsx)("th",{style:{textAlign:"right"},children:"Gross"}),(0,x.jsx)("th",{style:{textAlign:"right"},children:"Deductions"}),(0,x.jsx)("th",{style:{textAlign:"right"},children:"Net Pay"}),(0,x.jsx)("th",{style:{textAlign:"center"},children:"Status"}),(0,x.jsx)("th",{style:{textAlign:"right"},children:"Actions"})]})}),(0,x.jsx)("tbody",{children:d.length>0?d.map((e,t)=>{var n,s;const r=(e.providentFund||0)+(e.professionalTax||0)+(e.incomeTax||0)+(e.otherDeductions||0);return(0,x.jsxs)("tr",{children:[(0,x.jsxs)("td",{children:[e.month,"/",e.year]}),(0,x.jsx)("td",{style:{textAlign:"right"},children:(null===(n=e.grossSalary)||void 0===n?void 0:n.toFixed(2))||"-"}),(0,x.jsx)("td",{style:{textAlign:"right"},className:"amount-negative",children:r.toFixed(2)}),(0,x.jsx)("td",{style:{textAlign:"right"},className:"amount-positive",children:(null===(s=e.netSalary)||void 0===s?void 0:s.toFixed(2))||"-"}),(0,x.jsx)("td",{style:{textAlign:"center"},children:(0,x.jsx)("span",{className:"status-badge ".concat("paid"===e.status?"status-paid":"approved"===e.status?"status-approved":"status-draft"),children:e.status||"draft"})}),(0,x.jsx)("td",{style:{textAlign:"right"},children:(0,x.jsxs)("div",{className:"table-actions",children:["draft"===e.status&&(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("button",{onClick:()=>{return j(t=e),k({grossSalary:t.grossSalary||0,providentFund:t.providentFund||0,professionalTax:t.professionalTax||0,incomeTax:t.incomeTax||0,otherDeductions:t.otherDeductions||0}),void N(!0);var t},className:"btn-edit-action",children:"Edit"}),(0,x.jsx)("button",{onClick:()=>(async t=>{if(await g("Approve Salary","Mark this salary as approved?"))try{p(!0);const e=await fetch("".concat(_n,"/api/salary/approve/").concat(t),{method:"PUT",headers:Ln()});if(!e.ok)throw new Error("Approve failed (".concat(e.status,")"));await E(a),Ze.success("Salary approved")}catch(e){m((null===e||void 0===e?void 0:e.message)||"Approve failed")}finally{p(!1)}})(e._id),className:"btn-approve",children:"Approve"}),(0,x.jsx)("button",{onClick:()=>(async t=>{if(window.confirm("Are you sure you want to delete this salary record?"))try{p(!0);const e=await fetch("".concat(_n,"/api/salary/").concat(t),{method:"DELETE",headers:Ln()});if(!e.ok)throw new Error("Delete failed (".concat(e.status,")"));await E(a),Ze.success("Salary record deleted")}catch(e){m((null===e||void 0===e?void 0:e.message)||"Delete failed")}finally{p(!1)}})(e._id),className:"btn-delete-action",children:"Delete"})]}),"approved"===e.status&&(0,x.jsx)("button",{onClick:()=>(async t=>{const n=window.prompt("Enter payment method (e.g., cash, bank, upi)");if(!n)return;const s=window.prompt("Payment reference (optional)")||"";if(await g("Mark as Paid","Mark this salary as PAID via ".concat(n,"?")))try{p(!0);const e=await fetch("".concat(_n,"/api/salary/pay/").concat(t),{method:"PUT",headers:Ln(),body:JSON.stringify({paymentMethod:n,paymentReference:s})});if(!e.ok)throw new Error("Pay failed (".concat(e.status,")"));await E(a),Ze.success("Marked as paid")}catch(e){m((null===e||void 0===e?void 0:e.message)||"Pay failed")}finally{p(!1)}})(e._id),className:"btn-paid",children:"Mark Paid"}),(0,x.jsx)("a",{href:"".concat(_n,"/api/salary/payslip/").concat(e._id),target:"_blank",rel:"noreferrer",className:"link-payslip",children:"Payslip"})]})})]},e._id||t)}):(0,x.jsx)("tr",{children:(0,x.jsx)("td",{colSpan:"6",className:"empty-state",children:"No salary records found for this period."})})})]})}),w&&(0,x.jsx)("div",{className:"modal-overlay",children:(0,x.jsxs)("div",{className:"modal-content",children:[(0,x.jsx)("h3",{className:"modal-title",children:"Edit Salary Record"}),(0,x.jsxs)("form",{onSubmit:async e=>{e.preventDefault();try{p(!0);const e=await fetch("".concat(_n,"/api/salary/").concat(b._id),{method:"PUT",headers:Ln(),body:JSON.stringify(S)});if(!e.ok)throw new Error("Update failed (".concat(e.status,")"));await E(a),Ze.success("Salary updated successfully"),N(!1),j(null)}catch(e){m((null===e||void 0===e?void 0:e.message)||"Update failed")}finally{p(!1)}},children:[(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{className:"form-label",children:"Gross Salary"}),(0,x.jsx)("input",{type:"number",className:"form-input",value:S.grossSalary,onChange:e=>k((0,i.A)((0,i.A)({},S),{},{grossSalary:Number(e.target.value)}))})]}),(0,x.jsxs)("div",{className:"calc-grid",style:{gridTemplateColumns:"1fr 1fr",gap:"16px",marginBottom:"16px"},children:[(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{className:"form-label",children:"PF"}),(0,x.jsx)("input",{type:"number",className:"form-input",value:S.providentFund,onChange:e=>k((0,i.A)((0,i.A)({},S),{},{providentFund:Number(e.target.value)}))})]}),(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{className:"form-label",children:"Prof Tax"}),(0,x.jsx)("input",{type:"number",className:"form-input",value:S.professionalTax,onChange:e=>k((0,i.A)((0,i.A)({},S),{},{professionalTax:Number(e.target.value)}))})]}),(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{className:"form-label",children:"Income Tax"}),(0,x.jsx)("input",{type:"number",className:"form-input",value:S.incomeTax,onChange:e=>k((0,i.A)((0,i.A)({},S),{},{incomeTax:Number(e.target.value)}))})]}),(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{className:"form-label",children:"Other Ded"}),(0,x.jsx)("input",{type:"number",className:"form-input",value:S.otherDeductions,onChange:e=>k((0,i.A)((0,i.A)({},S),{},{otherDeductions:Number(e.target.value)}))})]})]}),(0,x.jsxs)("div",{className:"modal-actions",children:[(0,x.jsx)("button",{type:"button",onClick:()=>N(!1),className:"btn-secondary",children:"Cancel"}),(0,x.jsx)("button",{type:"submit",className:"btn-primary",children:"Update"})]})]})]})})]})},En=()=>{const[e,t]=(0,n.useState)([]),[a,s]=(0,n.useState)(!0),[r,i]=(0,n.useState)((new Date).getMonth()+1),[l,o]=(0,n.useState)((new Date).getFullYear());(0,n.useEffect)(()=>{c()},[r,l]);const c=async()=>{try{s(!0);const e=localStorage.getItem("token"),a=new Date(l,r-1,1).toISOString().split("T")[0],n=new Date(l,r,0).toISOString().split("T")[0],i=await fetch("".concat("http://localhost:5000","/api/workers/field/attendance/history?from=").concat(a,"&to=").concat(n),{headers:{Authorization:"Bearer ".concat(e)}});if(i.ok){const e=await i.json();t(Array.isArray(e)?e:e.data||[])}}catch(e){console.error("Error fetching attendance:",e)}finally{s(!1)}},d=e=>{switch(e){case"present":return"bg-green-100 text-green-700";case"absent":return"bg-red-100 text-red-700";case"half-day":return"bg-yellow-100 text-yellow-700";case"leave":return"bg-blue-100 text-blue-700";default:return"bg-gray-100 text-gray-700"}},u=e=>e?new Date(e).toLocaleTimeString("en-IN",{hour:"2-digit",minute:"2-digit"}):"-",h={present:e.filter(e=>"present"===e.status).length,absent:e.filter(e=>"absent"===e.status).length,leave:e.filter(e=>"leave"===e.status).length,total:e.length};return a?(0,x.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,x.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-sky-600"})}):(0,x.jsxs)("div",{className:"space-y-6",children:[(0,x.jsxs)("div",{className:"flex items-center justify-between",children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("h1",{className:"text-3xl font-bold text-slate-800",children:"My Attendance"}),(0,x.jsx)("p",{className:"text-slate-600 mt-1",children:"View your attendance history"})]}),(0,x.jsxs)("div",{className:"flex gap-3",children:[(0,x.jsx)("label",{htmlFor:"my-attendance-month-select",className:"sr-only",children:"Select month"}),(0,x.jsx)("select",{id:"my-attendance-month-select",value:r,onChange:e=>i(parseInt(e.target.value)),"aria-label":"Select month for attendance history",className:"px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-sky-500",children:Array.from({length:12},(e,t)=>t+1).map(e=>(0,x.jsx)("option",{value:e,children:new Date(2e3,e-1).toLocaleString("default",{month:"long"})},e))}),(0,x.jsx)("label",{htmlFor:"my-attendance-year-input",className:"sr-only",children:"Select year"}),(0,x.jsx)("input",{id:"my-attendance-year-input",type:"number",value:l,onChange:e=>o(parseInt(e.target.value)),"aria-label":"Select year for attendance history",className:"px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-sky-500 w-24"})]})]}),(0,x.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,x.jsx)("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-slate-200",children:(0,x.jsxs)("div",{className:"flex items-center justify-between",children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("p",{className:"text-sm text-slate-600",children:"Total Days"}),(0,x.jsx)("p",{className:"text-2xl font-bold text-slate-800 mt-1",children:h.total})]}),(0,x.jsx)("div",{className:"bg-blue-100 p-3 rounded-lg",children:(0,x.jsx)(Na,{className:"text-blue-600 text-xl"})})]})}),(0,x.jsx)("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-slate-200",children:(0,x.jsxs)("div",{className:"flex items-center justify-between",children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("p",{className:"text-sm text-slate-600",children:"Present"}),(0,x.jsx)("p",{className:"text-2xl font-bold text-green-600 mt-1",children:h.present})]}),(0,x.jsx)("div",{className:"bg-green-100 p-3 rounded-lg",children:(0,x.jsx)(Sa,{className:"text-green-600 text-xl"})})]})}),(0,x.jsx)("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-slate-200",children:(0,x.jsxs)("div",{className:"flex items-center justify-between",children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("p",{className:"text-sm text-slate-600",children:"Absent"}),(0,x.jsx)("p",{className:"text-2xl font-bold text-red-600 mt-1",children:h.absent})]}),(0,x.jsx)("div",{className:"bg-red-100 p-3 rounded-lg",children:(0,x.jsx)(en,{className:"text-red-600 text-xl"})})]})}),(0,x.jsx)("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-slate-200",children:(0,x.jsxs)("div",{className:"flex items-center justify-between",children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("p",{className:"text-sm text-slate-600",children:"On Leave"}),(0,x.jsx)("p",{className:"text-2xl font-bold text-blue-600 mt-1",children:h.leave})]}),(0,x.jsx)("div",{className:"bg-blue-100 p-3 rounded-lg",children:(0,x.jsx)(Na,{className:"text-blue-600 text-xl"})})]})})]}),(0,x.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6",children:[(0,x.jsx)("h2",{className:"text-xl font-semibold text-slate-800 mb-4",children:"Attendance History"}),(0,x.jsx)("div",{className:"overflow-x-auto",children:(0,x.jsxs)("table",{className:"w-full",children:[(0,x.jsx)("thead",{className:"bg-slate-50 border-b border-slate-200",children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-700 uppercase tracking-wider",children:"Date"}),(0,x.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-700 uppercase tracking-wider",children:"Check In"}),(0,x.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-700 uppercase tracking-wider",children:"Check Out"}),(0,x.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-700 uppercase tracking-wider",children:"Hours"}),(0,x.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-700 uppercase tracking-wider",children:"Status"})]})}),(0,x.jsx)("tbody",{className:"bg-white divide-y divide-slate-200",children:0===e.length?(0,x.jsx)("tr",{children:(0,x.jsx)("td",{colSpan:"5",className:"px-6 py-8 text-center text-slate-500",children:"No attendance records found for this period"})}):e.map(e=>(0,x.jsxs)("tr",{className:"hover:bg-slate-50",children:[(0,x.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-slate-600",children:new Date(e.date).toLocaleDateString()}),(0,x.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-slate-600",children:u(e.checkInAt)}),(0,x.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-slate-600",children:u(e.checkOutAt)}),(0,x.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-slate-600",children:e.hoursWorked?"".concat(e.hoursWorked.toFixed(1),"h"):"-"}),(0,x.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,x.jsx)("span",{className:"px-2 py-1 rounded text-xs font-medium ".concat(d(e.status)),children:e.status||"absent"})})]},e._id))})]})})]})]})},Dn=()=>{const e="http://localhost:5000",[t,a]=(0,n.useState)([]),[s,r]=(0,n.useState)(!0),[l,o]=(0,n.useState)(!1),[c,d]=(0,n.useState)(null),[u,h]=(0,n.useState)(""),[p,f]=(0,n.useState)("all"),[m,g]=(0,n.useState)(""),[v,y]=(0,n.useState)(""),[b,j]=(0,n.useState)({description:"",amount:"",category:"operational",paymentMethod:"cash",date:(new Date).toISOString().split("T")[0],vendor:"",reference:"",notes:""}),w=[{value:"operational",label:"Operational",badgeClass:"badge-blue"},{value:"raw_materials",label:"Raw Materials",badgeClass:"badge-green"},{value:"utilities",label:"Utilities",badgeClass:"badge-yellow"},{value:"maintenance",label:"Maintenance",badgeClass:"badge-orange"},{value:"transport",label:"Transport",badgeClass:"badge-purple"},{value:"salaries",label:"Salaries",badgeClass:"badge-pink"},{value:"tax",label:"Tax & Compliance",badgeClass:"badge-red"},{value:"other",label:"Other",badgeClass:"badge-gray"}];(0,n.useEffect)(()=>{N()},[]);const N=async()=>{try{r(!0);const t=localStorage.getItem("token"),n=await fetch("".concat(e,"/api/accountant/expenses"),{headers:{Authorization:"Bearer ".concat(t)}});if(n.ok){const e=await n.json();a(e.data||[])}}catch(t){console.error("Error fetching expenses:",t)}finally{r(!1)}},S=()=>{j({description:"",amount:"",category:"operational",paymentMethod:"cash",date:(new Date).toISOString().split("T")[0],vendor:"",reference:"",notes:""}),d(null),o(!1)},k=(0,n.useMemo)(()=>{let e=t;if(u){const t=u.toLowerCase();e=e.filter(e=>{var a,n,s;return(null===(a=e.description)||void 0===a?void 0:a.toLowerCase().includes(t))||(null===(n=e.vendor)||void 0===n?void 0:n.toLowerCase().includes(t))||(null===(s=e.reference)||void 0===s?void 0:s.toLowerCase().includes(t))})}return"all"!==p&&(e=e.filter(e=>e.category===p)),m&&(e=e.filter(e=>new Date(e.date)>=new Date(m))),v&&(e=e.filter(e=>new Date(e.date)<=new Date(v+"T23:59:59"))),e.sort((e,t)=>new Date(t.date)-new Date(e.date))},[t,u,p,m,v]),A=(0,n.useMemo)(()=>{const e=k.reduce((e,t)=>e+(t.amount||0),0),t={};return k.forEach(e=>{t[e.category]=(t[e.category]||0)+(e.amount||0)}),{total:e,byCategory:t}},[k]),C=e=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",maximumFractionDigits:0}).format(e);return s?(0,x.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,x.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-sky-600"})}):(0,x.jsxs)("div",{className:"expense-tracker-container",children:[(0,x.jsxs)("div",{className:"expense-header",children:[(0,x.jsxs)("div",{className:"header-content",children:[(0,x.jsx)("h1",{children:"Expense Tracker"}),(0,x.jsx)("p",{children:"Track and categorize operational expenses"})]}),(0,x.jsxs)("div",{className:"header-actions",children:[(0,x.jsxs)("button",{onClick:()=>{const e=[["Date","Description","Category","Amount","Payment Method","Vendor","Reference"],...k.map(e=>{var t;return[new Date(e.date).toLocaleDateString(),e.description,(null===(t=w.find(t=>t.value===e.category))||void 0===t?void 0:t.label)||e.category,e.amount,e.paymentMethod,e.vendor||"-",e.reference||"-"]})].map(e=>e.join(",")).join("\n"),t=new Blob([e],{type:"text/csv"}),a=window.URL.createObjectURL(t),n=document.createElement("a");n.href=a,n.download="expenses_".concat((new Date).toISOString().split("T")[0],".csv"),n.click()},className:"btn-secondary",children:[(0,x.jsx)(La,{}),(0,x.jsx)("span",{children:"Export CSV"})]}),(0,x.jsxs)("button",{onClick:()=>o(!0),className:"btn-primary",children:[(0,x.jsx)(za,{}),(0,x.jsx)("span",{children:"Add Expense"})]})]})]}),(0,x.jsxs)("div",{className:"summary-grid",children:[(0,x.jsxs)("div",{className:"summary-card",children:[(0,x.jsxs)("div",{className:"summary-content",children:[(0,x.jsx)("p",{children:"Total Expenses"}),(0,x.jsx)("p",{children:C(A.total)})]}),(0,x.jsx)("div",{className:"summary-icon icon-red",children:(0,x.jsx)(_a,{})})]}),Object.entries(A.byCategory).slice(0,3).map(e=>{let[t,a]=e;const n=w.find(e=>e.value===t);return(0,x.jsxs)("div",{className:"summary-card",children:[(0,x.jsxs)("div",{className:"summary-content",children:[(0,x.jsx)("p",{children:(null===n||void 0===n?void 0:n.label)||t}),(0,x.jsx)("p",{children:C(a)})]}),(0,x.jsx)("div",{className:"summary-icon icon-slate",children:(0,x.jsx)(Ja,{})})]},t)})]}),(0,x.jsxs)("div",{className:"filter-section",children:[(0,x.jsxs)("div",{className:"search-wrapper",children:[(0,x.jsx)("label",{htmlFor:"expense-search",className:"sr-only",children:"Search expenses"}),(0,x.jsx)(Wa,{className:"search-icon"}),(0,x.jsx)("input",{id:"expense-search",type:"text",className:"search-input",placeholder:"Search expenses...",value:u,onChange:e=>h(e.target.value)})]}),(0,x.jsxs)("select",{value:p,onChange:e=>f(e.target.value),className:"filter-select",children:[(0,x.jsx)("option",{value:"all",children:"All Categories"}),w.map(e=>(0,x.jsx)("option",{value:e.value,children:e.label},e.value))]}),(0,x.jsx)("input",{type:"date",value:m,onChange:e=>g(e.target.value),className:"filter-date",placeholder:"From Date"}),(0,x.jsx)("input",{type:"date",value:v,onChange:e=>y(e.target.value),className:"filter-date",placeholder:"To Date"})]}),(0,x.jsx)("div",{className:"table-container",children:(0,x.jsx)("div",{className:"table-responsive",children:(0,x.jsxs)("table",{children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{children:"Date"}),(0,x.jsx)("th",{children:"Description"}),(0,x.jsx)("th",{children:"Category"}),(0,x.jsx)("th",{children:"Amount"}),(0,x.jsx)("th",{children:"Payment Method"}),(0,x.jsx)("th",{children:"Vendor"}),(0,x.jsx)("th",{children:"Actions"})]})}),(0,x.jsx)("tbody",{children:0===k.length?(0,x.jsx)("tr",{children:(0,x.jsx)("td",{colSpan:"7",className:"empty-state",children:"No expenses found. Add your first expense to get started."})}):k.map(t=>{var a;const n=w.find(e=>e.value===t.category);return(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{children:new Date(t.date).toLocaleDateString()}),(0,x.jsx)("td",{children:t.description}),(0,x.jsx)("td",{children:(0,x.jsx)("span",{className:"category-badge ".concat((null===n||void 0===n?void 0:n.badgeClass)||"badge-gray"),children:(null===n||void 0===n?void 0:n.label)||t.category})}),(0,x.jsx)("td",{className:"amount-text",children:C(t.amount)}),(0,x.jsx)("td",{className:"payment-method",children:null===(a=t.paymentMethod)||void 0===a?void 0:a.replace("_"," ")}),(0,x.jsx)("td",{children:t.vendor||"-"}),(0,x.jsx)("td",{children:(0,x.jsxs)("div",{className:"action-buttons",children:[(0,x.jsx)("button",{onClick:()=>(e=>{d(e),j({description:e.description,amount:e.amount,category:e.category,paymentMethod:e.paymentMethod,date:new Date(e.date).toISOString().split("T")[0],vendor:e.vendor||"",reference:e.reference||"",notes:e.notes||""}),o(!0)})(t),className:"btn-icon btn-edit",children:(0,x.jsx)(Ta,{})}),(0,x.jsx)("button",{onClick:()=>(async t=>{if(window.confirm("Are you sure you want to delete this expense?"))try{const a=localStorage.getItem("token");(await fetch("".concat(e,"/api/accountant/expenses/").concat(t),{method:"DELETE",headers:{Authorization:"Bearer ".concat(a)}})).ok&&await N()}catch(a){console.error("Error deleting expense:",a)}})(t._id),className:"btn-icon btn-delete",children:(0,x.jsx)(Ya,{})})]})})]},t._id)})})]})})}),l&&(0,x.jsx)("div",{className:"modal-overlay",children:(0,x.jsxs)("div",{className:"modal-content",children:[(0,x.jsx)("h2",{className:"modal-title",children:c?"Edit Expense":"Add New Expense"}),(0,x.jsxs)("form",{onSubmit:async t=>{t.preventDefault();try{const t=localStorage.getItem("token"),a=c?"".concat(e,"/api/accountant/expenses/").concat(c._id):"".concat(e,"/api/accountant/expenses"),n=c?"PUT":"POST";(await fetch(a,{method:n,headers:{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"},body:JSON.stringify((0,i.A)((0,i.A)({},b),{},{amount:parseFloat(b.amount)}))})).ok&&(await N(),S())}catch(a){console.error("Error saving expense:",a)}},children:[(0,x.jsxs)("div",{className:"form-grid",children:[(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{className:"form-label",children:"Description *"}),(0,x.jsx)("input",{type:"text",required:!0,value:b.description,onChange:e=>j((0,i.A)((0,i.A)({},b),{},{description:e.target.value})),className:"form-input"})]}),(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{className:"form-label",children:"Amount (\u20b9) *"}),(0,x.jsx)("input",{type:"number",required:!0,step:"0.01",min:"0",value:b.amount,onChange:e=>j((0,i.A)((0,i.A)({},b),{},{amount:e.target.value})),className:"form-input"})]}),(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{className:"form-label",children:"Category *"}),(0,x.jsx)("select",{required:!0,value:b.category,onChange:e=>j((0,i.A)((0,i.A)({},b),{},{category:e.target.value})),className:"form-select",children:w.map(e=>(0,x.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{className:"form-label",children:"Payment Method *"}),(0,x.jsxs)("select",{required:!0,value:b.paymentMethod,onChange:e=>j((0,i.A)((0,i.A)({},b),{},{paymentMethod:e.target.value})),className:"form-select",children:[(0,x.jsx)("option",{value:"cash",children:"Cash"}),(0,x.jsx)("option",{value:"bank_transfer",children:"Bank Transfer"}),(0,x.jsx)("option",{value:"cheque",children:"Cheque"}),(0,x.jsx)("option",{value:"online",children:"Online"}),(0,x.jsx)("option",{value:"other",children:"Other"})]})]}),(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{className:"form-label",children:"Date *"}),(0,x.jsx)("input",{type:"date",required:!0,value:b.date,onChange:e=>j((0,i.A)((0,i.A)({},b),{},{date:e.target.value})),className:"form-input"})]}),(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{className:"form-label",children:"Vendor"}),(0,x.jsx)("input",{type:"text",value:b.vendor,onChange:e=>j((0,i.A)((0,i.A)({},b),{},{vendor:e.target.value})),className:"form-input"})]}),(0,x.jsxs)("div",{className:"form-group full-width",children:[(0,x.jsx)("label",{className:"form-label",children:"Reference"}),(0,x.jsx)("input",{type:"text",value:b.reference,onChange:e=>j((0,i.A)((0,i.A)({},b),{},{reference:e.target.value})),className:"form-input"})]}),(0,x.jsxs)("div",{className:"form-group full-width",children:[(0,x.jsx)("label",{className:"form-label",children:"Notes"}),(0,x.jsx)("textarea",{value:b.notes,onChange:e=>j((0,i.A)((0,i.A)({},b),{},{notes:e.target.value})),rows:"3",className:"form-textarea"})]})]}),(0,x.jsxs)("div",{className:"modal-actions",children:[(0,x.jsxs)("button",{type:"submit",className:"btn-modal-primary",children:[c?"Update":"Add"," Expense"]}),(0,x.jsx)("button",{type:"button",onClick:S,className:"btn-modal-secondary",children:"Cancel"})]})]})]})})]})},Pn=()=>{const e="http://localhost:5000",[t,a]=(0,n.useState)([]),[s,r]=(0,n.useState)([]),[l,o]=(0,n.useState)(!0),[c,d]=(0,n.useState)(!1),[u,h]=(0,n.useState)(!1),[p,f]=(0,n.useState)(null),[m,g]=(0,n.useState)(null),[v,y]=(0,n.useState)(""),[b,j]=(0,n.useState)({name:"",contactPerson:"",email:"",phone:"",address:"",gstNumber:"",panNumber:"",paymentTerms:"30",notes:""}),[w,N]=(0,n.useState)({type:"purchase",amount:"",date:(new Date).toISOString().split("T")[0],reference:"",description:"",paymentMethod:"bank_transfer"});(0,n.useEffect)(()=>{S(),k()},[]);const S=async()=>{try{o(!0);const t=localStorage.getItem("token"),n=await fetch("".concat(e,"/api/accountant/vendors"),{headers:{Authorization:"Bearer ".concat(t)}});if(n.ok){const e=await n.json();a(e.data||[])}}catch(t){console.error("Error fetching vendors:",t)}finally{o(!1)}},k=async function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;try{const a=localStorage.getItem("token"),n=t?"".concat(e,"/api/accountant/vendors/").concat(t,"/transactions"):"".concat(e,"/api/accountant/vendors/transactions"),s=await fetch(n,{headers:{Authorization:"Bearer ".concat(a)}});if(s.ok){const e=await s.json();r(e.data||[])}}catch(a){console.error("Error fetching transactions:",a)}},A=()=>{j({name:"",contactPerson:"",email:"",phone:"",address:"",gstNumber:"",panNumber:"",paymentTerms:"30",notes:""}),f(null),d(!1)},C=()=>{N({type:"purchase",amount:"",date:(new Date).toISOString().split("T")[0],reference:"",description:"",paymentMethod:"bank_transfer"}),h(!1)},_=(0,n.useMemo)(()=>{const e={};return t.forEach(t=>{const a=s.filter(e=>{var a;return e.vendorId===t._id||(null===(a=e.vendor)||void 0===a?void 0:a._id)===t._id}),n=a.filter(e=>"purchase"===e.type).reduce((e,t)=>e+(t.amount||0),0),r=a.filter(e=>"payment"===e.type).reduce((e,t)=>e+(t.amount||0),0);e[t._id]=n-r}),e},[t,s]),L=(0,n.useMemo)(()=>{if(!v)return t;const e=v.toLowerCase();return t.filter(t=>{var a,n,s,r;return(null===(a=t.name)||void 0===a?void 0:a.toLowerCase().includes(e))||(null===(n=t.email)||void 0===n?void 0:n.toLowerCase().includes(e))||(null===(s=t.phone)||void 0===s?void 0:s.includes(e))||(null===(r=t.gstNumber)||void 0===r?void 0:r.toLowerCase().includes(e))})},[t,v]),T=e=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",maximumFractionDigits:0}).format(e);return l?(0,x.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,x.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-sky-600"})}):(0,x.jsxs)("div",{className:"vendor-ledger-container",children:[(0,x.jsxs)("div",{className:"ledger-header",children:[(0,x.jsxs)("div",{className:"header-title",children:[(0,x.jsx)("h1",{children:"Vendor Ledger"}),(0,x.jsx)("p",{children:"Track purchases, payments, and balances per vendor"})]}),(0,x.jsxs)("div",{className:"header-actions",children:[(0,x.jsxs)("button",{onClick:()=>{const e=[["Vendor","Purchases","Payments","Balance","Contact","GST"],...t.map(e=>{const t=_[e._id]||0,a=s.filter(t=>{var a;return t.vendorId===e._id||(null===(a=t.vendor)||void 0===a?void 0:a._id)===e._id}),n=a.filter(e=>"purchase"===e.type).reduce((e,t)=>e+(t.amount||0),0),r=a.filter(e=>"payment"===e.type).reduce((e,t)=>e+(t.amount||0),0);return[e.name,n,r,t,e.phone||"-",e.gstNumber||"-"]})].map(e=>e.join(",")).join("\n"),a=new Blob([e],{type:"text/csv"}),n=window.URL.createObjectURL(a),r=document.createElement("a");r.href=n,r.download="vendor_ledger_".concat((new Date).toISOString().split("T")[0],".csv"),r.click()},className:"btn btn-secondary",children:[(0,x.jsx)(La,{}),(0,x.jsx)("span",{children:"Export CSV"})]}),(0,x.jsxs)("button",{onClick:()=>d(!0),className:"btn btn-primary",children:[(0,x.jsx)(za,{}),(0,x.jsx)("span",{children:"Add Vendor"})]})]})]}),(0,x.jsxs)("div",{className:"summary-grid",children:[(0,x.jsxs)("div",{className:"summary-card",children:[(0,x.jsxs)("div",{className:"summary-info",children:[(0,x.jsx)("p",{className:"label",children:"Total Vendors"}),(0,x.jsx)("p",{className:"value",children:t.length})]}),(0,x.jsx)("div",{className:"summary-icon icon-blue",children:(0,x.jsx)(ja,{})})]}),(0,x.jsxs)("div",{className:"summary-card",children:[(0,x.jsxs)("div",{className:"summary-info",children:[(0,x.jsx)("p",{className:"label",children:"Total Payable"}),(0,x.jsx)("p",{className:"value text-red",children:T(Object.values(_).filter(e=>e>0).reduce((e,t)=>e+t,0))})]}),(0,x.jsx)("div",{className:"summary-icon icon-red",children:(0,x.jsx)(Qa,{})})]}),(0,x.jsxs)("div",{className:"summary-card",children:[(0,x.jsxs)("div",{className:"summary-info",children:[(0,x.jsx)("p",{className:"label",children:"Total Receivable"}),(0,x.jsx)("p",{className:"value text-green",children:T(Math.abs(Object.values(_).filter(e=>e<0).reduce((e,t)=>e+t,0)))})]}),(0,x.jsx)("div",{className:"summary-icon icon-green",children:(0,x.jsx)(Ka,{})})]})]}),(0,x.jsx)("div",{className:"search-container",children:(0,x.jsxs)("div",{className:"search-input-wrapper",children:[(0,x.jsx)("label",{htmlFor:"vendor-search",className:"sr-only",children:"Search vendors"}),(0,x.jsx)(Wa,{className:"search-icon"}),(0,x.jsx)("input",{id:"vendor-search",type:"text",className:"search-input",placeholder:"Search vendors by name, email, phone, or GST...",value:v,onChange:e=>y(e.target.value)})]})}),(0,x.jsx)("div",{className:"table-container",children:(0,x.jsxs)("table",{children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{children:"Vendor"}),(0,x.jsx)("th",{children:"Contact"}),(0,x.jsx)("th",{children:"GST/PAN"}),(0,x.jsx)("th",{children:"Balance"}),(0,x.jsx)("th",{children:"Actions"})]})}),(0,x.jsx)("tbody",{children:0===L.length?(0,x.jsx)("tr",{children:(0,x.jsx)("td",{colSpan:"5",style:{textAlign:"center",padding:"48px",color:"#64748b"},children:"No vendors found. Add your first vendor to get started."})}):L.map(t=>{const a=_[t._id]||0;return(0,x.jsxs)("tr",{children:[(0,x.jsxs)("td",{children:[(0,x.jsx)("div",{className:"vendor-name",children:t.name}),t.contactPerson&&(0,x.jsx)("div",{className:"sub-text",children:t.contactPerson})]}),(0,x.jsxs)("td",{children:[(0,x.jsx)("div",{children:t.email||"-"}),(0,x.jsx)("div",{className:"sub-text",children:t.phone||"-"})]}),(0,x.jsxs)("td",{children:[(0,x.jsx)("div",{children:t.gstNumber||"-"}),t.panNumber&&(0,x.jsxs)("div",{className:"sub-text",children:["PAN: ",t.panNumber]})]}),(0,x.jsx)("td",{children:(0,x.jsxs)("div",{className:"font-semibold ".concat(a>0?"text-red":a<0?"text-green":"text-slate"),children:[T(Math.abs(a)),a>0?" (Payable)":a<0?" (Receivable)":" (Settled)"]})}),(0,x.jsx)("td",{children:(0,x.jsxs)("div",{className:"actions-cell",children:[(0,x.jsx)("button",{onClick:()=>{g(t),k(t._id),h(!0)},className:"action-btn btn-add-txn",title:"Add Transaction",children:(0,x.jsx)(_a,{})}),(0,x.jsx)("button",{onClick:()=>(e=>{f(e),j({name:e.name,contactPerson:e.contactPerson||"",email:e.email||"",phone:e.phone||"",address:e.address||"",gstNumber:e.gstNumber||"",panNumber:e.panNumber||"",paymentTerms:e.paymentTerms||"30",notes:e.notes||""}),d(!0)})(t),className:"action-btn btn-edit",title:"Edit",children:(0,x.jsx)(Ta,{})}),(0,x.jsx)("button",{onClick:()=>(async t=>{if(window.confirm("Are you sure you want to delete this vendor?"))try{const a=localStorage.getItem("token");(await fetch("".concat(e,"/api/accountant/vendors/").concat(t),{method:"DELETE",headers:{Authorization:"Bearer ".concat(a)}})).ok&&await S()}catch(a){console.error("Error deleting vendor:",a)}})(t._id),className:"action-btn btn-delete",title:"Delete",children:(0,x.jsx)(Ya,{})})]})})]},t._id)})})]})}),c&&(0,x.jsx)("div",{className:"modal-overlay",children:(0,x.jsxs)("div",{className:"modal-content",children:[(0,x.jsx)("h2",{className:"modal-title",children:p?"Edit Vendor":"Add New Vendor"}),(0,x.jsxs)("form",{onSubmit:async t=>{t.preventDefault();try{const t=localStorage.getItem("token"),a=p?"".concat(e,"/api/accountant/vendors/").concat(p._id):"".concat(e,"/api/accountant/vendors"),n=p?"PUT":"POST";(await fetch(a,{method:n,headers:{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"},body:JSON.stringify(b)})).ok&&(await S(),A())}catch(a){console.error("Error saving vendor:",a)}},children:[(0,x.jsxs)("div",{className:"form-grid",children:[(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{className:"form-label",children:"Vendor Name *"}),(0,x.jsx)("input",{type:"text",required:!0,className:"form-input",value:b.name,onChange:e=>j((0,i.A)((0,i.A)({},b),{},{name:e.target.value}))})]}),(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{className:"form-label",children:"Contact Person"}),(0,x.jsx)("input",{type:"text",className:"form-input",value:b.contactPerson,onChange:e=>j((0,i.A)((0,i.A)({},b),{},{contactPerson:e.target.value}))})]}),(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{className:"form-label",children:"Email"}),(0,x.jsx)("input",{type:"email",className:"form-input",value:b.email,onChange:e=>j((0,i.A)((0,i.A)({},b),{},{email:e.target.value}))})]}),(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{className:"form-label",children:"Phone"}),(0,x.jsx)("input",{type:"tel",className:"form-input",value:b.phone,onChange:e=>j((0,i.A)((0,i.A)({},b),{},{phone:e.target.value}))})]}),(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{className:"form-label",children:"GST Number"}),(0,x.jsx)("input",{type:"text",className:"form-input",value:b.gstNumber,onChange:e=>j((0,i.A)((0,i.A)({},b),{},{gstNumber:e.target.value}))})]}),(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{className:"form-label",children:"PAN Number"}),(0,x.jsx)("input",{type:"text",className:"form-input",value:b.panNumber,onChange:e=>j((0,i.A)((0,i.A)({},b),{},{panNumber:e.target.value}))})]})]}),(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{className:"form-label",children:"Address"}),(0,x.jsx)("textarea",{className:"form-textarea",value:b.address,onChange:e=>j((0,i.A)((0,i.A)({},b),{},{address:e.target.value})),rows:"2"})]}),(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{className:"form-label",children:"Notes"}),(0,x.jsx)("textarea",{className:"form-textarea",value:b.notes,onChange:e=>j((0,i.A)((0,i.A)({},b),{},{notes:e.target.value})),rows:"2"})]}),(0,x.jsxs)("div",{className:"modal-actions",children:[(0,x.jsxs)("button",{type:"submit",className:"btn btn-primary",children:[p?"Update":"Add"," Vendor"]}),(0,x.jsx)("button",{type:"button",onClick:A,className:"btn btn-secondary",children:"Cancel"})]})]})]})}),u&&m&&(0,x.jsx)("div",{className:"modal-overlay",children:(0,x.jsxs)("div",{className:"modal-content",children:[(0,x.jsxs)("h2",{className:"modal-title",children:["Add Transaction - ",m.name]}),(0,x.jsxs)("form",{onSubmit:async t=>{if(t.preventDefault(),m)try{const t=localStorage.getItem("token");(await fetch("".concat(e,"/api/accountant/vendors/").concat(m._id,"/transactions"),{method:"POST",headers:{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"},body:JSON.stringify((0,i.A)((0,i.A)({},w),{},{amount:parseFloat(w.amount)}))})).ok&&(await k(m._id),C())}catch(a){console.error("Error saving transaction:",a)}else alert("Please select a vendor first")},children:[(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{className:"form-label",children:"Type *"}),(0,x.jsxs)("select",{required:!0,className:"form-select",value:w.type,onChange:e=>N((0,i.A)((0,i.A)({},w),{},{type:e.target.value})),children:[(0,x.jsx)("option",{value:"purchase",children:"Purchase"}),(0,x.jsx)("option",{value:"payment",children:"Payment"})]})]}),(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{className:"form-label",children:"Amount (\u20b9) *"}),(0,x.jsx)("input",{type:"number",required:!0,step:"0.01",min:"0",className:"form-input",value:w.amount,onChange:e=>N((0,i.A)((0,i.A)({},w),{},{amount:e.target.value}))})]}),(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{className:"form-label",children:"Date *"}),(0,x.jsx)("input",{type:"date",required:!0,className:"form-input",value:w.date,onChange:e=>N((0,i.A)((0,i.A)({},w),{},{date:e.target.value}))})]}),(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{className:"form-label",children:"Reference"}),(0,x.jsx)("input",{type:"text",className:"form-input",value:w.reference,onChange:e=>N((0,i.A)((0,i.A)({},w),{},{reference:e.target.value}))})]}),(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{className:"form-label",children:"Description"}),(0,x.jsx)("textarea",{className:"form-textarea",value:w.description,onChange:e=>N((0,i.A)((0,i.A)({},w),{},{description:e.target.value})),rows:"2"})]}),(0,x.jsxs)("div",{className:"modal-actions",children:[(0,x.jsx)("button",{type:"submit",className:"btn btn-primary",children:"Add Transaction"}),(0,x.jsx)("button",{type:"button",onClick:C,className:"btn btn-secondary",children:"Cancel"})]})]})]})})]})},Rn=()=>{const[e,t]=(0,n.useState)({gst:[],compliance:[],reminders:[]}),[a,s]=(0,n.useState)(!0),[r,l]=(0,n.useState)({month:(new Date).getMonth()+1,year:(new Date).getFullYear()}),[o,c]=(0,n.useState)(!1),[d,u]=(0,n.useState)(!1),[h,p]=(0,n.useState)(null),[f,g]=(0,n.useState)({type:"gst",month:r.month,year:r.year,sales:0,purchases:0,gstPayable:0,status:"pending",title:"",description:"",dueDate:"",filedDate:""});(0,n.useEffect)(()=>{v()},[r]),(0,n.useEffect)(()=>{o&&!d&&g(e=>(0,i.A)((0,i.A)({},e),{},{month:r.month,year:r.year}))},[o,r]);const v=async()=>{try{s(!0);const e=localStorage.getItem("token"),a=await fetch("".concat("http://localhost:5000","/api/accountant/tax/filing?month=").concat(r.month,"&year=").concat(r.year),{headers:{Authorization:"Bearer ".concat(e)}});if(a.ok){const e=await a.json();t(e.data||{gst:[],compliance:[],reminders:[]})}else t({gst:[],compliance:[],reminders:[]})}catch(e){console.error("Error fetching tax data:",e)}finally{s(!1)}},y=e=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",maximumFractionDigits:0}).format(e||0),b=(0,n.useMemo)(()=>(e.reminders||[]).filter(e=>new Date(e.dueDate)>=new Date).sort((e,t)=>new Date(e.dueDate)-new Date(t.dueDate)).slice(0,5),[e.reminders]),j=e=>{u(!0),p(e._id),g({type:e.type,month:e.month,year:e.year,sales:e.sales||0,purchases:e.purchases||0,gstPayable:e.gstPayable||0,status:e.status||"pending",title:e.title||"",description:e.description||"",dueDate:e.dueDate?new Date(e.dueDate).toISOString().split("T")[0]:"",filedDate:e.filedDate?new Date(e.filedDate).toISOString().split("T")[0]:""}),c(!0)},w=async e=>{if(window.confirm("Are you sure you want to delete this record?"))try{await async function(e){return(await m.A.delete("".concat(nn,"/api/accountant/tax/record/").concat(e),{headers:sn()})).data}(e),v()}catch(t){console.error("Delete failed",t)}};return a?(0,x.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,x.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-sky-600"})}):(0,x.jsxs)("div",{className:"tax-filing-container",children:[(0,x.jsxs)("div",{className:"tax-header",children:[(0,x.jsxs)("div",{className:"header-content",children:[(0,x.jsx)("h1",{children:"Tax Filing Assistant"}),(0,x.jsx)("p",{children:"Automated GST and compliance reminders"})]}),(0,x.jsxs)("div",{className:"header-actions",children:[(0,x.jsx)("select",{className:"month-select",value:r.month,onChange:e=>l((0,i.A)((0,i.A)({},r),{},{month:parseInt(e.target.value)})),children:Array.from({length:12},(e,t)=>t+1).map(e=>(0,x.jsx)("option",{value:e,children:new Date(2e3,e-1).toLocaleString("default",{month:"long"})},e))}),(0,x.jsx)("input",{type:"number",className:"year-input",value:r.year,onChange:e=>l((0,i.A)((0,i.A)({},r),{},{year:parseInt(e.target.value)}))}),(0,x.jsxs)("button",{onClick:()=>{u(!1),g({type:"gst",month:r.month,year:r.year,sales:0,purchases:0,gstPayable:0,status:"pending",title:"",description:"",dueDate:"",filedDate:""}),c(!0)},className:"btn-add",children:[(0,x.jsx)(za,{}),(0,x.jsx)("span",{children:"Add Record"})]}),(0,x.jsxs)("button",{onClick:async()=>{alert("GST Report generation triggered (Mock)")},className:"btn-generate",children:[(0,x.jsx)(La,{}),(0,x.jsx)("span",{children:"Report"})]})]})]}),(0,x.jsxs)("div",{className:"reminders-section",children:[(0,x.jsxs)("div",{className:"section-header",children:[(0,x.jsx)(xa,{className:"text-orange-600 text-xl"}),(0,x.jsx)("h2",{className:"section-title",children:"Upcoming Deadlines"})]}),(0,x.jsx)("div",{className:"reminders-list",children:0===b.length?(0,x.jsx)("p",{className:"empty-state",children:"No upcoming deadlines"}):b.map((e,t)=>(0,x.jsx)("div",{className:"reminder-item reminder-warning",children:(0,x.jsxs)("div",{className:"reminder-content",children:[(0,x.jsxs)("div",{className:"reminder-info",children:[(0,x.jsx)("h3",{children:e.title}),(0,x.jsx)("p",{children:e.description})]}),(0,x.jsxs)("div",{className:"reminder-actions-mini",children:[(0,x.jsx)("button",{onClick:()=>j(e),className:"icon-btn-edit",children:(0,x.jsx)(Ta,{})}),(0,x.jsx)("button",{onClick:()=>w(e._id),className:"icon-btn-delete",children:(0,x.jsx)(Ya,{})})]})]})},e._id||t))})]}),(0,x.jsxs)("div",{className:"summary-grid",children:[(0,x.jsxs)("div",{className:"summary-card",children:[(0,x.jsxs)("div",{className:"summary-info",children:[(0,x.jsx)("p",{className:"label",children:"Total Sales"}),(0,x.jsx)("p",{className:"value",children:y(e.gst.reduce((e,t)=>e+(t.sales||0),0))})]}),(0,x.jsx)("div",{className:"summary-icon icon-green",children:(0,x.jsx)(Qa,{})})]}),(0,x.jsxs)("div",{className:"summary-card",children:[(0,x.jsxs)("div",{className:"summary-info",children:[(0,x.jsx)("p",{className:"label",children:"Total Purchases"}),(0,x.jsx)("p",{className:"value",children:y(e.gst.reduce((e,t)=>e+(t.purchases||0),0))})]}),(0,x.jsx)("div",{className:"summary-icon icon-blue",children:(0,x.jsx)(Ka,{})})]}),(0,x.jsxs)("div",{className:"summary-card",children:[(0,x.jsxs)("div",{className:"summary-info",children:[(0,x.jsx)("p",{className:"label",children:"GST Payable"}),(0,x.jsx)("p",{className:"value text-red",children:y(e.gst.reduce((e,t)=>e+(t.gstPayable||0),0))})]}),(0,x.jsx)("div",{className:"summary-icon icon-red",children:(0,x.jsx)(Ea,{})})]})]}),(0,x.jsxs)("div",{className:"compliance-section",children:[(0,x.jsx)("div",{className:"section-header-row",children:(0,x.jsx)("h2",{className:"section-title",children:"Compliance Status"})}),(0,x.jsx)("div",{className:"compliance-list",children:0===e.compliance.length?(0,x.jsx)("p",{className:"empty-state",children:"No compliance records found"}):e.compliance.map(e=>(0,x.jsxs)("div",{className:"compliance-item",children:[(0,x.jsxs)("div",{className:"compliance-details",children:["filed"===e.status?(0,x.jsx)(Sa,{className:"text-green-600 text-xl"}):(0,x.jsx)(Aa,{className:"text-orange-600 text-xl"}),(0,x.jsxs)("div",{children:[(0,x.jsx)("h3",{className:"comp-title",children:e.title}),(0,x.jsx)("p",{className:"comp-desc",children:e.description})]})]}),(0,x.jsxs)("div",{className:"compliance-actions",children:[(0,x.jsx)("span",{className:"status-badge ".concat("filed"===e.status?"badge-success":"badge-pending"),children:"filed"===e.status?"Filed":"Pending"}),(0,x.jsx)("button",{onClick:()=>j(e),className:"icon-btn-edit",children:(0,x.jsx)(Ta,{})}),(0,x.jsx)("button",{onClick:()=>w(e._id),className:"icon-btn-delete",children:(0,x.jsx)(Ya,{})})]})]},e._id))})]}),(0,x.jsxs)("div",{className:"gst-table-container",children:[(0,x.jsx)("div",{className:"table-header",children:(0,x.jsx)("h2",{children:"GST Details"})}),(0,x.jsx)("div",{className:"table-responsive",children:(0,x.jsxs)("table",{children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{children:"Type"}),(0,x.jsx)("th",{children:"Sales"}),(0,x.jsx)("th",{children:"Purchases"}),(0,x.jsx)("th",{children:"GST Payable"}),(0,x.jsx)("th",{children:"Status"}),(0,x.jsx)("th",{children:"Actions"})]})}),(0,x.jsx)("tbody",{children:0===e.gst.length?(0,x.jsx)("tr",{children:(0,x.jsx)("td",{colSpan:"6",className:"empty-state",children:"No GST data available for this period"})}):e.gst.map(e=>(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{className:"font-medium text-slate-800",children:e.title||"Standard Return"}),(0,x.jsx)("td",{children:y(e.sales||0)}),(0,x.jsx)("td",{children:y(e.purchases||0)}),(0,x.jsx)("td",{className:"text-red-600 font-bold",children:y(e.gstPayable||0)}),(0,x.jsx)("td",{children:(0,x.jsx)("span",{className:"status-badge ".concat("filed"===e.status?"badge-success":"badge-pending"),children:"filed"===e.status?"Filed":"Pending"})}),(0,x.jsx)("td",{children:(0,x.jsxs)("div",{className:"action-buttons",children:[(0,x.jsx)("button",{onClick:()=>j(e),className:"btn-icon btn-edit",children:(0,x.jsx)(Ta,{})}),(0,x.jsx)("button",{onClick:()=>w(e._id),className:"btn-icon btn-delete",children:(0,x.jsx)(Ya,{})})]})})]},e._id))})]})})]}),o&&(0,x.jsx)("div",{className:"modal-overlay",children:(0,x.jsxs)("div",{className:"modal-content",children:[(0,x.jsx)("h3",{className:"modal-title",children:d?"Edit Record":"Add New Record"}),(0,x.jsxs)("form",{onSubmit:async e=>{e.preventDefault();try{d?await async function(e,t){return(await m.A.put("".concat(nn,"/api/accountant/tax/record/").concat(e),t,{headers:sn()})).data}(h,f):await async function(e){return(await m.A.post("".concat(nn,"/api/accountant/tax/record"),e,{headers:sn()})).data}(f),c(!1),v()}catch(t){console.error("Save failed",t),alert("Failed to save record")}},children:[(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{className:"form-label",children:"Record Type"}),(0,x.jsxs)("select",{className:"form-select",value:f.type,onChange:e=>g((0,i.A)((0,i.A)({},f),{},{type:e.target.value})),children:[(0,x.jsx)("option",{value:"gst",children:"GST Return"}),(0,x.jsx)("option",{value:"compliance",children:"Compliance"}),(0,x.jsx)("option",{value:"reminder",children:"Reminder"})]})]}),"gst"===f.type&&(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{className:"form-label",children:"Title/Description"}),(0,x.jsx)("input",{className:"form-input",value:f.title,onChange:e=>g((0,i.A)((0,i.A)({},f),{},{title:e.target.value})),placeholder:"e.g. GSTR-3B"})]}),(0,x.jsxs)("div",{className:"grid-2",children:[(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{className:"form-label",children:"Sales"}),(0,x.jsx)("input",{type:"number",className:"form-input",value:f.sales,onChange:e=>g((0,i.A)((0,i.A)({},f),{},{sales:Number(e.target.value)}))})]}),(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{className:"form-label",children:"Purchases"}),(0,x.jsx)("input",{type:"number",className:"form-input",value:f.purchases,onChange:e=>g((0,i.A)((0,i.A)({},f),{},{purchases:Number(e.target.value)}))})]})]}),(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{className:"form-label",children:"GST Payable"}),(0,x.jsx)("input",{type:"number",className:"form-input",value:f.gstPayable,onChange:e=>g((0,i.A)((0,i.A)({},f),{},{gstPayable:Number(e.target.value)}))})]})]}),("compliance"===f.type||"reminder"===f.type)&&(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{className:"form-label",children:"Title"}),(0,x.jsx)("input",{className:"form-input",value:f.title,onChange:e=>g((0,i.A)((0,i.A)({},f),{},{title:e.target.value}))})]}),(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{className:"form-label",children:"Description"}),(0,x.jsx)("input",{className:"form-input",value:f.description,onChange:e=>g((0,i.A)((0,i.A)({},f),{},{description:e.target.value}))})]}),(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{className:"form-label",children:"Due Date"}),(0,x.jsx)("input",{type:"date",className:"form-input",value:f.dueDate,onChange:e=>g((0,i.A)((0,i.A)({},f),{},{dueDate:e.target.value}))})]})]}),(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{className:"form-label",children:"Status"}),(0,x.jsxs)("select",{className:"form-select",value:f.status,onChange:e=>g((0,i.A)((0,i.A)({},f),{},{status:e.target.value})),children:[(0,x.jsx)("option",{value:"pending",children:"Pending"}),(0,x.jsx)("option",{value:"filed",children:"Filed/Completed"}),(0,x.jsx)("option",{value:"overdue",children:"Overdue"})]})]}),(0,x.jsxs)("div",{className:"modal-actions",children:[(0,x.jsx)("button",{type:"button",onClick:()=>c(!1),className:"btn-secondary",children:"Cancel"}),(0,x.jsx)("button",{type:"submit",className:"btn-primary",children:"Save"})]})]})]})})]})},In=()=>{var e,t;const[a,s]=(0,n.useState)([]),[r,i]=(0,n.useState)(!0),[l,o]=(0,n.useState)(""),[c,d]=(0,n.useState)("all"),[u,h]=(0,n.useState)("all"),[p,f]=(0,n.useState)(""),[m,g]=(0,n.useState)(""),[v,y]=(0,n.useState)(null);(0,n.useEffect)(()=>{b()},[]);const b=async()=>{try{i(!0);const e=localStorage.getItem("token"),t=await fetch("".concat("http://localhost:5000","/api/accountant/audit-logs"),{headers:{Authorization:"Bearer ".concat(e)}});if(t.ok){const e=await t.json();s(e.data||[])}}catch(e){console.error("Error fetching audit logs:",e)}finally{i(!1)}},j=(0,n.useMemo)(()=>{let e=a;if(l){const t=l.toLowerCase();e=e.filter(e=>{var a,n,s,r,i,l,o;return(null===(a=e.entityType)||void 0===a?void 0:a.toLowerCase().includes(t))||(null===(n=e.entityId)||void 0===n?void 0:n.toLowerCase().includes(t))||(null===(s=e.description)||void 0===s?void 0:s.toLowerCase().includes(t))||(null===(r=e.user)||void 0===r||null===(i=r.name)||void 0===i?void 0:i.toLowerCase().includes(t))||(null===(l=e.user)||void 0===l||null===(o=l.email)||void 0===o?void 0:o.toLowerCase().includes(t))})}return"all"!==c&&(e=e.filter(e=>e.action===c)),"all"!==u&&(e=e.filter(e=>{var t;return(null===(t=e.user)||void 0===t?void 0:t._id)===u})),p&&(e=e.filter(e=>new Date(e.timestamp)>=new Date(p))),m&&(e=e.filter(e=>new Date(e.timestamp)<=new Date(m+"T23:59:59"))),e.sort((e,t)=>new Date(t.timestamp)-new Date(e.timestamp))},[a,l,c,u,p,m]),w=(0,n.useMemo)(()=>{const e=new Map;return a.forEach(t=>{t.user&&!e.has(t.user._id)&&e.set(t.user._id,t.user)}),Array.from(e.values())},[a]),N=e=>{switch(e){case"create":return(0,x.jsx)(za,{className:"text-green-600"});case"update":return(0,x.jsx)(Ta,{className:"text-blue-600"});case"delete":return(0,x.jsx)(Ya,{className:"text-red-600"});default:return(0,x.jsx)(Ga,{className:"text-slate-600"})}},S=e=>{switch(e){case"create":return"bg-green-100 text-green-700";case"update":return"bg-blue-100 text-blue-700";case"delete":return"bg-red-100 text-red-700";case"approve":return"bg-purple-100 text-purple-700";case"reject":return"bg-orange-100 text-orange-700";case"payment":return"bg-teal-100 text-teal-700";default:return"bg-gray-100 text-gray-700"}};return r?(0,x.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,x.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-sky-600"})}):(0,x.jsxs)("div",{className:"space-y-6",children:[(0,x.jsxs)("div",{className:"flex items-center justify-between",children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("h1",{className:"text-3xl font-bold text-slate-800",children:"Audit Trail Viewer"}),(0,x.jsx)("p",{className:"text-slate-600 mt-1",children:"View system logs and transaction history for compliance"})]}),(0,x.jsxs)("button",{onClick:()=>{const e=[["Timestamp","User","Action","Entity Type","Entity ID","Description","IP Address"],...j.map(e=>{var t,a;return[new Date(e.timestamp).toLocaleString(),(null===(t=e.user)||void 0===t?void 0:t.name)||(null===(a=e.user)||void 0===a?void 0:a.email)||"System",e.action,e.entityType||"-",e.entityId||"-",e.description||"-",e.ipAddress||"-"]})].map(e=>e.join(",")).join("\n"),t=new Blob([e],{type:"text/csv"}),a=window.URL.createObjectURL(t),n=document.createElement("a");n.href=a,n.download="audit_trail_".concat((new Date).toISOString().split("T")[0],".csv"),n.click()},className:"flex items-center gap-2 px-4 py-2 bg-slate-600 text-white rounded-lg hover:bg-slate-700 transition-colors",children:[(0,x.jsx)(La,{}),(0,x.jsx)("span",{children:"Export CSV"})]})]}),(0,x.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,x.jsx)("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-slate-200",children:(0,x.jsxs)("div",{className:"flex items-center justify-between",children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("p",{className:"text-sm text-slate-600",children:"Total Logs"}),(0,x.jsx)("p",{className:"text-2xl font-bold text-slate-800 mt-1",children:a.length})]}),(0,x.jsx)("div",{className:"bg-blue-100 p-3 rounded-lg",children:(0,x.jsx)(Ga,{className:"text-blue-600 text-xl"})})]})}),(0,x.jsx)("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-slate-200",children:(0,x.jsxs)("div",{className:"flex items-center justify-between",children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("p",{className:"text-sm text-slate-600",children:"Today's Activity"}),(0,x.jsx)("p",{className:"text-2xl font-bold text-slate-800 mt-1",children:a.filter(e=>{const t=new Date;return new Date(e.timestamp).toDateString()===t.toDateString()}).length})]}),(0,x.jsx)("div",{className:"bg-green-100 p-3 rounded-lg",children:(0,x.jsx)(Aa,{className:"text-green-600 text-xl"})})]})}),(0,x.jsx)("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-slate-200",children:(0,x.jsxs)("div",{className:"flex items-center justify-between",children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("p",{className:"text-sm text-slate-600",children:"Unique Users"}),(0,x.jsx)("p",{className:"text-2xl font-bold text-slate-800 mt-1",children:w.length})]}),(0,x.jsx)("div",{className:"bg-purple-100 p-3 rounded-lg",children:(0,x.jsx)(Za,{className:"text-purple-600 text-xl"})})]})}),(0,x.jsx)("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-slate-200",children:(0,x.jsxs)("div",{className:"flex items-center justify-between",children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("p",{className:"text-sm text-slate-600",children:"Filtered Results"}),(0,x.jsx)("p",{className:"text-2xl font-bold text-slate-800 mt-1",children:j.length})]}),(0,x.jsx)("div",{className:"bg-orange-100 p-3 rounded-lg",children:(0,x.jsx)(Pa,{className:"text-orange-600 text-xl"})})]})})]}),(0,x.jsx)("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-slate-200",children:(0,x.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[(0,x.jsxs)("div",{className:"relative",children:[(0,x.jsx)("label",{htmlFor:"audit-search",className:"sr-only",children:"Search audit logs"}),(0,x.jsx)(Wa,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400"}),(0,x.jsx)("input",{id:"audit-search",type:"text",placeholder:"Search logs...",value:l,onChange:e=>o(e.target.value),"aria-label":"Search audit logs",className:"w-full pl-10 pr-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-sky-500"})]}),(0,x.jsx)("label",{htmlFor:"audit-action-filter",className:"sr-only",children:"Filter by action"}),(0,x.jsxs)("select",{id:"audit-action-filter",value:c,onChange:e=>d(e.target.value),"aria-label":"Filter audit logs by action type",className:"px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-sky-500",children:[(0,x.jsx)("option",{value:"all",children:"All Actions"}),["create","update","delete","approve","reject","payment","export"].map(e=>(0,x.jsx)("option",{value:e,children:e.charAt(0).toUpperCase()+e.slice(1)},e))]}),(0,x.jsx)("label",{htmlFor:"audit-user-filter",className:"sr-only",children:"Filter by user"}),(0,x.jsxs)("select",{id:"audit-user-filter",value:u,onChange:e=>h(e.target.value),"aria-label":"Filter audit logs by user",className:"px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-sky-500",children:[(0,x.jsx)("option",{value:"all",children:"All Users"}),w.map(e=>(0,x.jsx)("option",{value:e._id,children:e.name||e.email},e._id))]}),(0,x.jsx)("label",{htmlFor:"audit-date-from",className:"sr-only",children:"From date"}),(0,x.jsx)("input",{id:"audit-date-from",type:"date",value:p,onChange:e=>f(e.target.value),"aria-label":"Filter audit logs from date",className:"px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-sky-500"}),(0,x.jsx)("label",{htmlFor:"audit-date-to",className:"sr-only",children:"To date"}),(0,x.jsx)("input",{id:"audit-date-to",type:"date",value:m,onChange:e=>g(e.target.value),"aria-label":"Filter audit logs to date",className:"px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-sky-500"})]})}),(0,x.jsx)("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden",children:(0,x.jsx)("div",{className:"overflow-x-auto",children:(0,x.jsxs)("table",{className:"w-full",children:[(0,x.jsx)("thead",{className:"bg-slate-50 border-b border-slate-200",children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-700 uppercase tracking-wider",children:"Timestamp"}),(0,x.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-700 uppercase tracking-wider",children:"User"}),(0,x.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-700 uppercase tracking-wider",children:"Action"}),(0,x.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-700 uppercase tracking-wider",children:"Entity"}),(0,x.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-700 uppercase tracking-wider",children:"Description"}),(0,x.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-700 uppercase tracking-wider",children:"Details"})]})}),(0,x.jsx)("tbody",{className:"bg-white divide-y divide-slate-200",children:0===j.length?(0,x.jsx)("tr",{children:(0,x.jsx)("td",{colSpan:"6",className:"px-6 py-8 text-center text-slate-500",children:"No audit logs found"})}):j.map(e=>{var t,a,n;return(0,x.jsxs)("tr",{className:"hover:bg-slate-50 cursor-pointer",onClick:()=>y(e),children:[(0,x.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-slate-600",children:(0,x.jsxs)("div",{className:"flex items-center gap-2",children:[(0,x.jsx)(Aa,{className:"text-slate-400"}),new Date(e.timestamp).toLocaleString()]})}),(0,x.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,x.jsxs)("div",{className:"flex items-center gap-2",children:[(0,x.jsx)("div",{className:"bg-slate-100 p-2 rounded-full",children:(0,x.jsx)(Za,{className:"text-slate-600 text-sm"})}),(0,x.jsxs)("div",{children:[(0,x.jsx)("div",{className:"text-sm font-medium text-slate-800",children:(null===(t=e.user)||void 0===t?void 0:t.name)||(null===(a=e.user)||void 0===a?void 0:a.email)||"System"}),(null===(n=e.user)||void 0===n?void 0:n.role)&&(0,x.jsx)("div",{className:"text-xs text-slate-500",children:e.user.role})]})]})}),(0,x.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,x.jsxs)("div",{className:"flex items-center gap-2",children:[N(e.action),(0,x.jsx)("span",{className:"px-2 py-1 rounded text-xs font-medium ".concat(S(e.action)),children:e.action})]})}),(0,x.jsxs)("td",{className:"px-6 py-4 text-sm text-slate-600",children:[(0,x.jsx)("div",{children:e.entityType||"-"}),e.entityId&&(0,x.jsxs)("div",{className:"text-xs text-slate-400",children:[e.entityId.substring(0,8),"..."]})]}),(0,x.jsx)("td",{className:"px-6 py-4 text-sm text-slate-600",children:e.description||"-"}),(0,x.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:(0,x.jsx)("button",{className:"text-sky-600 hover:text-sky-800",children:"View"})})]},e._id)})})]})})}),v&&(0,x.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,x.jsxs)("div",{className:"bg-white rounded-xl p-6 max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[(0,x.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,x.jsx)("h2",{className:"text-xl font-semibold",children:"Audit Log Details"}),(0,x.jsx)("button",{onClick:()=>y(null),className:"text-slate-400 hover:text-slate-600",children:"\xd7"})]}),(0,x.jsxs)("div",{className:"space-y-4",children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{className:"text-sm font-medium text-slate-700",children:"Timestamp"}),(0,x.jsx)("p",{className:"text-slate-800",children:new Date(v.timestamp).toLocaleString()})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{className:"text-sm font-medium text-slate-700",children:"User"}),(0,x.jsx)("p",{className:"text-slate-800",children:(null===(e=v.user)||void 0===e?void 0:e.name)||(null===(t=v.user)||void 0===t?void 0:t.email)||"System"})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{className:"text-sm font-medium text-slate-700",children:"Action"}),(0,x.jsx)("p",{className:"text-slate-800 capitalize",children:v.action})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{className:"text-sm font-medium text-slate-700",children:"Entity Type"}),(0,x.jsx)("p",{className:"text-slate-800",children:v.entityType||"-"})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{className:"text-sm font-medium text-slate-700",children:"Entity ID"}),(0,x.jsx)("p",{className:"text-slate-800 font-mono text-sm",children:v.entityId||"-"})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{className:"text-sm font-medium text-slate-700",children:"Description"}),(0,x.jsx)("p",{className:"text-slate-800",children:v.description||"-"})]}),v.changes&&(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{className:"text-sm font-medium text-slate-700",children:"Changes"}),(0,x.jsx)("pre",{className:"bg-slate-50 p-3 rounded text-xs overflow-auto",children:JSON.stringify(v.changes,null,2)})]}),v.ipAddress&&(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{className:"text-sm font-medium text-slate-700",children:"IP Address"}),(0,x.jsx)("p",{className:"text-slate-800 font-mono text-sm",children:v.ipAddress})]})]})]})})]})},Bn=()=>{const[e,t]=(0,n.useState)({products:[],batches:[],summary:{}}),[a,s]=(0,n.useState)(!0),[r,l]=(0,n.useState)({month:(new Date).getMonth()+1,year:(new Date).getFullYear()}),[o,c]=(0,n.useState)("products");(0,n.useEffect)(()=>{d()},[r,o]);const d=async()=>{try{s(!0);const e=localStorage.getItem("token"),a=await fetch("".concat("http://localhost:5000","/api/accountant/profitability?month=").concat(r.month,"&year=").concat(r.year,"&view=").concat(o),{headers:{Authorization:"Bearer ".concat(e)}});if(a.ok){const e=await a.json();t(e.data||{products:[],batches:[],summary:{}})}}catch(e){console.error("Error fetching profitability data:",e)}finally{s(!1)}},u=e=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",maximumFractionDigits:0}).format(e),h=(e,t)=>e&&0!==e?(e-t)/e*100:0,p=(0,n.useMemo)(()=>[..."products"===o?e.products:e.batches].sort((e,t)=>{const a=h(e.revenue,e.cost);return h(t.revenue,t.cost)-a}),[e,o]);return a?(0,x.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,x.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-sky-600"})}):(0,x.jsxs)("div",{className:"space-y-6",children:[(0,x.jsxs)("div",{className:"flex items-center justify-between",children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("h1",{className:"text-3xl font-bold text-slate-800",children:"Profitability Dashboard"}),(0,x.jsx)("p",{className:"text-slate-600 mt-1",children:"Visualize margins per product and batch"})]}),(0,x.jsxs)("div",{className:"flex gap-3",children:[(0,x.jsx)("label",{htmlFor:"profitability-month-select",className:"sr-only",children:"Select month"}),(0,x.jsx)("select",{id:"profitability-month-select",value:r.month,onChange:e=>l((0,i.A)((0,i.A)({},r),{},{month:parseInt(e.target.value)})),"aria-label":"Select month for profitability analysis",className:"px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-sky-500",children:Array.from({length:12},(e,t)=>t+1).map(e=>(0,x.jsx)("option",{value:e,children:new Date(2e3,e-1).toLocaleString("default",{month:"long"})},e))}),(0,x.jsx)("label",{htmlFor:"profitability-year-input",className:"sr-only",children:"Select year"}),(0,x.jsx)("input",{id:"profitability-year-input",type:"number",value:r.year,onChange:e=>l((0,i.A)((0,i.A)({},r),{},{year:parseInt(e.target.value)})),"aria-label":"Select year for profitability analysis",className:"px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-sky-500 w-24"}),(0,x.jsxs)("div",{className:"flex gap-2",children:[(0,x.jsx)("button",{onClick:()=>c("products"),className:"px-4 py-2 rounded-lg transition-colors ".concat("products"===o?"bg-sky-600 text-white":"bg-slate-200 text-slate-700 hover:bg-slate-300"),children:"Products"}),(0,x.jsx)("button",{onClick:()=>c("batches"),className:"px-4 py-2 rounded-lg transition-colors ".concat("batches"===o?"bg-sky-600 text-white":"bg-slate-200 text-slate-700 hover:bg-slate-300"),children:"Batches"})]}),(0,x.jsxs)("button",{onClick:()=>{const e=["products"===o?["Product","Revenue","Cost","Profit","Margin %","Quantity"]:["Batch","Product","Revenue","Cost","Profit","Margin %"],...p.map(e=>{const t=(e.revenue||0)-(e.cost||0),a=h(e.revenue,e.cost);return"products"===o?[e.name||e.productName,e.revenue||0,e.cost||0,t,a.toFixed(2),e.quantity||0]:[e.batchNumber||"-",e.productName||"-",e.revenue||0,e.cost||0,t,a.toFixed(2)]})].map(e=>e.join(",")).join("\n"),t=new Blob([e],{type:"text/csv"}),a=window.URL.createObjectURL(t),n=document.createElement("a");n.href=a,n.download="profitability_".concat(o,"_").concat(r.month,"_").concat(r.year,".csv"),n.click()},className:"flex items-center gap-2 px-4 py-2 bg-slate-600 text-white rounded-lg hover:bg-slate-700 transition-colors",children:[(0,x.jsx)(La,{}),(0,x.jsx)("span",{children:"Export CSV"})]})]})]}),(0,x.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,x.jsx)("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-slate-200",children:(0,x.jsxs)("div",{className:"flex items-center justify-between",children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("p",{className:"text-sm text-slate-600",children:"Total Revenue"}),(0,x.jsx)("p",{className:"text-2xl font-bold text-green-600 mt-1",children:u(e.summary.totalRevenue||0)})]}),(0,x.jsx)("div",{className:"bg-green-100 p-3 rounded-lg",children:(0,x.jsx)(Qa,{className:"text-green-600 text-xl"})})]})}),(0,x.jsx)("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-slate-200",children:(0,x.jsxs)("div",{className:"flex items-center justify-between",children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("p",{className:"text-sm text-slate-600",children:"Total Cost"}),(0,x.jsx)("p",{className:"text-2xl font-bold text-red-600 mt-1",children:u(e.summary.totalCost||0)})]}),(0,x.jsx)("div",{className:"bg-red-100 p-3 rounded-lg",children:(0,x.jsx)(Ka,{className:"text-red-600 text-xl"})})]})}),(0,x.jsx)("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-slate-200",children:(0,x.jsxs)("div",{className:"flex items-center justify-between",children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("p",{className:"text-sm text-slate-600",children:"Net Profit"}),(0,x.jsx)("p",{className:"text-2xl font-bold text-blue-600 mt-1",children:u((e.summary.totalRevenue||0)-(e.summary.totalCost||0))})]}),(0,x.jsx)("div",{className:"bg-blue-100 p-3 rounded-lg",children:(0,x.jsx)(ya,{className:"text-blue-600 text-xl"})})]})}),(0,x.jsx)("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-slate-200",children:(0,x.jsxs)("div",{className:"flex items-center justify-between",children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("p",{className:"text-sm text-slate-600",children:"Average Margin"}),(0,x.jsxs)("p",{className:"text-2xl font-bold text-purple-600 mt-1",children:[e.summary.totalRevenue>0?h(e.summary.totalRevenue,e.summary.totalCost).toFixed(1):0,"%"]})]}),(0,x.jsx)("div",{className:"bg-purple-100 p-3 rounded-lg",children:(0,x.jsx)(qa,{className:"text-purple-600 text-xl"})})]})})]}),(0,x.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden",children:[(0,x.jsx)("div",{className:"p-6 border-b border-slate-200",children:(0,x.jsx)("h2",{className:"text-xl font-semibold text-slate-800",children:"products"===o?"Product Profitability":"Batch Profitability"})}),(0,x.jsx)("div",{className:"overflow-x-auto",children:(0,x.jsxs)("table",{className:"w-full",children:[(0,x.jsx)("thead",{className:"bg-slate-50 border-b border-slate-200",children:(0,x.jsxs)("tr",{children:["batches"===o&&(0,x.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-700 uppercase tracking-wider",children:"Batch"}),(0,x.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-700 uppercase tracking-wider",children:"Product"}),(0,x.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-700 uppercase tracking-wider",children:"Revenue"}),(0,x.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-700 uppercase tracking-wider",children:"Cost"}),(0,x.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-700 uppercase tracking-wider",children:"Profit"}),(0,x.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-700 uppercase tracking-wider",children:"Margin %"}),"products"===o&&(0,x.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-700 uppercase tracking-wider",children:"Quantity"})]})}),(0,x.jsx)("tbody",{className:"bg-white divide-y divide-slate-200",children:0===p.length?(0,x.jsx)("tr",{children:(0,x.jsx)("td",{colSpan:"products"===o?7:6,className:"px-6 py-8 text-center text-slate-500",children:"No profitability data available for this period"})}):p.map((e,t)=>{const a=(e.revenue||0)-(e.cost||0),n=h(e.revenue,e.cost),s=n>=0;return(0,x.jsxs)("tr",{className:"hover:bg-slate-50",children:["batches"===o&&(0,x.jsx)("td",{className:"px-6 py-4 text-sm font-medium text-slate-800",children:e.batchNumber||"-"}),(0,x.jsx)("td",{className:"px-6 py-4 text-sm font-medium text-slate-800",children:e.name||e.productName||"-"}),(0,x.jsx)("td",{className:"px-6 py-4 text-sm text-slate-600",children:u(e.revenue||0)}),(0,x.jsx)("td",{className:"px-6 py-4 text-sm text-slate-600",children:u(e.cost||0)}),(0,x.jsx)("td",{className:"px-6 py-4 text-sm font-semibold ".concat(s?"text-green-600":"text-red-600"),children:u(a)}),(0,x.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,x.jsxs)("div",{className:"flex items-center gap-2",children:[(0,x.jsx)("div",{className:"w-16 h-2 rounded-full ".concat(s?"bg-green-200":"bg-red-200"),children:(0,x.jsx)("div",{className:"h-2 rounded-full ".concat(s?"bg-green-600":"bg-red-600"),style:{width:"".concat(Math.min(Math.abs(n),100),"%")}})}),(0,x.jsxs)("span",{className:"text-sm font-medium ".concat(s?"text-green-600":"text-red-600"),children:[n.toFixed(1),"%"]})]})}),"products"===o&&(0,x.jsx)("td",{className:"px-6 py-4 text-sm text-slate-600",children:e.quantity||0})]},t)})})]})})]}),(0,x.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,x.jsxs)("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-slate-200",children:[(0,x.jsx)("h3",{className:"text-lg font-semibold text-slate-700 mb-4",children:"Margin Distribution"}),(0,x.jsx)("div",{className:"h-64 bg-slate-50 rounded flex items-center justify-center text-slate-400",children:(0,x.jsxs)("div",{className:"text-center",children:[(0,x.jsx)(ya,{className:"text-4xl mx-auto mb-2"}),(0,x.jsx)("p",{children:"Chart visualization would be rendered here"})]})})]}),(0,x.jsxs)("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-slate-200",children:[(0,x.jsx)("h3",{className:"text-lg font-semibold text-slate-700 mb-4",children:"Revenue vs Cost"}),(0,x.jsx)("div",{className:"h-64 bg-slate-50 rounded flex items-center justify-center text-slate-400",children:(0,x.jsxs)("div",{className:"text-center",children:[(0,x.jsx)(qa,{className:"text-4xl mx-auto mb-2"}),(0,x.jsx)("p",{children:"Chart visualization would be rendered here"})]})})]})]})]})},Fn=()=>{const e="http://localhost:5000",[t,a]=(0,n.useState)([]),[s,r]=(0,n.useState)([]),[i,l]=(0,n.useState)([]),[o,c]=(0,n.useState)([]),[d,u]=(0,n.useState)(!0),[h,p]=(0,n.useState)(null),[f,m]=(0,n.useState)("");(0,n.useEffect)(()=>{g()},[]);const g=async()=>{try{u(!0);const t=localStorage.getItem("token"),[n,s]=await Promise.all([fetch("".concat(e,"/api/accountant/bank-reconciliation/statements"),{headers:{Authorization:"Bearer ".concat(t)}}),fetch("".concat(e,"/api/accountant/bank-reconciliation/transactions"),{headers:{Authorization:"Bearer ".concat(t)}})]);if(n.ok){const e=await n.json();a(e.data||[])}if(s.ok){const e=await s.json();r(e.data||[]),l(e.matched||[]),c(e.unmatched||[])}}catch(t){console.error("Error fetching reconciliation data:",t)}finally{u(!1)}},v=(0,n.useMemo)(()=>{if(!f)return o;const e=f.toLowerCase();return o.filter(t=>{var a,n,s;return(null===(a=t.description)||void 0===a?void 0:a.toLowerCase().includes(e))||(null===(n=t.reference)||void 0===n?void 0:n.toLowerCase().includes(e))||(null===(s=t.amount)||void 0===s?void 0:s.toString().includes(e))})},[o,f]);return d?(0,x.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,x.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-sky-600"})}):(0,x.jsxs)("div",{className:"space-y-6",children:[(0,x.jsxs)("div",{className:"flex items-center justify-between",children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("h1",{className:"text-3xl font-bold text-slate-800",children:"Bank Reconciliation"}),(0,x.jsx)("p",{className:"text-slate-600 mt-1",children:"Match bank statements with internal records"})]}),(0,x.jsxs)("div",{className:"flex gap-3",children:[(0,x.jsxs)("label",{htmlFor:"bank-statement-upload",className:"flex items-center gap-2 px-4 py-2 bg-sky-600 text-white rounded-lg hover:bg-sky-700 transition-colors cursor-pointer",children:[(0,x.jsx)(Xa,{}),(0,x.jsx)("span",{children:"Upload Statement"}),(0,x.jsx)("input",{id:"bank-statement-upload",type:"file",accept:".csv,.xlsx,.xls",onChange:async t=>{const a=t.target.files[0];if(a)try{const t=localStorage.getItem("token"),n=new FormData;n.append("statement",a);(await fetch("".concat(e,"/api/accountant/bank-reconciliation/upload"),{method:"POST",headers:{Authorization:"Bearer ".concat(t)},body:n})).ok&&(await g(),alert("Statement uploaded successfully"))}catch(n){console.error("Error uploading statement:",n),alert("Failed to upload statement")}},"aria-label":"Upload bank statement file",className:"hidden"})]}),(0,x.jsxs)("button",{onClick:g,className:"flex items-center gap-2 px-4 py-2 bg-slate-600 text-white rounded-lg hover:bg-slate-700 transition-colors",children:[(0,x.jsx)(Ua,{}),(0,x.jsx)("span",{children:"Refresh"})]})]})]}),(0,x.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,x.jsx)("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-slate-200",children:(0,x.jsxs)("div",{className:"flex items-center justify-between",children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("p",{className:"text-sm text-slate-600",children:"Total Statements"}),(0,x.jsx)("p",{className:"text-2xl font-bold text-slate-800 mt-1",children:t.length})]}),(0,x.jsx)("div",{className:"bg-blue-100 p-3 rounded-lg",children:(0,x.jsx)(Ca,{className:"text-blue-600 text-xl"})})]})}),(0,x.jsx)("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-slate-200",children:(0,x.jsxs)("div",{className:"flex items-center justify-between",children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("p",{className:"text-sm text-slate-600",children:"Matched"}),(0,x.jsx)("p",{className:"text-2xl font-bold text-green-600 mt-1",children:i.length})]}),(0,x.jsx)("div",{className:"bg-green-100 p-3 rounded-lg",children:(0,x.jsx)(Sa,{className:"text-green-600 text-xl"})})]})}),(0,x.jsx)("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-slate-200",children:(0,x.jsxs)("div",{className:"flex items-center justify-between",children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("p",{className:"text-sm text-slate-600",children:"Unmatched"}),(0,x.jsx)("p",{className:"text-2xl font-bold text-red-600 mt-1",children:o.length})]}),(0,x.jsx)("div",{className:"bg-red-100 p-3 rounded-lg",children:(0,x.jsx)(en,{className:"text-red-600 text-xl"})})]})}),(0,x.jsx)("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-slate-200",children:(0,x.jsxs)("div",{className:"flex items-center justify-between",children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("p",{className:"text-sm text-slate-600",children:"Reconciled"}),(0,x.jsx)("p",{className:"text-2xl font-bold text-purple-600 mt-1",children:t.filter(e=>e.reconciled).length})]}),(0,x.jsx)("div",{className:"bg-purple-100 p-3 rounded-lg",children:(0,x.jsx)(Sa,{className:"text-purple-600 text-xl"})})]})})]}),(0,x.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden",children:[(0,x.jsx)("div",{className:"p-6 border-b border-slate-200",children:(0,x.jsx)("h2",{className:"text-xl font-semibold text-slate-800",children:"Bank Statements"})}),(0,x.jsx)("div",{className:"overflow-x-auto",children:(0,x.jsxs)("table",{className:"w-full",children:[(0,x.jsx)("thead",{className:"bg-slate-50 border-b border-slate-200",children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-700 uppercase tracking-wider",children:"Date"}),(0,x.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-700 uppercase tracking-wider",children:"Account"}),(0,x.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-700 uppercase tracking-wider",children:"Transactions"}),(0,x.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-700 uppercase tracking-wider",children:"Status"}),(0,x.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-700 uppercase tracking-wider",children:"Actions"})]})}),(0,x.jsx)("tbody",{className:"bg-white divide-y divide-slate-200",children:0===t.length?(0,x.jsx)("tr",{children:(0,x.jsx)("td",{colSpan:"5",className:"px-6 py-8 text-center text-slate-500",children:"No bank statements found. Upload a statement to get started."})}):t.map(t=>(0,x.jsxs)("tr",{className:"hover:bg-slate-50",children:[(0,x.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-slate-600",children:new Date(t.date).toLocaleDateString()}),(0,x.jsx)("td",{className:"px-6 py-4 text-sm text-slate-800",children:t.accountName||"-"}),(0,x.jsx)("td",{className:"px-6 py-4 text-sm text-slate-600",children:t.transactionCount||0}),(0,x.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,x.jsx)("span",{className:"px-2 py-1 rounded text-xs font-medium ".concat(t.reconciled?"bg-green-100 text-green-700":"bg-orange-100 text-orange-700"),children:t.reconciled?"Reconciled":"Pending"})}),(0,x.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:[(0,x.jsx)("button",{onClick:()=>{p(t),g()},className:"text-sky-600 hover:text-sky-800 mr-3",children:"View"}),!t.reconciled&&(0,x.jsx)("button",{onClick:()=>(async t=>{if(window.confirm("Are you sure you want to reconcile this statement?"))try{const a=localStorage.getItem("token");(await fetch("".concat(e,"/api/accountant/bank-reconciliation/reconcile/").concat(t),{method:"POST",headers:{Authorization:"Bearer ".concat(a)}})).ok&&(await g(),alert("Statement reconciled successfully"))}catch(a){console.error("Error reconciling statement:",a)}})(t._id),className:"text-green-600 hover:text-green-800",children:"Reconcile"})]})]},t._id))})]})})]}),(0,x.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden",children:[(0,x.jsxs)("div",{className:"p-6 border-b border-slate-200 flex items-center justify-between",children:[(0,x.jsx)("h2",{className:"text-xl font-semibold text-slate-800",children:"Unmatched Transactions"}),(0,x.jsxs)("div",{className:"relative w-64",children:[(0,x.jsx)("label",{htmlFor:"reconciliation-search",className:"sr-only",children:"Search transactions"}),(0,x.jsx)(Wa,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400"}),(0,x.jsx)("input",{id:"reconciliation-search",type:"text",placeholder:"Search transactions...",value:f,onChange:e=>m(e.target.value),"aria-label":"Search bank reconciliation transactions",className:"w-full pl-10 pr-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-sky-500"})]})]}),(0,x.jsx)("div",{className:"overflow-x-auto",children:(0,x.jsxs)("table",{className:"w-full",children:[(0,x.jsx)("thead",{className:"bg-slate-50 border-b border-slate-200",children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-700 uppercase tracking-wider",children:"Date"}),(0,x.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-700 uppercase tracking-wider",children:"Description"}),(0,x.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-700 uppercase tracking-wider",children:"Reference"}),(0,x.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-700 uppercase tracking-wider",children:"Amount"}),(0,x.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-700 uppercase tracking-wider",children:"Type"}),(0,x.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-700 uppercase tracking-wider",children:"Actions"})]})}),(0,x.jsx)("tbody",{className:"bg-white divide-y divide-slate-200",children:0===v.length?(0,x.jsx)("tr",{children:(0,x.jsx)("td",{colSpan:"6",className:"px-6 py-8 text-center text-slate-500",children:0===o.length?"All transactions are matched":"No transactions found"})}):v.map(t=>{return(0,x.jsxs)("tr",{className:"hover:bg-slate-50",children:[(0,x.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-slate-600",children:new Date(t.date).toLocaleDateString()}),(0,x.jsx)("td",{className:"px-6 py-4 text-sm text-slate-800",children:t.description||"-"}),(0,x.jsx)("td",{className:"px-6 py-4 text-sm text-slate-600 font-mono",children:t.reference||"-"}),(0,x.jsxs)("td",{className:"px-6 py-4 text-sm font-semibold ".concat("credit"===t.type?"text-green-600":"text-red-600"),children:["credit"===t.type?"+":"-",(a=Math.abs(t.amount),new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",maximumFractionDigits:0}).format(a))]}),(0,x.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,x.jsx)("span",{className:"px-2 py-1 rounded text-xs font-medium ".concat("credit"===t.type?"bg-green-100 text-green-700":"bg-red-100 text-red-700"),children:t.type})}),(0,x.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:(0,x.jsx)("button",{onClick:()=>{const a=prompt("Enter transaction ID to match:");a&&(async(t,a)=>{try{const n=localStorage.getItem("token");(await fetch("".concat(e,"/api/accountant/bank-reconciliation/match"),{method:"POST",headers:{Authorization:"Bearer ".concat(n),"Content-Type":"application/json"},body:JSON.stringify({statementId:t,transactionId:a})})).ok&&await g()}catch(n){console.error("Error matching transaction:",n)}})(t._id,a)},className:"text-sky-600 hover:text-sky-800",children:"Match"})})]},t._id);var a})})]})})]})]})},On=()=>{const e="http://localhost:5000",[t,a]=(0,n.useState)([]),[s,l]=(0,n.useState)(!0),[o,c]=(0,n.useState)("all"),[d,u]=(0,n.useState)(!1),[h,p]=(0,n.useState)({title:"",message:"",target:"all"}),[f,m]=(0,n.useState)(!1);(0,n.useEffect)(()=>{g();const e=setInterval(g,3e5);return()=>clearInterval(e)},[]);const g=async()=>{try{l(!0);const t=localStorage.getItem("token"),n=await fetch("".concat(e,"/api/accountant/alerts"),{headers:{Authorization:"Bearer ".concat(t)}});if(n.ok){const e=await n.json();a(e.data||[])}}catch(t){console.error("Error fetching alerts:",t)}finally{l(!1)}},v=e=>{switch(e){case"payment":return(0,x.jsx)(_a,{});case"deadline":return(0,x.jsx)(Na,{});case"document":return(0,x.jsx)(Ea,{});case"compliance":return(0,x.jsx)(ga,{});default:return(0,x.jsx)(xa,{})}},y=(0,n.useMemo)(()=>"all"===o?t:t.filter(e=>"pending"===o?"pending"===e.status:"overdue"!==o||"overdue"===e.status),[t,o]),b=(0,n.useMemo)(()=>({total:t.length,overdue:t.filter(e=>"overdue"===e.status).length,highPriority:t.filter(e=>"high"===e.priority&&"completed"!==e.status).length,completed:t.filter(e=>"completed"===e.status).length}),[t]);return(0,x.jsxs)("div",{className:"alerts-container",children:[(0,x.jsxs)("div",{className:"page-header",children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("h1",{className:"page-title",children:"Alerts & Reminders"}),(0,x.jsx)("p",{className:"page-subtitle",children:"Manage your pending tasks and notifications."})]}),(0,x.jsxs)("div",{className:"header-actions",style:{display:"flex",gap:"12px"},children:[(0,x.jsxs)("button",{onClick:()=>u(!0),className:"btn-primary",style:{display:"flex",alignItems:"center",gap:"8px",background:"#0ea5e9",color:"white",border:"none",padding:"8px 16px",borderRadius:"8px",cursor:"pointer",fontWeight:"600"},children:[(0,x.jsx)(Ha,{})," Send Message"]}),(0,x.jsxs)("div",{className:"filter-group",children:[(0,x.jsx)("button",{onClick:()=>c("all"),className:"filter-btn ".concat("all"===o?"active":""),children:"All"}),(0,x.jsx)("button",{onClick:()=>c("overdue"),className:"filter-btn ".concat("overdue"===o?"active-overdue":""),children:"Overdue"}),(0,x.jsx)("button",{onClick:()=>c("pending"),className:"filter-btn ".concat("pending"===o?"active-pending":""),children:"Pending"})]})]})]}),s?(0,x.jsx)("div",{className:"loading-container",children:(0,x.jsx)("div",{className:"spinner"})}):(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)("div",{className:"stats-grid",children:[(0,x.jsxs)("div",{className:"stat-card",children:[(0,x.jsxs)("div",{className:"stat-info",children:[(0,x.jsx)("div",{className:"stat-label",children:"Total Active"}),(0,x.jsx)("div",{className:"stat-value",children:b.total})]}),(0,x.jsx)("div",{className:"stat-icon blue",children:(0,x.jsx)(ba,{})})]}),(0,x.jsxs)("div",{className:"stat-card",children:[(0,x.jsxs)("div",{className:"stat-info",children:[(0,x.jsx)("div",{className:"stat-label",children:"Overdue"}),(0,x.jsx)("div",{className:"stat-value",style:{color:"#ef4444"},children:b.overdue})]}),(0,x.jsx)("div",{className:"stat-icon red",children:(0,x.jsx)(xa,{})})]}),(0,x.jsxs)("div",{className:"stat-card",children:[(0,x.jsxs)("div",{className:"stat-info",children:[(0,x.jsx)("div",{className:"stat-label",children:"High Priority"}),(0,x.jsx)("div",{className:"stat-value",style:{color:"#f97316"},children:b.highPriority})]}),(0,x.jsx)("div",{className:"stat-icon orange",children:(0,x.jsx)(Aa,{})})]}),(0,x.jsxs)("div",{className:"stat-card",children:[(0,x.jsxs)("div",{className:"stat-info",children:[(0,x.jsx)("div",{className:"stat-label",children:"Completed"}),(0,x.jsx)("div",{className:"stat-value",style:{color:"#22c55e"},children:b.completed})]}),(0,x.jsx)("div",{className:"stat-icon green",children:(0,x.jsx)(Sa,{})})]})]}),(0,x.jsxs)("div",{className:"alerts-section",children:[(0,x.jsxs)("h3",{className:"section-title",children:["all"===o?(0,x.jsx)(ba,{}):"overdue"===o?(0,x.jsx)(xa,{}):(0,x.jsx)(Aa,{}),o.charAt(0).toUpperCase()+o.slice(1)," Notifications"]}),y.length>0?y.map(t=>{const a=(e=>{if(!e)return null;const t=new Date,a=new Date(e);return Math.ceil((a-t)/864e5)})(t.dueDate);return(0,x.jsxs)("div",{className:"alert-item priority-".concat(t.priority||"medium"," status-").concat(t.status),children:[(0,x.jsx)("div",{className:"alert-icon-wrapper",children:v(t.type)}),(0,x.jsxs)("div",{className:"alert-content",children:[(0,x.jsx)("div",{className:"alert-header",children:(0,x.jsx)("h4",{className:"alert-title",children:t.title})}),(0,x.jsx)("p",{className:"alert-desc",children:t.description}),(0,x.jsxs)("div",{className:"alert-meta",children:[t.dueDate&&(0,x.jsxs)("span",{className:"meta-tag meta-due ".concat(a<0?"urgent":0===a?"today":""),children:[(0,x.jsx)(Na,{}),"Due: ",new Date(t.dueDate).toLocaleDateString(),null!==a&&(0,x.jsxs)("strong",{children:["(",a<0?"Overdue":0===a?"Today":"".concat(a," days left"),")"]})]}),t.priority&&(0,x.jsxs)("span",{className:"meta-tag",style:{background:"#f1f5f9",textTransform:"capitalize"},children:["Priority: ",t.priority]}),t.link&&(0,x.jsxs)(r.N_,{to:t.link,className:"view-link",children:["View Details ",(0,x.jsx)(va,{})]})]})]}),(0,x.jsxs)("div",{className:"alert-actions",children:["completed"!==t.status&&(0,x.jsx)("button",{className:"action-btn btn-complete",onClick:()=>(async t=>{try{const a=localStorage.getItem("token");(await fetch("".concat(e,"/api/accountant/alerts/").concat(t,"/complete"),{method:"POST",headers:{Authorization:"Bearer ".concat(a)}})).ok&&(await g(),Ze.success("Alert marked as completed"))}catch(a){console.error("Error completing alert:",a)}})(t._id),title:"Mark as Completed",children:(0,x.jsx)(Sa,{size:20})}),(0,x.jsx)("button",{className:"action-btn btn-dismiss",onClick:()=>(async t=>{try{const a=localStorage.getItem("token");(await fetch("".concat(e,"/api/accountant/alerts/").concat(t,"/dismiss"),{method:"POST",headers:{Authorization:"Bearer ".concat(a)}})).ok&&(await g(),Ze.info("Alert dismissed"))}catch(a){console.error("Error dismissing alert:",a)}})(t._id),title:"Dismiss Alert",children:(0,x.jsx)(tn,{size:20})})]})]},t._id)}):(0,x.jsxs)("div",{className:"empty-state",children:[(0,x.jsx)("div",{className:"empty-icon",children:(0,x.jsx)(Sa,{})}),(0,x.jsx)("div",{className:"empty-text",children:"All caught up!"}),(0,x.jsxs)("div",{className:"empty-subtext",children:["No ","all"!==o?o:""," alerts found at the moment."]})]})]})]}),d&&(0,x.jsx)("div",{className:"modal-overlay",style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:(0,x.jsxs)("div",{className:"modal-content",style:{background:"white",padding:"24px",borderRadius:"16px",width:"100%",maxWidth:"500px",boxShadow:"0 10px 25px rgba(0,0,0,0.1)"},children:[(0,x.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"20px"},children:[(0,x.jsx)("h3",{style:{margin:0,fontSize:"20px",fontWeight:"bold",color:"#0f172a"},children:"Send Notification"}),(0,x.jsx)("button",{onClick:()=>u(!1),style:{background:"none",border:"none",cursor:"pointer"},children:(0,x.jsx)(tn,{size:24})})]}),(0,x.jsxs)("form",{onSubmit:async t=>{if(t.preventDefault(),h.title&&h.message){m(!0);try{const t=localStorage.getItem("token");let a="".concat(e,"/api/bulk-notifications/role"),n={title:h.title,message:h.message,type:"info"};"all"===h.target?a="".concat(e,"/api/bulk-notifications/all"):n.role=h.target;const s=await fetch(a,{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify(n)}),r=await s.json();s.ok?(Ze.success("Notification sent to ".concat(r.count||"users"," recipients")),u(!1),p({title:"",message:"",target:"all"})):Ze.error(r.message||"Failed to send notification")}catch(a){console.error("Send error:",a),Ze.error("Failed to send notification")}finally{m(!1)}}else Ze.error("Please fill in all fields")},children:[(0,x.jsxs)("div",{style:{marginBottom:"16px"},children:[(0,x.jsx)("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"500",color:"#475569"},children:"Recipient Group"}),(0,x.jsxs)("select",{value:h.target,onChange:e=>p((0,i.A)((0,i.A)({},h),{},{target:e.target.value})),style:{width:"100%",padding:"10px",borderRadius:"8px",border:"1px solid #e2e8f0",fontSize:"14px"},children:[(0,x.jsx)("option",{value:"all",children:"All Staff & Managers"}),(0,x.jsx)("option",{value:"manager",children:"Managers Only"}),(0,x.jsx)("option",{value:"staff",children:"Staff Only"}),(0,x.jsx)("option",{value:"lab",children:"Lab Staff Only"}),(0,x.jsx)("option",{value:"delivery_staff",children:"Delivery Staff Only"})]})]}),(0,x.jsxs)("div",{style:{marginBottom:"16px"},children:[(0,x.jsx)("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"500",color:"#475569"},children:"Subject / Title"}),(0,x.jsx)("input",{type:"text",value:h.title,onChange:e=>p((0,i.A)((0,i.A)({},h),{},{title:e.target.value})),placeholder:"e.g., Important Meeting",style:{width:"100%",padding:"10px",borderRadius:"8px",border:"1px solid #e2e8f0",fontSize:"14px"},required:!0})]}),(0,x.jsxs)("div",{style:{marginBottom:"24px"},children:[(0,x.jsx)("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"500",color:"#475569"},children:"Message"}),(0,x.jsx)("textarea",{rows:"4",value:h.message,onChange:e=>p((0,i.A)((0,i.A)({},h),{},{message:e.target.value})),placeholder:"Type your message here...",style:{width:"100%",padding:"10px",borderRadius:"8px",border:"1px solid #e2e8f0",fontSize:"14px",resize:"vertical"},required:!0})]}),(0,x.jsxs)("div",{style:{display:"flex",gap:"12px",justifyContent:"flex-end"},children:[(0,x.jsx)("button",{type:"button",onClick:()=>u(!1),style:{padding:"10px 20px",borderRadius:"8px",border:"1px solid #e2e8f0",background:"white",cursor:"pointer",color:"#64748b",fontWeight:"500"},children:"Cancel"}),(0,x.jsx)("button",{type:"submit",disabled:f,style:{padding:"10px 24px",borderRadius:"8px",border:"none",background:f?"#94a3b8":"#0ea5e9",color:"white",cursor:f?"not-allowed":"pointer",fontWeight:"600",display:"flex",alignItems:"center",gap:"8px"},children:f?"Sending...":(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(Ha,{})," Send"]})})]})]})]})})]})},qn=()=>{const e="http://localhost:5000",[t,a]=(0,n.useState)([]),[s,r]=(0,n.useState)(!0),[l,o]=(0,n.useState)(!1),[c,d]=(0,n.useState)(""),[u,h]=(0,n.useState)("all"),[p,f]=(0,n.useState)(!1),[m,g]=(0,n.useState)({file:null,category:"invoice",description:"",reference:"",date:(new Date).toISOString().split("T")[0]}),v=[{value:"invoice",label:"Invoice",colorClass:"tag-blue",iconClass:"icon-blue"},{value:"bill",label:"Bill",colorClass:"tag-green",iconClass:"icon-green"},{value:"receipt",label:"Receipt",colorClass:"tag-purple",iconClass:"icon-purple"},{value:"contract",label:"Contract",colorClass:"tag-orange",iconClass:"icon-orange"},{value:"tax",label:"Tax Document",colorClass:"tag-red",iconClass:"icon-red"},{value:"bank",label:"Bank Statement",colorClass:"tag-teal",iconClass:"icon-blue"},{value:"other",label:"Other",colorClass:"tag-gray",iconClass:"icon-gray"}];(0,n.useEffect)(()=>{y()},[]);const y=async()=>{try{r(!0);const t=localStorage.getItem("token"),n=await fetch("".concat(e,"/api/accountant/documents"),{headers:{Authorization:"Bearer ".concat(t)}});if(n.ok){const e=await n.json();a(e.data||[])}}catch(t){console.error("Error fetching documents:",t)}finally{r(!1)}},b=e=>{var t;const a=null===e||void 0===e||null===(t=e.split(".").pop())||void 0===t?void 0:t.toLowerCase();return["jpg","jpeg","png","gif"].includes(a)?(0,x.jsx)(Ia,{style:{color:"#2563eb"}}):(0,x.jsx)(Ea,{style:{color:"#64748b"}})},j=(0,n.useMemo)(()=>{let e=t;if(c){const t=c.toLowerCase();e=e.filter(e=>{var a,n,s;return(null===(a=e.description)||void 0===a?void 0:a.toLowerCase().includes(t))||(null===(n=e.reference)||void 0===n?void 0:n.toLowerCase().includes(t))||(null===(s=e.fileName)||void 0===s?void 0:s.toLowerCase().includes(t))})}return"all"!==u&&(e=e.filter(e=>e.category===u)),e.sort((e,t)=>new Date(t.uploadedAt||t.createdAt)-new Date(e.uploadedAt||e.createdAt))},[t,c,u]);return s?(0,x.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,x.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-sky-600"})}):(0,x.jsxs)("div",{className:"documents-container",children:[(0,x.jsxs)("div",{className:"documents-header",children:[(0,x.jsxs)("div",{className:"header-content",children:[(0,x.jsx)("h1",{children:"Document Upload & Archiving"}),(0,x.jsx)("p",{children:"Attach bills, invoices, delivery notes, and more"})]}),(0,x.jsxs)("button",{onClick:()=>f(!0),className:"btn-primary",children:[(0,x.jsx)($a,{}),(0,x.jsx)("span",{children:"Upload Document"})]})]}),(0,x.jsxs)("div",{className:"summary-grid",children:[(0,x.jsxs)("div",{className:"summary-card",children:[(0,x.jsxs)("div",{className:"summary-content",children:[(0,x.jsx)("p",{children:"Total Documents"}),(0,x.jsx)("p",{children:t.length})]}),(0,x.jsx)("div",{className:"summary-icon icon-blue",children:(0,x.jsx)(Da,{})})]}),v.slice(0,3).map(e=>{const a=t.filter(t=>t.category===e.value).length;return(0,x.jsxs)("div",{className:"summary-card",children:[(0,x.jsxs)("div",{className:"summary-content",children:[(0,x.jsx)("p",{children:e.label}),(0,x.jsx)("p",{children:a})]}),(0,x.jsx)("div",{className:"summary-icon ".concat(e.iconClass),children:(0,x.jsx)(Ra,{})})]},e.value)})]}),(0,x.jsxs)("div",{className:"filter-section",children:[(0,x.jsxs)("div",{className:"search-wrapper",children:[(0,x.jsx)("label",{htmlFor:"document-search",className:"sr-only",children:"Search documents"}),(0,x.jsx)(Wa,{className:"search-icon"}),(0,x.jsx)("input",{id:"document-search",type:"text",className:"search-input",placeholder:"Search documents...",value:c,onChange:e=>d(e.target.value)})]}),(0,x.jsxs)("select",{value:u,onChange:e=>h(e.target.value),className:"filter-select",children:[(0,x.jsx)("option",{value:"all",children:"All Categories"}),v.map(e=>(0,x.jsx)("option",{value:e.value,children:e.label},e.value))]})]}),(0,x.jsx)("div",{className:"documents-grid",children:0===j.length?(0,x.jsxs)("div",{className:"empty-state",children:[(0,x.jsx)(Da,{className:"empty-icon"}),(0,x.jsx)("h3",{style:{fontSize:"18px",fontWeight:600,color:"#1e293b",marginBottom:"8px"},children:"No documents found"}),(0,x.jsx)("p",{style:{color:"#64748b",marginBottom:"16px"},children:"Upload your first document to get started"}),(0,x.jsx)("button",{onClick:()=>f(!0),className:"btn-primary",style:{margin:"0 auto"},children:"Upload Document"})]}):j.map(t=>{const a=v.find(e=>e.value===t.category);return(0,x.jsxs)("div",{className:"document-card",children:[(0,x.jsxs)("div",{className:"doc-header",children:[(0,x.jsxs)("div",{className:"doc-info",children:[(0,x.jsx)("div",{className:"file-icon",children:b(t.fileName)}),(0,x.jsxs)("div",{className:"doc-title",children:[(0,x.jsx)("h3",{children:t.description||t.fileName}),(0,x.jsx)("p",{className:"doc-date",children:new Date(t.uploadedAt||t.createdAt).toLocaleDateString()})]})]}),(0,x.jsx)("button",{onClick:()=>(async t=>{if(window.confirm("Are you sure you want to delete this document?"))try{const a=localStorage.getItem("token");(await fetch("".concat(e,"/api/accountant/documents/").concat(t),{method:"DELETE",headers:{Authorization:"Bearer ".concat(a)}})).ok&&await y()}catch(a){console.error("Error deleting document:",a)}})(t._id),className:"btn-delete",title:"Delete document",children:(0,x.jsx)(Ya,{})})]}),(0,x.jsxs)("div",{className:"doc-body",children:[(0,x.jsx)("div",{className:"doc-tags",children:(0,x.jsx)("span",{className:"category-tag ".concat((null===a||void 0===a?void 0:a.colorClass)||"tag-gray"),children:(null===a||void 0===a?void 0:a.label)||t.category})}),(0,x.jsxs)("div",{className:"doc-meta",children:[t.reference&&(0,x.jsxs)("p",{className:"ref-text",children:["Ref: ",t.reference]}),(0,x.jsxs)("p",{children:["Size: ",(n=t.fileSize,n?n<1024?n+" B":n<1048576?(n/1024).toFixed(1)+" KB":(n/1048576).toFixed(1)+" MB":"-")]})]}),(0,x.jsxs)("button",{onClick:()=>(async t=>{try{const a=localStorage.getItem("token"),n=await fetch("".concat(e,"/api/accountant/documents/").concat(t._id,"/download"),{headers:{Authorization:"Bearer ".concat(a)}});if(n.ok){const e=await n.blob(),a=window.URL.createObjectURL(e),s=t.createElement("a");s.href=a,s.download=t.fileName||"document",s.click()}}catch(a){console.error("Error downloading document:",a)}})(t),className:"btn-download",children:[(0,x.jsx)(La,{}),(0,x.jsx)("span",{children:"Download"})]})]})]},t._id);var n})}),p&&(0,x.jsx)("div",{className:"modal-overlay",children:(0,x.jsxs)("div",{className:"modal-content",children:[(0,x.jsx)("h2",{className:"modal-title",children:"Upload Document"}),(0,x.jsxs)("form",{onSubmit:async t=>{if(t.preventDefault(),m.file)try{o(!0);const t=localStorage.getItem("token"),a=new FormData;a.append("file",m.file),a.append("category",m.category),a.append("description",m.description),a.append("reference",m.reference),a.append("date",m.date);(await fetch("".concat(e,"/api/accountant/documents/upload"),{method:"POST",headers:{Authorization:"Bearer ".concat(t)},body:a})).ok?(await y(),f(!1),g({file:null,category:"invoice",description:"",reference:"",date:(new Date).toISOString().split("T")[0]}),alert("Document uploaded successfully")):alert("Failed to upload document")}catch(a){console.error("Error uploading document:",a),alert("Failed to upload document")}finally{o(!1)}else alert("Please select a file")},children:[(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{className:"form-label",children:"File *"}),(0,x.jsx)("input",{type:"file",required:!0,onChange:e=>{const t=e.target.files[0];t&&g((0,i.A)((0,i.A)({},m),{},{file:t}))},className:"form-input"}),m.file&&(0,x.jsx)("p",{className:"file-name-display",children:m.file.name})]}),(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{className:"form-label",children:"Category *"}),(0,x.jsx)("select",{required:!0,value:m.category,onChange:e=>g((0,i.A)((0,i.A)({},m),{},{category:e.target.value})),className:"form-select",children:v.map(e=>(0,x.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{className:"form-label",children:"Description"}),(0,x.jsx)("input",{type:"text",value:m.description,onChange:e=>g((0,i.A)((0,i.A)({},m),{},{description:e.target.value})),className:"form-input"})]}),(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{className:"form-label",children:"Reference"}),(0,x.jsx)("input",{type:"text",value:m.reference,onChange:e=>g((0,i.A)((0,i.A)({},m),{},{reference:e.target.value})),className:"form-input"})]}),(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{className:"form-label",children:"Date"}),(0,x.jsx)("input",{type:"date",value:m.date,onChange:e=>g((0,i.A)((0,i.A)({},m),{},{date:e.target.value})),className:"form-input"})]}),(0,x.jsxs)("div",{className:"modal-actions",children:[(0,x.jsx)("button",{type:"submit",disabled:l,className:"btn-primary",style:{opacity:l?.7:1},children:l?"Uploading...":"Upload"}),(0,x.jsx)("button",{type:"button",onClick:()=>f(!1),className:"btn-secondary",children:"Cancel"})]})]})]})})]})},zn=()=>{const[e,t]=(0,n.useState)(null),[a,s]=(0,n.useState)({month:(new Date).getMonth()+1,year:(new Date).getFullYear()}),r=[{id:"financial-summary",title:"Financial Summary Report",description:"Complete overview of revenue, expenses, and profit",icon:ya,backgroundClass:"icon-blue",formats:["PDF","Excel"]},{id:"expense-report",title:"Monthly Expense Report",description:"Detailed breakdown of all expenses by category",icon:_a,backgroundClass:"icon-red",formats:["PDF","Excel","CSV"]},{id:"vendor-ledger",title:"Vendor Ledger Summary",description:"Complete vendor accounts with purchases and payments",icon:Ea,backgroundClass:"icon-green",formats:["PDF","Excel","CSV"]},{id:"salary-disbursement",title:"Salary Disbursement Sheet",description:"Monthly salary payments and deductions",icon:_a,backgroundClass:"icon-purple",formats:["PDF","Excel"]},{id:"gst-report",title:"GST Filing Report",description:"GST calculations and compliance data",icon:Ea,backgroundClass:"icon-orange",formats:["PDF","Excel"]},{id:"profitability",title:"Profitability Analysis",description:"Product and batch margin analysis",icon:qa,backgroundClass:"icon-teal",formats:["PDF","Excel"]},{id:"audit-trail",title:"Audit Trail Report",description:"Complete transaction history and changes",icon:Ea,backgroundClass:"icon-indigo",formats:["PDF","CSV"]},{id:"bank-reconciliation",title:"Bank Reconciliation Report",description:"Matched and unmatched transactions",icon:ya,backgroundClass:"icon-pink",formats:["PDF","Excel"]}];return(0,x.jsxs)("div",{className:"reports-container",children:[(0,x.jsxs)("div",{className:"reports-header",children:[(0,x.jsxs)("div",{className:"header-content",children:[(0,x.jsx)("h1",{children:"Export Reports"}),(0,x.jsx)("p",{children:"Generate downloadable PDFs and Excel files"})]}),(0,x.jsxs)("div",{className:"header-actions",children:[(0,x.jsx)("select",{className:"month-select",value:a.month,onChange:e=>s((0,i.A)((0,i.A)({},a),{},{month:parseInt(e.target.value)})),"aria-label":"Select month for report",children:Array.from({length:12},(e,t)=>t+1).map(e=>(0,x.jsx)("option",{value:e,children:new Date(2e3,e-1).toLocaleString("default",{month:"long"})},e))}),(0,x.jsx)("input",{type:"number",className:"year-input",value:a.year,onChange:e=>s((0,i.A)((0,i.A)({},a),{},{year:parseInt(e.target.value)})),"aria-label":"Select year for report"})]})]}),(0,x.jsx)("div",{className:"reports-grid",children:r.map(n=>{const s=n.icon;return(0,x.jsxs)("div",{className:"report-card",children:[(0,x.jsx)("div",{className:"report-icon-wrapper ".concat(n.backgroundClass),children:(0,x.jsx)(s,{})}),(0,x.jsx)("h3",{className:"report-title",children:n.title}),(0,x.jsx)("p",{className:"report-description",children:n.description}),(0,x.jsx)("div",{className:"report-actions",children:n.formats.map(s=>(0,x.jsx)("button",{onClick:()=>(async(e,n)=>{try{t("".concat(e,"-").concat(n));const s=localStorage.getItem("token"),r=await fetch("".concat("http://localhost:5000","/api/accountant/reports/").concat(e,"?format=").concat(n.toLowerCase(),"&month=").concat(a.month,"&year=").concat(a.year),{headers:{Authorization:"Bearer ".concat(s)}});if(r.ok){const t=await r.blob(),s=window.URL.createObjectURL(t),i=document.createElement("a");i.href=s,i.download="".concat(e,"_").concat(a.month,"_").concat(a.year,".").concat("excel"===n.toLowerCase()?"xlsx":n.toLowerCase()),i.click(),window.URL.revokeObjectURL(s)}else alert("Failed to generate report")}catch(s){console.error("Error generating report:",s),alert("Failed to generate report")}finally{t(null)}})(n.id,s),disabled:e==="".concat(n.id,"-").concat(s),className:"btn-generate",children:e==="".concat(n.id,"-").concat(s)?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-sky-600"}),(0,x.jsx)("span",{children:"Generating..."})]}):(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(La,{}),(0,x.jsx)("span",{children:s})]})},s))})]},n.id)})}),(0,x.jsxs)("div",{className:"quick-actions-section",children:[(0,x.jsx)("h2",{className:"section-title",children:"Quick Actions"}),(0,x.jsxs)("div",{className:"actions-grid",children:[(0,x.jsxs)("button",{onClick:()=>{s({month:(new Date).getMonth()+1,year:(new Date).getFullYear()})},className:"quick-action-card",children:[(0,x.jsxs)("div",{className:"action-header",children:[(0,x.jsx)(Na,{className:"action-icon"}),(0,x.jsx)("span",{className:"action-title",children:"Current Month"})]}),(0,x.jsx)("p",{className:"action-desc",children:"Set period to current month"})]}),(0,x.jsxs)("button",{onClick:()=>{const e=new Date;e.setMonth(e.getMonth()-1),s({month:e.getMonth()+1,year:e.getFullYear()})},className:"quick-action-card",children:[(0,x.jsxs)("div",{className:"action-header",children:[(0,x.jsx)(Na,{className:"action-icon"}),(0,x.jsx)("span",{className:"action-title",children:"Last Month"})]}),(0,x.jsx)("p",{className:"action-desc",children:"Set period to previous month"})]}),(0,x.jsxs)("button",{onClick:()=>{const e=(new Date).getFullYear();s({month:1,year:e})},className:"quick-action-card",children:[(0,x.jsxs)("div",{className:"action-header",children:[(0,x.jsx)(Na,{className:"action-icon"}),(0,x.jsx)("span",{className:"action-title",children:"Current Year"})]}),(0,x.jsx)("p",{className:"action-desc",children:"Set period to current year"})]})]})]})]})};function Mn(){const[e,t]=(0,n.useState)([]),[a,s]=(0,n.useState)(!0),[r,i]=(0,n.useState)((new Date).getFullYear()),[l,o]=(0,n.useState)((new Date).getMonth()+1),[c,d]=(0,n.useState)(null),[u,h]=(0,n.useState)(null),[p,f]=(0,n.useState)(!1),g=async()=>{s(!0);try{const e=await async function(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(null===(e=(await m.A.get("".concat(nn,"/api/daily-wage/workers"),{params:t,headers:sn()})).data)||void 0===e?void 0:e.data)||[]}({limit:100});t(e)}catch(e){t([])}finally{s(!1)}};(0,n.useEffect)(()=>{g()},[]);const v=async e=>{d(e),h(null);if(window.confirm("Auto-calculate wages for ".concat(e.name,"?"))){f(!0);try{const t=await async function(e,t){var a;let{year:n,month:s}=t;return null===(a=(await m.A.get("".concat(nn,"/api/daily-wage/calculate/").concat(e),{params:{year:n,month:s},headers:sn()})).data)||void 0===a?void 0:a.data}(e._id||e.id,{year:r,month:l}),a=await async function(e,t){var a;let{year:n,month:s}=t;return null===(a=(await m.A.get("".concat(nn,"/api/daily-wage/summary/").concat(e),{params:{year:n,month:s},headers:sn()})).data)||void 0===a?void 0:a.data}(e._id||e.id,{year:r,month:l});h({calc:t,summary:a})}catch(t){console.error("Calculation failed",t)}finally{f(!1)}}},y=e=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",maximumFractionDigits:0}).format(e||0),b=function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return t.split(".").reduce((e,t)=>e&&e[t],e)||a};return(0,x.jsxs)("div",{className:"wages-container",children:[(0,x.jsx)("div",{className:"page-header",children:(0,x.jsx)("h2",{className:"page-title",children:"Auto-calculate Wages"})}),(0,x.jsx)("div",{className:"controls-card",children:(0,x.jsxs)("div",{className:"controls-row",children:[(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{className:"form-label",children:"Year"}),(0,x.jsx)("input",{type:"number",className:"form-input",value:r,onChange:e=>i(Number(e.target.value))})]}),(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{className:"form-label",children:"Month"}),(0,x.jsx)("input",{type:"number",min:1,max:12,className:"form-input",value:l,onChange:e=>o(Number(e.target.value))})]})]})}),a?(0,x.jsx)("div",{className:"loading-spinner"}):(0,x.jsx)("div",{className:"table-container",children:(0,x.jsxs)("table",{className:"wages-table",children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{children:"Worker Name"}),(0,x.jsx)("th",{children:"Daily Wage (\u20b9)"}),(0,x.jsx)("th",{children:"Action"})]})}),(0,x.jsx)("tbody",{children:e.length>0?e.map(e=>{var t;return(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{style:{fontWeight:500},children:e.name}),(0,x.jsx)("td",{children:null!==(t=e.dailyWage)&&void 0!==t?t:"-"}),(0,x.jsx)("td",{children:(0,x.jsx)("button",{className:"btn-calc",onClick:()=>v(e),children:"Calculate"})})]},e._id||e.id)}):(0,x.jsx)("tr",{children:(0,x.jsx)("td",{colSpan:"3",style:{textAlign:"center",padding:"32px",color:"#94a3b8"},children:"No workers found."})})})]})}),p&&(0,x.jsx)("div",{className:"loading-spinner"}),c&&u&&!p&&(0,x.jsx)("div",{className:"result-section",children:(0,x.jsxs)("div",{className:"salary-slip-card",children:[(0,x.jsxs)("div",{className:"slip-header",children:[(0,x.jsxs)("div",{className:"slip-title",children:[(0,x.jsx)("h3",{children:c.name}),(0,x.jsx)("p",{className:"slip-subtitle",children:"Salary Calculation Result"})]}),(0,x.jsxs)("div",{className:"slip-period",children:[(0,x.jsx)("span",{className:"period-label",children:"Period"}),(0,x.jsxs)("span",{className:"period-value",children:[l,"/",r]})]})]}),(0,x.jsxs)("div",{className:"slip-body",children:[(0,x.jsxs)("div",{className:"slip-column",children:[(0,x.jsx)("h4",{className:"slip-column-header",children:"Earnings"}),(0,x.jsxs)("div",{className:"slip-row",children:[(0,x.jsx)("span",{className:"row-label",children:"Working Days"}),(0,x.jsx)("span",{className:"row-value",children:b(u,"calc.month.workingDays")})]}),(0,x.jsxs)("div",{className:"slip-row",children:[(0,x.jsx)("span",{className:"row-label",children:"Gross Salary"}),(0,x.jsx)("span",{className:"row-value value-highlight",children:y(b(u,"calc.month.grossSalary"))})]}),(0,x.jsxs)("div",{className:"slip-row",children:[(0,x.jsx)("span",{className:"row-label",children:"Bonus"}),(0,x.jsx)("span",{className:"row-value",children:y(b(u,"calc.month.bonusAmount"))})]}),(0,x.jsxs)("div",{className:"slip-row",children:[(0,x.jsx)("span",{className:"row-label",children:"Transportation"}),(0,x.jsx)("span",{className:"row-value",children:y(b(u,"summary.benefits.transportAllowance"))})]}),(0,x.jsxs)("div",{className:"slip-row",children:[(0,x.jsx)("span",{className:"row-label",children:"Food Allowance"}),(0,x.jsx)("span",{className:"row-value",children:y(b(u,"summary.benefits.foodAllowance"))})]})]}),(0,x.jsxs)("div",{className:"slip-column",children:[(0,x.jsx)("h4",{className:"slip-column-header",children:"Deductions"}),(0,x.jsxs)("div",{className:"slip-row",children:[(0,x.jsx)("span",{className:"row-label",children:"Advance Taken"}),(0,x.jsx)("span",{className:"row-value",style:{color:"#ef4444"},children:y(b(u,"calc.month.advanceAmount"))})]}),(0,x.jsxs)("div",{className:"slip-row",children:[(0,x.jsx)("span",{className:"row-label",children:"Other Deductions"}),(0,x.jsx)("span",{className:"row-value",style:{color:"#ef4444"},children:y(b(u,"calc.month.deductionAmount"))})]}),(0,x.jsxs)("div",{className:"slip-row",children:[(0,x.jsx)("span",{className:"row-label",children:"Provident Fund"}),(0,x.jsx)("span",{className:"row-value",style:{color:"#ef4444"},children:y(b(u,"summary.benefits.providentFund"))})]})]})]}),(0,x.jsx)("div",{className:"slip-footer",children:(0,x.jsxs)("div",{className:"net-pay-box",children:[(0,x.jsx)("span",{className:"net-label",children:"Net Payable Amount"}),(0,x.jsx)("span",{className:"net-amount",children:y(b(u,"calc.month.pendingAmount")||b(u,"calc.month.grossSalary"))})]})})]})})]})}const Un=()=>{const e="http://localhost:5000",[t,a]=(0,n.useState)([]),[s,r]=(0,n.useState)(!0),[l,o]=(0,n.useState)(!1),[c,d]=(0,n.useState)(null),[u,h]=(0,n.useState)({name:"",code:"",type:"factory",address:{street:"",city:"",state:"",pincode:"",country:"India"},contact:{phone:"",email:"",manager:""},financialSettings:{gstNumber:"",panNumber:"",bankAccount:{accountNumber:"",ifscCode:"",bankName:""}},status:"active"});(0,n.useEffect)(()=>{p()},[]);const p=async()=>{try{r(!0);const t=localStorage.getItem("token"),n=await fetch("".concat(e,"/api/accountant/branches"),{headers:{Authorization:"Bearer ".concat(t)}});if(n.ok){const e=await n.json();a(e.data||[])}}catch(t){console.error("Error fetching branches:",t)}finally{r(!1)}},f=()=>{h({name:"",code:"",type:"factory",address:{street:"",city:"",state:"",pincode:"",country:"India"},contact:{phone:"",email:"",manager:""},financialSettings:{gstNumber:"",panNumber:"",bankAccount:{accountNumber:"",ifscCode:"",bankName:""}},status:"active"}),d(null),o(!1)};return s?(0,x.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,x.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-sky-600"})}):(0,x.jsxs)("div",{className:"space-y-6",children:[(0,x.jsxs)("div",{className:"flex items-center justify-between",children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("h1",{className:"text-3xl font-bold text-slate-800",children:"Multi-Branch Accounting"}),(0,x.jsx)("p",{className:"text-slate-600 mt-1",children:"Manage factory units and branch ledgers"})]}),(0,x.jsxs)("button",{onClick:()=>o(!0),className:"flex items-center gap-2 px-4 py-2 bg-sky-600 text-white rounded-lg hover:bg-sky-700 transition-colors",children:[(0,x.jsx)(za,{}),(0,x.jsx)("span",{children:"Add Branch"})]})]}),l&&(0,x.jsxs)("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-slate-200",children:[(0,x.jsx)("h2",{className:"text-xl font-semibold mb-4",children:c?"Edit Branch":"Add New Branch"}),(0,x.jsxs)("form",{onSubmit:async t=>{t.preventDefault();try{const t=localStorage.getItem("token"),a=c?"".concat(e,"/api/accountant/branches/").concat(c._id):"".concat(e,"/api/accountant/branches"),n=c?"PUT":"POST";(await fetch(a,{method:n,headers:{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"},body:JSON.stringify(u)})).ok&&(await p(),f())}catch(a){console.error("Error saving branch:",a)}},className:"space-y-4",children:[(0,x.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Branch Name *"}),(0,x.jsx)("input",{type:"text",required:!0,value:u.name,onChange:e=>h((0,i.A)((0,i.A)({},u),{},{name:e.target.value})),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-sky-500"})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Branch Code *"}),(0,x.jsx)("input",{type:"text",required:!0,value:u.code,onChange:e=>h((0,i.A)((0,i.A)({},u),{},{code:e.target.value.toUpperCase()})),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-sky-500"})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Type *"}),(0,x.jsxs)("select",{required:!0,value:u.type,onChange:e=>h((0,i.A)((0,i.A)({},u),{},{type:e.target.value})),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-sky-500",children:[(0,x.jsx)("option",{value:"factory",children:"Factory"}),(0,x.jsx)("option",{value:"warehouse",children:"Warehouse"}),(0,x.jsx)("option",{value:"office",children:"Office"}),(0,x.jsx)("option",{value:"processing_unit",children:"Processing Unit"})]})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Status *"}),(0,x.jsxs)("select",{required:!0,value:u.status,onChange:e=>h((0,i.A)((0,i.A)({},u),{},{status:e.target.value})),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-sky-500",children:[(0,x.jsx)("option",{value:"active",children:"Active"}),(0,x.jsx)("option",{value:"inactive",children:"Inactive"}),(0,x.jsx)("option",{value:"maintenance",children:"Maintenance"})]})]})]}),(0,x.jsxs)("div",{className:"border-t pt-4",children:[(0,x.jsx)("h3",{className:"font-semibold mb-3",children:"Address"}),(0,x.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Street"}),(0,x.jsx)("input",{type:"text",value:u.address.street,onChange:e=>h((0,i.A)((0,i.A)({},u),{},{address:(0,i.A)((0,i.A)({},u.address),{},{street:e.target.value})})),className:"w-full px-3 py-2 border border-slate-300 rounded-lg"})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"City"}),(0,x.jsx)("input",{type:"text",value:u.address.city,onChange:e=>h((0,i.A)((0,i.A)({},u),{},{address:(0,i.A)((0,i.A)({},u.address),{},{city:e.target.value})})),className:"w-full px-3 py-2 border border-slate-300 rounded-lg"})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"State"}),(0,x.jsx)("input",{type:"text",value:u.address.state,onChange:e=>h((0,i.A)((0,i.A)({},u),{},{address:(0,i.A)((0,i.A)({},u.address),{},{state:e.target.value})})),className:"w-full px-3 py-2 border border-slate-300 rounded-lg"})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Pincode"}),(0,x.jsx)("input",{type:"text",value:u.address.pincode,onChange:e=>h((0,i.A)((0,i.A)({},u),{},{address:(0,i.A)((0,i.A)({},u.address),{},{pincode:e.target.value})})),className:"w-full px-3 py-2 border border-slate-300 rounded-lg"})]})]})]}),(0,x.jsxs)("div",{className:"border-t pt-4",children:[(0,x.jsx)("h3",{className:"font-semibold mb-3",children:"Financial Settings"}),(0,x.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"GST Number"}),(0,x.jsx)("input",{type:"text",value:u.financialSettings.gstNumber,onChange:e=>h((0,i.A)((0,i.A)({},u),{},{financialSettings:(0,i.A)((0,i.A)({},u.financialSettings),{},{gstNumber:e.target.value})})),className:"w-full px-3 py-2 border border-slate-300 rounded-lg"})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"PAN Number"}),(0,x.jsx)("input",{type:"text",value:u.financialSettings.panNumber,onChange:e=>h((0,i.A)((0,i.A)({},u),{},{financialSettings:(0,i.A)((0,i.A)({},u.financialSettings),{},{panNumber:e.target.value})})),className:"w-full px-3 py-2 border border-slate-300 rounded-lg"})]})]})]}),(0,x.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,x.jsxs)("button",{type:"submit",className:"px-6 py-2 bg-sky-600 text-white rounded-lg hover:bg-sky-700",children:[c?"Update":"Create"," Branch"]}),(0,x.jsx)("button",{type:"button",onClick:f,className:"px-6 py-2 bg-slate-200 text-slate-700 rounded-lg hover:bg-slate-300",children:"Cancel"})]})]})]}),(0,x.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:t.map(t=>{var a,n;return(0,x.jsxs)("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-slate-200 hover:shadow-md transition-all",children:[(0,x.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,x.jsxs)("div",{className:"flex items-center gap-3",children:[(0,x.jsx)("div",{className:"bg-sky-100 p-3 rounded-lg",children:(0,x.jsx)(wa,{className:"text-sky-600 text-xl"})}),(0,x.jsxs)("div",{children:[(0,x.jsx)("h3",{className:"font-semibold text-slate-800",children:t.name}),(0,x.jsx)("p",{className:"text-sm text-slate-500",children:t.code})]})]}),(0,x.jsxs)("div",{className:"flex gap-2",children:[(0,x.jsx)("button",{onClick:()=>(e=>{d(e),h({name:e.name,code:e.code,type:e.type,address:e.address||{street:"",city:"",state:"",pincode:"",country:"India"},contact:e.contact||{phone:"",email:"",manager:""},financialSettings:e.financialSettings||{gstNumber:"",panNumber:"",bankAccount:{accountNumber:"",ifscCode:"",bankName:""}},status:e.status}),o(!0)})(t),className:"p-2 text-sky-600 hover:bg-sky-50 rounded-lg",children:(0,x.jsx)(Ta,{})}),(0,x.jsx)("button",{onClick:()=>(async t=>{if(window.confirm("Are you sure you want to delete this branch?"))try{const a=localStorage.getItem("token");(await fetch("".concat(e,"/api/accountant/branches/").concat(t),{method:"DELETE",headers:{Authorization:"Bearer ".concat(a)}})).ok&&await p()}catch(a){console.error("Error deleting branch:",a)}})(t._id),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg",children:(0,x.jsx)(Ya,{})})]})]}),(0,x.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,x.jsxs)("div",{className:"flex items-center gap-2 text-slate-600",children:[(0,x.jsx)(Fa,{}),(0,x.jsxs)("span",{children:[(null===(a=t.address)||void 0===a?void 0:a.city)||"N/A",", ",(null===(n=t.address)||void 0===n?void 0:n.state)||"N/A"]})]}),(0,x.jsxs)("div",{className:"flex items-center gap-2",children:[(0,x.jsx)("span",{className:"px-2 py-1 rounded text-xs font-medium ".concat("active"===t.status?"bg-green-100 text-green-700":"inactive"===t.status?"bg-red-100 text-red-700":"bg-yellow-100 text-yellow-700"),children:t.status}),(0,x.jsx)("span",{className:"px-2 py-1 rounded text-xs font-medium bg-blue-100 text-blue-700",children:t.type})]})]})]},t._id)})}),0===t.length&&!s&&(0,x.jsxs)("div",{className:"text-center py-12 bg-white rounded-xl border border-slate-200",children:[(0,x.jsx)(wa,{className:"text-4xl text-slate-400 mx-auto mb-4"}),(0,x.jsx)("p",{className:"text-slate-600",children:"No branches found. Create your first branch to get started."})]})]})},Wn=()=>(0,x.jsxs)("div",{className:"homepage animate__animated animate__fadeIn",children:[(0,x.jsx)("nav",{className:"top-nav",children:(0,x.jsxs)("div",{className:"container",style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,x.jsxs)("div",{className:"nav-logo",style:{fontWeight:"700",fontSize:"1.5rem",color:"#001e2b"},children:["Antigravity",(0,x.jsx)("span",{style:{color:"#607d8b"},children:"."})]}),(0,x.jsxs)("ul",{children:[(0,x.jsx)("li",{children:(0,x.jsx)(r.N_,{to:"/",children:"Home"})}),(0,x.jsx)("li",{children:(0,x.jsx)(r.N_,{to:"/about",children:"About"})}),(0,x.jsx)("li",{children:(0,x.jsx)(r.N_,{to:"/history",children:"History"})}),(0,x.jsx)("li",{children:(0,x.jsx)(r.N_,{to:"/gallery",children:"Gallery"})}),(0,x.jsx)("li",{children:(0,x.jsx)(r.N_,{to:"/contact",children:"Contact"})}),(0,x.jsx)("li",{children:(0,x.jsx)(r.N_,{to:"/login",className:"btn-primary",style:{padding:"0.5rem 1.5rem",color:"#fff"},children:"Login"})})]})]})}),(0,x.jsx)("section",{className:"hero-section",children:(0,x.jsx)("div",{className:"container",children:(0,x.jsxs)("div",{className:"hero-content",children:[(0,x.jsxs)("div",{className:"hero-text",children:[(0,x.jsxs)("h1",{className:"hero-title animate__animated animate__fadeInDown",children:["Smart Accounting for ",(0,x.jsx)("br",{})," Rubber Manufacturing"]}),(0,x.jsx)("p",{className:"hero-subtitle animate__animated animate__fadeInUp",children:"Streamline latex billing, wage automation, inventory tracking, and payroll management with Antigravity. Empowering operations with precision, transparency, and speed."}),(0,x.jsxs)("div",{className:"hero-actions",children:[(0,x.jsx)(r.N_,{to:"/login",className:"btn btn-primary animate__animated animate__fadeInLeft",children:"Get Started"}),(0,x.jsx)(r.N_,{to:"/contact",className:"btn btn-secondary animate__animated animate__fadeInRight",children:"Contact Sales"})]})]}),(0,x.jsxs)("div",{className:"hero-image",children:[(0,x.jsx)("img",{src:"/images/logo-placeholder.png",alt:"Antigravity Dashboard",onError:e=>e.target.style.display="none"}),(0,x.jsx)("div",{style:{position:"absolute",width:"100%",height:"100%",background:"radial-gradient(circle, rgba(96, 125, 139, 0.2) 0%, transparent 70%)",zIndex:-1}})]})]})})}),(0,x.jsx)("section",{className:"info-strip",children:(0,x.jsxs)("div",{className:"container",style:{display:"flex",justifyContent:"space-between",width:"100%"},children:[(0,x.jsxs)("div",{className:"info-item",children:[(0,x.jsx)("i",{className:"fas fa-file-invoice-dollar"})," Latex Billing"]}),(0,x.jsxs)("div",{className:"info-item",children:[(0,x.jsx)("i",{className:"fas fa-robot"})," Wage Automation"]}),(0,x.jsxs)("div",{className:"info-item",children:[(0,x.jsx)("i",{className:"fas fa-chart-line"})," Vendor Ledger Control"]})]})}),(0,x.jsx)("section",{className:"quick-nav-section",children:(0,x.jsxs)("div",{className:"container",children:[(0,x.jsx)("h2",{className:"section-title",children:"Explore Modules"}),(0,x.jsxs)("div",{className:"quick-nav-grid",children:[(0,x.jsxs)(r.N_,{to:"/about",className:"nav-card",children:[(0,x.jsx)("div",{className:"nav-icon",children:(0,x.jsx)("i",{className:"fas fa-info-circle"})}),(0,x.jsx)("h3",{children:"About Antigravity"}),(0,x.jsx)("p",{children:"Learn about our mission to revolutionize manufacturing accounting."})]}),(0,x.jsxs)(r.N_,{to:"/history",className:"nav-card",children:[(0,x.jsx)("div",{className:"nav-icon",children:(0,x.jsx)("i",{className:"fas fa-history"})}),(0,x.jsx)("h3",{children:"Our History"}),(0,x.jsx)("p",{children:"From humble beginnings to industry leadership in tech solutions."})]}),(0,x.jsxs)(r.N_,{to:"/gallery",className:"nav-card",children:[(0,x.jsx)("div",{className:"nav-icon",children:(0,x.jsx)("i",{className:"fas fa-images"})}),(0,x.jsx)("h3",{children:"Gallery"}),(0,x.jsx)("p",{children:"See our dashboard in action across various facilities."})]}),(0,x.jsxs)(r.N_,{to:"/contact",className:"nav-card",children:[(0,x.jsx)("div",{className:"nav-icon",children:(0,x.jsx)("i",{className:"fas fa-envelope"})}),(0,x.jsx)("h3",{children:"Contact Support"}),(0,x.jsx)("p",{children:"Get listed or ask for support with your integration."})]}),(0,x.jsxs)(r.N_,{to:"/login",className:"nav-card login-card","aria-label":"Login",children:[(0,x.jsx)("div",{className:"nav-icon",children:(0,x.jsx)("i",{className:"fas fa-sign-in-alt"})}),(0,x.jsxs)("h3",{children:["Login ",(0,x.jsx)("span",{className:"nav-cta","aria-hidden":"true",children:(0,x.jsx)("i",{className:"fas fa-arrow-right"})})]}),(0,x.jsx)("p",{children:"Access your Antigravity Dashboard"})]})]})]})}),(0,x.jsx)("section",{className:"features-section",children:(0,x.jsxs)("div",{className:"container",children:[(0,x.jsx)("h2",{className:"section-title",children:"Why Choose Antigravity?"}),(0,x.jsxs)("div",{className:"features-grid",children:[(0,x.jsxs)("div",{className:"feature-item",children:[(0,x.jsx)("div",{className:"feature-icon",children:(0,x.jsx)("i",{className:"fas fa-tachometer-alt"})}),(0,x.jsx)("h3",{children:"Precision & Speed"}),(0,x.jsx)("p",{children:"Clean UI and modular design empower you to manage operations with unmatched speed and accuracy."})]}),(0,x.jsxs)("div",{className:"feature-item",children:[(0,x.jsx)("div",{className:"feature-icon",children:(0,x.jsx)("i",{className:"fas fa-calculator"})}),(0,x.jsx)("h3",{children:"Financial Tools"}),(0,x.jsx)("p",{children:"Integrated tax filing, profitability analysis, and bank reconciliation for complete financial control."})]}),(0,x.jsxs)("div",{className:"feature-item",children:[(0,x.jsx)("div",{className:"feature-icon",children:(0,x.jsx)("i",{className:"fas fa-cubes"})}),(0,x.jsx)("h3",{children:"Inventory Tracking"}),(0,x.jsx)("p",{children:"Real-time tracking of latex barrels, stock monitoring, and automated shortage alerts."})]}),(0,x.jsxs)("div",{className:"feature-item",children:[(0,x.jsx)("div",{className:"feature-icon",children:(0,x.jsx)("i",{className:"fas fa-users-cog"})}),(0,x.jsx)("h3",{children:"Payroll Management"}),(0,x.jsx)("p",{children:"Automated wage calculations pending verify, ensuring fair and timely payments to staff."})]})]})]})}),(0,x.jsx)("section",{className:"news-section",children:(0,x.jsxs)("div",{className:"container",children:[(0,x.jsx)("h2",{className:"section-title",children:"Latest Updates"}),(0,x.jsxs)("div",{className:"news-grid",children:[(0,x.jsxs)("article",{className:"news-card featured",children:[(0,x.jsx)("div",{className:"news-image",children:(0,x.jsx)("img",{src:"/images/holy2.jpg",alt:"Manufacturing Update",onError:e=>e.target.src="https://via.placeholder.com/600x400?text=Module+Update"})}),(0,x.jsxs)("div",{className:"news-content",children:[(0,x.jsx)("span",{className:"news-category",children:"System Update"}),(0,x.jsx)("h3",{children:"New Profitability Module Live"}),(0,x.jsx)("p",{children:"We've launched the new Profitability Dashboard, allowing you to track margins in real-time across all product lines."}),(0,x.jsx)("span",{className:"news-time",children:"2 days ago"})]})]}),(0,x.jsxs)("article",{className:"news-card",children:[(0,x.jsx)("div",{className:"news-image",children:(0,x.jsx)("img",{src:"/images/holy3.jpg",alt:"Sustainability Award",onError:e=>e.target.src="https://via.placeholder.com/400x300?text=Award"})}),(0,x.jsxs)("div",{className:"news-content",children:[(0,x.jsx)("span",{className:"news-category",children:"Awards"}),(0,x.jsx)("h3",{children:"Best Industrial UX 2025"}),(0,x.jsx)("p",{children:"Antigravity receives recognition for outstanding user experience in manufacturing software."}),(0,x.jsx)("span",{className:"news-time",children:"1 week ago"})]})]}),(0,x.jsxs)("article",{className:"news-card",children:[(0,x.jsx)("div",{className:"news-image",children:(0,x.jsx)("img",{src:"/images/holy4.jpg",alt:"Partnership News",onError:e=>e.target.src="https://via.placeholder.com/400x300?text=Partnership"})}),(0,x.jsxs)("div",{className:"news-content",children:[(0,x.jsx)("span",{className:"news-category",children:"Partnerships"}),(0,x.jsx)("h3",{children:"New Vendor Integrations"}),(0,x.jsx)("p",{children:"Seamlessly connect with top chemical suppliers for automated reordering."}),(0,x.jsx)("span",{className:"news-time",children:"2 weeks ago"})]})]})]})]})}),(0,x.jsx)("section",{className:"cta-section",children:(0,x.jsx)("div",{className:"container",children:(0,x.jsxs)("div",{className:"cta-content",children:[(0,x.jsx)("h2",{children:"Ready to Defy Gravity?"}),(0,x.jsx)("p",{children:"Join smart manufacturers who trust Antigravity for their operations."}),(0,x.jsxs)("div",{className:"cta-buttons",children:[(0,x.jsx)(r.N_,{to:"/contact",className:"btn btn-primary",children:"Request Demo"}),(0,x.jsx)(r.N_,{to:"/login",className:"btn btn-secondary",children:"Login to Dashboard"})]})]})})}),(0,x.jsx)("footer",{className:"footer",children:(0,x.jsxs)("div",{className:"container",children:[(0,x.jsxs)("div",{className:"footer-content",children:[(0,x.jsxs)("div",{className:"footer-section",children:[(0,x.jsx)("h3",{children:"Antigravity"}),(0,x.jsx)("p",{children:"Smart accounting and operations dashboard for the modern rubber industry."})]}),(0,x.jsxs)("div",{className:"footer-section",children:[(0,x.jsx)("h4",{children:"Quick Links"}),(0,x.jsxs)("ul",{children:[(0,x.jsx)("li",{children:(0,x.jsx)(r.N_,{to:"/about",children:"About Us"})}),(0,x.jsx)("li",{children:(0,x.jsx)(r.N_,{to:"/history",children:"Features"})}),(0,x.jsx)("li",{children:(0,x.jsx)(r.N_,{to:"/gallery",children:"Screenshots"})}),(0,x.jsx)("li",{children:(0,x.jsx)(r.N_,{to:"/contact",children:"Contact"})})]})]}),(0,x.jsxs)("div",{className:"footer-section",children:[(0,x.jsx)("h4",{children:"Services"}),(0,x.jsxs)("ul",{children:[(0,x.jsx)("li",{children:(0,x.jsx)(r.N_,{to:"/login",children:"Login"})}),(0,x.jsx)("li",{children:(0,x.jsx)(r.N_,{to:"/contact",children:"Support"})})]})]})]}),(0,x.jsx)("div",{className:"footer-bottom",children:(0,x.jsx)("p",{children:"\xa9 2025 Antigravity Systems. All Rights Reserved."})})]})})]}),Hn=()=>(0,x.jsxs)("div",{className:"about-page brand-gradient",children:[(0,x.jsxs)("header",{className:"about-header",children:[(0,x.jsx)("h1",{children:"About Holy Family Polymers"}),(0,x.jsx)("p",{children:"Pioneering quality and trust in the natural rubber latex industry since our inception."})]}),(0,x.jsxs)("main",{className:"about-content",children:[(0,x.jsxs)("section",{className:"about-section",children:[(0,x.jsx)("h2",{children:"Our Story"}),(0,x.jsxs)("div",{className:"story-grid",children:[(0,x.jsx)("div",{className:"story-image",children:(0,x.jsx)("img",{src:"/images/images2.jpeg",alt:"Rubber Plantation"})}),(0,x.jsxs)("div",{className:"story-text",children:[(0,x.jsx)("p",{children:"Founded in the heart of Kerala's rubber country, Kottayam, Holy Family Polymers was born from a desire to create a transparent and efficient link between local rubber farmers and the global market."}),(0,x.jsx)("p",{children:"We saw the hard work of our community and built a platform that not only ensures fair pricing but also streamlines the entire process through technology. Our commitment is to uphold the values of integrity, quality, and community in every transaction."})]})]})]}),(0,x.jsxs)("section",{className:"about-section",children:[(0,x.jsx)("h2",{children:"Our Values"}),(0,x.jsxs)("div",{className:"values-grid",children:[(0,x.jsxs)("div",{className:"value-card",children:[(0,x.jsx)("i",{className:"fas fa-check-circle value-icon"}),(0,x.jsx)("h3",{children:"Quality First"}),(0,x.jsx)("p",{children:"We are dedicated to providing the highest grade of natural rubber latex, meeting stringent quality standards."})]}),(0,x.jsxs)("div",{className:"value-card",children:[(0,x.jsx)("i",{className:"fas fa-handshake value-icon"}),(0,x.jsx)("h3",{children:"Integrity & Trust"}),(0,x.jsx)("p",{children:"Our business is built on transparent pricing and honest relationships with our valued suppliers and clients."})]}),(0,x.jsxs)("div",{className:"value-card",children:[(0,x.jsx)("i",{className:"fas fa-users value-icon"}),(0,x.jsx)("h3",{children:"Community Focused"}),(0,x.jsx)("p",{children:"We are committed to empowering local farmers and contributing to the growth of our community in Kottayam."})]})]})]})]})]}),Vn=()=>(0,x.jsxs)("div",{className:"contact-page brand-gradient",children:[(0,x.jsx)("h1",{children:"Contact Holy Family Polymers"}),(0,x.jsx)("p",{children:"Have questions about our products, orders, or services? We\u2019re here to help. Reach out to us through any of the options below."}),(0,x.jsxs)("div",{className:"contact-grid",children:[(0,x.jsxs)("a",{href:"tel:+919876543210",className:"contact-card",children:[(0,x.jsx)("i",{className:"fas fa-phone-alt contact-icon"}),(0,x.jsx)("h3",{children:"Call Us"}),(0,x.jsx)("p",{children:"+91 98765 43210"})]}),(0,x.jsxs)("a",{href:"mailto:holyfamilypolymers@gmail.com",className:"contact-card",children:[(0,x.jsx)("i",{className:"fas fa-envelope contact-icon"}),(0,x.jsx)("h3",{children:"Email Us"}),(0,x.jsx)("p",{children:"holyfamilypolymers@gmail.com"})]}),(0,x.jsxs)("a",{href:"https://maps.google.com/?q=HolyFamily+Polymers,Kottayam,Kerala",target:"_blank",rel:"noopener noreferrer",className:"contact-card",children:[(0,x.jsx)("i",{className:"fas fa-map-marker-alt contact-icon"}),(0,x.jsx)("h3",{children:"Visit Us"}),(0,x.jsx)("p",{children:"Holy Family Polymers, Kottayam, Kerala"})]})]})]}),Gn=()=>(0,x.jsxs)("div",{className:"history-page brand-gradient",children:[(0,x.jsx)("h1",{children:"Our History"}),(0,x.jsx)("p",{children:"This is the history page for Holy Family Polymers."})]}),Jn=()=>(0,x.jsxs)("div",{className:"gallery-container brand-gradient",children:[(0,x.jsx)("h1",{children:"Gallery"}),(0,x.jsx)("div",{className:"gallery-grid",children:["/images/holy1.jpg","/images/holy2.jpg","/images/holy3.jpg","/images/holy4.jpg","/images/holy5.jpg","/images/holy6.jpg","/images/holy7.jpg"].map((e,t)=>(0,x.jsx)("div",{className:"gallery-item",children:(0,x.jsx)("img",{src:e,alt:"Gallery ".concat(t)})},t))})]}),Yn=()=>{var e;const[t,a]=(0,n.useState)({email:"",password:""}),[s,l]=(0,n.useState)(""),[o,c]=(0,n.useState)(!1),[d,u]=(0,n.useState)(""),[h,p]=(0,n.useState)(!1),m=(0,w.Zp)(),g=(0,w.zy)(),{login:v,googleSignIn:b}=y(),j=(null===(e=g.state)||void 0===e?void 0:e.from)||null;n.useEffect(()=>{var e,t;null!==(e=g.state)&&void 0!==e&&e.registrationSuccess&&(u("\u2705 Registration successful! Please login with your credentials."),null!==(t=g.state)&&void 0!==t&&t.email&&a(e=>(0,i.A)((0,i.A)({},e),{},{email:g.state.email})))},[g.state]);const{email:N,password:S}=t,[k,A]=(0,n.useState)({email:"",password:""}),C=e=>{const{name:t,value:a}=e.target;let n="";"email"===t?n=un(a,hn.login.email,"Email"):"password"===t&&(n=un(a,hn.login.password,"Password")),A(e=>(0,i.A)((0,i.A)({},e),{},{[t]:n||""}))},_=e=>{const{name:n,value:s}=e.target;a((0,i.A)((0,i.A)({},t),{},{[n]:s})),k[n]&&A(e=>(0,i.A)((0,i.A)({},e),{},{[n]:""})),d&&u("")},L=e=>{e&&"lab"===e.role?j&&String(j).startsWith("/lab")?m(j,{replace:!0}):m("/lab/dashboard",{replace:!0}):e&&"accountant"===e.role?m("/accountant/latex",{replace:!0}):j?m(j,{replace:!0}):e&&"admin"===e.role?m("/admin/home",{replace:!0}):e&&"manager"===e.role?m("/manager/home",{replace:!0}):e&&"delivery_staff"===e.role?m("/delivery",{replace:!0}):e&&"field_staff"===e.role?m("/staff",{replace:!0}):m("/user",{replace:!0})};return(0,x.jsx)("div",{className:"modern-auth-wrapper",children:(0,x.jsxs)("div",{className:"auth-container",children:[(0,x.jsxs)("div",{className:"bg-shapes",children:[(0,x.jsx)("div",{className:"shape shape-1"}),(0,x.jsx)("div",{className:"shape shape-2"}),(0,x.jsx)("div",{className:"shape shape-3"})]}),(0,x.jsxs)("div",{className:"auth-card",children:[(0,x.jsxs)("div",{className:"auth-header",children:[(0,x.jsxs)("div",{className:"logo-section",children:[(0,x.jsx)("div",{className:"logo-icon",children:(0,x.jsxs)("svg",{width:"40",height:"40",viewBox:"0 0 40 40",fill:"none",children:[(0,x.jsx)("rect",{width:"40",height:"40",rx:"12",fill:"url(#logoGradient)"}),(0,x.jsx)("path",{d:"M12 20L18 14L28 24L22 30L12 20Z",fill:"white",fillOpacity:"0.9"}),(0,x.jsx)("defs",{children:(0,x.jsxs)("linearGradient",{id:"logoGradient",x1:"0",y1:"0",x2:"40",y2:"40",children:[(0,x.jsx)("stop",{stopColor:"#3B82F6"}),(0,x.jsx)("stop",{offset:"1",stopColor:"#1D4ED8"})]})})]})}),(0,x.jsxs)("div",{className:"logo-text",children:[(0,x.jsx)("h1",{children:"Holy Family Polymers"}),(0,x.jsx)("p",{children:"Smart Manufacturing Solutions"})]})]}),(0,x.jsxs)(r.N_,{to:"/",className:"back-home",children:[(0,x.jsx)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",children:(0,x.jsx)("path",{d:"M19 12H5M12 19l-7-7 7-7",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),"Home"]})]}),(0,x.jsxs)("div",{className:"welcome-section",children:[(0,x.jsx)("h2",{children:"Welcome Back"}),(0,x.jsx)("p",{children:"Sign in to access your dashboard and manage operations"})]}),d&&(0,x.jsxs)("div",{className:"alert alert-success",children:[(0,x.jsx)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",children:(0,x.jsx)("path",{d:"M20 6L9 17l-5-5",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),d]}),s&&(0,x.jsxs)("div",{className:"alert alert-error",children:[(0,x.jsxs)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",children:[(0,x.jsx)("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"2"}),(0,x.jsx)("line",{x1:"15",y1:"9",x2:"9",y2:"15",stroke:"currentColor",strokeWidth:"2"}),(0,x.jsx)("line",{x1:"9",y1:"9",x2:"15",y2:"15",stroke:"currentColor",strokeWidth:"2"})]}),s]}),(0,x.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),(()=>{const e=un(N,hn.login.email,"Email"),t=un(S,hn.login.password,"Password");return A({email:e||"",password:t||""}),!e&&!t})())try{c(!0),l("");const e=await v(N,S);L(e.user)}catch(n){var t,a;l((null===(t=n.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.message)||n.message||"An error occurred during login.")}finally{c(!1)}},className:"auth-form",children:[(0,x.jsxs)("div",{className:"form-field ".concat(k.email?"error":""," ").concat(N&&!k.email?"valid":""),children:[(0,x.jsx)("label",{htmlFor:"email",children:"Email Address"}),(0,x.jsx)("input",{id:"email",type:"email",name:"email",value:N,onChange:_,onBlur:C,placeholder:"Enter your email",required:!0}),k.email&&(0,x.jsx)("span",{className:"field-error",children:k.email}),N&&!k.email&&(0,x.jsx)("span",{className:"field-success",children:(0,x.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",children:(0,x.jsx)("path",{d:"M20 6L9 17l-5-5",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),(0,x.jsxs)("div",{className:"form-field ".concat(k.password?"error":""," ").concat(S&&!k.password?"valid":""),children:[(0,x.jsx)("label",{htmlFor:"password",children:"Password"}),(0,x.jsxs)("div",{className:"password-input",children:[(0,x.jsx)("input",{id:"password",type:h?"text":"password",name:"password",value:S,onChange:_,onBlur:C,placeholder:"Enter your password",required:!0}),(0,x.jsx)("button",{type:"button",className:"password-toggle",onClick:()=>p(!h),children:h?(0,x.jsxs)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",children:[(0,x.jsx)("path",{d:"M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24",stroke:"currentColor",strokeWidth:"2"}),(0,x.jsx)("line",{x1:"1",y1:"1",x2:"23",y2:"23",stroke:"currentColor",strokeWidth:"2"})]}):(0,x.jsxs)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",children:[(0,x.jsx)("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z",stroke:"currentColor",strokeWidth:"2"}),(0,x.jsx)("circle",{cx:"12",cy:"12",r:"3",stroke:"currentColor",strokeWidth:"2"})]})})]}),k.password&&(0,x.jsx)("span",{className:"field-error",children:k.password}),S&&S.length>=6&&!k.password&&(0,x.jsx)("span",{className:"field-success",children:(0,x.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",children:(0,x.jsx)("path",{d:"M20 6L9 17l-5-5",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),(0,x.jsxs)("button",{className:"btn-primary",type:"submit",disabled:o,children:[o&&(0,x.jsx)("div",{className:"spinner"}),o?"Signing in...":"Sign In"]})]}),(0,x.jsx)("div",{className:"divider",children:(0,x.jsx)("span",{children:"or continue with"})}),(0,x.jsx)("div",{className:"google-login-container",children:(0,x.jsx)(f,{onSuccess:async e=>{try{if(c(!0),l(""),null===e||void 0===e||!e.credential)throw new Error("No credential received from Google");const t=await b(e.credential);L(null===t||void 0===t?void 0:t.user)}catch(n){var t,a;console.error("Google Sign-In Error:",n);const e=(null===n||void 0===n||null===(t=n.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.message)||(null===n||void 0===n?void 0:n.message)||"Google Sign-In failed. Please try again.";l(e)}finally{c(!1)}},onError:()=>l("Google Sign-In failed. Please try again."),disabled:o,theme:"outline",size:"large",width:"100%"})}),(0,x.jsxs)("div",{className:"auth-footer",children:[(0,x.jsx)(r.N_,{to:"/forgot-password",className:"link-secondary",children:"Forgot your password?"}),(0,x.jsxs)("div",{className:"signup-prompt",children:["Don't have an account?",(0,x.jsx)(r.N_,{to:"/register",state:j?{from:j}:void 0,className:"link-primary",children:"Create Account"})]})]})]})]})})},Kn=()=>{var e;const[t,a]=(0,n.useState)({name:"",email:"",phoneNumber:"",password:"",confirmPassword:""}),[s,l]=(0,n.useState)({}),[o,c]=(0,n.useState)(""),[d,u]=(0,n.useState)(1),[h,p]=(0,n.useState)(!1),m=(0,w.Zp)(),g=(0,w.zy)(),{register:v,googleSignIn:b}=y(),j=(null===(e=g.state)||void 0===e?void 0:e.from)||null,{name:N,email:S,phoneNumber:k,password:A,confirmPassword:C}=t,_=e=>{var t;return(null===(t=(e=>{const t=cn.name(e,"Name");return t?{valid:!1,message:t}:{valid:!0}})(e))||void 0===t?void 0:t.valid)||e.length>2},L=e=>!cn.email(e),T=e=>!cn.phone(e),E=e=>!cn.password(e),D=(e,t)=>e===t&&!!e,P=e=>{const{name:t,value:n}=e.target;a(e=>(0,i.A)((0,i.A)({},e),{},{[t]:n})),s[t]&&l(e=>(0,i.A)((0,i.A)({},e),{},{[t]:""}))},R=e=>{["name","email","phoneNumber","password","confirmPassword"].includes(e.target.name)&&" "===e.key&&e.preventDefault()};return(0,x.jsx)("div",{className:"modern-auth-wrapper",children:(0,x.jsxs)("div",{className:"auth-container",children:[(0,x.jsxs)("div",{className:"bg-shapes",children:[(0,x.jsx)("div",{className:"shape shape-1"}),(0,x.jsx)("div",{className:"shape shape-2"}),(0,x.jsx)("div",{className:"shape shape-3"})]}),(0,x.jsxs)("div",{className:"auth-card",children:[(0,x.jsxs)("div",{className:"auth-header",children:[(0,x.jsxs)("div",{className:"logo-section",children:[(0,x.jsx)("div",{className:"logo-icon",children:(0,x.jsxs)("svg",{width:"40",height:"40",viewBox:"0 0 40 40",fill:"none",children:[(0,x.jsx)("rect",{width:"40",height:"40",rx:"12",fill:"url(#logoGradient)"}),(0,x.jsx)("path",{d:"M12 20L18 14L28 24L22 30L12 20Z",fill:"white",fillOpacity:"0.9"}),(0,x.jsx)("defs",{children:(0,x.jsxs)("linearGradient",{id:"logoGradient",x1:"0",y1:"0",x2:"40",y2:"40",children:[(0,x.jsx)("stop",{stopColor:"#3B82F6"}),(0,x.jsx)("stop",{offset:"1",stopColor:"#1D4ED8"})]})})]})}),(0,x.jsxs)("div",{className:"logo-text",children:[(0,x.jsx)("h1",{children:"Holy Family Polymers"}),(0,x.jsx)("p",{children:"Smart Manufacturing Solutions"})]})]}),(0,x.jsxs)(r.N_,{to:"/",className:"back-home",children:[(0,x.jsx)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",children:(0,x.jsx)("path",{d:"M19 12H5M12 19l-7-7 7-7",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),"Home"]})]}),(0,x.jsxs)("div",{className:"welcome-section",children:[(0,x.jsx)("h2",{children:"Create Your Account"}),(0,x.jsx)("p",{children:"Join Holy Family Polymers and start managing your operations efficiently"})]}),(0,x.jsx)("div",{className:"google-login-container",children:(0,x.jsx)(f,{onSuccess:async e=>{try{p(!0),await b(e.credential),m("/user",{replace:!0})}catch(t){l({general:"Google Sign-In failed. Please try again."})}finally{p(!1)}},onError:()=>l({general:"Google Sign-In failed. Please try again."}),disabled:h,theme:"outline",size:"large",width:"100%"})}),(0,x.jsx)("div",{className:"divider",children:(0,x.jsx)("span",{children:"or sign up with email"})}),(0,x.jsxs)("div",{className:"progress-steps",children:[(0,x.jsxs)("div",{className:"step ".concat(d>=1?"active":""),children:[(0,x.jsx)("div",{className:"step-number",children:"1"}),(0,x.jsx)("span",{children:"Personal Info"})]}),(0,x.jsxs)("div",{className:"step ".concat(d>=2?"active":""),children:[(0,x.jsx)("div",{className:"step-number",children:"2"}),(0,x.jsx)("span",{children:"Security"})]})]}),s.general&&(0,x.jsxs)("div",{className:"alert alert-error",children:[(0,x.jsxs)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",children:[(0,x.jsx)("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"2"}),(0,x.jsx)("line",{x1:"15",y1:"9",x2:"9",y2:"15",stroke:"currentColor",strokeWidth:"2"}),(0,x.jsx)("line",{x1:"9",y1:"9",x2:"15",y2:"15",stroke:"currentColor",strokeWidth:"2"})]}),s.general]}),o&&(0,x.jsxs)("div",{className:"alert alert-success",children:[(0,x.jsx)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",children:(0,x.jsx)("path",{d:"M20 6L9 17l-5-5",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),o]}),(0,x.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),p(!0),c(""),(()=>{const e=pn(t)||{};return l(e),0===Object.keys(e).length})())try{const e=function(){const e=((arguments.length>0&&void 0!==arguments[0]?arguments[0]:"")||"").toString().replace(/\D/g,"");return e?e.length>10?e.slice(-10):e:""}(k),t={name:N,email:S,phoneNumber:e,password:A};await v(t),c("\ud83c\udf89 Account created successfully! Redirecting..."),setTimeout(()=>{m("/login",{replace:!0,state:{registrationSuccess:!0,email:S}})},2e3)}catch(i){var a,n,s,r;console.error("\u274c Registration error:",i);const e=(null===(a=i.response)||void 0===a||null===(n=a.data)||void 0===n?void 0:n.message)||"";null!==(s=i.response)&&void 0!==s&&null!==(r=s.data)&&void 0!==r&&r.errors?l(i.response.data.errors):/already exists/i.test(e)?l({email:e}):l({general:e||"An error occurred during registration."})}finally{p(!1)}else p(!1),window.scrollTo({top:0,behavior:"smooth"})},className:"auth-form",children:[1===d&&(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)("div",{className:"form-field ".concat(s.name?"error":""," ").concat(_(N)?"valid":""),children:[(0,x.jsx)("label",{htmlFor:"name",children:"Full Name"}),(0,x.jsx)("input",{id:"name",type:"text",name:"name",value:N,onChange:P,placeholder:"Enter your full name",maxLength:50}),s.name&&(0,x.jsx)("span",{className:"field-error",children:s.name}),_(N)&&(0,x.jsx)("span",{className:"field-success",children:(0,x.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",children:(0,x.jsx)("path",{d:"M20 6L9 17l-5-5",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),(0,x.jsxs)("div",{className:"form-field ".concat(s.email?"error":""," ").concat(L(S)?"valid":""),children:[(0,x.jsx)("label",{htmlFor:"email",children:"Email Address"}),(0,x.jsx)("input",{id:"email",type:"email",name:"email",value:S,onChange:P,placeholder:"Enter your email address"}),s.email&&(0,x.jsx)("span",{className:"field-error",children:s.email}),L(S)&&(0,x.jsx)("span",{className:"field-success",children:(0,x.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",children:(0,x.jsx)("path",{d:"M20 6L9 17l-5-5",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),(0,x.jsxs)("div",{className:"form-field ".concat(s.phoneNumber?"error":""," ").concat(T(k)?"valid":""),children:[(0,x.jsx)("label",{htmlFor:"phoneNumber",children:"Phone Number"}),(0,x.jsx)("input",{id:"phoneNumber",type:"text",name:"phoneNumber",value:k,onChange:P,placeholder:"Enter your phone number",maxLength:15}),s.phoneNumber&&(0,x.jsx)("span",{className:"field-error",children:s.phoneNumber}),T(k)&&(0,x.jsx)("span",{className:"field-success",children:(0,x.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",children:(0,x.jsx)("path",{d:"M20 6L9 17l-5-5",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})})]})]}),2===d&&(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)("div",{className:"form-field ".concat(s.password?"error":""," ").concat(E(A)?"valid":""),children:[(0,x.jsx)("label",{htmlFor:"password",children:"Password"}),(0,x.jsx)("input",{id:"password",type:"password",name:"password",value:A,onChange:P,onKeyDown:R,placeholder:"Create a strong password"}),s.password&&(0,x.jsx)("span",{className:"field-error",children:s.password}),E(A)&&(0,x.jsx)("span",{className:"field-success",children:(0,x.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",children:(0,x.jsx)("path",{d:"M20 6L9 17l-5-5",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),(0,x.jsxs)("div",{className:"form-field ".concat(s.confirmPassword?"error":""," ").concat(D(A,C)?"valid":""),children:[(0,x.jsx)("label",{htmlFor:"confirmPassword",children:"Confirm Password"}),(0,x.jsx)("input",{id:"confirmPassword",type:"password",name:"confirmPassword",value:C,onChange:P,onKeyDown:R,placeholder:"Confirm your password"}),s.confirmPassword&&(0,x.jsx)("span",{className:"field-error",children:s.confirmPassword}),D(A,C)&&(0,x.jsx)("span",{className:"field-success",children:(0,x.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",children:(0,x.jsx)("path",{d:"M20 6L9 17l-5-5",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})})]})]}),(0,x.jsxs)("div",{className:"form-actions",children:[d>1&&(0,x.jsxs)("button",{type:"button",className:"btn-secondary",onClick:()=>u(d-1),children:[(0,x.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",children:(0,x.jsx)("path",{d:"M19 12H5M12 19l-7-7 7-7",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),"Previous"]}),d<2?(0,x.jsxs)("button",{type:"button",className:"btn-primary",onClick:()=>_(N)?L(S)?T(k)?void u(2):l({phoneNumber:"Please enter a valid phone number"}):l({email:"Please enter a valid email address"}):l({name:"Please enter a valid name"}),children:["Continue",(0,x.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",children:(0,x.jsx)("path",{d:"M5 12h14M12 5l7 7-7 7",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})]}):(0,x.jsxs)("button",{className:"btn-primary",type:"submit",disabled:h,children:[h&&(0,x.jsx)("div",{className:"spinner"}),h?"Creating Account...":"Create Account"]})]})]}),(0,x.jsx)("div",{className:"auth-footer",children:(0,x.jsxs)("div",{className:"signup-prompt",children:["Already have an account?",(0,x.jsx)(r.N_,{to:"/login",state:j?{from:j}:void 0,className:"link-primary",children:"Sign In"})]})})]})]})})},Qn=()=>{const[e,t]=(0,n.useState)(""),[a,s]=(0,n.useState)(""),[i,l]=(0,n.useState)(""),[o,c]=(0,n.useState)(!1);return(0,x.jsx)("div",{className:"modern-auth-wrapper",children:(0,x.jsxs)("div",{className:"auth-container",children:[(0,x.jsxs)("div",{className:"bg-shapes",children:[(0,x.jsx)("div",{className:"shape shape-1"}),(0,x.jsx)("div",{className:"shape shape-2"}),(0,x.jsx)("div",{className:"shape shape-3"})]}),(0,x.jsxs)("div",{className:"auth-card",children:[(0,x.jsxs)("div",{className:"auth-header",children:[(0,x.jsxs)("div",{className:"logo-section",children:[(0,x.jsx)("div",{className:"logo-icon",children:(0,x.jsxs)("svg",{width:"40",height:"40",viewBox:"0 0 40 40",fill:"none",children:[(0,x.jsx)("rect",{width:"40",height:"40",rx:"12",fill:"url(#logoGradient)"}),(0,x.jsx)("path",{d:"M12 20L18 14L28 24L22 30L12 20Z",fill:"white",fillOpacity:"0.9"}),(0,x.jsx)("defs",{children:(0,x.jsxs)("linearGradient",{id:"logoGradient",x1:"0",y1:"0",x2:"40",y2:"40",children:[(0,x.jsx)("stop",{stopColor:"#3B82F6"}),(0,x.jsx)("stop",{offset:"1",stopColor:"#1D4ED8"})]})})]})}),(0,x.jsxs)("div",{className:"logo-text",children:[(0,x.jsx)("h1",{children:"Holy Family Polymers"}),(0,x.jsx)("p",{children:"Smart Manufacturing Solutions"})]})]}),(0,x.jsxs)(r.N_,{to:"/",className:"back-home",children:[(0,x.jsx)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",children:(0,x.jsx)("path",{d:"M19 12H5M12 19l-7-7 7-7",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),"Home"]})]}),(0,x.jsxs)("div",{className:"welcome-section",children:[(0,x.jsx)("div",{className:"reset-icon",children:(0,x.jsxs)("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",children:[(0,x.jsx)("path",{d:"M12 2a10 10 0 1 0 10 10A10 10 0 0 0 12 2zm0 18a8 8 0 1 1 8-8 8 8 0 0 1-8 8z",fill:"currentColor"}),(0,x.jsx)("path",{d:"M12 6v6l4 2",stroke:"white",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]})}),(0,x.jsx)("h2",{children:"Reset Your Password"}),(0,x.jsx)("p",{children:"Enter your email address and we'll send you a secure link to reset your password"})]}),a&&(0,x.jsxs)("div",{className:"alert alert-success",children:[(0,x.jsx)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",children:(0,x.jsx)("path",{d:"M20 6L9 17l-5-5",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),a]}),i&&(0,x.jsxs)("div",{className:"alert alert-error",children:[(0,x.jsxs)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",children:[(0,x.jsx)("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"2"}),(0,x.jsx)("line",{x1:"15",y1:"9",x2:"9",y2:"15",stroke:"currentColor",strokeWidth:"2"}),(0,x.jsx)("line",{x1:"9",y1:"9",x2:"15",y2:"15",stroke:"currentColor",strokeWidth:"2"})]}),i]}),(0,x.jsxs)("form",{onSubmit:async t=>{t.preventDefault(),s(""),l(""),c(!0);try{const t=await m.A.post("".concat("http://localhost:5000","/api/auth/forgot-password"),{email:e});s(t.data.message||"Password reset link has been sent to your email.")}catch(r){var a,n;l((null===(a=r.response)||void 0===a||null===(n=a.data)||void 0===n?void 0:n.message)||"An error occurred while sending the reset link.")}finally{c(!1)}},className:"auth-form",children:[(0,x.jsxs)("div",{className:"form-field",children:[(0,x.jsx)("label",{htmlFor:"email",children:"Email Address"}),(0,x.jsx)("input",{id:"email",type:"email",value:e,onChange:e=>t(e.target.value),placeholder:"Enter your registered email",required:!0,disabled:o})]}),(0,x.jsxs)("button",{className:"btn-primary",type:"submit",disabled:o,children:[o&&(0,x.jsx)("div",{className:"spinner"}),o?"Sending Reset Link...":"Send Reset Link"]})]}),(0,x.jsxs)("div",{className:"auth-footer",children:[(0,x.jsxs)("div",{className:"signup-prompt",children:["Remember your password?",(0,x.jsx)(r.N_,{to:"/login",className:"link-primary",children:"Sign In"})]}),(0,x.jsxs)("div",{className:"signup-prompt",children:["Don't have an account?",(0,x.jsx)(r.N_,{to:"/register",className:"link-primary",children:"Create Account"})]})]})]})]})})},$n=()=>{const[e,t]=(0,n.useState)(""),[a,s]=(0,n.useState)(""),[i,l]=(0,n.useState)(""),[o,c]=(0,n.useState)(""),[d,u]=(0,n.useState)(!1),{token:h}=(0,w.g)(),p=(0,w.Zp)();return(0,x.jsx)("div",{className:"auth-wrapper no-showcase",children:(0,x.jsxs)("div",{className:"form-container",children:[(0,x.jsx)("div",{className:"logo-container",children:(0,x.jsx)("img",{src:"/images/logo.png",alt:"Holy Family Polymers Logo",className:"company-logo"})}),(0,x.jsx)("div",{className:"back-row",children:(0,x.jsxs)(r.N_,{to:"/",className:"back-link",children:[(0,x.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,x.jsx)("path",{d:"M19 12H5M12 19l-7-7 7-7",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),"Back to Home"]})}),(0,x.jsx)("h2",{children:"Reset Your Password"}),i&&(0,x.jsx)("div",{className:"success-message",children:i}),o&&(0,x.jsx)("div",{className:"error-message",children:o}),(0,x.jsxs)("form",{onSubmit:async t=>{if(t.preventDefault(),l(""),c(""),e===a){u(!0);try{const t=await m.A.put("".concat("http://localhost:5000","/api/auth/reset-password/").concat(h),{password:e});l(t.data.message||"Password has been reset successfully. Please log in."),setTimeout(()=>{p("/login")},3e3)}catch(r){var n,s;c((null===(n=r.response)||void 0===n||null===(s=n.data)||void 0===s?void 0:s.message)||"An error occurred. The token may be invalid or expired.")}finally{u(!1)}}else c("Passwords do not match.")},children:[(0,x.jsxs)("div",{className:"input-group floating",children:[(0,x.jsx)("input",{className:"form-input",type:"password",placeholder:" ",value:e,onChange:e=>t(e.target.value),required:!0,disabled:d}),(0,x.jsx)("label",{children:"New Password"})]}),(0,x.jsxs)("div",{className:"input-group floating",children:[(0,x.jsx)("input",{className:"form-input",type:"password",placeholder:" ",value:a,onChange:e=>s(e.target.value),required:!0,disabled:d}),(0,x.jsx)("label",{children:"Confirm New Password"})]}),(0,x.jsx)("button",{className:"form-button",type:"submit",disabled:d,children:d?"Resetting...":"Reset Password"})]}),(0,x.jsx)("div",{className:"auth-links",style:{marginTop:"1rem"},children:(0,x.jsxs)("span",{children:["Remember your password? ",(0,x.jsx)(r.N_,{to:"/login",children:"Login here"})]})})]})})},Xn=()=>{const[e,t]=(0,n.useState)({staffId:""}),[a,s]=(0,n.useState)(""),[l,o]=(0,n.useState)(!1),c=(0,w.Zp)(),d=(0,w.zy)(),{staffLogin:u}=y(),{staffId:h}=e;(0,n.useEffect)(()=>{var e;const a=null===(e=d.state)||void 0===e?void 0:e.staffId;a&&t({staffId:a})},[d.state]);return(0,x.jsx)("div",{className:"auth-wrapper dark-theme no-showcase",children:(0,x.jsxs)("div",{className:"form-container",children:[(0,x.jsx)("div",{className:"logo-container",children:(0,x.jsx)("img",{src:"/images/logo.svg",alt:"Holy Family Polymers Logo",className:"company-logo"})}),(0,x.jsx)("div",{className:"back-row",children:(0,x.jsxs)(r.N_,{to:"/",className:"back-link",children:[(0,x.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,x.jsx)("path",{d:"M19 12H5M12 19l-7-7 7-7",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),"Back to Home"]})}),(0,x.jsxs)("h2",{children:[(0,x.jsxs)("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{marginRight:"0.5rem",verticalAlign:"middle"},children:[(0,x.jsx)("rect",{x:"3",y:"5",width:"18",height:"14",rx:"2",stroke:"currentColor",strokeWidth:"2"}),(0,x.jsx)("path",{d:"M7 9H17",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"}),(0,x.jsx)("circle",{cx:"8.5",cy:"13.5",r:"1.5",fill:"currentColor"}),(0,x.jsx)("path",{d:"M12 15c-1.2-1.6-4.8-1.6-6 0",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})]}),"Staff Portal"]}),a&&(0,x.jsxs)("div",{className:"error-message",children:[(0,x.jsxs)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,x.jsx)("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"2"}),(0,x.jsx)("line",{x1:"15",y1:"9",x2:"9",y2:"15",stroke:"currentColor",strokeWidth:"2"}),(0,x.jsx)("line",{x1:"9",y1:"9",x2:"15",y2:"15",stroke:"currentColor",strokeWidth:"2"})]}),a]}),(0,x.jsxs)("div",{style:{background:"rgba(245, 158, 11, 0.1)",border:"1px solid rgba(245, 158, 11, 0.3)",color:"#92400e",padding:"1rem",borderRadius:"var(--radius-lg)",marginBottom:"1.5rem",display:"flex",alignItems:"center",gap:"0.5rem",fontSize:"0.9rem"},children:[(0,x.jsxs)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,x.jsx)("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"2"}),(0,x.jsx)("path",{d:"m9 12 2 2 4-4",stroke:"currentColor",strokeWidth:"2"})]}),"Enter your Staff ID to access the staff portal"]}),(0,x.jsxs)("form",{onSubmit:async e=>{var t;if(e.preventDefault(),h?/^HF[A-Z0-9]{3}$/i.test(h)||/^HFP-S-\d{4}$/i.test(h)||/^[A-Z]{3}-\d{4}-\d{3}$/i.test(h)?(s(""),1):(s("Enter a valid Staff ID like HFA42, HFP-S-0002, or STF-2025-005"),0):(s("Please enter Staff ID."),0))try{o(!0),s("");const e=await u(h.toUpperCase());"delivery_staff"!==(t=e.user.role)?"field_staff"!==t&&"admin"!==t?s("This login is for staff only."):c("/staff",{replace:!0}):c("/delivery",{replace:!0})}catch(r){var a,n;s((null===(a=r.response)||void 0===a||null===(n=a.data)||void 0===n?void 0:n.message)||r.message||"An error occurred during login.")}finally{o(!1)}},children:[(0,x.jsxs)("div",{className:"input-group floating",children:[(0,x.jsx)("input",{className:"form-input",placeholder:" ",name:"staffId",value:h,onChange:a=>{const{name:n,value:s}=a.target,r=s.replace(/\s+/g,"").toUpperCase();t((0,i.A)((0,i.A)({},e),{},{[n]:r}))},required:!0,style:{textTransform:"uppercase"}}),(0,x.jsx)("label",{children:"Staff ID (e.g., HFA42, HFP-S-0002, or STF-2025-005)"})]}),(0,x.jsxs)("button",{className:"form-button staff",type:"submit",disabled:l,children:[l&&(0,x.jsx)("span",{className:"loading-spinner"}),(0,x.jsx)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{marginRight:"0.5rem"},children:(0,x.jsx)("path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4M10 17l5-5-5-5M21 12H9",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),l?"Authenticating...":"Access Staff Portal"]})]}),(0,x.jsxs)("div",{className:"auth-links",children:[(0,x.jsxs)(r.N_,{to:"/forgot-password",children:[(0,x.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,x.jsx)("path",{d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z",stroke:"currentColor",strokeWidth:"2"})}),"Need Help?"]}),(0,x.jsxs)("span",{children:["New staff member?",(0,x.jsx)(r.N_,{to:"/staff/register",children:"Register Here"})]}),(0,x.jsxs)("span",{children:["Customer Login?",(0,x.jsxs)(r.N_,{to:"/login",children:[(0,x.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{marginRight:"0.25rem"},children:[(0,x.jsx)("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2",stroke:"currentColor",strokeWidth:"2"}),(0,x.jsx)("circle",{cx:"12",cy:"7",r:"4",stroke:"currentColor",strokeWidth:"2"})]}),"Customer Portal"]})]})]})]})})},Zn="http://localhost:5000",es=()=>{const{validateToken:e}=y(),[t,a]=(0,n.useState)(!0),[s,r]=(0,n.useState)(!1),[l,o]=(0,n.useState)(""),[c,d]=(0,n.useState)(""),[u,h]=(0,n.useState)(!1),[p,f]=(0,n.useState)("edit"),[g,v]=(0,n.useState)({name:"",email:"",phoneNumber:"",location:""}),[b,j]=(0,n.useState)({name:"",email:"",phoneNumber:"",location:""}),[w,N]=(0,n.useState)({currentPassword:"",newPassword:"",confirmPassword:""});(0,n.useEffect)(()=>{(async()=>{try{const e=localStorage.getItem("user");if(e){const t=JSON.parse(e),a={name:t.name||"",email:t.email||"",phoneNumber:t.phoneNumber||"",location:t.location||""};v(e=>(0,i.A)((0,i.A)({},e),a)),j(a)}const t=localStorage.getItem("token"),a=t?{Authorization:"Bearer ".concat(t)}:{},n=(await m.A.get("".concat(Zn,"/api/users/profile"),{headers:a})).data,s={name:n.name||"",email:n.email||"",phoneNumber:n.phoneNumber||"",location:n.location||""};v(s),j(s)}catch(e){}finally{a(!1)}})()},[]);const S=e=>{const{name:t,value:a}=e.target;v(e=>(0,i.A)((0,i.A)({},e),{},{[t]:a}))},k=e=>{const{name:t,value:a}=e.target;N(e=>(0,i.A)((0,i.A)({},e),{},{[t]:a}))};return t?(0,x.jsx)("p",{children:"Loading profile..."}):(0,x.jsxs)("div",{className:"profile-container navy-theme",children:[(0,x.jsxs)("aside",{className:"profile-summary",children:[(0,x.jsxs)("div",{className:"summary-title",children:[(0,x.jsx)("i",{className:"fas fa-user-circle"}),(0,x.jsx)("span",{children:"Your Profile Details"})]}),(0,x.jsxs)("div",{className:"summary-item",children:[(0,x.jsx)("div",{className:"label",children:"Your Name"}),(0,x.jsx)("div",{className:"value",children:g.name||"--"})]}),(0,x.jsxs)("div",{className:"summary-item",children:[(0,x.jsx)("div",{className:"label",children:"Your Email"}),(0,x.jsx)("div",{className:"value",children:(0,x.jsx)("a",{href:"mailto:".concat(g.email),children:g.email||"--"})})]}),(0,x.jsxs)("div",{className:"summary-item",children:[(0,x.jsx)("div",{className:"label",children:"Your Mobile"}),(0,x.jsx)("div",{className:"value",children:g.phoneNumber||"--"})]}),(0,x.jsxs)("div",{className:"summary-item",children:[(0,x.jsx)("div",{className:"label",children:"Status"}),(0,x.jsx)("div",{className:"value active",children:"Active"})]})]}),(0,x.jsxs)("section",{className:"profile-content",children:[(0,x.jsxs)("div",{className:"tabs",children:[(0,x.jsx)("button",{className:"tab ".concat("edit"===p?"active":""),onClick:()=>f("edit"),children:"Edit Profile"}),(0,x.jsx)("button",{className:"tab ".concat("password"===p?"active":""),onClick:()=>f("password"),children:"Change Password"})]}),l&&(0,x.jsx)("div",{className:"alert success",children:l}),c&&(0,x.jsx)("div",{className:"alert error",children:c}),"edit"===p&&(0,x.jsxs)("form",{className:"profile-form",onSubmit:async t=>{if(t.preventDefault(),d(""),o(""),g.name.trim())if(g.phoneNumber.trim())try{r(!0);const t=g.phoneNumber.replace(/\D/g,""),a=t.startsWith("91")&&12===t.length?t.slice(2):t.startsWith("0")?t.slice(1):t,n={name:g.name.trim(),phoneNumber:a,location:g.location.trim()},s=localStorage.getItem("token"),l=s?{Authorization:"Bearer ".concat(s)}:{},c=(await m.A.put("".concat(Zn,"/api/users/profile"),n,{headers:l})).data.user,d=JSON.parse(localStorage.getItem("user")||"{}");localStorage.setItem("user",JSON.stringify((0,i.A)((0,i.A)({},d),c)));const u={name:c.name||g.name,email:g.email,phoneNumber:c.phoneNumber||g.phoneNumber,location:c.location||g.location};v(u),j(u),o("Profile updated successfully"),h(!1),await e()}catch(t){var a,n;d((null===t||void 0===t||null===(a=t.response)||void 0===a||null===(n=a.data)||void 0===n?void 0:n.message)||"Failed to update profile")}finally{r(!1)}else d("Phone number is required");else d("Name is required")},children:[(0,x.jsxs)("div",{className:"grid-2",children:[(0,x.jsxs)("div",{className:"form-row",children:[(0,x.jsx)("label",{htmlFor:"name",children:"Full Name"}),(0,x.jsx)("input",{id:"name",name:"name",type:"text",value:g.name,onChange:S,placeholder:"Your name",disabled:!u})]}),(0,x.jsxs)("div",{className:"form-row",children:[(0,x.jsx)("label",{htmlFor:"email",children:"Email"}),(0,x.jsx)("input",{id:"email",name:"email",type:"email",value:g.email,disabled:!0})]})]}),(0,x.jsxs)("div",{className:"grid-2",children:[(0,x.jsxs)("div",{className:"form-row",children:[(0,x.jsx)("label",{htmlFor:"phoneNumber",children:"Mobile No"}),(0,x.jsx)("input",{id:"phoneNumber",name:"phoneNumber",type:"tel",value:g.phoneNumber,onChange:S,placeholder:"e.g. 9876543210",disabled:!u})]}),(0,x.jsxs)("div",{className:"form-row",children:[(0,x.jsx)("label",{htmlFor:"location",children:"Location"}),(0,x.jsx)("input",{id:"location",name:"location",type:"text",value:g.location,onChange:S,placeholder:"City, State",disabled:!u})]})]}),(0,x.jsxs)("div",{className:"form-actions",children:[!u&&(0,x.jsx)("button",{type:"button",className:"btn primary",onClick:()=>h(!0),children:"Edit"}),u&&(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("button",{type:"button",className:"btn",onClick:()=>{v(b),h(!1),d(""),o("")},disabled:s,style:{marginRight:8},children:"Cancel"}),(0,x.jsx)("button",{type:"submit",className:"btn primary",disabled:s,children:s?"Saving...":"Update"})]})]})]}),"password"===p&&(0,x.jsxs)("form",{className:"profile-form",onSubmit:async e=>{if(e.preventDefault(),d(""),o(""),w.currentPassword&&w.newPassword)if(w.newPassword===w.confirmPassword)try{r(!0);const e=localStorage.getItem("token"),t=e?{Authorization:"Bearer ".concat(e)}:{};await m.A.post("".concat(Zn,"/api/auth/change-password"),{currentPassword:w.currentPassword,newPassword:w.newPassword},{headers:t}),o("Password updated successfully"),N({currentPassword:"",newPassword:"",confirmPassword:""}),f("edit")}catch(e){var t,a;d((null===e||void 0===e||null===(t=e.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.message)||"Failed to change password")}finally{r(!1)}else d("New passwords do not match");else d("Please fill all password fields")},children:[(0,x.jsxs)("div",{className:"form-row",children:[(0,x.jsx)("label",{htmlFor:"currentPassword",children:"Current Password"}),(0,x.jsx)("input",{id:"currentPassword",name:"currentPassword",type:"password",value:w.currentPassword,onChange:k,placeholder:"Enter current password"})]}),(0,x.jsxs)("div",{className:"grid-2",children:[(0,x.jsxs)("div",{className:"form-row",children:[(0,x.jsx)("label",{htmlFor:"newPassword",children:"New Password"}),(0,x.jsx)("input",{id:"newPassword",name:"newPassword",type:"password",value:w.newPassword,onChange:k,placeholder:"Enter new password"})]}),(0,x.jsxs)("div",{className:"form-row",children:[(0,x.jsx)("label",{htmlFor:"confirmPassword",children:"Confirm Password"}),(0,x.jsx)("input",{id:"confirmPassword",name:"confirmPassword",type:"password",value:w.confirmPassword,onChange:k,placeholder:"Confirm password"})]})]}),(0,x.jsx)("div",{className:"form-actions",children:(0,x.jsx)("button",{type:"submit",className:"btn primary",disabled:s,children:s?"Updating...":"Change Password"})})]})]})]})},ts=()=>{const[e,t]=(0,n.useState)(!0),[a,s]=(0,n.useState)(""),[r,i]=(0,n.useState)({name:"",email:"",phoneNumber:"",location:""});return(0,n.useEffect)(()=>{(async()=>{try{const e=localStorage.getItem("user");if(e){const t=JSON.parse(e);i({name:t.name||"",email:t.email||"",phoneNumber:t.phoneNumber||"",location:t.location||""})}const t=localStorage.getItem("token"),a=t?{Authorization:"Bearer ".concat(t)}:{},n=(await m.A.get("".concat("http://localhost:5000","/api/users/profile"),{headers:a})).data;i({name:n.name||"",email:n.email||"",phoneNumber:n.phoneNumber||"",location:n.location||""})}catch(n){var e,a;s((null===n||void 0===n||null===(e=n.response)||void 0===e||null===(a=e.data)||void 0===a?void 0:a.message)||"Failed to load profile")}finally{t(!1)}})()},[]),e?(0,x.jsx)("p",{children:"Loading profile..."}):(0,x.jsxs)("div",{className:"profile-container navy-theme",children:[(0,x.jsxs)("aside",{className:"profile-summary",children:[(0,x.jsxs)("div",{className:"summary-title",children:[(0,x.jsx)("i",{className:"fas fa-user-circle"}),(0,x.jsx)("span",{children:"Your Profile Details"})]}),(0,x.jsxs)("div",{className:"summary-item",children:[(0,x.jsx)("div",{className:"label",children:"Your Name"}),(0,x.jsx)("div",{className:"value",children:r.name||"--"})]}),(0,x.jsxs)("div",{className:"summary-item",children:[(0,x.jsx)("div",{className:"label",children:"Your Email"}),(0,x.jsx)("div",{className:"value",children:(0,x.jsx)("a",{href:"mailto:".concat(r.email),children:r.email||"--"})})]}),(0,x.jsxs)("div",{className:"summary-item",children:[(0,x.jsx)("div",{className:"label",children:"Your Mobile"}),(0,x.jsx)("div",{className:"value",children:r.phoneNumber||"--"})]}),(0,x.jsxs)("div",{className:"summary-item",children:[(0,x.jsx)("div",{className:"label",children:"Status"}),(0,x.jsx)("div",{className:"value active",children:"Active"})]})]}),(0,x.jsxs)("section",{className:"profile-content",children:[(0,x.jsx)("div",{className:"tabs",style:{borderBottom:"none",marginBottom:0},children:(0,x.jsx)("button",{className:"tab active",children:"Profile"})}),a&&(0,x.jsx)("div",{className:"alert error",children:a}),(0,x.jsxs)("div",{className:"profile-form",children:[(0,x.jsxs)("div",{className:"grid-2",children:[(0,x.jsxs)("div",{className:"form-row",children:[(0,x.jsx)("label",{children:"Name"}),(0,x.jsx)("input",{type:"text",value:r.name,disabled:!0})]}),(0,x.jsxs)("div",{className:"form-row",children:[(0,x.jsx)("label",{children:"Email"}),(0,x.jsx)("input",{type:"email",value:r.email,disabled:!0})]})]}),(0,x.jsxs)("div",{className:"grid-2",children:[(0,x.jsxs)("div",{className:"form-row",children:[(0,x.jsx)("label",{children:"Phone Number"}),(0,x.jsx)("input",{type:"tel",value:r.phoneNumber,disabled:!0})]}),(0,x.jsxs)("div",{className:"form-row",children:[(0,x.jsx)("label",{children:"Location"}),(0,x.jsx)("input",{type:"text",value:r.location,disabled:!0})]})]})]})]})]})},as="http://localhost:5000",ns=e=>e?{Authorization:"Bearer ".concat(e)}:{};function ss(){var e,t;const a="LATEX60",[s,r]=(0,n.useState)(null),[i,l]=(0,n.useState)([]),[o,c]=(0,n.useState)(""),[d,u]=(0,n.useState)(""),[h,p]=(0,n.useState)(""),[f,g]=(0,n.useState)(!1),[v,y]=(0,n.useState)(!1),b=(new Date).toISOString().split("T")[0],j=e=>{var t,a,n,s,r,i,l,o,c;if(!e)return{official:null,company:null,date:null};const d=Number(null!==(t=null!==(a=null!==(n=e.inr)&&void 0!==n?n:e.marketRate)&&void 0!==a?a:e.rate)&&void 0!==t?t:e.official),u=Number(null!==(s=null!==(r=null!==(i=e.company)&&void 0!==i?i:e.companyRate)&&void 0!==r?r:e.usd)&&void 0!==s?s:e.buyRate),h=null!==(l=null!==(o=null!==(c=e.effectiveDate)&&void 0!==c?c:e.createdAt)&&void 0!==o?o:e.date)&&void 0!==l?l:null;return{official:isNaN(d)?null:d,company:isNaN(u)?null:u,date:h}},w=(()=>{if(!s||!o)return null;const{company:e}=j(s);if(!e)return null;const t=parseFloat(o);if(isNaN(t)||t<=0)return null;const a=e*(t/100);return{perQuintal:a,perKg:a/100}})(),N=()=>{y(!0),async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"latex60";const{data:t}=await m.A.get("".concat(_e,"/api/rates/published/latest"),{params:{product:e}});return t}("latex60").then(e=>r(e)).catch(()=>r(null)).finally(()=>y(!1))};(0,n.useEffect)(()=>{N(),S();const e=setInterval(()=>{N(),S()},6e4);return()=>clearInterval(e)},[]);const S=()=>{g(!0),function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return m.A.get("".concat(as,"/api/daily-rates/history"),{params:e,headers:ns(t)})}({category:a,limit:50,from:d,to:h}).then(e=>{let{data:t}=e;return l(Array.isArray(t)?t:(null===t||void 0===t?void 0:t.rows)||[])}).catch(()=>l([])).finally(()=>g(!1))},k=(e,t)=>{const a=window.URL.createObjectURL(e),n=document.createElement("a");n.href=a,n.download=t,n.click(),window.URL.revokeObjectURL(a)};return(0,x.jsxs)("div",{className:"user-rate-history",children:[(0,x.jsxs)("div",{className:"header",style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,x.jsx)("h2",{style:{margin:0},children:"Live Rates"}),(0,x.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8},children:[s&&(0,x.jsxs)("span",{style:{color:"#64748b",fontSize:12},children:["Last updated: ",s.effectiveDate?new Date(s.effectiveDate).toLocaleString("en-IN"):"\u2014"]}),(0,x.jsx)("button",{className:"btn-secondary",onClick:()=>{N(),S()},disabled:v||f,children:v||f?"Refreshing\u2026":"Refresh"})]})]}),(0,x.jsxs)("div",{className:"dash-card",style:{maxWidth:720},children:[(0,x.jsxs)("div",{style:{marginBottom:12,fontWeight:600,display:"flex",alignItems:"center",justifyContent:"space-between",gap:12,flexWrap:"wrap"},children:[(0,x.jsx)("div",{children:"Category: LATEX60"}),(0,x.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:16,flexWrap:"wrap"},children:[(0,x.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:8,margin:0},children:[(0,x.jsx)("span",{style:{color:"#334155",fontWeight:600},children:"Effectve Price Calculator (DRC %)"}),(0,x.jsx)("input",{type:"number",min:0,max:100,step:"0.01",value:o,onChange:e=>c(e.target.value),placeholder:"Enter DRC",style:{width:100,padding:"4px 8px",borderRadius:"4px",border:"1px solid #cbd5e1"}})]}),w&&(0,x.jsxs)("div",{className:"effective-rate-box",children:[(0,x.jsxs)("div",{className:"rate-item",children:[(0,x.jsx)("span",{className:"label",children:"Rate / Kg"}),(0,x.jsxs)("span",{className:"value",children:["\u20b9",w.perKg.toFixed(2)]})]}),(0,x.jsx)("div",{className:"rate-item separator",children:"|"}),(0,x.jsxs)("div",{className:"rate-item",children:[(0,x.jsx)("span",{className:"label",children:"Rate / Quintal"}),(0,x.jsxs)("span",{className:"value",children:["\u20b9",w.perQuintal.toFixed(0)]})]})]})]})]}),s?(0,x.jsxs)("table",{className:"rates-table",style:{maxWidth:680},children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{children:"Date"}),(0,x.jsx)("th",{children:"Official Market Rate (INR)"}),(0,x.jsx)("th",{children:"Company Buying Rate"})]})}),(0,x.jsx)("tbody",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{children:new Date(j(s).date||Date.now()).toLocaleDateString("en-IN")}),(0,x.jsx)("td",{children:null!==(e=j(s).official)&&void 0!==e?e:"-"}),(0,x.jsx)("td",{children:null!==(t=j(s).company)&&void 0!==t?t:"-"})]})})]}):(0,x.jsx)("div",{className:"no-data",children:"No data"})]}),(0,x.jsxs)("div",{className:"dash-card",style:{marginTop:16,maxWidth:1e3},children:[(0,x.jsxs)("div",{style:{display:"flex",alignItems:"end",justifyContent:"space-between",gap:12,flexWrap:"wrap"},children:[(0,x.jsx)("h3",{style:{marginTop:0},children:"Recent History"}),(0,x.jsxs)("div",{style:{display:"flex",alignItems:"end",gap:8,flexWrap:"wrap"},children:[(0,x.jsxs)("label",{children:["From",(0,x.jsx)("input",{type:"date",value:d,max:b,onChange:e=>{const t=e.target.value;h&&h<t&&p(t),u(t)}})]}),(0,x.jsxs)("label",{children:["To",(0,x.jsx)("input",{type:"date",value:h,min:d,max:b,onChange:e=>{const t=e.target.value;p(d&&t<d?d:t)}})]}),(0,x.jsx)("button",{className:"btn",onClick:S,disabled:f,children:f?"Loading...":"Filter"}),(0,x.jsx)("button",{className:"btn-secondary",onClick:async()=>{try{const e=(await function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return m.A.get("".concat(as,"/api/daily-rates/export/csv"),{params:e,responseType:"blob",headers:ns(t)})}({category:a,from:d,to:h})).data;k(e,"latex60-rate-history.csv")}catch(e){}},children:"Export CSV"}),(0,x.jsx)("button",{className:"btn-secondary",onClick:async()=>{try{const e=(await function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return m.A.get("".concat(as,"/api/daily-rates/export/pdf"),{params:e,responseType:"blob",headers:ns(t)})}({category:a,from:d,to:h})).data;k(e,"latex60-rate-history.pdf")}catch(e){}},children:"Export PDF"})]})]}),f?(0,x.jsx)("p",{children:"Loading..."}):i&&i.length>0?(0,x.jsxs)("table",{className:"rates-table",children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{children:"Date"}),(0,x.jsx)("th",{children:"Category"}),(0,x.jsx)("th",{children:"Official Market Rate (INR)"}),(0,x.jsx)("th",{children:"Company Buying Rate"})]})}),(0,x.jsx)("tbody",{children:i.map(e=>{var t,a;const n=new Date(e.effectiveDate).toLocaleDateString("en-IN"),s=j(e);return(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{children:n}),(0,x.jsx)("td",{children:e.category}),(0,x.jsx)("td",{children:null!==(t=s.official)&&void 0!==t?t:"-"}),(0,x.jsx)("td",{children:null!==(a=s.company)&&void 0!==a?a:"-"})]},e._id)})})]}):(0,x.jsx)("div",{className:"no-data",children:"No recent history"})]})]})}const rs="http://localhost:5000",is=()=>{const[e,t]=(0,n.useState)(!0),[a]=(0,n.useState)(""),[s,r]=(0,n.useState)([]);(0,n.useEffect)(()=>{(async()=>{try{const e=localStorage.getItem("token"),t=e?{Authorization:"Bearer ".concat(e)}:{},a=(await m.A.get("".concat(rs,"/api/notifications"),{headers:t})).data,n=(Array.isArray(null===a||void 0===a?void 0:a.notifications)?a.notifications:Array.isArray(a)?a:[]).filter(e=>{const t=(e.category||"").toLowerCase(),a=(e.title||"").toLowerCase(),n=(e.message||"").toLowerCase();return!(a.includes("pickup")||a.includes("delivery")||a.includes("scheduled")||n.includes("pickup")||n.includes("delivery")||n.includes("scheduled"))&&(!!(t.includes("rate")||t.includes("price")||t.includes("live_rate"))||(!!(a.includes("rate")||a.includes("price")||a.includes("live rate"))||(!!(a.includes("approved")||a.includes("rejected")||a.includes("approval"))||!!(n.includes("approved")||n.includes("rejected")||n.includes("approval")))))});r(n)}catch(e){console.error("Error loading notifications:",e),r([])}finally{t(!1)}})()},[]);const l=()=>{const e=localStorage.getItem("token");return e?{Authorization:"Bearer ".concat(e)}:{}},o=e=>{if(!e)return null;const t={sampleId:"Sample ID",customerName:"Customer",calculatedAmount:"Amount",marketRate:"Market Rate",companyRate:"Company Rate",quantity:"Quantity",drcPercentage:"DRC %",requestId:"Request ID",barrelCount:"Barrel Count",customer:"Customer",receivedAt:"Received At",taskId:"Task ID",scheduledAt:"Scheduled At"};return Object.entries(e).filter(e=>{let[t,a]=e;return void 0!==a&&null!==a&&""!==a}).map(e=>{let[a,n]=e;return{label:t[a]||a.replace(/([A-Z])/g," $1").trim(),value:String(n)}})},c=e=>{if(!e)return"\ud83d\udccb";const t=e.toLowerCase();return t.includes("billing")||t.includes("latex")?"\ud83d\udcb0":t.includes("drc")||t.includes("test")?"\ud83e\uddea":t.includes("pickup")||t.includes("scheduled")?"\ud83d\udce6":t.includes("sample")?"\ud83d\udd2c":t.includes("delivery")?"\ud83d\ude9a":t.includes("payment")||t.includes("bill")?"\ud83d\udcb3":"\ud83d\udccb"},d=s.filter(e=>!e.read).length;return e?(0,x.jsx)("div",{className:"notif-container",children:(0,x.jsxs)("div",{className:"loading-state",children:[(0,x.jsx)("div",{className:"loading-spinner"}),(0,x.jsx)("p",{children:"Loading notifications..."})]})}):(0,x.jsxs)("div",{className:"notif-container",children:[(0,x.jsxs)("div",{className:"notif-header",children:[(0,x.jsxs)("div",{className:"header-content",children:[(0,x.jsx)("h1",{className:"notif-title",children:"Notifications"}),d>0&&(0,x.jsxs)("span",{className:"unread-badge",children:[d," new"]})]}),(0,x.jsx)("div",{className:"notif-actions",children:(0,x.jsx)("button",{className:"btn-clear",onClick:async()=>{const e=s;r([]);try{await m.A.post("".concat(rs,"/api/notifications/clear"),{},{headers:l()})}catch(t){r(e)}},disabled:0===s.length,children:"Clear All"})})]}),a&&(0,x.jsx)("div",{className:"alert error",children:a}),0===s.length?(0,x.jsxs)("div",{className:"empty-state",children:[(0,x.jsx)("div",{className:"empty-icon",children:"\ud83d\udd14"}),(0,x.jsx)("p",{className:"empty-text",children:"No notifications at the moment"}),(0,x.jsx)("p",{className:"empty-subtext",children:"You're all caught up!"})]}):(0,x.jsx)("div",{className:"notif-list",children:s.map(e=>(0,x.jsxs)("div",{className:"notif-item ".concat(e.read?"":"unread"),children:[(0,x.jsx)("div",{className:"notif-icon",children:c(e.title)}),(0,x.jsxs)("div",{className:"notif-content",children:[(0,x.jsx)("div",{className:"notif-item-title",children:e.title||"Notification"}),(0,x.jsx)("div",{className:"notif-message",children:e.message}),e.meta&&o(e.meta)&&o(e.meta).length>0&&(0,x.jsx)("div",{className:"notif-metadata",children:o(e.meta).map((e,t)=>(0,x.jsxs)("span",{className:"metadata-tag",children:[(0,x.jsxs)("strong",{children:[e.label,":"]})," ",e.value]},t))}),(0,x.jsx)("div",{className:"notif-time",children:new Date(e.createdAt||Date.now()).toLocaleString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})})]}),(0,x.jsxs)("div",{className:"notif-actions-col",children:[e.link&&(0,x.jsx)("button",{className:"btn-open",onClick:()=>window.location.href=e.link,children:"Open"}),!e.read&&(0,x.jsx)("button",{className:"btn-mark",onClick:()=>(async e=>{r(t=>t.map(t=>t._id===e||t.id===e?(0,i.A)((0,i.A)({},t),{},{read:!0}):t));try{const t=localStorage.getItem("token");await m.A.patch("".concat(rs,"/api/notifications/").concat(e,"/read"),{},{headers:{Authorization:"Bearer ".concat(t)}})}catch(t){r(t=>t.map(t=>t._id===e||t.id===e?(0,i.A)((0,i.A)({},t),{},{read:!1}):t))}})(e._id||e.id),title:"Mark as read",children:"Mark Read"})]})]},e._id||e.id))})]})},ls=()=>(0,x.jsxs)("div",{className:"user-dashboard",children:[(0,x.jsx)("h2",{children:"Customer Dashboard"}),(0,x.jsxs)("div",{className:"dash-grid",style:{display:"grid",gap:16,gridTemplateColumns:"repeat(auto-fill, minmax(220px, 1fr))"},children:[(0,x.jsxs)("div",{className:"dash-card",children:[(0,x.jsx)("h3",{children:"Profile"}),(0,x.jsx)("p",{children:"View and update your profile details."}),(0,x.jsx)(r.k2,{className:"btn",to:"/user/profile",children:"Go to Profile"})]}),(0,x.jsxs)("div",{className:"dash-card",children:[(0,x.jsx)("h3",{children:"Live Rate"}),(0,x.jsx)("p",{children:"Check current market rate and history."}),(0,x.jsx)(r.k2,{className:"btn",to:"/user/live-rate",children:"View Live Rate"})]}),(0,x.jsxs)("div",{className:"dash-card",children:[(0,x.jsx)("h3",{children:"Transactions & Bills"}),(0,x.jsx)("p",{children:"Browse past transactions and download bills."}),(0,x.jsx)(r.k2,{className:"btn",to:"/user/transactions",children:"View Transactions"})]}),(0,x.jsxs)("div",{className:"dash-card",children:[(0,x.jsx)("h3",{children:"Requests & Complaints"}),(0,x.jsx)("p",{children:"Request barrels or log an issue."}),(0,x.jsx)(r.k2,{className:"btn",to:"/user/requests",children:"Open Requests"})]}),(0,x.jsxs)("div",{className:"dash-card",children:[(0,x.jsx)("h3",{children:"Notifications"}),(0,x.jsx)("p",{children:"See recent alerts and updates."}),(0,x.jsx)(r.k2,{className:"btn",to:"/user/notifications",children:"View Notifications"})]})]})]}),os="http://localhost:5000",cs=async e=>{const t=localStorage.getItem("token"),a=t?{Authorization:"Bearer ".concat(t)}:{};if(!e||!e.type)throw new Error("type is required");if("BARREL"===e.type){const t={quantity:e.quantity,notes:e.notes||""};return(await m.A.post("".concat(os,"/api/requests/barrels"),t,{headers:a})).data}if("COMPLAINT"===e.type){const t={category:e.category||"other",title:e.subject,description:e.description||""};return(await m.A.post("".concat(os,"/api/requests/issues"),t,{headers:a})).data}throw new Error("Unsupported request type")},ds=()=>{const[e,t]=(0,n.useState)([]),[a,s]=(0,n.useState)(0),[l,o]=(0,n.useState)(1),[c]=(0,n.useState)(10),[d,u]=(0,n.useState)(""),[h,p]=(0,n.useState)(""),[f,g]=(0,n.useState)(!0),[v,y]=(0,n.useState)(null),[b,j]=(0,n.useState)({}),[w,N]=(0,n.useState)(!1),[S,k]=(0,n.useState)(!1),A=(e.reduce((e,t)=>e+(parseFloat(t.finalAmount)||0),0),e.filter(e=>!e.isVerified).length,(new Date).toISOString().split("T")[0]),C=async()=>{g(!0);try{const e=await async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=localStorage.getItem("token"),a=t?{Authorization:"Bearer ".concat(t)}:{};try{const t=(await m.A.get("".concat(os,"/api/customer/transactions"),{params:e,headers:a})).data;return Array.isArray(t)?{rows:t,total:t.length}:{rows:(null===t||void 0===t?void 0:t.rows)||[],total:(null===t||void 0===t?void 0:t.total)||0}}catch(n){return{rows:[],total:0}}}({page:l,pageSize:c,from:d,to:h});t(e.rows),s(e.total)}catch(e){t([]),s(0)}finally{g(!1)}};(0,n.useEffect)(()=>{C()},[l,c]);const _=()=>{y(null),j({})},L=async e=>{N(!0);try{await(async(e,t)=>{const a=localStorage.getItem("token"),n=a?{Authorization:"Bearer ".concat(a)}:{};try{return(await m.A.patch("".concat(os,"/api/customer/transactions/").concat(e),t,{headers:n})).data}catch(s){return(0,i.A)((0,i.A)({_id:e},t),{},{__simulated:!0})}})(e,b),t(t=>t.map(t=>t._id===e||t.id===e?(0,i.A)((0,i.A)({},t),b):t)),y(null),j({})}catch(a){alert((null===a||void 0===a?void 0:a.message)||"Failed to save changes")}finally{N(!1)}},T=async e=>{if(window.confirm("Publish changes? This will finalize the transaction.")){k(!0);try{await(async e=>{const t=localStorage.getItem("token"),a=t?{Authorization:"Bearer ".concat(t)}:{};try{return(await m.A.post("".concat(os,"/api/customer/transactions/").concat(e,"/publish"),{},{headers:a})).data}catch(n){return{_id:e,status:"published",__simulated:!0}}})(e),await C(),alert("Published successfully")}catch(t){alert((null===t||void 0===t?void 0:t.message)||"Failed to publish")}finally{k(!1)}}};return(0,x.jsxs)("div",{className:"transactions-page",children:[(0,x.jsxs)("div",{style:{marginBottom:"2rem"},children:[(0,x.jsxs)("h1",{style:{fontSize:"1.75rem",fontWeight:"700",color:"#0f172a",display:"flex",alignItems:"center",gap:"12px",margin:"0 0 0.5rem 0"},children:[(0,x.jsx)("i",{className:"fas fa-receipt",style:{color:"#8b5cf6"}}),"Transactions & Bills"]}),(0,x.jsx)("p",{style:{color:"#64748b",margin:0},children:"View and manage your payment history, bills, and recent activity."})]}),(0,x.jsx)("div",{className:"dash-card",style:{padding:"1.5rem",marginBottom:"1.5rem",background:"#fff"},children:(0,x.jsxs)("div",{style:{display:"flex",alignItems:"flex-end",gap:"1rem",flexWrap:"wrap"},children:[(0,x.jsxs)("div",{style:{flex:1,minWidth:"200px"},children:[(0,x.jsx)("label",{style:{fontSize:"0.875rem",fontWeight:"600",color:"#475569",marginBottom:"6px",display:"block"},children:"From Date"}),(0,x.jsxs)("div",{style:{position:"relative"},children:[(0,x.jsx)("i",{className:"fas fa-calendar-alt",style:{position:"absolute",left:"12px",top:"50%",transform:"translateY(-50%)",color:"#94a3b8"}}),(0,x.jsx)("input",{type:"date",value:d,max:A,onChange:e=>{const t=e.target.value;h&&h<t&&p(t),u(t)},style:{width:"100%",paddingLeft:"36px"}})]})]}),(0,x.jsxs)("div",{style:{flex:1,minWidth:"200px"},children:[(0,x.jsx)("label",{style:{fontSize:"0.875rem",fontWeight:"600",color:"#475569",marginBottom:"6px",display:"block"},children:"To Date"}),(0,x.jsxs)("div",{style:{position:"relative"},children:[(0,x.jsx)("i",{className:"fas fa-calendar-alt",style:{position:"absolute",left:"12px",top:"50%",transform:"translateY(-50%)",color:"#94a3b8"}}),(0,x.jsx)("input",{type:"date",value:h,min:d,max:A,onChange:e=>{const t=e.target.value;p(d&&t<d?d:t)},style:{width:"100%",paddingLeft:"36px"}})]})]}),(0,x.jsx)("div",{children:(0,x.jsxs)("button",{className:"btn",onClick:()=>{o(1),C()},style:{height:"42px",display:"flex",alignItems:"center",gap:"8px"},children:[(0,x.jsx)("i",{className:"fas fa-filter"})," Filter Results"]})})]})}),f?(0,x.jsxs)("div",{style:{textAlign:"center",padding:"4rem"},children:[(0,x.jsx)("i",{className:"fas fa-spinner fa-spin",style:{fontSize:"2rem",color:"#8b5cf6"}}),(0,x.jsx)("p",{style:{marginTop:"1rem",color:"#64748b"},children:"Loading transactions..."})]}):0===e.length?(0,x.jsxs)("div",{className:"dash-card",style:{textAlign:"center",padding:"4rem 2rem"},children:[(0,x.jsx)("div",{style:{width:"64px",height:"64px",background:"#f1f5f9",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 1.5rem auto"},children:(0,x.jsx)("i",{className:"fas fa-file-invoice",style:{fontSize:"1.75rem",color:"#94a3b8"}})}),(0,x.jsx)("h3",{style:{fontSize:"1.25rem",color:"#1e293b",margin:"0 0 0.5rem 0"},children:"No Transactions Found"}),(0,x.jsx)("p",{style:{color:"#64748b",maxWidth:"400px",margin:"0 auto"},children:"We couldn't find any transactions for the selected date range. Try adjusting your filters."})]}):(0,x.jsxs)("div",{className:"dash-card",style:{overflow:"hidden"},children:[(0,x.jsx)("div",{className:"table-wrap",children:(0,x.jsxs)("table",{className:"table",children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{children:"Date"}),(0,x.jsx)("th",{children:"Batch ID"}),(0,x.jsx)("th",{children:"Weight (kg)"}),(0,x.jsx)("th",{children:"DRC (%)"}),(0,x.jsx)("th",{children:"Amount (\u20b9)"}),(0,x.jsx)("th",{style:{textAlign:"right"},children:"Actions"})]})}),(0,x.jsx)("tbody",{children:e.map(e=>{var t,a;const n=e.id||e._id,s=v===n;return(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{children:(0,x.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,x.jsx)("div",{style:{width:"32px",height:"32px",background:"#f8fafc",borderRadius:"8px",display:"flex",alignItems:"center",justifyContent:"center",color:"#64748b"},children:(0,x.jsx)("i",{className:"fas fa-calendar-day",style:{fontSize:"0.8rem"}})}),(0,x.jsx)("span",{style:{fontWeight:"500"},children:new Date(e.date||e.createdAt).toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric"})})]})}),(0,x.jsx)("td",{children:(0,x.jsx)("span",{className:"badge",style:{background:"#f1f5f9",color:"#475569"},children:e.batchId||"#N/A"})}),(0,x.jsx)("td",{children:s?(0,x.jsx)("input",{type:"number",step:"0.01",value:b.weightKg,onChange:e=>j(t=>(0,i.A)((0,i.A)({},t),{},{weightKg:e.target.value})),style:{width:"100px"}}):(0,x.jsx)("span",{style:{fontWeight:"600"},children:null!==(t=null!==(a=e.weightKg)&&void 0!==a?a:e.weight)&&void 0!==t?t:"-"})}),(0,x.jsx)("td",{children:s?(0,x.jsx)("input",{type:"number",step:"0.01",value:b.drcPercent,onChange:e=>j(t=>(0,i.A)((0,i.A)({},t),{},{drcPercent:e.target.value})),style:{width:"80px"}}):(0,x.jsx)("span",{children:e.drcPercent?"".concat(e.drcPercent,"%"):"-"})}),(0,x.jsx)("td",{children:s?(0,x.jsx)("input",{type:"number",step:"0.01",value:b.finalAmount,onChange:e=>j(t=>(0,i.A)((0,i.A)({},t),{},{finalAmount:e.target.value})),style:{width:"100px"}}):(0,x.jsx)("span",{style:{color:"#16a34a",fontWeight:"700"},children:e.finalAmount?"\u20b9".concat(parseFloat(e.finalAmount).toLocaleString("en-IN")):"-"})}),(0,x.jsx)("td",{style:{textAlign:"right"},children:(0,x.jsx)("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px"},children:s?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("button",{className:"btn",disabled:w,onClick:()=>L(n),style:{padding:"6px 12px",fontSize:"0.85rem"},children:w?"...":"Save"}),(0,x.jsx)("button",{className:"btn-secondary",onClick:_,style:{padding:"6px 12px",fontSize:"0.85rem"},children:"Cancel"}),(0,x.jsx)("button",{className:"btn",style:{background:"#ef4444",borderColor:"#ef4444"},disabled:S,onClick:()=>T(n),children:S?"...":"Publish"})]}):(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(r.N_,{to:"/user/transactions/".concat(n),className:"btn-secondary",style:{padding:"6px 12px",fontSize:"0.85rem"},children:"View"}),(0,x.jsx)("button",{className:"btn-secondary",onClick:()=>(e=>{var t,a,n,s;window.confirm("Are you sure you want to edit this transaction?")&&(y(e.id||e._id),j({weightKg:null!==(t=null!==(a=e.weightKg)&&void 0!==a?a:e.weight)&&void 0!==t?t:"",drcPercent:null!==(n=e.drcPercent)&&void 0!==n?n:"",finalAmount:null!==(s=e.finalAmount)&&void 0!==s?s:""}))})(e),style:{padding:"6px 12px",fontSize:"0.85rem"},children:"Edit"})]})})})]},n)})})]})}),(0,x.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"1rem 1.5rem",borderTop:"1px solid #f1f5f9"},children:[(0,x.jsxs)("div",{style:{color:"#64748b",fontSize:"0.875rem"},children:["Showing page ",(0,x.jsx)("span",{style:{fontWeight:"600",color:"#0f172a"},children:l})]}),(0,x.jsxs)("div",{style:{display:"flex",gap:"8px"},children:[(0,x.jsxs)("button",{className:"btn-secondary",disabled:1===l,onClick:()=>o(e=>Math.max(1,e-1)),style:{opacity:1===l?.5:1},children:[(0,x.jsx)("i",{className:"fas fa-chevron-left",style:{marginRight:"6px"}})," Prev"]}),(0,x.jsxs)("button",{className:"btn-secondary",disabled:e.length<c||l*c>=a,onClick:()=>o(e=>e+1),style:{opacity:e.length<c||l*c>=a?.5:1},children:["Next ",(0,x.jsx)("i",{className:"fas fa-chevron-right",style:{marginLeft:"6px"}})]})]})]})]})]})},us=e=>{let{label:t,value:a}=e;return(0,x.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"160px 1fr",gap:8},children:[(0,x.jsx)("div",{style:{color:"#6b7280"},children:t}),(0,x.jsx)("div",{children:null!==a&&void 0!==a?a:"-"})]})},hs=()=>{var e,t,a,s,r;const{id:i}=(0,w.g)(),[l,o]=(0,n.useState)(null),[c,d]=(0,n.useState)(!0),[u,h]=(0,n.useState)("");(0,n.useEffect)(()=>{(async()=>{h(""),d(!0);try{const e=await(async e=>{const t=localStorage.getItem("token"),a=t?{Authorization:"Bearer ".concat(t)}:{};try{return(await m.A.get("".concat(os,"/api/customer/transactions/").concat(e),{headers:a})).data}catch(n){throw new Error("Transaction details not available")}})(i);o(e)}catch(e){h("Failed to load transaction")}finally{d(!1)}})()},[i]);if(c)return(0,x.jsx)("p",{children:"Loading..."});if(u)return(0,x.jsx)("div",{className:"alert error",children:u});if(!l)return(0,x.jsx)("div",{className:"no-data",children:"Not found"});const p=new Date(l.date||l.createdAt).toLocaleString("en-IN"),f=(null===(e=l.priceCalcMeta)||void 0===e?void 0:e.formula)||"DRC \xd7 Weight \xd7 Rate";return(0,x.jsxs)("div",{children:[(0,x.jsx)("h2",{children:"Transaction Detail"}),(0,x.jsxs)("div",{className:"dash-card",style:{maxWidth:720,display:"grid",gap:12},children:[(0,x.jsx)(us,{label:"Date",value:p}),(0,x.jsx)(us,{label:"Batch",value:l.batchId}),(0,x.jsx)(us,{label:"Weight (kg)",value:null!==(t=l.weightKg)&&void 0!==t?t:l.weight}),(0,x.jsx)(us,{label:"DRC (%)",value:l.drcPercent}),(0,x.jsx)(us,{label:"Agreed Rate",value:null!==(a=l.agreedRatePerKg)&&void 0!==a?a:"-"}),(0,x.jsx)(us,{label:"Market Rate",value:null!==(s=l.marketRatePerKg)&&void 0!==s?s:"-"}),(0,x.jsx)(us,{label:"Amount",value:null!==(r=l.finalAmount)&&void 0!==r?r:"-"})]}),(0,x.jsxs)("div",{className:"dash-card",style:{marginTop:16},children:[(0,x.jsx)("h3",{style:{marginTop:0},children:"Price Calculation"}),(0,x.jsx)("p",{children:f})]}),l.labReport&&(0,x.jsxs)("div",{className:"dash-card",style:{marginTop:16},children:[(0,x.jsx)("h3",{style:{marginTop:0},children:"Lab Report"}),(0,x.jsx)(us,{label:"DRC (%)",value:l.labReport.drcPercent}),(0,x.jsx)(us,{label:"Moisture",value:l.labReport.moisture}),(0,x.jsx)(us,{label:"Impurities",value:l.labReport.impurities}),l.labReport.reportUrl&&(0,x.jsx)("a",{className:"btn-secondary",href:l.labReport.reportUrl,target:"_blank",rel:"noreferrer",children:"Open Report"})]}),(0,x.jsx)("div",{style:{marginTop:16},children:(0,x.jsx)("button",{className:"btn",onClick:async()=>{try{((e,t)=>{const a=window.URL.createObjectURL(e),n=document.createElement("a");n.href=a,n.download=t,n.click(),window.URL.revokeObjectURL(a)})(await(async e=>{const t=localStorage.getItem("token"),a=t?{Authorization:"Bearer ".concat(t)}:{};try{return(await m.A.get("".concat(os,"/api/customer/bills/").concat(e,"/pdf"),{headers:a,responseType:"blob"})).data}catch(n){throw new Error("Bill PDF download not available")}})(i),"bill-".concat(i,".pdf"))}catch(e){alert("Failed to download PDF")}},children:"Download Bill (PDF)"})})]})},ps={type:"BARREL",quantity:1,notes:""},fs={name:"",phone:"",barrelCount:1,notes:""},ms={type:"COMPLAINT",subject:"",category:"other",description:""},xs=()=>{const{user:e,validateToken:t}=y(),[a,s]=(0,n.useState)("BARREL"),[r,l]=(0,n.useState)(ps),[o,c]=(0,n.useState)(fs),[d,u]=(0,n.useState)(ms),[h,p]=(0,n.useState)(!1),[f,g]=(0,n.useState)([]),[v,b]=(0,n.useState)(!0),[j,w]=(0,n.useState)(""),[N,S]=(0,n.useState)({lat:null,lng:null,accuracy:null}),[k,A]=(0,n.useState)(""),C=Ae(),[_,L]=(0,n.useState)(""),[T,E]=(0,n.useState)({allowance:0,used:0,remaining:1/0}),[D,P]=(0,n.useState)(0),R=async()=>{b(!0);try{g(await async function(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const a=localStorage.getItem("token"),n=a?{Authorization:"Bearer ".concat(a)}:{},[s,r,i]=await Promise.all([m.A.get("".concat(os,"/api/requests/barrels/my"),{params:t,headers:n}).catch(()=>({data:[]})),m.A.get("".concat(os,"/api/requests/issues/my"),{params:t,headers:n}).catch(()=>({data:[]})),m.A.get("".concat(os,"/api/delivery/barrels/intake/my"),{params:t,headers:n}).catch(()=>({data:[]}))]),l=Array.isArray(s.data)?s.data:[],o=Array.isArray(r.data)?r.data:[],c=Array.isArray(null===(e=i.data)||void 0===e?void 0:e.items)?i.data.items:[];return[...l.map(e=>({_id:e._id,createdAt:e.createdAt,type:"BARREL",quantity:e.quantity,notes:e.notes,status:e.status||"pending"})),...c.map(e=>({_id:e._id,createdAt:e.createdAt,type:"SELL_BARRELS",barrelCount:e.barrelCount,companyBarrel:e.companyBarrel,subject:"Sell ".concat(e.barrelCount," barrel(s) - ").concat(e.name),notes:e.notes,status:e.status||"pending"})),...o.map(e=>({_id:e._id,createdAt:e.createdAt,type:"COMPLAINT",subject:e.title,category:e.category,description:e.description,status:e.status||"open"}))].sort((e,t)=>new Date(t.createdAt)-new Date(e.createdAt))}())}catch(e){g([])}finally{b(!1)}},I=async()=>{try{var e,t,a;const n=await(async()=>{const e=localStorage.getItem("token"),t=e?{Authorization:"Bearer ".concat(e)}:{};return(await m.A.get("".concat(os,"/api/delivery/barrels/allowance/my"),{headers:t})).data||{allowance:0,used:0,remaining:1/0}})();E({allowance:Number(null!==(e=n.allowance)&&void 0!==e?e:0),used:Number(null!==(t=n.used)&&void 0!==t?t:0),remaining:n.remaining===1/0?1/0:Number(null!==(a=n.remaining)&&void 0!==a?a:0)})}catch(n){}},B=async()=>{try{const e=await(async()=>{const e=localStorage.getItem("token"),t=e?{Authorization:"Bearer ".concat(e)}:{};try{const e=(await m.A.get("".concat(os,"/api/barrels/my-assigned"),{headers:t})).data||{};return"number"===typeof e.count?e.count:Array.isArray(e.records)?e.records.length:0}catch(a){return 0}})();P(Number(e)||0)}catch(e){P(0)}};(0,n.useEffect)(()=>{R(),I(),B()},[]),(0,n.useEffect)(()=>{"SELL_BARRELS"===a&&B()},[a]),(0,n.useEffect)(()=>{const a=e=>String((null===e||void 0===e?void 0:e.provider)||(null===e||void 0===e?void 0:e.authProvider)||(null===e||void 0===e?void 0:e.loginProvider)||(null===e||void 0===e?void 0:e.loginType)||"").toLowerCase().includes("google");if(e){var n,s;const r=(null===e||void 0===e?void 0:e.name)||(null===e||void 0===e?void 0:e.fullName)||(null===e||void 0===e||null===(n=e.profile)||void 0===n?void 0:n.name)||"",l=(null===e||void 0===e?void 0:e.phoneNumber)||(null===e||void 0===e?void 0:e.phone)||(null===e||void 0===e?void 0:e.mobile)||(null===e||void 0===e||null===(s=e.profile)||void 0===s?void 0:s.phone)||"",o=a(e);return c(e=>(0,i.A)((0,i.A)({},e),{},{name:r||e.name,phone:o?"":l||e.phone})),void(o||(l||"").trim()||"function"!==typeof t||t().then(e=>{var t;const a=(null===e||void 0===e?void 0:e.phoneNumber)||(null===e||void 0===e?void 0:e.phone)||(null===e||void 0===e?void 0:e.mobile)||(null===e||void 0===e||null===(t=e.profile)||void 0===t?void 0:t.phone)||"";a&&c(e=>(0,i.A)((0,i.A)({},e),{},{phone:a}))}).catch(()=>{}))}try{let e=null;const t=localStorage.getItem("user");if(t)e=JSON.parse(t);else{const t=localStorage.getItem("profile")||localStorage.getItem("userProfile")||localStorage.getItem("auth");if(t)try{const a=JSON.parse(t);e=(null===a||void 0===a?void 0:a.user)||a}catch(x){e=null}}if(e){var r,l,o,d,u,h,p,f,m;const t=(null===(r=e)||void 0===r?void 0:r.name)||(null===(l=e)||void 0===l?void 0:l.fullName)||(null===(o=e)||void 0===o||null===(d=o.profile)||void 0===d?void 0:d.name)||"",n=(null===(u=e)||void 0===u?void 0:u.phoneNumber)||(null===(h=e)||void 0===h?void 0:h.phone)||(null===(p=e)||void 0===p?void 0:p.mobile)||(null===(f=e)||void 0===f||null===(m=f.profile)||void 0===m?void 0:m.phone)||"",s=a(e);c(e=>(0,i.A)((0,i.A)({},e),{},{name:t||e.name,phone:s?"":n||e.phone}))}}catch(g){}},[e]);return(0,x.jsxs)("div",{children:[(0,x.jsx)("h2",{children:"Requests & Complaints"}),(0,x.jsxs)("div",{className:"tabs",style:{display:"flex",gap:8,marginBottom:12},children:[(0,x.jsx)("button",{className:"btn-secondary ".concat("BARREL"===a?"active":""),onClick:()=>s("BARREL"),children:"New Barrel"}),(0,x.jsx)("button",{className:"btn-secondary ".concat("SELL_BARRELS"===a?"active":""),onClick:()=>s("SELL_BARRELS"),children:"Sell Barrels"}),(0,x.jsx)("button",{className:"btn-secondary ".concat("COMPLAINT"===a?"active":""),onClick:()=>s("COMPLAINT"),children:"Complaint"})]}),j&&(0,x.jsx)("div",{className:"alert error",children:j}),_&&(0,x.jsx)("div",{className:"alert",style:{color:"#0a7"},children:_}),"BARREL"===a?(0,x.jsxs)("div",{className:"dash-card",style:{display:"grid",gap:12},children:[(0,x.jsxs)("label",{children:["Quantity (Max: 50 barrels)",(0,x.jsx)("input",{type:"number",min:1,max:50,step:1,value:r.quantity,onChange:e=>l((0,i.A)((0,i.A)({},r),{},{quantity:e.target.value}))})]}),(0,x.jsxs)("label",{children:["Notes (optional)",(0,x.jsx)("textarea",{value:r.notes,onChange:e=>l((0,i.A)((0,i.A)({},r),{},{notes:e.target.value}))})]}),(0,x.jsx)("button",{className:"btn",onClick:async()=>{p(!0),w("");try{const e=Number(r.quantity)||1;if(e<1||e>50)return w("Quantity must be between 1 and 50 barrels"),void p(!1);await cs({type:"BARREL",quantity:e,notes:r.notes}),l(ps),await R()}catch(e){w("Failed to submit request")}finally{p(!1)}},disabled:h,children:h?"Submitting...":"Submit Request"})]}):"SELL_BARRELS"===a?(0,x.jsxs)("div",{className:"dash-card",style:{display:"grid",gap:12},children:[(0,x.jsxs)("div",{style:{display:"grid",gap:12,gridTemplateColumns:"1fr 1fr"},children:[(0,x.jsxs)("label",{children:["Name",(0,x.jsx)("input",{type:"text",value:o.name,onChange:e=>c((0,i.A)((0,i.A)({},o),{},{name:e.target.value}))})]}),(0,x.jsxs)("label",{children:["Phone",(0,x.jsx)("input",{type:"tel",value:o.phone,onChange:e=>c((0,i.A)((0,i.A)({},o),{},{phone:e.target.value}))})]})]}),(0,x.jsxs)("label",{children:["Barrel Count",(0,x.jsx)("input",{type:"number",min:1,step:1,value:o.barrelCount,onChange:e=>c((0,i.A)((0,i.A)({},o),{},{barrelCount:e.target.value}))})]}),(0,x.jsx)("div",{style:{display:"flex",gap:12,color:"#2563eb",fontSize:13},children:(0,x.jsxs)("span",{children:["Company Barrels: ",D]})}),(0,x.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12},children:[(0,x.jsx)("button",{type:"button",onClick:()=>{navigator&&"geolocation"in navigator?(A("Requesting location..."),navigator.geolocation.getCurrentPosition(e=>{const{latitude:t,longitude:a,accuracy:n}=e.coords;S({lat:t,lng:a,accuracy:n}),A("Location captured (\xb1".concat(Math.round(n),"m)"))},e=>{A((null===e||void 0===e?void 0:e.message)||"Failed to get location")},{enableHighAccuracy:!0,timeout:15e3,maximumAge:0})):A("Geolocation not supported by this browser.")},children:"Use my location"}),(0,x.jsx)("span",{style:{color:"#555"},children:k}),N.lat&&N.lng&&(0,x.jsxs)("span",{style:{fontSize:12,color:"#2563eb"},children:["Lat: ",N.lat.toFixed(5),", Lng: ",N.lng.toFixed(5)]})]}),(0,x.jsxs)("label",{children:["Notes (optional)",(0,x.jsx)("textarea",{value:o.notes,onChange:e=>c((0,i.A)((0,i.A)({},o),{},{notes:e.target.value}))})]}),(0,x.jsx)("button",{className:"btn",onClick:async()=>{p(!0),w("");try{const e=Number(o.barrelCount);if(o.name&&o.phone&&e)if(e<1)w("Barrel count must be at least 1");else if(e>D)w("Requested barrels (".concat(e,") exceed your company barrels (").concat(D,")."));else{if(!await C("Confirm submission","Are you sure? Please wait for manager verification."))return void p(!1);await(async e=>{let{name:t,phone:a,barrelCount:n,notes:s,location:r,locationAccuracy:i}=e;const l=localStorage.getItem("token"),o=l?{Authorization:"Bearer ".concat(l)}:{},c={customerName:t,customerPhone:a,barrelCount:Number(n),notes:s};return r&&void 0!==i&&(c.location=r,c.locationAccuracy=i),(await m.A.post("".concat(os,"/api/delivery/barrels/intake"),c,{headers:o})).data})((0,i.A)({name:String(o.name).trim(),phone:String(o.phone).trim(),barrelCount:e,notes:o.notes||""},N.lat&&N.lng?{location:{type:"Point",coordinates:[N.lng,N.lat]},locationAccuracy:N.accuracy}:{})),c(fs),S({lat:null,lng:null,accuracy:null}),A(""),L("Submitted. Please wait for manager verification."),await Promise.all([R(),I(),B()])}else w("Please enter name, phone and barrel count")}catch(e){w((null===e||void 0===e?void 0:e.message)||"Failed to submit sell barrels request")}finally{p(!1)}},disabled:h,children:h?"Submitting...":"Submit Request"})]}):(0,x.jsxs)("div",{className:"dash-card",style:{display:"grid",gap:12},children:[(0,x.jsxs)("label",{children:["Subject",(0,x.jsx)("input",{type:"text",value:d.subject,onChange:e=>u((0,i.A)((0,i.A)({},d),{},{subject:e.target.value}))})]}),(0,x.jsxs)("label",{children:["Category",(0,x.jsxs)("select",{value:d.category,onChange:e=>u((0,i.A)((0,i.A)({},d),{},{category:e.target.value})),children:[(0,x.jsx)("option",{value:"other",children:"Pickup Delay"}),(0,x.jsx)("option",{value:"other",children:"Billing Discrepancy"}),(0,x.jsx)("option",{value:"barrel",children:"Barrel Damage"}),(0,x.jsx)("option",{value:"other",children:"Other"})]})]}),(0,x.jsxs)("label",{children:["Description",(0,x.jsx)("textarea",{rows:4,value:d.description,onChange:e=>u((0,i.A)((0,i.A)({},d),{},{description:e.target.value}))})]}),(0,x.jsx)("button",{className:"btn",onClick:async()=>{p(!0),w("");try{await cs({type:"COMPLAINT",subject:d.subject,category:d.category,description:d.description}),u(ms),await R()}catch(e){w("Failed to submit complaint")}finally{p(!1)}},disabled:h,children:h?"Submitting...":"Submit Complaint"})]}),(0,x.jsxs)("div",{className:"dash-card",style:{marginTop:16},children:[(0,x.jsx)("h3",{style:{marginTop:0},children:"My Requests"}),(0,x.jsxs)("div",{style:{display:"flex",gap:16,flexWrap:"wrap",marginBottom:8},children:[(0,x.jsxs)("span",{style:{background:"#eef6ff",color:"#2563eb",padding:"6px 10px",borderRadius:6},children:["Total Sell Barrels: ",f.filter(e=>"SELL_BARRELS"===e.type).reduce((e,t)=>e+(Number(t.barrelCount)||0),0)]}),(0,x.jsxs)("span",{style:{background:"#f1f5f9",color:"#334155",padding:"6px 10px",borderRadius:6},children:["Pending Sell Barrels: ",f.filter(e=>"SELL_BARRELS"===e.type&&"pending"===String(e.status||"").toLowerCase()).reduce((e,t)=>e+(Number(t.barrelCount)||0),0)]})]}),v?(0,x.jsx)("p",{children:"Loading..."}):0===f.length?(0,x.jsx)("div",{className:"no-data",children:"No requests"}):(0,x.jsx)("div",{className:"table-wrap",children:(0,x.jsxs)("table",{className:"table",children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{children:"Created"}),(0,x.jsx)("th",{children:"Type"}),(0,x.jsx)("th",{children:"Barrels"}),(0,x.jsx)("th",{children:"Subject/Notes"}),(0,x.jsx)("th",{children:"Status"})]})}),(0,x.jsx)("tbody",{children:f.map(e=>{var t,a;return(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{children:new Date(e.createdAt||Date.now()).toLocaleString("en-IN")}),(0,x.jsx)("td",{children:"SELL_BARRELS"===e.type?"SELL BARRELS":e.type}),(0,x.jsx)("td",{children:"SELL_BARRELS"===e.type?null!==(t=null!==(a=e.barrelCount)&&void 0!==a?a:e.count)&&void 0!==t?t:"-":"BARREL"===e.type?e.quantity||1:"-"}),(0,x.jsx)("td",{children:"BARREL"===e.type?e.notes||"-":e.subject||e.notes||"-"}),(0,x.jsx)("td",{children:(0,x.jsx)("span",{className:"badge status-".concat((e.status||"pending").toLowerCase().replace(/\s+/g,"-")),children:e.status||"pending"})})]},e.id||e._id)})})]})})]})]})},gs="http://localhost:5000";function vs(){const e=localStorage.getItem("token");return e?{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}:{"Content-Type":"application/json"}}const ys=()=>{const[e,t]=(0,n.useState)([]),[a,s]=(0,n.useState)(!1),[r,l]=(0,n.useState)(""),[o,c]=(0,n.useState)(""),[d,u]=(0,n.useState)({totalVolumeKg:"",notes:""}),[h,p]=(0,n.useState)({lat:null,lng:null,accuracy:null}),[f,m]=(0,n.useState)(""),g=e=>{if(!e)return"-";try{const t=new Date(e);return Number.isNaN(t.getTime())?"-":t.toLocaleString()}catch(t){return"-"}},v=async()=>{s(!0),l(""),c("");try{const e=await fetch("".concat(gs,"/api/sell-requests/my"),{headers:vs()});if(!e.ok)throw new Error("Failed to load (".concat(e.status,")"));const a=await e.json();t(Array.isArray(a)?a:[])}catch(e){l(((null===e||void 0===e?void 0:e.message)||"Failed to load").replace(/<[^>]*>/g,"")),t([])}finally{s(!1)}};(0,n.useEffect)(()=>{v()},[]);return(0,x.jsxs)("div",{style:{padding:16},children:[(0,x.jsx)("h2",{children:"Sell Latex"}),r&&(0,x.jsx)("div",{style:{color:"tomato",marginBottom:8},children:r}),o&&(0,x.jsx)("div",{style:{color:"#0a7"},children:o}),(0,x.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),l(""),c("");const t=Number(d.totalVolumeKg);if(!t||t<=0)l("Please enter a valid volume in Kg.");else try{const e=(0,i.A)({totalVolumeKg:t,notes:d.notes||void 0},h.lat&&h.lng?{location:{type:"Point",coordinates:[h.lng,h.lat]},locationAccuracy:h.accuracy}:{}),a=await fetch("".concat(gs,"/api/sell-requests"),{method:"POST",headers:vs(),body:JSON.stringify(e)});if(!a.ok){const e=await a.text();if(400===a.status)return void l(e.replace(/<[^>]*>/g,"")||"Bad request");if(401===a.status)return void l("You are not authenticated. Please login again.");throw new Error("Submit failed (".concat(a.status,")"))}u({totalVolumeKg:"",notes:""}),c("Request submitted successfully."),await v()}catch(e){l(((null===e||void 0===e?void 0:e.message)||"Failed to submit").replace(/<[^>]*>/g,""))}},style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12,maxWidth:720},children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{children:"Volume (Kg)"}),(0,x.jsx)("input",{type:"number",min:"1",step:"0.01",value:d.totalVolumeKg,onChange:e=>u(t=>(0,i.A)((0,i.A)({},t),{},{totalVolumeKg:e.target.value})),required:!0})]}),(0,x.jsxs)("div",{style:{gridColumn:"1 / -1"},children:[(0,x.jsx)("label",{children:"Notes"}),(0,x.jsx)("textarea",{rows:3,value:d.notes,onChange:e=>u(t=>(0,i.A)((0,i.A)({},t),{},{notes:e.target.value})),placeholder:"Optional"})]}),(0,x.jsxs)("div",{style:{gridColumn:"1 / -1",display:"flex",alignItems:"center",gap:12},children:[(0,x.jsx)("button",{type:"button",onClick:()=>{navigator&&"geolocation"in navigator?(m("Requesting location..."),navigator.geolocation.getCurrentPosition(e=>{const{latitude:t,longitude:a,accuracy:n}=e.coords;p({lat:t,lng:a,accuracy:n}),m("Location captured (\xb1".concat(Math.round(n),"m)"))},e=>{m((null===e||void 0===e?void 0:e.message)||"Failed to get location")},{enableHighAccuracy:!0,timeout:15e3,maximumAge:0})):m("Geolocation not supported by this browser.")},children:"Use my location"}),(0,x.jsx)("span",{style:{color:"#555"},children:f}),h.lat&&h.lng&&(0,x.jsxs)("span",{style:{fontSize:12,color:"#2563eb"},children:["Lat: ",h.lat.toFixed(5),", Lng: ",h.lng.toFixed(5)]})]}),(0,x.jsx)("div",{style:{gridColumn:"1 / -1"},children:(0,x.jsx)("button",{className:"btn",type:"submit",children:"Submit Request"})})]}),(0,x.jsxs)("div",{style:{marginTop:16,overflowX:"auto"},children:[(0,x.jsx)("h3",{children:"My Requests"}),a?(0,x.jsx)("div",{children:"Loading..."}):(0,x.jsxs)("table",{className:"dashboard-table",style:{minWidth:880},children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{children:"Status"}),(0,x.jsx)("th",{children:"Volume (Kg)"}),(0,x.jsx)("th",{children:"DRC%"}),(0,x.jsx)("th",{children:"Rate"}),(0,x.jsx)("th",{children:"Amount"}),(0,x.jsx)("th",{children:"Requested"}),(0,x.jsx)("th",{children:"Invoice"})]})}),(0,x.jsxs)("tbody",{children:[e.map(e=>{var t,a,n,s;return(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{children:e.status}),(0,x.jsx)("td",{children:null!==(t=e.totalVolumeKg)&&void 0!==t?t:"-"}),(0,x.jsx)("td",{children:null!==(a=e.drcPct)&&void 0!==a?a:"-"}),(0,x.jsx)("td",{children:null!==(n=e.marketRate)&&void 0!==n?n:"-"}),(0,x.jsx)("td",{children:null!==(s=e.amount)&&void 0!==s?s:"-"}),(0,x.jsx)("td",{children:g(e.requestedAt||e.createdAt)}),(0,x.jsx)("td",{children:e.invoicePdfUrl&&"VERIFIED"===e.status?(0,x.jsx)("a",{href:e.invoicePdfUrl,target:"_blank",rel:"noreferrer",children:"Download"}):"-"})]},e._id)}),0===e.length&&!a&&(0,x.jsx)("tr",{children:(0,x.jsx)("td",{colSpan:7,style:{textAlign:"center",color:"#6b7280"},children:"No requests yet."})})]})]})]})]})},bs=()=>{const{user:e}=y(),[t,a]=(0,n.useState)(!0),[s,i]=(0,n.useState)([]);return(0,n.useEffect)(()=>{setTimeout(()=>{i([{id:1,type:"sell_request",title:"Sell Barrel Request",description:"Submit barrels for sale and get paid",icon:"fas fa-truck-loading",link:"/user/requests",color:"#10b981",status:"available"},{id:2,type:"barrel_request",title:"Request Barrels",description:"Request empty barrels for latex collection",icon:"fas fa-box-open",link:"/user/requests",color:"#3b82f6",status:"available"},{id:3,type:"view_rate",title:"View Live Rate",description:"Check current market rate for latex",icon:"fas fa-chart-line",link:"/user/live-rate",color:"#f59e0b",status:"available"},{id:4,type:"transactions",title:"View Transactions",description:"Browse your payment history and bills",icon:"fas fa-receipt",link:"/user/transactions",color:"#8b5cf6",status:"available"},{id:5,type:"complaint",title:"Report Issue",description:"Submit a complaint or report a problem",icon:"fas fa-exclamation-triangle",link:"/user/requests",color:"#ef4444",status:"available"},{id:6,type:"profile",title:"Update Profile",description:"View and edit your profile information",icon:"fas fa-user-edit",link:"/user/profile",color:"#06b6d4",status:"available"}]),a(!1)},500)},[]),t?(0,x.jsx)("div",{className:"my-actions-page",style:{padding:"2rem"},children:(0,x.jsxs)("div",{style:{textAlign:"center",padding:"3rem"},children:[(0,x.jsx)("i",{className:"fas fa-spinner fa-spin",style:{fontSize:"2rem",color:"#10b981"}}),(0,x.jsx)("p",{style:{marginTop:"1rem",color:"#6b7280"},children:"Loading your actions..."})]})}):(0,x.jsxs)("div",{className:"my-actions-page",style:{padding:"1.5rem 2rem"},children:[(0,x.jsxs)("div",{style:{marginBottom:"2rem"},children:[(0,x.jsxs)("h1",{style:{fontSize:"1.75rem",fontWeight:"700",color:"#0f172a",margin:"0 0 0.5rem 0",display:"flex",alignItems:"center",gap:"12px"},children:[(0,x.jsx)("i",{className:"fas fa-tasks",style:{color:"#10b981"}}),"My Actions"]}),(0,x.jsxs)("p",{style:{color:"#64748b",margin:0,fontSize:"0.95rem"},children:["Welcome back, ",(0,x.jsx)("strong",{children:(null===e||void 0===e?void 0:e.name)||"Customer"}),"! Here's what you can do:"]})]}),(0,x.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(280px, 1fr))",gap:"1.25rem"},children:s.map(e=>(0,x.jsx)(r.k2,{to:e.link,style:{textDecoration:"none"},children:(0,x.jsxs)("div",{className:"action-card",style:{background:"#ffffff",border:"1px solid #e5e7eb",borderRadius:"14px",padding:"1.5rem",cursor:"pointer",transition:"all 0.2s ease",boxShadow:"0 2px 8px rgba(0,0,0,0.04)",display:"flex",flexDirection:"column",gap:"12px",position:"relative",overflow:"hidden"},onMouseEnter:t=>{t.currentTarget.style.transform="translateY(-4px)",t.currentTarget.style.boxShadow="0 12px 24px rgba(0,0,0,0.08)",t.currentTarget.style.borderColor=e.color},onMouseLeave:e=>{e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="0 2px 8px rgba(0,0,0,0.04)",e.currentTarget.style.borderColor="#e5e7eb"},children:[(0,x.jsx)("div",{style:{width:"48px",height:"48px",borderRadius:"12px",background:"".concat(e.color,"15"),display:"flex",alignItems:"center",justifyContent:"center"},children:(0,x.jsx)("i",{className:e.icon,style:{fontSize:"1.25rem",color:e.color}})}),(0,x.jsxs)("div",{children:[(0,x.jsx)("h3",{style:{fontSize:"1.1rem",fontWeight:"600",color:"#1f2937",margin:"0 0 6px 0"},children:e.title}),(0,x.jsx)("p",{style:{fontSize:"0.875rem",color:"#6b7280",margin:0,lineHeight:"1.5"},children:e.description})]}),(0,x.jsx)("div",{style:{position:"absolute",right:"1rem",top:"50%",transform:"translateY(-50%)",color:"#cbd5e1",fontSize:"1rem"},children:(0,x.jsx)("i",{className:"fas fa-chevron-right"})})]})},e.id))}),(0,x.jsxs)("div",{style:{marginTop:"2rem",padding:"1.5rem",background:"linear-gradient(135deg, #10b981 0%, #059669 100%)",borderRadius:"14px",color:"white"},children:[(0,x.jsxs)("h3",{style:{margin:"0 0 1rem 0",fontSize:"1.1rem",fontWeight:"600"},children:[(0,x.jsx)("i",{className:"fas fa-info-circle",style:{marginRight:"8px"}}),"Quick Tips"]}),(0,x.jsxs)("ul",{style:{margin:0,paddingLeft:"1.25rem",lineHeight:"1.8"},children:[(0,x.jsxs)("li",{children:["Check the ",(0,x.jsx)("strong",{children:"Live Rate"})," before submitting sell requests"]}),(0,x.jsx)("li",{children:"Keep your phone number updated for notifications"}),(0,x.jsxs)("li",{children:["Track your request status in ",(0,x.jsx)("strong",{children:"Transactions"})]})]})]})]})},js=e=>{let{children:t}=e;const{isAuthenticated:a,loading:n,user:s}=y();return n?(0,x.jsx)("div",{children:"Loading..."}):a&&s?"field_staff"!==s.role&&"admin"!==s.role?(0,x.jsx)(w.C5,{to:"/user"}):t:(0,x.jsx)(w.C5,{to:"/login"})},ws=e=>{let{children:t}=e;const a=(0,w.Zp)(),{logout:s,user:i}=y(),[l,o]=(0,n.useState)(!1),c=(0,n.useRef)(null);(0,n.useEffect)(()=>{const e=e=>{c.current&&!c.current.contains(e.target)&&o(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);return(0,x.jsxs)("div",{className:"dashboard-container",children:[(0,x.jsxs)("aside",{className:"sidebar",children:[(0,x.jsx)("div",{className:"sidebar-header",children:"Staff Panel"}),(0,x.jsxs)("ul",{className:"sidebar-nav",children:[(0,x.jsx)("li",{className:"nav-item",children:(0,x.jsxs)(r.k2,{to:"/staff/attendance",children:[(0,x.jsx)("i",{className:"fas fa-user-clock nav-icon"})," Attendance"]})}),(0,x.jsx)("li",{className:"nav-item",children:(0,x.jsxs)(r.k2,{to:"/staff/schedule",children:[(0,x.jsx)("i",{className:"fas fa-calendar-alt nav-icon"})," My Schedule"]})}),(0,x.jsx)("li",{className:"nav-item",children:(0,x.jsxs)(r.k2,{to:"/staff/leave",children:[(0,x.jsx)("i",{className:"fas fa-calendar-days nav-icon"})," Apply Leave"]})}),(0,x.jsx)("li",{className:"nav-item",children:(0,x.jsxs)(r.k2,{to:"/staff/salary",children:[(0,x.jsx)("i",{className:"fas fa-wallet nav-icon"})," Salary Details"]})}),(0,x.jsx)("li",{className:"nav-item",children:(0,x.jsxs)(r.k2,{to:"/staff/issues",children:[(0,x.jsx)("i",{className:"fas fa-exclamation-circle nav-icon"})," Raise Issue"]})}),(0,x.jsx)("li",{className:"nav-item",children:(0,x.jsxs)(r.k2,{to:"/staff/return-barrels",children:[(0,x.jsx)("i",{className:"fas fa-undo nav-icon"})," Return Barrel"]})})]})]}),(0,x.jsxs)("div",{className:"main-content-wrapper",children:[(0,x.jsxs)("header",{className:"dashboard-header",children:[(0,x.jsx)("div",{children:"Staff"}),(0,x.jsx)("div",{className:"user-header-actions",style:{marginLeft:"auto"},children:(0,x.jsxs)("div",{className:"profile-menu",ref:c,children:[(0,x.jsxs)("button",{type:"button",className:"profile-link",title:"Profile",onClick:()=>o(e=>!e),children:[(0,x.jsx)("i",{className:"fas fa-user-circle"}),(0,x.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",marginLeft:"8px"},children:[(0,x.jsx)("span",{style:{fontWeight:"600",fontSize:"14px"},children:i&&(i.name||"Staff")||"Staff"}),(0,x.jsx)("span",{style:{fontSize:"12px",color:"#64748b",textTransform:"uppercase"},children:null!==i&&void 0!==i&&i.role?i.role.replace("_"," "):"Staff"})]})]}),l&&(0,x.jsxs)("div",{className:"profile-dropdown",children:[(0,x.jsxs)(r.k2,{to:"/staff/profile",className:"dropdown-item",onClick:()=>o(!1),children:[(0,x.jsx)("i",{className:"fas fa-user"}),(0,x.jsx)("span",{children:"Profile"})]}),(0,x.jsxs)("button",{className:"dropdown-item",onClick:async()=>{try{await s(),a("/login")}catch(e){a("/login")}},children:[(0,x.jsx)("i",{className:"fas fa-sign-out-alt"}),(0,x.jsx)("span",{children:"Logout"})]})]})]})})]}),(0,x.jsx)("main",{className:"dashboard-content",children:t})]})]})};function Ns(){var e;const[t,a]=(0,n.useState)({worker:null,attendance:null,route:null}),[s,r]=(0,n.useState)(null),[i,l]=(0,n.useState)(!0),[o,c]=(0,n.useState)(""),d=localStorage.getItem("token"),u="http://localhost:5000",h=(0,n.useRef)(!1),p=(0,n.useCallback)(async()=>{try{l(!0),c("");const e=await fetch("".concat(u,"/api/workers/field/dashboard"),{headers:{Authorization:"Bearer ".concat(d)}});if(!e.ok)throw new Error("Failed to load");const t=await e.json();a(t)}catch(e){c(e.message||"Failed to load")}finally{l(!1)}},[d,u]),f=(0,n.useCallback)(async()=>{try{const e=await fetch("".concat(u,"/api/workers/field/shift-schedule"),{headers:{Authorization:"Bearer ".concat(d)}});if(e.ok){const t=await e.json();r(t)}}catch(e){console.error("Failed to load shift schedule:",e)}},[d,u]);(0,n.useEffect)(()=>{if(h.current)return;h.current=!0;let e=!0;return(async()=>{e&&(await p(),e&&await f())})(),()=>{e=!1}},[]);const m=async e=>{try{const t="in"===e?"/api/workers/field/attendance/check-in":"/api/workers/field/attendance/check-out",a=await fetch(t,{method:"POST",headers:{Authorization:"Bearer ".concat(d)}}),n=await a.json();if(!a.ok)throw new Error(n.message||"Action failed");await p()}catch(t){alert(t.message||"Failed")}};if(i)return(0,x.jsx)("div",{className:"loading-state",children:"\u23f3 Loading your dashboard..."});if(o)return(0,x.jsxs)("div",{className:"error-state",children:["\u274c ",o]});const{worker:g,attendance:v,route:y}=t;return(0,x.jsxs)("div",{className:"staff-dashboard",children:[(0,x.jsxs)("div",{className:"staff-dashboard-header",children:[(0,x.jsxs)("h2",{children:["\ud83d\udc4b Welcome Back, ",(null===g||void 0===g?void 0:g.name)||"Staff Member","!"]}),(0,x.jsx)("p",{children:"Here's your dashboard overview for today"})]}),(0,x.jsxs)("div",{className:"dashboard-grid",children:[(0,x.jsxs)("div",{className:"dashboard-card",children:[(0,x.jsxs)("div",{className:"card-header",children:[(0,x.jsx)("div",{className:"card-icon profile",children:(0,x.jsx)("i",{className:"fas fa-user"})}),(0,x.jsx)("h3",{children:"Profile"})]}),(0,x.jsx)("div",{className:"card-body",children:g?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)("div",{className:"info-row",children:[(0,x.jsx)("span",{className:"info-label",children:"Name"}),(0,x.jsx)("span",{className:"info-value",children:g.name})]}),(0,x.jsxs)("div",{className:"info-row",children:[(0,x.jsx)("span",{className:"info-label",children:"Daily Wage"}),(0,x.jsxs)("span",{className:"info-value",children:["\u20b9 ",g.dailyWage||0]})]}),(0,x.jsxs)("div",{className:"info-row",children:[(0,x.jsx)("span",{className:"info-label",children:"Contact"}),(0,x.jsx)("span",{className:"info-value",children:g.contactNumber||"-"})]}),(0,x.jsxs)("div",{className:"info-row",children:[(0,x.jsx)("span",{className:"info-label",children:"Origin"}),(0,x.jsx)("span",{className:"info-value",children:g.origin||"-"})]})]}):(0,x.jsx)("div",{className:"no-data",children:"No profile linked"})})]}),(0,x.jsxs)("div",{className:"dashboard-card",children:[(0,x.jsxs)("div",{className:"card-header",children:[(0,x.jsx)("div",{className:"card-icon shift",children:(0,x.jsx)("i",{className:"fas fa-clock"})}),(0,x.jsx)("h3",{children:"Today's Shift"})]}),(0,x.jsx)("div",{className:"card-body",children:null!==s&&void 0!==s&&s.myAssignment?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)("div",{className:"shift-badge",children:[(0,x.jsx)("i",{className:"fas ".concat("Morning"===s.myAssignment.shiftType?"fa-sun":"fa-moon")}),s.myAssignment.shiftType," Shift"]}),(0,x.jsxs)("div",{className:"info-row",children:[(0,x.jsx)("span",{className:"info-label",children:"Start Time"}),(0,x.jsx)("span",{className:"info-value",children:s.myAssignment.startTime})]}),(0,x.jsxs)("div",{className:"info-row",children:[(0,x.jsx)("span",{className:"info-label",children:"End Time"}),(0,x.jsx)("span",{className:"info-value",children:s.myAssignment.endTime})]}),(0,x.jsxs)("a",{href:"/staff/shift-schedule",className:"view-schedule-link",children:[(0,x.jsx)("i",{className:"fas fa-calendar-alt"}),"View Full Schedule"]})]}):(0,x.jsx)("div",{className:"no-data",children:"No shift assigned for this week"})})]}),(0,x.jsxs)("div",{className:"dashboard-card",children:[(0,x.jsxs)("div",{className:"card-header",children:[(0,x.jsx)("div",{className:"card-icon attendance",children:(0,x.jsx)("i",{className:"fas fa-clipboard-check"})}),(0,x.jsx)("h3",{children:"Attendance (Today)"})]}),(0,x.jsxs)("div",{className:"card-body",children:[(0,x.jsxs)("div",{className:"info-row",children:[(0,x.jsx)("span",{className:"info-label",children:"Check-in"}),(0,x.jsx)("span",{className:"info-value",children:null!==v&&void 0!==v&&v.checkInAt?new Date(v.checkInAt).toLocaleTimeString():"-"})]}),(0,x.jsxs)("div",{className:"info-row",children:[(0,x.jsx)("span",{className:"info-label",children:"Check-out"}),(0,x.jsx)("span",{className:"info-value",children:null!==v&&void 0!==v&&v.checkOutAt?new Date(v.checkOutAt).toLocaleTimeString():"-"})]}),(null===v||void 0===v?void 0:v.isLate)&&(0,x.jsxs)("div",{className:"late-badge",children:[(0,x.jsx)("i",{className:"fas fa-exclamation-triangle"}),"Late arrival"]}),(0,x.jsxs)("div",{className:"attendance-actions",children:[(0,x.jsxs)("button",{className:"btn-check-in",onClick:()=>m("in"),disabled:!(null===v||void 0===v||!v.checkInAt),children:[(0,x.jsx)("i",{className:"fas fa-sign-in-alt"}),"Check In"]}),(0,x.jsxs)("button",{className:"btn-check-out",onClick:()=>m("out"),disabled:!(null!==v&&void 0!==v&&v.checkInAt)||!(null===v||void 0===v||!v.checkOutAt),children:[(0,x.jsx)("i",{className:"fas fa-sign-out-alt"}),"Check Out"]})]})]})]}),(0,x.jsxs)("div",{className:"dashboard-card",children:[(0,x.jsxs)("div",{className:"card-header",children:[(0,x.jsx)("div",{className:"card-icon route",children:(0,x.jsx)("i",{className:"fas fa-route"})}),(0,x.jsx)("h3",{children:"Today's Route"})]}),(0,x.jsx)("div",{className:"card-body",children:y?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)("div",{className:"info-row",children:[(0,x.jsx)("span",{className:"info-label",children:"Status"}),(0,x.jsx)("span",{className:"status-badge ".concat(null===(e=y.status)||void 0===e?void 0:e.toLowerCase().replace(/\s+/g,"-")),children:y.status})]}),(0,x.jsxs)("div",{className:"info-row",children:[(0,x.jsx)("span",{className:"info-label",children:"Started"}),(0,x.jsx)("span",{className:"info-value",children:y.startedAt?new Date(y.startedAt).toLocaleTimeString():"-"})]}),(0,x.jsxs)("div",{className:"info-row",children:[(0,x.jsx)("span",{className:"info-label",children:"Completed"}),(0,x.jsx)("span",{className:"info-value",children:y.completedAt?new Date(y.completedAt).toLocaleTimeString():"-"})]})]}):(0,x.jsx)("div",{className:"no-data",children:"No route assigned"})})]})]})]})}function Ss(e){let{token:t,onAdd:a,onRemove:s}=e;const[r,i]=(0,n.useState)([]),[l,o]=(0,n.useState)(""),[c,d]=(0,n.useState)(""),[u,h]=(0,n.useState)("Aadhaar"),[p,f]=(0,n.useState)(null),[m,g]=(0,n.useState)(!1),v="http://localhost:5000";(0,n.useEffect)(()=>{(async()=>{const e=await fetch("".concat(v,"/api/workers/me"),{headers:{Authorization:"Bearer ".concat(t)}});if(e.ok){const t=await e.json();i(t.documents||[])}})()},[t,v]);return(0,x.jsxs)("div",{children:[(0,x.jsxs)("div",{style:{display:"flex",flexWrap:"wrap",gap:8,marginBottom:12},children:[(0,x.jsxs)("select",{className:"form-control",value:u,onChange:e=>h(e.target.value),style:{maxWidth:180},children:[(0,x.jsx)("option",{value:"Aadhaar",children:"Aadhaar"}),(0,x.jsx)("option",{value:"Health Card",children:"Health Card"}),(0,x.jsx)("option",{value:"Photo",children:"Photo"}),(0,x.jsx)("option",{value:"Other",children:"Other"})]}),(0,x.jsx)("input",{className:"form-control",placeholder:"Label (optional)",value:l,onChange:e=>o(e.target.value)}),(0,x.jsx)("input",{className:"form-control",type:"file",accept:".jpg,.jpeg,.png,.gif,.webp,.pdf",onChange:e=>{var t;return f((null===(t=e.target.files)||void 0===t?void 0:t[0])||null)},style:{maxWidth:280}}),(0,x.jsx)("input",{className:"form-control",placeholder:"Document URL (optional if file chosen)",value:c,onChange:e=>d(e.target.value)}),(0,x.jsx)("button",{className:"btn btn-primary",onClick:async()=>{let e=c;if(p)try{var n;g(!0);const a=new FormData;a.append("file",p);const s=await fetch("".concat(v,"/api/uploads/document"),{method:"POST",headers:{Authorization:"Bearer ".concat(t)},body:a});if(!s.ok){const e=await s.text();throw new Error(e||"Upload failed")}const r=await s.json();e=null!==r&&void 0!==r&&null!==(n=r.file)&&void 0!==n&&n.path?"".concat(v).concat(r.file.path):e}catch(r){return alert(r.message||"File upload failed"),void g(!1)}finally{g(!1)}await a(l||u,e),o(""),d(""),f(null);const s=await fetch("".concat(v,"/api/workers/me"),{headers:{Authorization:"Bearer ".concat(t)}});if(s.ok){const e=await s.json();i(e.documents||[])}},disabled:m,children:m?"Uploading...":"Upload"})]}),(0,x.jsxs)("ul",{className:"list-group",children:[r.map((e,a)=>(0,x.jsxs)("li",{className:"list-group-item d-flex justify-content-between align-items-center",children:[(0,x.jsxs)("span",{children:[e.label?"".concat(e.label," - "):"",(0,x.jsx)("a",{href:e.url,target:"_blank",rel:"noreferrer",children:e.url})]}),(0,x.jsx)("button",{className:"btn btn-sm btn-outline-danger",onClick:()=>(async e=>{await s(e);const a=await fetch("".concat(v,"/api/workers/me"),{headers:{Authorization:"Bearer ".concat(t)}});if(a.ok){const e=await a.json();i(e.documents||[])}})(a),children:"Remove"})]},a)),0===r.length&&(0,x.jsx)("li",{className:"list-group-item",children:"No documents"})]})]})}const ks=()=>{var e,t,a,s;const{user:r}=y(),[l,o]=(0,n.useState)(null),[c,d]=(0,n.useState)("personal"),[u,h]=(0,n.useState)(!1),[p,f]=(0,n.useState)(!0),[m,g]=(0,n.useState)(null),[v,b]=(0,n.useState)(null),[j,N]=(0,n.useState)(!1),[S,k]=(0,n.useState)({}),[A,C]=(0,n.useState)(!1),_=localStorage.getItem("token"),L=(0,w.zy)();(0,n.useEffect)(()=>{r&&(async()=>{const e="http://localhost:5000";try{f(!0);const n=await fetch("".concat(e,"/api/workers/me"),{headers:{Authorization:"Bearer ".concat(_)}});if(n.ok){var t,a;const e=await n.json();return o({name:e.name||(null===(t=e.user)||void 0===t?void 0:t.name),email:null===(a=e.user)||void 0===a?void 0:a.email,dailyWage:e.dailyWage,origin:e.origin,contactNumber:e.contactNumber,role:e.role,staffId:e.staffId||e._id,address:e.address,emergencyContactName:e.emergencyContactName,emergencyContactNumber:e.emergencyContactNumber,dateOfBirth:e.dateOfBirth,aadhaarNumber:e.aadhaarNumber,photoUrl:e.photoUrl,health:e.health}),void g(null)}const s=await fetch("".concat(e,"/api/users/profile"),{headers:{Authorization:"Bearer ".concat(_)}});if(!s.ok)throw new Error("Failed to load profile");{const e=await s.json();o({name:e.name,email:e.email,dailyWage:0,origin:e.location||"-",contactNumber:e.phoneNumber||"-",role:e.role||"staff",staffId:e._id,address:e.address||"",emergencyContactName:"",emergencyContactNumber:"",dateOfBirth:"",aadhaarNumber:"",photoUrl:"",health:{}}),g(null)}}catch(n){g(n.message||"Failed to load profile")}finally{f(!1)}})()},[r,_]),(0,n.useEffect)(()=>{const e=new URLSearchParams(L.search),t=e.get("view"),a=e.get("tab");"1"!==t&&"true"!==t||N(!0),"documents"===a&&d("documents"),"health"===a&&d("health")},[L.search]);const T="http://localhost:5000",E=e=>e&&e.trim()?/^[a-zA-Z\s.]+$/.test(e)?e.trim().length<2?"Name must be at least 2 characters":"":"Only letters, spaces and dots allowed":"Name is required",D=e=>{if(!e||!e.toString().trim())return"Phone number is required";const t=String(e).replace(/\D/g,"");if(t.startsWith("91")&&12===t.length){const e=t.slice(2);if(!/^[6-9]\d{9}$/.test(e))return"Invalid Indian mobile number"}else if(10===t.length){if(!/^[6-9]\d{9}$/.test(t))return"Invalid 10-digit mobile number"}else{if(11!==t.length||!t.startsWith("0"))return"Provide 10 digits or +91 followed by 10 digits";{const e=t.slice(1);if(!/^[6-9]\d{9}$/.test(e))return"Invalid 10-digit mobile number"}}return""},P=e=>e&&e.trim()?e.trim().length<5?"Address must be at least 5 characters":"":"Address is required",R=e=>{if(!e)return"";const t=new Date(e);if(Number.isNaN(t.getTime()))return"Invalid date";const a=new Date;if(t>a)return"Date cannot be in the future";return a.getFullYear()-t.getFullYear()-(a<new Date(a.getFullYear(),t.getMonth(),t.getDate())?1:0)<18?"Must be at least 18 years old":""},I=e=>{if(!e)return"";return 12!==String(e).replace(/\D/g,"").length?"Aadhaar must be 12 digits":""},B=e=>{if(!e)return"";try{return new URL(e),""}catch(t){return"Enter a valid URL (include http/https)"}},F=e=>e?/^(A|B|AB|O)[+-]$/i.test(e)?"":"Use formats like O+, A-, AB+":"",O=async(e,t,a)=>{let n="";switch(e){case"name":n=E(t);break;case"contactNumber":n=D(t);break;case"address":n=P(t);break;case"emergencyContactName":n=t?E(t):"";break;case"emergencyContactNumber":n=t?D(t):"";break;case"dateOfBirth":n=R(t);break;case"aadhaarNumber":n=I(t);break;case"health.bloodGroup":n=F(t);break;case"health.medicalCertificateUrl":n=B(t);break;case"origin":n=["kerala","other"].includes(String(t||"").toLowerCase())?"":"Invalid option";break;default:n=""}k(t=>(0,i.A)((0,i.A)({},t),{},{[e]:n})),n||await q(a)},q=async e=>{try{var t,a;h(!0),g(null);const n=await fetch("".concat(T,"/api/workers/me"),{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(_)},body:JSON.stringify(e)});if(!n.ok){const e=await n.json().catch(()=>({message:"Failed to save"}));throw new Error(e.message||"Server error: ".concat(n.status))}const s=await n.json();o((0,i.A)((0,i.A)({},l),{},{name:s.name||(null===(t=s.user)||void 0===t?void 0:t.name),email:null===(a=s.user)||void 0===a?void 0:a.email,dailyWage:s.dailyWage,origin:s.origin,contactNumber:s.contactNumber,address:s.address,emergencyContactName:s.emergencyContactName,emergencyContactNumber:s.emergencyContactNumber,dateOfBirth:s.dateOfBirth,aadhaarNumber:s.aadhaarNumber,photoUrl:s.photoUrl,health:s.health,staffId:s.staffId||s._id})),b("Profile updated successfully!"),setTimeout(()=>{g(null),b(null)},3e3)}catch(n){console.error("Profile update error:",n),g(n.message||"Failed to save profile")}finally{h(!1)}},z=()=>{const e=["personal","documents","health"],t=e.indexOf(c);t<e.length-1?d(e[t+1]):N(!0)},M=async()=>{const e={};var t,a,n;("personal"===c&&(e.name=E((null===l||void 0===l?void 0:l.name)||""),e.contactNumber=D((null===l||void 0===l?void 0:l.contactNumber)||""),e.address=P((null===l||void 0===l?void 0:l.address)||""),null!==l&&void 0!==l&&l.emergencyContactName&&(e.emergencyContactName=E(l.emergencyContactName)),null!==l&&void 0!==l&&l.emergencyContactNumber&&(e.emergencyContactNumber=D(l.emergencyContactNumber)),e.dateOfBirth=R((null===l||void 0===l?void 0:l.dateOfBirth)||""),e.aadhaarNumber=I((null===l||void 0===l?void 0:l.aadhaarNumber)||""),e.origin=["kerala","other"].includes(String((null===l||void 0===l?void 0:l.origin)||"").toLowerCase())?"":"Invalid option"),"health"===c)&&(e["health.bloodGroup"]=F((null===l||void 0===l||null===(t=l.health)||void 0===t?void 0:t.bloodGroup)||""),e["health.medicalCertificateUrl"]=B((null===l||void 0===l||null===(a=l.health)||void 0===a?void 0:a.medicalCertificateUrl)||""),null!==l&&void 0!==l&&null!==(n=l.health)&&void 0!==n&&n.lastCheckupDate&&(e["health.lastCheckupDate"]=R(l.health.lastCheckupDate)));const s=Object.fromEntries(Object.entries(e).filter(e=>{let[,t]=e;return t}));k(e=>(0,i.A)((0,i.A)({},e),s)),Object.keys(s).length>0?g("Please fix the highlighted errors"):await q({})};if(p)return(0,x.jsx)("div",{style:{padding:16},children:"Loading profile..."});const U=()=>m?(0,x.jsxs)("div",{className:"alert alert-danger",style:{marginBottom:16},children:[(0,x.jsx)("i",{className:"fas fa-exclamation-triangle"})," ",m]}):null,W=()=>v?(0,x.jsxs)("div",{className:"alert alert-success",style:{marginBottom:16},children:[(0,x.jsx)("i",{className:"fas fa-check-circle"})," ",v]}):null,H=()=>(0,x.jsxs)("div",{style:{marginTop:24,padding:20,backgroundColor:"#f8f9fa",border:"1px solid #dee2e6",borderRadius:8,maxWidth:640},children:[(0,x.jsx)("h3",{style:{color:"#495057",marginBottom:16},children:"Staff Information Summary"}),(0,x.jsxs)("div",{style:{display:"grid",gap:12},children:[(0,x.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",padding:"8px 0",borderBottom:"1px solid #e9ecef"},children:[(0,x.jsx)("strong",{children:"Staff ID:"}),(0,x.jsx)("span",{style:{color:"#6c757d"},children:(null===l||void 0===l?void 0:l.staffId)||"Not assigned"})]}),(0,x.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",padding:"8px 0",borderBottom:"1px solid #e9ecef"},children:[(0,x.jsx)("strong",{children:"Name:"}),(0,x.jsx)("span",{style:{color:"#6c757d"},children:(null===l||void 0===l?void 0:l.name)||"Not provided"})]}),(0,x.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",padding:"8px 0",borderBottom:"1px solid #e9ecef"},children:[(0,x.jsx)("strong",{children:"Address:"}),(0,x.jsx)("span",{style:{color:"#6c757d",textAlign:"right",maxWidth:"60%"},children:(null===l||void 0===l?void 0:l.address)||"Not provided"})]}),(0,x.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",padding:"8px 0",borderBottom:"1px solid #e9ecef"},children:[(0,x.jsx)("strong",{children:"Contact:"}),(0,x.jsx)("span",{style:{color:"#6c757d"},children:(null===l||void 0===l?void 0:l.contactNumber)||"Not provided"})]}),(0,x.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",padding:"8px 0",borderBottom:"1px solid #e9ecef"},children:[(0,x.jsx)("strong",{children:"Email:"}),(0,x.jsx)("span",{style:{color:"#6c757d"},children:(null===l||void 0===l?void 0:l.email)||"Not provided"})]}),(0,x.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",padding:"8px 0"},children:[(0,x.jsx)("strong",{children:"Role:"}),(0,x.jsx)("span",{style:{color:"#6c757d"},children:(null===l||void 0===l?void 0:l.role)||"Staff"})]})]}),(0,x.jsxs)("div",{style:{marginTop:16,display:"flex",gap:12},children:[(0,x.jsx)("button",{className:"btn btn-secondary",onClick:()=>N(!1),children:"Edit Profile"}),(0,x.jsx)("button",{className:"btn btn-success",onClick:()=>window.print(),children:"Print Profile"})]})]});return(0,x.jsxs)("div",{style:{padding:16},children:[(0,x.jsx)("h2",{children:"My Profile"}),(0,x.jsx)(U,{}),(0,x.jsx)(W,{}),j?(0,x.jsx)(H,{}):(0,x.jsx)(x.Fragment,{children:(0,x.jsxs)("div",{style:{display:"flex",gap:12,marginTop:12},children:[(0,x.jsx)("button",{className:"btn btn-".concat("personal"===c?"primary":"light"),onClick:()=>d("personal"),children:"Personal"}),(0,x.jsx)("button",{className:"btn btn-".concat("documents"===c?"primary":"light"),onClick:()=>d("documents"),children:"Documents"}),(0,x.jsx)("button",{className:"btn btn-".concat("health"===c?"primary":"light"),onClick:()=>d("health"),children:"Health"})]})}),"personal"===c&&(0,x.jsxs)("div",{style:{marginTop:16,maxWidth:640},children:[(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{children:"Name"}),(0,x.jsx)("input",{className:"form-control",defaultValue:(null===l||void 0===l?void 0:l.name)||"",onBlur:e=>O("name",e.target.value,{name:e.target.value}),onChange:()=>S.name&&k(e=>(0,i.A)((0,i.A)({},e),{},{name:""}))}),S.name?(0,x.jsx)("div",{className:"text-danger",style:{fontSize:12},children:S.name}):null]}),(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{children:"Contact Number"}),(0,x.jsx)("input",{className:"form-control",defaultValue:(null===l||void 0===l?void 0:l.contactNumber)||"",onBlur:e=>O("contactNumber",e.target.value,{contactNumber:e.target.value}),onChange:()=>S.contactNumber&&k(e=>(0,i.A)((0,i.A)({},e),{},{contactNumber:""}))}),S.contactNumber?(0,x.jsx)("div",{className:"text-danger",style:{fontSize:12},children:S.contactNumber}):null]}),(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{children:"Address"}),(0,x.jsx)("textarea",{className:"form-control",defaultValue:(null===l||void 0===l?void 0:l.address)||"",onBlur:e=>O("address",e.target.value,{address:e.target.value}),onChange:()=>S.address&&k(e=>(0,i.A)((0,i.A)({},e),{},{address:""}))}),S.address?(0,x.jsx)("div",{className:"text-danger",style:{fontSize:12},children:S.address}):null]}),(0,x.jsxs)("div",{className:"form-row",style:{display:"flex",gap:12},children:[(0,x.jsxs)("div",{className:"form-group",style:{flex:1},children:[(0,x.jsx)("label",{children:"Emergency Contact Name"}),(0,x.jsx)("input",{className:"form-control",defaultValue:(null===l||void 0===l?void 0:l.emergencyContactName)||"",onBlur:e=>O("emergencyContactName",e.target.value,{emergencyContactName:e.target.value}),onChange:()=>S.emergencyContactName&&k(e=>(0,i.A)((0,i.A)({},e),{},{emergencyContactName:""}))}),S.emergencyContactName?(0,x.jsx)("div",{className:"text-danger",style:{fontSize:12},children:S.emergencyContactName}):null]}),(0,x.jsxs)("div",{className:"form-group",style:{flex:1},children:[(0,x.jsx)("label",{children:"Emergency Contact Number"}),(0,x.jsx)("input",{className:"form-control",defaultValue:(null===l||void 0===l?void 0:l.emergencyContactNumber)||"",onBlur:e=>O("emergencyContactNumber",e.target.value,{emergencyContactNumber:e.target.value}),onChange:()=>S.emergencyContactNumber&&k(e=>(0,i.A)((0,i.A)({},e),{},{emergencyContactNumber:""}))}),S.emergencyContactNumber?(0,x.jsx)("div",{className:"text-danger",style:{fontSize:12},children:S.emergencyContactNumber}):null]})]}),(0,x.jsxs)("div",{className:"form-row",style:{display:"flex",gap:12},children:[(0,x.jsxs)("div",{className:"form-group",style:{flex:1},children:[(0,x.jsx)("label",{children:"Date of Birth"}),(0,x.jsx)("input",{type:"date",className:"form-control",defaultValue:null!==l&&void 0!==l&&l.dateOfBirth?String(l.dateOfBirth).slice(0,10):"",onBlur:e=>O("dateOfBirth",e.target.value,{dateOfBirth:e.target.value}),onChange:()=>S.dateOfBirth&&k(e=>(0,i.A)((0,i.A)({},e),{},{dateOfBirth:""}))}),S.dateOfBirth?(0,x.jsx)("div",{className:"text-danger",style:{fontSize:12},children:S.dateOfBirth}):null]}),(0,x.jsxs)("div",{className:"form-group",style:{flex:1},children:[(0,x.jsx)("label",{children:"Origin"}),(0,x.jsxs)("select",{className:"form-control",defaultValue:(null===l||void 0===l?void 0:l.origin)||"kerala",onChange:e=>O("origin",e.target.value,{origin:e.target.value}),children:[(0,x.jsx)("option",{value:"kerala",children:"Kerala"}),(0,x.jsx)("option",{value:"other",children:"Other State"})]}),S.origin?(0,x.jsx)("div",{className:"text-danger",style:{fontSize:12},children:S.origin}):null]})]}),(0,x.jsxs)("div",{className:"form-row",style:{display:"flex",gap:12},children:[(0,x.jsxs)("div",{className:"form-group",style:{flex:1},children:[(0,x.jsx)("label",{children:"Aadhaar Number"}),(0,x.jsx)("input",{className:"form-control",defaultValue:(null===l||void 0===l?void 0:l.aadhaarNumber)||"",onBlur:e=>O("aadhaarNumber",e.target.value,{aadhaarNumber:e.target.value}),onChange:()=>S.aadhaarNumber&&k(e=>(0,i.A)((0,i.A)({},e),{},{aadhaarNumber:""}))}),S.aadhaarNumber?(0,x.jsx)("div",{className:"text-danger",style:{fontSize:12},children:S.aadhaarNumber}):null]}),(0,x.jsxs)("div",{className:"form-group",style:{flex:1},children:[(0,x.jsx)("label",{children:"Photo"}),(0,x.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12},children:[(0,x.jsx)("input",{type:"file",accept:".jpg,.jpeg,.png,.webp",className:"form-control",onChange:async e=>{const t=e.target.files&&e.target.files[0];if(t)try{var a;C(!0);const e=new FormData;e.append("file",t);const n=await fetch("".concat(T,"/api/uploads/document"),{method:"POST",headers:{Authorization:"Bearer ".concat(_)},body:e});if(!n.ok){const e=await n.text();throw new Error(e||"Upload failed")}const s=await n.json(),r=null!==s&&void 0!==s&&null!==(a=s.file)&&void 0!==a&&a.path?"".concat(T).concat(s.file.path):"";if(!r)throw new Error("No file URL returned");await q({photoUrl:r})}catch(n){g(n.message||"Photo upload failed")}finally{C(!1)}}}),A?(0,x.jsx)("span",{style:{color:"#6c757d"},children:"Uploading..."}):null]}),null!==l&&void 0!==l&&l.photoUrl?(0,x.jsx)("div",{style:{marginTop:8},children:(0,x.jsx)("img",{src:l.photoUrl,alt:"Profile",style:{height:64,width:64,objectFit:"cover",borderRadius:6,border:"1px solid #ddd"}})}):null]})]}),(0,x.jsxs)("div",{style:{marginTop:24,display:"flex",gap:12},children:[(0,x.jsx)("button",{className:"btn btn-primary",onClick:M,disabled:u,style:{minWidth:100},children:u?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("i",{className:"fas fa-spinner fa-spin",style:{marginRight:8}}),"Saving..."]}):(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("i",{className:"fas fa-save",style:{marginRight:8}}),"Save"]})}),(0,x.jsxs)("button",{className:"btn btn-success",onClick:z,disabled:u,style:{minWidth:100},children:[(0,x.jsx)("i",{className:"fas fa-arrow-right",style:{marginRight:8}}),"Next"]})]})]}),"documents"===c&&(0,x.jsxs)("div",{style:{marginTop:16},children:[(0,x.jsx)(Ss,{token:_,onAdd:async(e,t)=>{await fetch("".concat(T,"/api/workers/me/documents"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(_)},body:JSON.stringify({label:e,url:t})})},onRemove:async e=>{await fetch("".concat(T,"/api/workers/me/documents/").concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(_)}})}}),(0,x.jsxs)("div",{style:{marginTop:24,display:"flex",gap:12},children:[(0,x.jsx)("button",{className:"btn btn-primary",onClick:M,disabled:u,style:{minWidth:100},children:u?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("i",{className:"fas fa-spinner fa-spin",style:{marginRight:8}}),"Saving..."]}):(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("i",{className:"fas fa-save",style:{marginRight:8}}),"Save"]})}),(0,x.jsxs)("button",{className:"btn btn-success",onClick:z,disabled:u,style:{minWidth:100},children:[(0,x.jsx)("i",{className:"fas fa-arrow-right",style:{marginRight:8}}),"Next"]})]})]}),"health"===c&&(0,x.jsxs)("div",{style:{marginTop:16,maxWidth:640},children:[(0,x.jsxs)("div",{className:"form-row",style:{display:"flex",gap:12},children:[(0,x.jsxs)("div",{className:"form-group",style:{flex:1},children:[(0,x.jsx)("label",{children:"Blood Group"}),(0,x.jsx)("input",{className:"form-control",defaultValue:(null===l||void 0===l||null===(e=l.health)||void 0===e?void 0:e.bloodGroup)||"",onBlur:e=>O("health.bloodGroup",e.target.value,{health:(0,i.A)((0,i.A)({},null===l||void 0===l?void 0:l.health),{},{bloodGroup:e.target.value})}),onChange:()=>S["health.bloodGroup"]&&k(e=>(0,i.A)((0,i.A)({},e),{},{"health.bloodGroup":""}))}),S["health.bloodGroup"]?(0,x.jsx)("div",{className:"text-danger",style:{fontSize:12},children:S["health.bloodGroup"]}):null]}),(0,x.jsxs)("div",{className:"form-group",style:{flex:1},children:[(0,x.jsx)("label",{children:"Medical Certificate URL"}),(0,x.jsx)("input",{className:"form-control",defaultValue:(null===l||void 0===l||null===(t=l.health)||void 0===t?void 0:t.medicalCertificateUrl)||"",onBlur:e=>O("health.medicalCertificateUrl",e.target.value,{health:(0,i.A)((0,i.A)({},null===l||void 0===l?void 0:l.health),{},{medicalCertificateUrl:e.target.value})}),onChange:()=>S["health.medicalCertificateUrl"]&&k(e=>(0,i.A)((0,i.A)({},e),{},{"health.medicalCertificateUrl":""}))}),S["health.medicalCertificateUrl"]?(0,x.jsx)("div",{className:"text-danger",style:{fontSize:12},children:S["health.medicalCertificateUrl"]}):null]})]}),(0,x.jsx)("div",{className:"form-row",style:{display:"flex",gap:12},children:(0,x.jsxs)("div",{className:"form-group",style:{flex:1},children:[(0,x.jsx)("label",{children:"Last Checkup Date"}),(0,x.jsx)("input",{type:"date",className:"form-control",defaultValue:null!==l&&void 0!==l&&null!==(a=l.health)&&void 0!==a&&a.lastCheckupDate?String(l.health.lastCheckupDate).slice(0,10):"",onBlur:e=>O("health.lastCheckupDate",e.target.value,{health:(0,i.A)((0,i.A)({},null===l||void 0===l?void 0:l.health),{},{lastCheckupDate:e.target.value})}),onChange:()=>S["health.lastCheckupDate"]&&k(e=>(0,i.A)((0,i.A)({},e),{},{"health.lastCheckupDate":""}))}),S["health.lastCheckupDate"]?(0,x.jsx)("div",{className:"text-danger",style:{fontSize:12},children:S["health.lastCheckupDate"]}):null]})}),(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{children:"Notes"}),(0,x.jsx)("textarea",{className:"form-control",defaultValue:(null===l||void 0===l||null===(s=l.health)||void 0===s?void 0:s.notes)||"",onBlur:e=>q({health:(0,i.A)((0,i.A)({},null===l||void 0===l?void 0:l.health),{},{notes:e.target.value})})})]}),(0,x.jsxs)("div",{style:{marginTop:24,display:"flex",gap:12},children:[(0,x.jsx)("button",{className:"btn btn-primary",onClick:M,disabled:u,children:u?"Saving...":"Save"}),(0,x.jsxs)("button",{className:"btn btn-success",onClick:z,disabled:u,style:{minWidth:120},children:[(0,x.jsx)("i",{className:"fas fa-eye",style:{marginRight:8}}),"View Summary"]})]})]})]})},As=()=>{const{user:e}=y(),[t,a]=(0,n.useState)([]),[s,r]=(0,n.useState)(!1),[i,l]=(0,n.useState)(""),[o,c]=(0,n.useState)(!1),[d,u]=(0,n.useState)(""),h=(0,n.useRef)(null);(0,n.useEffect)(()=>{h.current&&h.current.focus()},[]);const p=async n=>{if(!(e=>/^BHFP\d{1,3}$/.test(e))(n))return u("\u274c Invalid format! Use: BHFP + 1-3 digits (e.g., BHFP1, BHFP12, BHFP123)"),void setTimeout(()=>u(""),5e3);if(t.find(e=>e.barrelId===n))return u("\u26a0\ufe0f Barrel already scanned"),void setTimeout(()=>u(""),3e3);c(!0);try{const t={barrelId:n,scannedAt:(new Date).toISOString(),status:"scanned",scannedBy:(null===e||void 0===e?void 0:e.name)||"Staff"};a(e=>[...e,t]),u("\u2705 Barrel ".concat(n," scanned successfully")),setTimeout(()=>u(""),3e3)}catch(s){u("\u274c Error scanning barrel"),setTimeout(()=>u(""),3e3)}finally{c(!1)}},f=async()=>{try{await fetch("/api/notifications/barrel-return",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("token"))},body:JSON.stringify({barrels:t,returnedBy:null===e||void 0===e?void 0:e.name,message:"".concat(t.length," barrels have been returned and need reassignment")})})}catch(a){console.error("Failed to notify manager:",a)}};return(0,x.jsxs)("div",{className:"return-barrels-container",children:[(0,x.jsxs)("div",{className:"page-header",children:[(0,x.jsx)("h1",{children:"Return Barrels"}),(0,x.jsx)("p",{children:"Scan barrel IDs to mark them as returned"})]}),d&&(0,x.jsx)("div",{className:"message ".concat(d.includes("Error")?"error":"success"),children:d}),(0,x.jsxs)("div",{className:"scanner-section",children:[(0,x.jsx)("div",{className:"scanner-status-banner",children:s?(0,x.jsxs)("div",{className:"status-indicator scanning",children:[(0,x.jsx)("div",{className:"pulse-dot"}),(0,x.jsx)("span",{className:"status-text",children:"\ud83d\udd34 Scanning..."}),(0,x.jsx)("div",{className:"scanning-animation",children:(0,x.jsx)("div",{className:"scan-line"})})]}):(0,x.jsxs)("div",{className:"status-indicator ready",children:[(0,x.jsx)("div",{className:"ready-icon",children:"\u2713"}),(0,x.jsx)("span",{className:"status-text",children:"\ud83d\udfe2 Ready to Scan"}),(0,x.jsx)("span",{className:"status-subtext",children:"Scan or type Barrel ID below"})]})}),(0,x.jsxs)("div",{className:"scanner-input-container",children:[(0,x.jsx)("label",{htmlFor:"scanner",children:"Barrel ID Input:"}),(0,x.jsx)("input",{ref:h,id:"scanner",type:"text",value:i,onChange:e=>{const t=e.target.value;if(l(t),t.length>0?r(!0):r(!1),t.includes("\n")||t.length>8){const e=t.replace("\n","").trim();e&&(p(e),l(""),r(!1))}},onKeyPress:e=>{"Enter"===e.key&&i.trim()&&(p(i.trim()),l(""),r(!1))},placeholder:"Scan with barcode scanner or type manually and press Enter...",className:"scanner-input ".concat(s?"active":""),disabled:o,autoFocus:!0}),(0,x.jsx)("button",{className:"manual-add-btn",onClick:()=>{i.trim()&&(p(i.trim()),l(""),r(!1))},disabled:!i.trim()||o,children:"Add Barrel"})]})]}),(0,x.jsxs)("div",{className:"scanned-barrels-section",children:[(0,x.jsxs)("h3",{children:["Scanned Barrels (",t.length,")"]}),0===t.length?(0,x.jsxs)("div",{className:"no-barrels",children:[(0,x.jsx)("p",{children:"No barrels scanned yet"}),(0,x.jsx)("p",{children:"Use the scanner above to scan barrel IDs"})]}):(0,x.jsx)("div",{className:"barrels-list",children:t.map((e,t)=>(0,x.jsxs)("div",{className:"barrel-item",children:[(0,x.jsxs)("div",{className:"barrel-info",children:[(0,x.jsx)("span",{className:"barrel-id",children:e.barrelId}),(0,x.jsxs)("span",{className:"scan-time",children:["Scanned: ",new Date(e.scannedAt).toLocaleTimeString()]})]}),(0,x.jsx)("button",{className:"remove-btn",onClick:()=>{return t=e.barrelId,void a(e=>e.filter(e=>e.barrelId!==t));var t},disabled:o,children:"\u2715"})]},e.barrelId))})]}),(0,x.jsx)("div",{className:"actions-section",children:(0,x.jsx)("button",{className:"complete-return-btn",onClick:async()=>{if(0===t.length)return u("No barrels to return"),void setTimeout(()=>u(""),3e3);c(!0);try{const n={barrels:t,returnedBy:null===e||void 0===e?void 0:e._id,returnedAt:(new Date).toISOString(),status:"returned"};if(!(await fetch("/api/barrels/return",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("token"))},body:JSON.stringify(n)})).ok)throw new Error("Failed to return barrels");u("".concat(t.length," barrels returned successfully! Manager will be notified.")),a([]),await f()}catch(n){u("Error completing return")}finally{c(!1),setTimeout(()=>u(""),5e3)}},disabled:0===t.length||o,children:o?"Processing...":"Complete Return (".concat(t.length," barrels)")})}),(0,x.jsxs)("div",{className:"instructions",children:[(0,x.jsx)("h4",{children:"\ud83d\udccb Instructions:"}),(0,x.jsxs)("div",{className:"format-example",children:[(0,x.jsx)("strong",{children:"\u2705 Valid Barrel ID Format:"}),(0,x.jsxs)("div",{className:"format-box",children:[(0,x.jsx)("span",{className:"format-label",children:"BHFP"})," + ",(0,x.jsx)("span",{className:"format-label",children:"1-3 digits"})]}),(0,x.jsxs)("div",{className:"examples",children:[(0,x.jsx)("span",{className:"valid-example",children:"\u2705 BHFP1"}),(0,x.jsx)("span",{className:"valid-example",children:"\u2705 BHFP12"}),(0,x.jsx)("span",{className:"valid-example",children:"\u2705 BHFP123"})]}),(0,x.jsxs)("div",{className:"examples invalid",children:[(0,x.jsx)("span",{className:"invalid-example",children:"\u274c bhfp90 (lowercase)"}),(0,x.jsx)("span",{className:"invalid-example",children:"\u274c BHFP1234 (4 digits)"}),(0,x.jsx)("span",{className:"invalid-example",children:"\u274c abcd78 (wrong prefix)"})]})]}),(0,x.jsxs)("ul",{children:[(0,x.jsx)("li",{children:"Scan or manually enter barrel IDs in the correct format"}),(0,x.jsx)("li",{children:"Each valid barrel will be added to the list"}),(0,x.jsx)("li",{children:'Click "Complete Return" when all barrels are scanned'}),(0,x.jsx)("li",{children:"Manager will be notified and can reassign barrels"})]})]})]})},Cs=e=>{let{salaryData:t,salaryType:a}=e;var n,s,r,i,l,o,c,d,u,h,p,f,m,g,v,y,b,j,w,N,S,k,A,C,_,L,T,E,D,P,R,I,B,F,O,q,z,M,U,W,H,V,G,J,Y,K,Q;return"daily"===a?(0,x.jsxs)("div",{className:"salary-cards-grid",children:[(0,x.jsxs)("div",{className:"salary-detail-card",children:[(0,x.jsx)("h5",{children:"\ud83d\udcb0 Daily Wage Details"}),(0,x.jsxs)("div",{className:"salary-row",children:[(0,x.jsx)("span",{className:"salary-label",children:"Working Days"}),(0,x.jsx)("span",{className:"salary-value",children:(null===(n=t.salary)||void 0===n?void 0:n.workingDays)||0})]}),(0,x.jsxs)("div",{className:"salary-row",children:[(0,x.jsx)("span",{className:"salary-label",children:"Daily Wage"}),(0,x.jsxs)("span",{className:"salary-value",children:["\u20b9",(null===(s=t.salary)||void 0===s||null===(r=s.dailyWage)||void 0===r?void 0:r.toLocaleString())||"0"]})]}),(0,x.jsxs)("div",{className:"salary-row",children:[(0,x.jsx)("span",{className:"salary-label",children:"Gross Salary"}),(0,x.jsxs)("span",{className:"salary-value positive",children:["\u20b9",(null===(i=t.salary)||void 0===i||null===(l=i.grossSalary)||void 0===l?void 0:l.toLocaleString())||"0"]})]}),(null===(o=t.salary)||void 0===o?void 0:o.totalBenefits)>0&&(0,x.jsxs)("div",{className:"salary-row",children:[(0,x.jsx)("span",{className:"salary-label",children:"Total Benefits"}),(0,x.jsxs)("span",{className:"salary-value positive",children:["\u20b9",null===(c=t.salary.totalBenefits)||void 0===c?void 0:c.toLocaleString()]})]})]}),(0,x.jsxs)("div",{className:"salary-detail-card",children:[(0,x.jsx)("h5",{children:"\ud83d\udcca Payment Summary"}),(0,x.jsxs)("div",{className:"salary-row",children:[(0,x.jsx)("span",{className:"salary-label",children:"Received"}),(0,x.jsxs)("span",{className:"salary-value positive",children:["\u20b9",(null===(d=t.salary)||void 0===d||null===(u=d.receivedAmount)||void 0===u?void 0:u.toLocaleString())||"0"]})]}),(0,x.jsxs)("div",{className:"salary-row",children:[(0,x.jsx)("span",{className:"salary-label",children:"Advance"}),(0,x.jsxs)("span",{className:"salary-value",children:["\u20b9",(null===(h=t.salary)||void 0===h||null===(p=h.advanceAmount)||void 0===p?void 0:p.toLocaleString())||"0"]})]}),(0,x.jsxs)("div",{className:"salary-row",children:[(0,x.jsx)("span",{className:"salary-label",children:"Bonus"}),(0,x.jsxs)("span",{className:"salary-value positive",children:["\u20b9",(null===(f=t.salary)||void 0===f||null===(m=f.bonusAmount)||void 0===m?void 0:m.toLocaleString())||"0"]})]}),(0,x.jsxs)("div",{className:"salary-row",children:[(0,x.jsx)("span",{className:"salary-label",children:"Deductions"}),(0,x.jsxs)("span",{className:"salary-value negative",children:["\u20b9",(null===(g=t.salary)||void 0===g||null===(v=g.deductionAmount)||void 0===v?void 0:v.toLocaleString())||"0"]})]}),(0,x.jsx)("hr",{className:"salary-divider"}),(0,x.jsxs)("div",{className:"salary-row salary-total-row",children:[(0,x.jsx)("span",{className:"salary-label",children:"Pending"}),(0,x.jsxs)("span",{className:"salary-value",children:["\u20b9",(null===(y=t.salary)||void 0===y||null===(b=y.pendingAmount)||void 0===b?void 0:b.toLocaleString())||"0"]})]})]})]}):(0,x.jsxs)("div",{className:"salary-cards-grid",children:[(0,x.jsxs)("div",{className:"salary-detail-card",children:[(0,x.jsx)("h5",{children:"\ud83d\udcb0 Salary Breakdown"}),(0,x.jsxs)("div",{className:"salary-row",children:[(0,x.jsx)("span",{className:"salary-label",children:"Basic Salary"}),(0,x.jsxs)("span",{className:"salary-value",children:["\u20b9",(null===(j=t.salary)||void 0===j||null===(w=j.basicSalary)||void 0===w?void 0:w.toLocaleString())||"0"]})]}),(0,x.jsxs)("div",{className:"salary-row",children:[(0,x.jsx)("span",{className:"salary-label",children:"House Rent Allowance"}),(0,x.jsxs)("span",{className:"salary-value",children:["\u20b9",(null===(N=t.salary)||void 0===N||null===(S=N.houseRentAllowance)||void 0===S?void 0:S.toLocaleString())||"0"]})]}),(0,x.jsxs)("div",{className:"salary-row",children:[(0,x.jsx)("span",{className:"salary-label",children:"Medical Allowance"}),(0,x.jsxs)("span",{className:"salary-value",children:["\u20b9",(null===(k=t.salary)||void 0===k||null===(A=k.medicalAllowance)||void 0===A?void 0:A.toLocaleString())||"0"]})]}),(0,x.jsxs)("div",{className:"salary-row",children:[(0,x.jsx)("span",{className:"salary-label",children:"Transport Allowance"}),(0,x.jsxs)("span",{className:"salary-value",children:["\u20b9",(null===(C=t.salary)||void 0===C||null===(_=C.transportAllowance)||void 0===_?void 0:_.toLocaleString())||"0"]})]}),(0,x.jsxs)("div",{className:"salary-row",children:[(0,x.jsx)("span",{className:"salary-label",children:"Special Allowance"}),(0,x.jsxs)("span",{className:"salary-value",children:["\u20b9",(null===(L=t.salary)||void 0===L||null===(T=L.specialAllowance)||void 0===T?void 0:T.toLocaleString())||"0"]})]}),(0,x.jsxs)("div",{className:"salary-row",children:[(0,x.jsx)("span",{className:"salary-label",children:"Bonus"}),(0,x.jsxs)("span",{className:"salary-value positive",children:["\u20b9",(null===(E=t.salary)||void 0===E||null===(D=E.bonus)||void 0===D?void 0:D.toLocaleString())||"0"]})]}),(0,x.jsxs)("div",{className:"salary-row",children:[(0,x.jsx)("span",{className:"salary-label",children:"Overtime"}),(0,x.jsxs)("span",{className:"salary-value positive",children:["\u20b9",(null===(P=t.salary)||void 0===P||null===(R=P.overtime)||void 0===R?void 0:R.toLocaleString())||"0"]})]}),(0,x.jsx)("hr",{className:"salary-divider"}),(0,x.jsxs)("div",{className:"salary-row salary-total-row",children:[(0,x.jsx)("span",{className:"salary-label",children:"Gross Salary"}),(0,x.jsxs)("span",{className:"salary-value positive",children:["\u20b9",(null===(I=t.salary)||void 0===I||null===(B=I.grossSalary)||void 0===B?void 0:B.toLocaleString())||"0"]})]})]}),(0,x.jsxs)("div",{className:"salary-detail-card",children:[(0,x.jsx)("h5",{children:"\ud83d\udcc9 Deductions & Net Salary"}),(0,x.jsxs)("div",{className:"salary-row",children:[(0,x.jsx)("span",{className:"salary-label",children:"Provident Fund"}),(0,x.jsxs)("span",{className:"salary-value negative",children:["\u20b9",(null===(F=t.salary)||void 0===F||null===(O=F.providentFund)||void 0===O?void 0:O.toLocaleString())||"0"]})]}),(0,x.jsxs)("div",{className:"salary-row",children:[(0,x.jsx)("span",{className:"salary-label",children:"Professional Tax"}),(0,x.jsxs)("span",{className:"salary-value negative",children:["\u20b9",(null===(q=t.salary)||void 0===q||null===(z=q.professionalTax)||void 0===z?void 0:z.toLocaleString())||"0"]})]}),(0,x.jsxs)("div",{className:"salary-row",children:[(0,x.jsx)("span",{className:"salary-label",children:"Income Tax"}),(0,x.jsxs)("span",{className:"salary-value negative",children:["\u20b9",(null===(M=t.salary)||void 0===M||null===(U=M.incomeTax)||void 0===U?void 0:U.toLocaleString())||"0"]})]}),(0,x.jsxs)("div",{className:"salary-row",children:[(0,x.jsx)("span",{className:"salary-label",children:"Other Deductions"}),(0,x.jsxs)("span",{className:"salary-value negative",children:["\u20b9",(null===(W=t.salary)||void 0===W||null===(H=W.otherDeductions)||void 0===H?void 0:H.toLocaleString())||"0"]})]}),(0,x.jsx)("hr",{className:"salary-divider"}),(0,x.jsxs)("div",{className:"salary-row salary-total-row",children:[(0,x.jsx)("span",{className:"salary-label",children:"Net Salary"}),(0,x.jsxs)("span",{className:"salary-value positive",children:["\u20b9",(null===(V=t.salary)||void 0===V||null===(G=V.netSalary)||void 0===G?void 0:G.toLocaleString())||"0"]})]}),(0,x.jsxs)("span",{className:"salary-status-badge ".concat("paid"===(null===(J=t.salary)||void 0===J?void 0:J.status)?"paid":"approved"===(null===(Y=t.salary)||void 0===Y?void 0:Y.status)?"approved":"draft"),children:["Status: ",(null===(K=t.salary)||void 0===K||null===(Q=K.status)||void 0===Q?void 0:Q.toUpperCase())||"DRAFT"]})]})]})},_s=e=>{let{history:t,salaryType:a}=e;return(0,x.jsxs)("div",{className:"history-container",children:[(0,x.jsxs)("h4",{children:["\ud83d\udccb Salary History (","daily"===a?"Daily Wage":"Monthly Salary",")"]}),(0,x.jsx)("div",{className:"table-responsive",children:(0,x.jsxs)("table",{className:"salary-history-table",children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{children:"Period"}),(0,x.jsx)("th",{children:"Type"}),(0,x.jsx)("th",{children:"Working Days"}),(0,x.jsx)("th",{children:"Gross Amount"}),(0,x.jsx)("th",{children:"Net Amount"}),(0,x.jsx)("th",{children:"Status"}),(0,x.jsx)("th",{children:"Actions"})]})}),(0,x.jsxs)("tbody",{children:[t.map(e=>{var t,n,s,r;return(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{children:"daily"===a?"".concat(e.month,"/").concat(e.year):new Date(e.year,e.month-1).toLocaleString("default",{month:"short",year:"numeric"})}),(0,x.jsx)("td",{children:"daily"===a?"Daily Wage":"Monthly Salary"}),(0,x.jsx)("td",{children:e.workingDays||"-"}),(0,x.jsxs)("td",{children:["\u20b9",(null===(t=e.grossSalary)||void 0===t?void 0:t.toLocaleString())||"-"]}),(0,x.jsxs)("td",{children:["\u20b9",(null===(n=e.netSalary)||void 0===n?void 0:n.toLocaleString())||(null===(s=e.pendingAmount)||void 0===s?void 0:s.toLocaleString())||"-"]}),(0,x.jsx)("td",{children:(0,x.jsx)("span",{className:"table-badge ".concat("paid"===e.status?"success":"approved"===e.status?"info":"warning"),children:(null===(r=e.status)||void 0===r?void 0:r.toUpperCase())||"PENDING"})}),(0,x.jsx)("td",{children:("paid"===e.status||"approved"===e.status)&&(0,x.jsxs)("button",{className:"download-btn",children:[(0,x.jsx)("i",{className:"fas fa-download"})," Download"]})})]},e._id)}),0===t.length&&(0,x.jsx)("tr",{children:(0,x.jsx)("td",{colSpan:7,className:"empty-history-message",children:"No salary history available"})})]})]})})]})},Ls=()=>{var e;const{user:t}=y(),[a,s]=(0,n.useState)("current"),[r,i]=(0,n.useState)(null),[l,o]=(0,n.useState)([]),[c,d]=(0,n.useState)(!1),u=(e=>{switch(e){case"delivery_staff":case"field_staff":return"daily";default:return"monthly"}})(null===t||void 0===t?void 0:t.role),h=(e=>{switch(e){case"delivery_staff":case"field_staff":return"Daily Wage System";case"lab":case"lab_staff":case"lab_manager":return"Monthly Salary System";default:return"Salary System"}})(null===t||void 0===t?void 0:t.role);return(0,n.useEffect)(()=>{(async()=>{if(null!==t&&void 0!==t&&t._id){d(!0);try{const e="http://localhost:5000",t=localStorage.getItem("token"),a=await fetch("".concat(e,"/api/unified-salary/unified"),{headers:{Authorization:"Bearer ".concat(t)}});if(a.ok){const e=await a.json();i(e.data)}}catch(e){console.error("Error loading salary data:",e)}finally{d(!1)}}})()},[t]),(0,n.useEffect)(()=>{(async()=>{if(null!==t&&void 0!==t&&t._id)try{const e="http://localhost:5000",t=localStorage.getItem("token"),a=await fetch("".concat(e,"/api/unified-salary/unified/history"),{headers:{Authorization:"Bearer ".concat(t)}});if(a.ok){const e=await a.json();o(e.data||[])}}catch(e){console.error("Error loading salary history:",e)}})()},[t]),c?(0,x.jsx)("div",{className:"loading-spinner",children:(0,x.jsx)("div",{className:"spinner"})}):(0,x.jsx)("div",{className:"unified-salary-container",children:(0,x.jsx)("div",{className:"salary-card-wrapper",children:(0,x.jsxs)("div",{className:"salary-main-card",children:[(0,x.jsxs)("div",{className:"salary-header",children:[(0,x.jsx)("h3",{children:h}),(0,x.jsxs)("div",{className:"view-toggle-group",children:[(0,x.jsx)("button",{className:"view-toggle-btn ".concat("current"===a?"active":""),onClick:()=>s("current"),children:"Current Period"}),(0,x.jsx)("button",{className:"view-toggle-btn ".concat("history"===a?"active":""),onClick:()=>s("history"),children:"History"})]})]}),(0,x.jsxs)("div",{className:"salary-body",children:[(0,x.jsxs)("div",{className:"salary-type-info",children:[(0,x.jsxs)("h5",{children:[(0,x.jsx)("i",{className:"fas fa-info-circle"})," Your Salary Type"]}),(0,x.jsxs)("p",{children:[(0,x.jsx)("strong",{children:"Role:"})," ",null===t||void 0===t||null===(e=t.role)||void 0===e?void 0:e.replace("_"," ").toUpperCase()," |",(0,x.jsx)("strong",{children:" Payment Type:"})," ","daily"===u?"Daily Wage":"Monthly Salary"]}),(0,x.jsx)("small",{children:"daily"===u?"Your salary is calculated based on daily attendance and wage rate.":"Your salary is calculated based on monthly salary template and allowances."})]}),"current"===a?r?(0,x.jsx)(Cs,{salaryData:r,salaryType:u}):(0,x.jsxs)("div",{className:"no-data-message",children:[(0,x.jsx)("h5",{children:"No Salary Data Available"}),(0,x.jsx)("p",{children:"Please contact HR to set up your salary structure."})]}):(0,x.jsx)(_s,{history:l,salaryType:u})]})]})})})},Ts=e=>{let{defaultView:t}=e;return(0,x.jsx)(Ls,{})},Es=()=>{const e="http://localhost:5000",t=localStorage.getItem("token"),[a,s]=(0,n.useState)({leaveType:"casual",dayType:"full",startDate:"",endDate:"",reason:""}),[r,l]=(0,n.useState)([]),[o,c]=(0,n.useState)(!0),[d,u]=(0,n.useState)(!1),[h,p]=(0,n.useState)(""),[f,m]=(0,n.useState)({}),[g,v]=(0,n.useState)(!1),y=(new Date).toISOString().split("T")[0],b=new Date;b.setFullYear(b.getFullYear()+2);const j=b.toISOString().split("T")[0],w=(0,n.useCallback)(async()=>{try{c(!0);const a=await fetch("".concat(e,"/api/leave/my-leaves"),{headers:{Authorization:"Bearer ".concat(t)}});if(a.ok){const e=await a.json();console.log("API Response:",e);const t=Array.isArray(null===e||void 0===e?void 0:e.leaves)?e.leaves:Array.isArray(e)?e:[];console.log("Processed leaves array:",t),l(t)}else console.log("API Error:",a.status,a.statusText),l([]),p("Failed to load leave requests")}catch(h){console.error("Error loading leaves:",h),l([]),p("Failed to load leave requests")}finally{c(!1)}},[e,t]);(0,n.useEffect)(()=>{w()},[w]);return(0,x.jsxs)("div",{style:{padding:16},children:[(0,x.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[(0,x.jsx)("h2",{style:{margin:0},children:"Field Staff Leave Management"}),(0,x.jsx)("button",{className:"btn btn-outline-primary",onClick:()=>v(!0),children:"\ud83d\udccb View Leave History"})]}),h&&(0,x.jsx)("div",{style:{color:"crimson",marginTop:8},children:h}),(0,x.jsxs)("form",{onSubmit:async n=>{if(n.preventDefault(),p(""),m({}),(()=>{const e={},t=new Date;if(t.setHours(0,0,0,0),a.startDate){const n=new Date(a.startDate);n<t&&(e.startDate="Start date cannot be in the past");const s=new Date;s.setFullYear(s.getFullYear()+2),n>s&&(e.startDate="Start date too far in future")}else e.startDate="Start date is required";if(a.endDate){const n=new Date(a.endDate);n<t&&(e.endDate="End date cannot be in the past");const s=new Date;s.setFullYear(s.getFullYear()+2),n>s&&(e.endDate="End date too far in future")}else e.endDate="End date is required";if(a.startDate&&a.endDate){const t=new Date(a.startDate),n=new Date(a.endDate);n<t&&(e.endDate="End date cannot be earlier than start date"),"half"===a.dayType&&t.toDateString()!==n.toDateString()&&(e.endDate="Half day leave must be for a single day only")}return m(e),0===Object.keys(e).length})())try{u(!0);const n=await fetch("".concat(e,"/api/leave/apply"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify(a)});if(n.ok)s({leaveType:"casual",dayType:"full",startDate:"",endDate:"",reason:""}),await w();else{const e=await n.json().catch(()=>({}));p(e.message||"Failed to apply leave")}}catch(r){p("Failed to apply leave. Please try again.")}finally{u(!1)}},style:{maxWidth:640,marginTop:12},children:[(0,x.jsxs)("div",{className:"form-row",style:{display:"flex",gap:12},children:[(0,x.jsxs)("div",{className:"form-group",style:{flex:1},children:[(0,x.jsx)("label",{children:"Leave Type"}),(0,x.jsxs)("select",{className:"form-control",value:a.leaveType,onChange:e=>s((0,i.A)((0,i.A)({},a),{},{leaveType:e.target.value})),children:[(0,x.jsx)("option",{value:"casual",children:"Casual"}),(0,x.jsx)("option",{value:"sick",children:"Sick"}),(0,x.jsx)("option",{value:"earned",children:"Earned"})]})]}),(0,x.jsxs)("div",{className:"form-group",style:{flex:1},children:[(0,x.jsx)("label",{children:"Day Type"}),(0,x.jsxs)("select",{className:"form-control",value:a.dayType,onChange:e=>{const t=e.target.value;s(e=>{let a=e.endDate;return"half"===t&&e.startDate&&(a=e.startDate),(0,i.A)((0,i.A)({},e),{},{dayType:t,endDate:a})})},children:[(0,x.jsx)("option",{value:"full",children:"Full Day"}),(0,x.jsx)("option",{value:"half",children:"Half Day"})]})]}),(0,x.jsxs)("div",{className:"form-group",style:{flex:1},children:[(0,x.jsx)("label",{children:"Start Date *"}),(0,x.jsx)("input",{type:"date",className:"form-control",value:a.startDate,min:y,max:j,onChange:e=>{const t=e.target.value;s(e=>{let a=e.endDate;return a&&t&&new Date(a)<new Date(t)&&(a=t),"half"===e.dayType&&t&&(a=t),(0,i.A)((0,i.A)({},e),{},{startDate:t,endDate:a})}),f.startDate&&m(e=>(0,i.A)((0,i.A)({},e),{},{startDate:""})),f.endDate&&m(e=>(0,i.A)((0,i.A)({},e),{},{endDate:""}))},style:{borderColor:f.startDate?"#dc3545":""}}),f.startDate&&(0,x.jsx)("div",{style:{color:"#dc3545",fontSize:12},children:f.startDate})]}),(0,x.jsxs)("div",{className:"form-group",style:{flex:1},children:[(0,x.jsx)("label",{children:"End Date *"}),(0,x.jsx)("input",{type:"date",className:"form-control",value:a.endDate,min:a.startDate||y,max:j,onChange:e=>{s(t=>(0,i.A)((0,i.A)({},t),{},{endDate:e.target.value})),f.endDate&&m(e=>(0,i.A)((0,i.A)({},e),{},{endDate:""}))},style:{borderColor:f.endDate?"#dc3545":""}}),f.endDate&&(0,x.jsx)("div",{style:{color:"#dc3545",fontSize:12},children:f.endDate})]})]}),(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{children:"Reason"}),(0,x.jsx)("textarea",{className:"form-control",value:a.reason,onChange:e=>s((0,i.A)((0,i.A)({},a),{},{reason:e.target.value}))})]}),(0,x.jsx)("button",{className:"btn btn-primary",type:"submit",disabled:d,children:d?"Submitting...":"Apply"})]}),(0,x.jsxs)("div",{style:{marginTop:24},children:[(0,x.jsx)("h4",{children:"My Leave Requests"}),o?(0,x.jsx)("div",{children:"Loading..."}):(0,x.jsxs)("table",{className:"table table-sm",children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{children:"Type"}),(0,x.jsx)("th",{children:"Start"}),(0,x.jsx)("th",{children:"End"}),(0,x.jsx)("th",{children:"Day Type"}),(0,x.jsx)("th",{children:"Status"}),(0,x.jsx)("th",{children:"Actions"})]})}),(0,x.jsxs)("tbody",{children:[(Array.isArray(r)?r:[]).map(a=>(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{children:a.leaveType}),(0,x.jsx)("td",{children:a.startDate?new Date(a.startDate).toLocaleDateString():"-"}),(0,x.jsx)("td",{children:a.endDate?new Date(a.endDate).toLocaleDateString():"-"}),(0,x.jsx)("td",{children:a.dayType||"full"}),(0,x.jsx)("td",{children:a.status}),(0,x.jsx)("td",{children:"pending"===a.status&&(0,x.jsx)("button",{className:"btn btn-sm btn-outline-danger",onClick:()=>(async a=>{await fetch("".concat(e,"/api/leave/cancel/").concat(a),{method:"DELETE",headers:{Authorization:"Bearer ".concat(t)}}),await w()})(a._id),children:"Cancel"})})]},a._id)),(!Array.isArray(r)||0===r.length)&&(0,x.jsx)("tr",{children:(0,x.jsx)("td",{colSpan:6,children:"No leave requests"})})]})]})]}),(0,x.jsx)(me,{isOpen:g,onClose:()=>v(!1)})]})},Ds=()=>{const[e,t]=(0,n.useState)(null),[a,s]=(0,n.useState)(!0),[r,l]=(0,n.useState)(""),[o,c]=(0,n.useState)(!1),[d,u]=(0,n.useState)({requestDate:"",currentShift:"",requestedShift:"",reason:""}),[h,p]=(0,n.useState)(!1),[f,m]=(0,n.useState)([]),[g,v]=(0,n.useState)("week"),y="http://localhost:5000",b=localStorage.getItem("token"),j=async()=>{try{s(!0),l("");const e=await fetch("".concat(y,"/api/workers/field/shift-schedule"),{headers:{Authorization:"Bearer ".concat(b)}}),a=await e.json();e.ok?t(a):l(a.message||"Failed to load shift schedule")}catch(r){console.error("Error fetching shift schedule:",r),l("Failed to load shift schedule")}finally{s(!1)}},w=async()=>{try{const e=await fetch("".concat(y,"/api/workers/schedule-change-requests"),{headers:{Authorization:"Bearer ".concat(b)}});if(e.ok){const t=await e.json();m(t)}}catch(r){console.error("Error fetching requests:",r)}};(0,n.useEffect)(()=>{j(),w()},[]);const N=e=>new Date(e).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),S=e=>{const t=new Date(e),a=[];for(let n=0;n<7;n++){const e=new Date(t);e.setDate(t.getDate()+n),a.push(e)}return a},k=e=>e.toLocaleDateString("en-US",{weekday:"long"}),A=e=>{const t=new Date;return e.toDateString()===t.toDateString()},C=e=>"Morning"===e?"fa-sun":"Evening"===e?"fa-moon":"fa-calendar-times",_=e=>"Morning"===e?"#ffc107":"Evening"===e?"#6f42c1":"#6c757d",L=e=>{switch(e){case"pending":return"#ffa500";case"approved":return"#28a745";case"rejected":return"#dc3545";default:return"#6c757d"}};return a?(0,x.jsx)("div",{className:"my-schedule",children:(0,x.jsx)("div",{className:"loading",children:"Loading schedule..."})}):r?(0,x.jsxs)("div",{className:"my-schedule",children:[(0,x.jsx)("div",{className:"error",children:r}),(0,x.jsx)("button",{onClick:j,className:"retry-btn",children:"Retry"})]}):(0,x.jsxs)("div",{className:"my-schedule",children:[(0,x.jsx)("div",{className:"page-header",children:(0,x.jsxs)("div",{className:"header-content",children:[(0,x.jsxs)("div",{className:"header-left",children:[(0,x.jsxs)("h2",{children:[(0,x.jsx)("i",{className:"fas fa-calendar-alt"}),"My Shift Schedule"]}),(0,x.jsx)("p",{className:"header-subtitle",children:"View and manage your work schedule"})]}),(0,x.jsxs)("div",{className:"header-actions",children:[(0,x.jsxs)("button",{onClick:j,className:"refresh-btn",title:"Refresh schedule",children:[(0,x.jsx)("i",{className:"fas fa-sync-alt"}),(0,x.jsx)("span",{className:"btn-text",children:"Refresh"})]}),(0,x.jsxs)("button",{onClick:()=>c(!o),className:"request-btn",title:"Request a schedule change",children:[(0,x.jsx)("i",{className:"fas fa-calendar-plus"}),(0,x.jsx)("span",{className:"btn-text",children:"Request Change"})]})]})]})}),e&&e.myAssignment?(0,x.jsxs)("div",{className:"schedule-content",children:[(0,x.jsxs)("div",{className:"quick-stats",children:[(0,x.jsxs)("div",{className:"stat-card highlight-card",children:[(0,x.jsx)("div",{className:"stat-icon",style:{color:_(e.myAssignment.shiftType)},children:(0,x.jsx)("i",{className:"fas ".concat(C(e.myAssignment.shiftType))})}),(0,x.jsxs)("div",{className:"stat-info",children:[(0,x.jsx)("div",{className:"stat-label",children:"Current Shift"}),(0,x.jsx)("div",{className:"stat-value",children:e.myAssignment.shiftType})]})]}),(0,x.jsxs)("div",{className:"stat-card",children:[(0,x.jsx)("div",{className:"stat-icon",style:{color:"#28a745"},children:(0,x.jsx)("i",{className:"fas fa-clock"})}),(0,x.jsxs)("div",{className:"stat-info",children:[(0,x.jsx)("div",{className:"stat-label",children:"Shift Hours"}),(0,x.jsxs)("div",{className:"stat-value",children:[e.myAssignment.startTime," - ",e.myAssignment.endTime]})]})]}),(0,x.jsxs)("div",{className:"stat-card",children:[(0,x.jsx)("div",{className:"stat-icon",style:{color:"#007bff"},children:(0,x.jsx)("i",{className:"fas fa-calendar-week"})}),(0,x.jsxs)("div",{className:"stat-info",children:[(0,x.jsx)("div",{className:"stat-label",children:"This Week"}),(0,x.jsx)("div",{className:"stat-value",children:new Date(e.weekStart).toLocaleDateString("en-US",{month:"short",day:"numeric"})})]})]})]}),(0,x.jsxs)("div",{className:"week-calendar",children:[(0,x.jsxs)("div",{className:"week-header",children:[(0,x.jsxs)("h3",{children:[(0,x.jsx)("i",{className:"fas fa-calendar-week"}),"Week of ",N(e.weekStart)]}),(0,x.jsxs)("div",{className:"view-toggle",children:[(0,x.jsx)("button",{className:"toggle-btn ".concat("week"===g?"active":""),onClick:()=>v("week"),title:"Week view",children:(0,x.jsx)("i",{className:"fas fa-calendar-week"})}),(0,x.jsx)("button",{className:"toggle-btn ".concat("list"===g?"active":""),onClick:()=>v("list"),title:"List view",children:(0,x.jsx)("i",{className:"fas fa-list"})})]})]}),"week"===g?(0,x.jsx)("div",{className:"week-grid",children:S(e.weekStart).map((t,a)=>{const n=A(t);return(0,x.jsxs)("div",{className:"day-card ".concat(n?"today":""),children:[(0,x.jsxs)("div",{className:"day-header",children:[(0,x.jsx)("div",{className:"day-name",children:t.toLocaleDateString("en-US",{weekday:"short"})}),(0,x.jsx)("div",{className:"day-number",children:t.getDate()}),n&&(0,x.jsx)("span",{className:"today-badge",children:"Today"})]}),(0,x.jsxs)("div",{className:"day-content",children:[(0,x.jsxs)("div",{className:"shift-badge",style:{background:"".concat(_(e.myAssignment.shiftType),"20"),borderLeft:"3px solid ".concat(_(e.myAssignment.shiftType))},children:[(0,x.jsx)("i",{className:"fas ".concat(C(e.myAssignment.shiftType)),style:{color:_(e.myAssignment.shiftType)}}),(0,x.jsx)("span",{children:e.myAssignment.shiftType})]}),(0,x.jsxs)("div",{className:"shift-time",children:[e.myAssignment.startTime," - ",e.myAssignment.endTime]})]})]},a)})}):(0,x.jsx)("div",{className:"week-list",children:S(e.weekStart).map((t,a)=>{const n=A(t);return(0,x.jsxs)("div",{className:"list-item ".concat(n?"today":""),children:[(0,x.jsxs)("div",{className:"list-date",children:[(0,x.jsx)("div",{className:"date-circle",children:t.getDate()}),(0,x.jsxs)("div",{className:"date-info",children:[(0,x.jsx)("div",{className:"date-day",children:k(t)}),(0,x.jsx)("div",{className:"date-month",children:t.toLocaleDateString("en-US",{month:"long",year:"numeric"})})]}),n&&(0,x.jsx)("span",{className:"today-badge",children:"Today"})]}),(0,x.jsxs)("div",{className:"list-shift",children:[(0,x.jsxs)("div",{className:"shift-type-badge",style:{color:_(e.myAssignment.shiftType)},children:[(0,x.jsx)("i",{className:"fas ".concat(C(e.myAssignment.shiftType))}),e.myAssignment.shiftType," Shift"]}),(0,x.jsxs)("div",{className:"shift-timing",children:[(0,x.jsx)("i",{className:"fas fa-clock"}),e.myAssignment.startTime," - ",e.myAssignment.endTime]})]})]},a)})})]}),(0,x.jsxs)("div",{className:"shift-reference",children:[(0,x.jsxs)("h3",{children:[(0,x.jsx)("i",{className:"fas fa-info-circle"}),"All Available Shifts"]}),(0,x.jsxs)("div",{className:"shifts-grid",children:[(0,x.jsxs)("div",{className:"shift-card morning-shift",children:[(0,x.jsxs)("div",{className:"shift-card-header",children:[(0,x.jsx)("i",{className:"fas fa-sun"}),(0,x.jsx)("span",{children:"Morning Shift"})]}),(0,x.jsxs)("div",{className:"shift-card-time",children:[(0,x.jsx)("i",{className:"fas fa-clock"}),e.morningStart," - ",e.morningEnd]}),"Morning"===e.myAssignment.shiftType&&(0,x.jsxs)("div",{className:"current-shift-badge",children:[(0,x.jsx)("i",{className:"fas fa-check-circle"})," Your Shift"]})]}),(0,x.jsxs)("div",{className:"shift-card evening-shift",children:[(0,x.jsxs)("div",{className:"shift-card-header",children:[(0,x.jsx)("i",{className:"fas fa-moon"}),(0,x.jsx)("span",{children:"Evening Shift"})]}),(0,x.jsxs)("div",{className:"shift-card-time",children:[(0,x.jsx)("i",{className:"fas fa-clock"}),e.eveningStart," - ",e.eveningEnd]}),"Evening"===e.myAssignment.shiftType&&(0,x.jsxs)("div",{className:"current-shift-badge",children:[(0,x.jsx)("i",{className:"fas fa-check-circle"})," Your Shift"]})]})]})]})]}):(0,x.jsx)("div",{className:"no-schedule-container",children:(0,x.jsxs)("div",{className:"no-schedule",children:[(0,x.jsx)("div",{className:"no-schedule-icon",children:(0,x.jsx)("i",{className:"fas fa-calendar-times"})}),(0,x.jsx)("h3",{children:"No Shift Assigned"}),(0,x.jsx)("p",{className:"no-schedule-message",children:"You haven't been assigned to any shift for this week yet."}),(0,x.jsxs)("div",{className:"no-schedule-action",children:[(0,x.jsx)("p",{children:"Please contact your administrator for shift assignment."}),(0,x.jsxs)("button",{onClick:j,className:"retry-action-btn",children:[(0,x.jsx)("i",{className:"fas fa-redo"})," Check Again"]})]})]})}),o&&(0,x.jsx)("div",{className:"request-form-overlay",children:(0,x.jsxs)("div",{className:"request-form",children:[(0,x.jsxs)("div",{className:"form-header",children:[(0,x.jsx)("h3",{children:"Request Schedule Change"}),(0,x.jsx)("button",{onClick:()=>c(!1),className:"close-btn",children:(0,x.jsx)("i",{className:"fas fa-times"})})]}),(0,x.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),p(!0);try{const e=await fetch("".concat(y,"/api/workers/schedule-change-requests"),{method:"POST",headers:{Authorization:"Bearer ".concat(b),"Content-Type":"application/json"},body:JSON.stringify(d)});if(e.ok)alert("Schedule change request submitted successfully!"),c(!1),u({requestDate:"",currentShift:"",requestedShift:"",reason:""}),w();else{const t=await e.json();alert(t.message||"Failed to submit request")}}catch(r){console.error("Error submitting request:",r),alert("Failed to submit request")}finally{p(!1)}},children:[(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{children:"Date for Change:"}),(0,x.jsx)("input",{type:"date",value:d.requestDate,onChange:e=>u((0,i.A)((0,i.A)({},d),{},{requestDate:e.target.value})),min:(new Date).toISOString().split("T")[0],max:new Date(Date.now()+12096e5).toISOString().split("T")[0],required:!0}),(0,x.jsx)("small",{children:"You can request changes up to 2 weeks in advance"})]}),(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{children:"Current Shift:"}),(0,x.jsxs)("select",{value:d.currentShift,onChange:e=>u((0,i.A)((0,i.A)({},d),{},{currentShift:e.target.value})),required:!0,children:[(0,x.jsx)("option",{value:"",children:"Select current shift"}),(0,x.jsx)("option",{value:"Morning",children:"Morning Shift"}),(0,x.jsx)("option",{value:"Evening",children:"Evening Shift"})]})]}),(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{children:"Requested Shift:"}),(0,x.jsxs)("select",{value:d.requestedShift,onChange:e=>u((0,i.A)((0,i.A)({},d),{},{requestedShift:e.target.value})),required:!0,children:[(0,x.jsx)("option",{value:"",children:"Select requested shift"}),(0,x.jsx)("option",{value:"Morning",children:"Morning Shift"}),(0,x.jsx)("option",{value:"Evening",children:"Evening Shift"}),(0,x.jsx)("option",{value:"Off",children:"Day Off"})]})]}),(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{children:"Reason for Change:"}),(0,x.jsx)("textarea",{value:d.reason,onChange:e=>u((0,i.A)((0,i.A)({},d),{},{reason:e.target.value})),placeholder:"Please provide a reason for the schedule change request...",rows:"3",required:!0})]}),(0,x.jsxs)("div",{className:"form-actions",children:[(0,x.jsx)("button",{type:"button",onClick:()=>c(!1),className:"cancel-btn",children:"Cancel"}),(0,x.jsx)("button",{type:"submit",disabled:h,className:"submit-btn",children:h?"Submitting...":"Submit Request"})]})]})]})}),(0,x.jsxs)("div",{className:"my-requests",children:[(0,x.jsxs)("div",{className:"section-header",children:[(0,x.jsxs)("h3",{children:[(0,x.jsx)("i",{className:"fas fa-exchange-alt"}),"My Schedule Change Requests"]}),f.length>0&&(0,x.jsxs)("span",{className:"requests-count",children:[f.filter(e=>"pending"===e.status).length," Pending"]})]}),0===f.length?(0,x.jsxs)("div",{className:"no-requests",children:[(0,x.jsx)("i",{className:"fas fa-inbox"}),(0,x.jsx)("p",{children:"You haven't submitted any schedule change requests yet."}),(0,x.jsxs)("button",{onClick:()=>c(!0),className:"quick-request-btn",children:[(0,x.jsx)("i",{className:"fas fa-plus-circle"}),"Submit Your First Request"]})]}):(0,x.jsx)("div",{className:"requests-list",children:f.map(e=>(0,x.jsxs)("div",{className:"request-card status-".concat(e.status),children:[(0,x.jsx)("div",{className:"request-status-indicator",style:{background:L(e.status)}}),(0,x.jsxs)("div",{className:"request-content",children:[(0,x.jsxs)("div",{className:"request-header",children:[(0,x.jsxs)("div",{className:"request-date",children:[(0,x.jsx)("i",{className:"fas fa-calendar"}),(0,x.jsx)("span",{children:N(e.requestDate)})]}),(0,x.jsxs)("span",{className:"status-badge ".concat(e.status),children:[(0,x.jsx)("i",{className:"fas ".concat("pending"===e.status?"fa-clock":"approved"===e.status?"fa-check-circle":"fa-times-circle")}),e.status.charAt(0).toUpperCase()+e.status.slice(1)]})]}),(0,x.jsxs)("div",{className:"request-details",children:[(0,x.jsxs)("div",{className:"shift-change-info",children:[(0,x.jsxs)("div",{className:"shift-item from",children:[(0,x.jsx)("span",{className:"label",children:"From"}),(0,x.jsxs)("span",{className:"value",children:[(0,x.jsx)("i",{className:"fas ".concat(C(e.currentShift))}),e.currentShift," Shift"]})]}),(0,x.jsx)("i",{className:"fas fa-long-arrow-alt-right arrow-icon"}),(0,x.jsxs)("div",{className:"shift-item to",children:[(0,x.jsx)("span",{className:"label",children:"To"}),(0,x.jsxs)("span",{className:"value",children:[(0,x.jsx)("i",{className:"fas ".concat("Off"===e.requestedShift?"fa-calendar-times":C(e.requestedShift))}),"Off"===e.requestedShift?"Day Off":"".concat(e.requestedShift," Shift")]})]})]}),(0,x.jsxs)("div",{className:"request-reason",children:[(0,x.jsxs)("div",{className:"reason-label",children:[(0,x.jsx)("i",{className:"fas fa-comment"}),"Reason"]}),(0,x.jsx)("div",{className:"reason-text",children:e.reason})]}),e.managerResponse&&(0,x.jsxs)("div",{className:"manager-response",children:[(0,x.jsxs)("div",{className:"response-label",children:[(0,x.jsx)("i",{className:"fas fa-reply"}),"Manager Response"]}),(0,x.jsx)("div",{className:"response-text",children:e.managerResponse})]})]}),(0,x.jsx)("div",{className:"request-footer",children:(0,x.jsxs)("div",{className:"request-date-submitted",children:[(0,x.jsx)("i",{className:"fas fa-clock"}),"Submitted ",new Date(e.createdAt).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"})]})})]})]},e._id))})]}),(0,x.jsxs)("div",{className:"help-section",children:[(0,x.jsx)("div",{className:"help-header",children:(0,x.jsxs)("h4",{children:[(0,x.jsx)("i",{className:"fas fa-lightbulb"}),"Schedule Guidelines & Tips"]})}),(0,x.jsxs)("div",{className:"help-grid",children:[(0,x.jsxs)("div",{className:"help-card",children:[(0,x.jsx)("div",{className:"help-icon",children:(0,x.jsx)("i",{className:"fas fa-clock"})}),(0,x.jsxs)("div",{className:"help-content",children:[(0,x.jsx)("h5",{children:"Advance Notice"}),(0,x.jsx)("p",{children:"Submit requests at least 24 hours in advance"})]})]}),(0,x.jsxs)("div",{className:"help-card",children:[(0,x.jsx)("div",{className:"help-icon",children:(0,x.jsx)("i",{className:"fas fa-calendar-check"})}),(0,x.jsxs)("div",{className:"help-content",children:[(0,x.jsx)("h5",{children:"Planning Ahead"}),(0,x.jsx)("p",{children:"Request changes up to 2 weeks in advance"})]})]}),(0,x.jsxs)("div",{className:"help-card",children:[(0,x.jsx)("div",{className:"help-icon",children:(0,x.jsx)("i",{className:"fas fa-user-check"})}),(0,x.jsxs)("div",{className:"help-content",children:[(0,x.jsx)("h5",{children:"Approval Required"}),(0,x.jsx)("p",{children:"All requests need manager approval"})]})]}),(0,x.jsxs)("div",{className:"help-card",children:[(0,x.jsx)("div",{className:"help-icon",children:(0,x.jsx)("i",{className:"fas fa-exclamation-triangle"})}),(0,x.jsxs)("div",{className:"help-content",children:[(0,x.jsx)("h5",{children:"Emergencies"}),(0,x.jsx)("p",{children:"Contact your manager directly for urgent changes"})]})]})]})]})]})},Ps=()=>(0,x.jsxs)("div",{children:[(0,x.jsx)("h2",{children:"Wage Rates"}),(0,x.jsx)("p",{children:"These are indicative rates. Actual rates may vary based on policy updates."}),(0,x.jsx)("div",{className:"rates-table",style:{overflowX:"auto",marginTop:12},children:(0,x.jsxs)("table",{children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{children:"Role"}),(0,x.jsx)("th",{children:"Daily Rate"}),(0,x.jsx)("th",{children:"Hourly Rate"})]})}),(0,x.jsx)("tbody",{children:[{role:"Tapper",daily:900,hourly:120},{role:"Loader",daily:800,hourly:105},{role:"Driver",daily:1100,hourly:150}].map(e=>(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{children:e.role}),(0,x.jsxs)("td",{children:["\u20b9",e.daily]}),(0,x.jsxs)("td",{children:["\u20b9",e.hourly]})]},e.role))})]})})]}),Rs=()=>{const[e,t]=(0,n.useState)({subject:"",description:"",category:"general",priority:"normal"}),[a,s]=(0,n.useState)(!1),[r,l]=(0,n.useState)(""),o=a=>t((0,i.A)((0,i.A)({},e),{},{[a.target.name]:a.target.value}));return(0,x.jsxs)("div",{style:{maxWidth:720},children:[(0,x.jsx)("h2",{children:"Raise an Issue / Complaint"}),(0,x.jsx)("p",{children:"Please describe your issue. Our team will review and respond."}),(0,x.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),s(!0),l("");try{await new Promise(e=>setTimeout(e,600)),l("Issue submitted successfully."),t({subject:"",description:"",category:"general",priority:"normal"})}catch(r){var a,n;l((null===r||void 0===r||null===(a=r.response)||void 0===a||null===(n=a.data)||void 0===n?void 0:n.message)||"Failed to submit issue.")}finally{s(!1)}},style:{display:"grid",gap:12,marginTop:12},children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{children:"Subject"}),(0,x.jsx)("input",{name:"subject",value:e.subject,onChange:o,required:!0,style:{width:"100%"}})]}),(0,x.jsxs)("div",{style:{display:"flex",gap:12},children:[(0,x.jsxs)("div",{style:{flex:1},children:[(0,x.jsx)("label",{children:"Category"}),(0,x.jsxs)("select",{name:"category",value:e.category,onChange:o,children:[(0,x.jsx)("option",{value:"general",children:"General"}),(0,x.jsx)("option",{value:"salary",children:"Salary"}),(0,x.jsx)("option",{value:"schedule",children:"Schedule"}),(0,x.jsx)("option",{value:"safety",children:"Safety"}),(0,x.jsx)("option",{value:"other",children:"Other"})]})]}),(0,x.jsxs)("div",{style:{width:200},children:[(0,x.jsx)("label",{children:"Priority"}),(0,x.jsxs)("select",{name:"priority",value:e.priority,onChange:o,children:[(0,x.jsx)("option",{value:"low",children:"Low"}),(0,x.jsx)("option",{value:"normal",children:"Normal"}),(0,x.jsx)("option",{value:"high",children:"High"})]})]})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{children:"Description"}),(0,x.jsx)("textarea",{name:"description",value:e.description,onChange:o,rows:5,required:!0,style:{width:"100%"}})]}),(0,x.jsx)("div",{children:(0,x.jsx)("button",{className:"btn btn-primary",type:"submit",disabled:a,children:a?"Submitting...":"Submit Issue"})}),r&&(0,x.jsx)("div",{role:"status",style:{opacity:.9},children:r})]})]})},Is=["D","E","F","G","H","I","J","K","L"],Bs=e=>{let{label:t,cols:a=10,vacantSet:n,onClaim:s}=e;return(0,x.jsx)("div",{className:"hanger-block","aria-label":"Hanger block ".concat(t),children:Is.map(e=>(0,x.jsx)("div",{className:"hanger-row",children:(0,x.jsx)("div",{className:"row-cells",children:Array.from({length:a}).map((a,r)=>{const i=r+1,l="".concat(t,"-").concat(e,"-").concat(i),o=n.has(l);return(0,x.jsx)("div",{className:"slot ".concat(o?"free":"occupied"),role:"button",tabIndex:0,onClick:()=>o&&s(t,e,i),title:o?"Vacant (click to claim)":"Occupied","aria-label":"".concat(e).concat(i," ").concat(o?"vacant":"occupied")},l)})})},"".concat(t,"-").concat(e)))})},Fs=()=>{const[e,t]=(0,n.useState)([]),[a,s]=(0,n.useState)(!1),[r,i]=(0,n.useState)(""),l=(0,n.useMemo)(()=>{const t=new Set;for(const a of e)t.add("".concat(a.block,"-").concat(a.row,"-").concat(a.col));return t},[e]),o=async()=>{s(!0),i("");try{const e=await ee("".concat(X,"/api/hanger-spaces/vacant"));t(e)}catch(n){var e,a;i((null===(e=n.response)||void 0===e||null===(a=e.data)||void 0===a?void 0:a.message)||n.message)}finally{s(!1)}};(0,n.useEffect)(()=>{o()},[]);const c=async(t,a,n)=>{try{const s=e.find(e=>e.block===t&&e.row===a&&e.col===n);if(!s)return;const r=window.prompt("Product/label (optional):","")||"";await function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return te("".concat(X,"/api/hanger-spaces/").concat(e,"/assign"),{action:t,product:a})}(s._id,"claim",r),await o(),alert("Slot claimed.")}catch(i){var s,r;alert((null===(s=i.response)||void 0===s||null===(r=s.data)||void 0===r?void 0:r.message)||i.message)}};return(0,x.jsxs)("div",{className:"hanger-page",children:[r&&(0,x.jsx)("div",{style:{color:"#fca5a5",marginBottom:12},children:r}),(0,x.jsxs)("div",{style:{display:"flex",gap:12,alignItems:"center",marginBottom:12},children:[(0,x.jsx)("button",{className:"btn",onClick:o,disabled:a,children:"Reload"}),(0,x.jsxs)("span",{style:{color:"#e2e8f0"},children:["Vacant: ",e.length]})]}),(0,x.jsxs)("div",{className:"hanger-wrap",children:[(0,x.jsx)("div",{className:"row-labels left","aria-hidden":!0,children:Is.map(e=>(0,x.jsx)("div",{className:"row-label",children:e},"left-".concat(e)))}),(0,x.jsx)(Bs,{label:"A",cols:10,vacantSet:l,onClaim:c}),(0,x.jsx)("div",{className:"hanger-gap"}),(0,x.jsx)(Bs,{label:"B",cols:10,vacantSet:l,onClaim:c}),(0,x.jsx)("div",{className:"row-labels right","aria-hidden":!0,children:Is.map(e=>(0,x.jsx)("div",{className:"row-label",children:e},"right-".concat(e)))})]}),(0,x.jsxs)("div",{className:"legend",children:[(0,x.jsxs)("div",{className:"legend-item",children:[(0,x.jsx)("span",{className:"slot free"})," Vacant"]}),(0,x.jsxs)("div",{className:"legend-item",children:[(0,x.jsx)("span",{className:"slot occupied"})," Occupied"]})]})]})},Os="http://localhost:5000",qs=()=>{const e=localStorage.getItem("token");return e?{Authorization:"Bearer ".concat(e)}:{}};async function zs(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{data:t}=await m.A.get("".concat(Os,"/api/staff/trips"),{params:e,headers:qs()});return t}async function Ms(e,t,a){const{data:n}=await m.A.patch("".concat(Os,"/api/staff/trips/").concat(e,"/stops/").concat(t,"/status"),a,{headers:(0,i.A)((0,i.A)({},qs()),{},{"Content-Type":"application/json"})});return n}const Us=()=>{const[e,t]=(0,n.useState)(""),[a,s]=(0,n.useState)(()=>(new Date).toISOString().split("T")[0]),[r,l]=(0,n.useState)([{customer:"",address:"",windowFrom:"",windowTo:"",type:"pickup",barrels:0,notes:""}]),o=(e,t,a)=>l(n=>n.map((n,s)=>s===e?(0,i.A)((0,i.A)({},n),{},{[t]:a}):n));return(0,x.jsxs)("div",{className:"user-rate-history",children:[(0,x.jsxs)("div",{className:"header",children:[(0,x.jsx)("h1",{children:"\ud83d\udee3\ufe0f Route Plan"}),(0,x.jsx)("p",{children:"Create the daily pickup/drop route and schedule"})]}),(0,x.jsxs)("form",{onSubmit:async t=>{t.preventDefault();try{const t={routeName:e,date:a,stops:r};await async function(e){const{data:t}=await m.A.post("".concat(Os,"/api/staff/trips"),e,{headers:(0,i.A)((0,i.A)({},qs()),{},{"Content-Type":"application/json"})});return t}(t),alert("Route plan saved.")}catch(l){var n,s;console.error(l),alert((null===l||void 0===l||null===(n=l.response)||void 0===n||null===(s=n.data)||void 0===s?void 0:s.message)||"Failed to save route plan")}},className:"dash-card",style:{maxWidth:980,margin:"0 auto"},children:[(0,x.jsxs)("div",{className:"grid",style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{children:"Route Name"}),(0,x.jsx)("input",{type:"text",value:e,onChange:e=>t(e.target.value),required:!0})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{children:"Date"}),(0,x.jsx)("input",{type:"date",value:a,onChange:e=>s(e.target.value),required:!0})]})]}),(0,x.jsxs)("div",{style:{marginTop:16},children:[(0,x.jsx)("h3",{children:"Stops"}),r.map((e,t)=>(0,x.jsxs)("div",{className:"dash-card",style:{padding:12,marginBottom:10},children:[(0,x.jsxs)("div",{className:"grid",style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:10},children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{children:"Customer"}),(0,x.jsx)("input",{type:"text",value:e.customer,onChange:e=>o(t,"customer",e.target.value)})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{children:"Type"}),(0,x.jsxs)("select",{value:e.type,onChange:e=>o(t,"type",e.target.value),children:[(0,x.jsx)("option",{value:"pickup",children:"Pickup"}),(0,x.jsx)("option",{value:"drop",children:"Drop"})]})]}),(0,x.jsxs)("div",{style:{gridColumn:"1 / -1"},children:[(0,x.jsx)("label",{children:"Address"}),(0,x.jsx)("input",{type:"text",value:e.address,onChange:e=>o(t,"address",e.target.value)})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{children:"Window From"}),(0,x.jsx)("input",{type:"time",value:e.windowFrom,onChange:e=>o(t,"windowFrom",e.target.value)})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{children:"Window To"}),(0,x.jsx)("input",{type:"time",value:e.windowTo,onChange:e=>o(t,"windowTo",e.target.value)})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{children:"Barrels"}),(0,x.jsx)("input",{type:"number",min:0,value:e.barrels,onChange:e=>o(t,"barrels",Number(e.target.value))})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{children:"Notes"}),(0,x.jsx)("input",{type:"text",value:e.notes,onChange:e=>o(t,"notes",e.target.value)})]})]}),(0,x.jsx)("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:8},children:(0,x.jsx)("button",{type:"button",className:"btn",onClick:()=>(e=>l(t=>t.filter((t,a)=>a!==e)))(t),children:"Remove"})})]},t))]}),(0,x.jsxs)("div",{style:{display:"flex",gap:10,marginTop:8},children:[(0,x.jsx)("button",{type:"button",className:"btn",onClick:()=>l(e=>[...e,{customer:"",address:"",windowFrom:"",windowTo:"",type:"pickup",barrels:0,notes:""}]),children:"Add Stop"}),(0,x.jsx)("button",{type:"submit",className:"btn primary",children:"Save Plan"})]})]})]})},Ws=()=>{const[e,t]=(0,n.useState)(!0),[a,s]=(0,n.useState)(""),[r,l]=(0,n.useState)(null),[o,c]=(0,n.useState)([]),d=(0,n.useMemo)(()=>(new Date).toISOString().split("T")[0],[]);(0,n.useEffect)(()=>{(async()=>{t(!0),s("");try{const{trips:e}=await zs({date:d}),t=Array.isArray(e)&&e.length?e[0]:null;l(t),c((null===t||void 0===t?void 0:t.stops)||[])}catch(n){var e,a;s((null===n||void 0===n||null===(e=n.response)||void 0===e||null===(a=e.data)||void 0===a?void 0:a.message)||"Failed to load trips")}finally{t(!1)}})()},[d]);const u=(e,t,a)=>c(n=>n.map((n,s)=>s===e?(0,i.A)((0,i.A)({},n),{},{[t]:a}):n)),h=async e=>{if(null===r||void 0===r||!r._id)return;const t=o[e];try{await Ms(r._id,t._id,{status:t.status,inventoryFileName:t.inventoryFileName,notes:t.notes,eta:t.eta}),await async function(e){const{data:t}=await m.A.post("".concat(Os,"/api/notifications/staff-trip-event"),e,{headers:(0,i.A)((0,i.A)({},qs()),{},{"Content-Type":"application/json"})});return t}({tripId:r._id,stopId:t._id,status:t.status});const{trips:e}=await zs({date:d}),a=Array.isArray(e)&&e.length?e[0]:null;l(a),c((null===a||void 0===a?void 0:a.stops)||[])}catch(s){var a,n;alert((null===s||void 0===s||null===(a=s.response)||void 0===a||null===(n=a.data)||void 0===n?void 0:n.message)||"Failed to update stop")}};return(0,x.jsxs)("div",{className:"user-rate-history",children:[(0,x.jsxs)("div",{className:"header",children:[(0,x.jsx)("h1",{children:"\ud83d\ude9a Pickups & Drops (Today)"}),(0,x.jsx)("p",{children:"Mark pickup/drop status and set inventory file name"})]}),a&&(0,x.jsx)("div",{className:"alert error",children:a}),e?(0,x.jsx)("div",{className:"loading",children:"Loading..."}):r?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)("div",{className:"dash-card",style:{marginBottom:12},children:[(0,x.jsx)("strong",{children:"Trip:"})," ",r.routeName," \xa0 | \xa0 ",(0,x.jsx)("strong",{children:"Date:"})," ",r.date]}),(0,x.jsx)("div",{className:"rates-table-container",children:(0,x.jsxs)("table",{className:"rates-table",children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{children:"#"}),(0,x.jsx)("th",{children:"Customer"}),(0,x.jsx)("th",{children:"Type"}),(0,x.jsx)("th",{children:"ETA"}),(0,x.jsx)("th",{children:"Barrels"}),(0,x.jsx)("th",{children:"Inventory File Name"}),(0,x.jsx)("th",{children:"Status"}),(0,x.jsx)("th",{children:"Notes"}),(0,x.jsx)("th",{children:"Action"})]})}),(0,x.jsx)("tbody",{children:o.map((e,t)=>{return(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{children:t+1}),(0,x.jsx)("td",{children:(a=e.customer,null==a?"-":"string"===typeof a||"number"===typeof a?String(a):"object"===typeof a&&(a.name||a.email||a.phone||a._id)||"-")}),(0,x.jsx)("td",{children:e.type}),(0,x.jsx)("td",{children:(0,x.jsx)("input",{type:"time",value:e.eta||"",onChange:e=>u(t,"eta",e.target.value)})}),(0,x.jsx)("td",{children:e.barrels}),(0,x.jsxs)("td",{children:[(0,x.jsx)("input",{type:"text",placeholder:"e.g. INV_2025_09_25_A",value:e.inventoryFileName||"",onChange:e=>u(t,"inventoryFileName",e.target.value)}),(0,x.jsxs)("div",{style:{marginTop:6},children:[(0,x.jsx)("input",{type:"file",accept:"image/*",onChange:async a=>{var n;const s=null===(n=a.target.files)||void 0===n?void 0:n[0];if(s)try{const{url:a}=await async function(e){const t=new FormData;t.append("file",e);const{data:a}=await m.A.post("".concat(Os,"/api/uploads"),t,{headers:(0,i.A)((0,i.A)({},qs()),{},{"Content-Type":"multipart/form-data"})});return{url:(null===a||void 0===a?void 0:a.url)||(null===a||void 0===a?void 0:a.path)||(null===a||void 0===a?void 0:a.fileUrl)}}(s);u(t,"proofUrl",a),await Ms(r._id,e._id,{proofUrl:a})}catch(l){alert("Upload failed")}}}),e.proofUrl&&(0,x.jsx)("div",{style:{marginTop:4},children:(0,x.jsx)("a",{href:e.proofUrl,target:"_blank",rel:"noreferrer",children:"View proof"})})]})]}),(0,x.jsx)("td",{children:(0,x.jsxs)("select",{value:e.status,onChange:e=>u(t,"status",e.target.value),children:[(0,x.jsx)("option",{value:"pending",children:"Pending"}),(0,x.jsx)("option",{value:"on_the_way",children:"On the way"}),(0,x.jsx)("option",{value:"picked",children:"Picked Up"}),(0,x.jsx)("option",{value:"dropped",children:"Dropped"}),(0,x.jsx)("option",{value:"skipped",children:"Skipped"}),(0,x.jsx)("option",{value:"failed",children:"Failed"})]})}),(0,x.jsx)("td",{children:(0,x.jsx)("input",{type:"text",placeholder:"Optional notes",value:e.notes||"",onChange:e=>u(t,"notes",e.target.value)})}),(0,x.jsx)("td",{children:(0,x.jsx)("button",{className:"btn primary",onClick:()=>h(t),children:"Save"})})]},e._id);var a})})]})})]}):(0,x.jsx)("div",{className:"no-data",children:"No trip found for today. Create a route plan first."})]})},Hs=e=>{let{children:t}=e;const{isAuthenticated:a,loading:n,user:s}=y();if(n)return(0,x.jsx)("div",{children:"Loading..."});if(!a||!s)return(0,x.jsx)(w.C5,{to:"/login"});const r=String(s.role||"").toLowerCase().replace(/\s+/g,"_");return"delivery_staff"!==r&&"admin"!==r&&"lab"!==r?(0,x.jsx)(w.C5,{to:"/user"}):t},Vs=e=>{let{barrelId:t,onDRCUpdated:a}=e;const{userRole:s}=L(),[r,i]=(0,n.useState)(""),[l,o]=(0,n.useState)(250),[c,d]=(0,n.useState)(500),[u,h]=(0,n.useState)(0),[p,f]=(0,n.useState)(!1),[m,g]=(0,n.useState)("");(0,n.useEffect)(()=>{v(),y()},[t]);const v=async()=>{try{const e=await fetch("/api/barrels/".concat(t)),a=await e.json();o(a.capacity||250)}catch(e){console.error("Error fetching barrel details:",e)}},y=async()=>{try{const e=await fetch("/api/daily-rates/latest"),t=await e.json();d(t.ratePerKg||500)}catch(e){console.error("Error fetching market rate:",e)}},b=e=>l*e/100,j=e=>{const t=parseFloat(e);if(isNaN(t))return i(e),h(0),void g("");if(t<0||t>100)return void g("DRC must be between 0% and 100%");i(e),g("");const a=(e=>e*c)(b(t));h(a)};return(0,x.jsx)(T,{title:"DRC Measurement - Barrel ".concat(t),icon:"fas fa-flask",className:"mb-6",children:(0,x.jsxs)("div",{className:"drc-measurement",children:[(0,x.jsxs)("div",{className:"measurement-inputs",children:[(0,x.jsxs)("div",{className:"input-group",children:[(0,x.jsx)("label",{children:"Barrel Capacity (L)"}),(0,x.jsx)("input",{type:"number",value:l,onChange:e=>o(parseFloat(e.target.value)),disabled:!0,className:"form-input"})]}),(0,x.jsxs)("div",{className:"input-group",children:[(0,x.jsx)("label",{children:"DRC Percentage (%)"}),(0,x.jsx)("input",{type:"number",value:r,onChange:e=>j(e.target.value),placeholder:"Enter DRC %",className:"form-input ".concat(m?"error":""),min:"0",max:"100",step:"0.01"}),m&&(0,x.jsx)("span",{className:"error-message",children:m})]}),(0,x.jsxs)("div",{className:"input-group",children:[(0,x.jsx)("label",{children:"Market Rate (\u20b9/L)"}),(0,x.jsx)("input",{type:"number",value:c,onChange:e=>d(parseFloat(e.target.value)),className:"form-input"})]})]}),(0,x.jsxs)("div",{className:"calculation-results",children:[(0,x.jsxs)("div",{className:"result-item",children:[(0,x.jsx)("span",{className:"result-label",children:"Effective Rubber:"}),(0,x.jsxs)("span",{className:"result-value",children:[r?b(parseFloat(r)).toFixed(2):"0"," L"]})]}),(0,x.jsxs)("div",{className:"result-item",children:[(0,x.jsx)("span",{className:"result-label",children:"Calculated Price:"}),(0,x.jsxs)("span",{className:"result-value",children:["\u20b9",u.toFixed(2)]})]})]}),(0,x.jsx)("div",{className:"action-buttons",children:(0,x.jsxs)(E,{onClick:async()=>{if(r&&!m){f(!0);try{if(!(await fetch("/api/barrels/drc/update",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("token"))},body:JSON.stringify({barrelId:t,drc:parseFloat(r),effectiveRubber:b(parseFloat(r)),calculatedPrice:u,marketRate:c,barrelCapacity:l,status:"pending_verification"})})).ok)throw new Error("Failed to submit DRC measurement");null===a||void 0===a||a({barrelId:t,drc:parseFloat(r),effectiveRubber:b(parseFloat(r)),calculatedPrice:u,status:"pending_verification"})}catch(e){g(e.message)}finally{f(!1)}}},disabled:!r||m||p,loading:p,children:[(0,x.jsx)("i",{className:"fas fa-check"})," Submit DRC"]})})]})})},Gs=e=>{let{onBarrelScanned:t,onLocationUpdate:a}=e;const{userRole:s,getRoleColor:r}=L(),l=(0,n.useRef)(null),o=(0,n.useRef)(null),[c,d]=(0,n.useState)(!1),[u,h]=(0,n.useState)([]),[p,f]=(0,n.useState)(null),[m,g]=(0,n.useState)(""),[v,y]=(0,n.useState)(!0);(0,n.useEffect)(()=>{b()},[]);const b=()=>{navigator.geolocation&&navigator.geolocation.getCurrentPosition(e=>{f({latitude:e.coords.latitude,longitude:e.coords.longitude,accuracy:e.coords.accuracy})},e=>{console.error("Error getting location:",e),g("Location access required for barrel tracking")})},j=()=>{l.current&&l.current.srcObject&&l.current.srcObject.getTracks().forEach(e=>e.stop()),d(!1)},w=async(e,t)=>{try{if(!(await fetch("/api/barrels/update-status",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("token"))},body:JSON.stringify({barrelId:e,status:t,location:p,timestamp:(new Date).toISOString()})})).ok)throw new Error("Failed to update barrel status");h(a=>a.map(a=>a.barrelId===e?(0,i.A)((0,i.A)({},a),{},{status:t,updatedAt:new Date}):a)),null===a||void 0===a||a(e,t,p)}catch(n){g(n.message)}};return(0,x.jsxs)("div",{className:"barrel-qr-scanner",children:[(0,x.jsxs)(T,{title:"Barrel QR Scanner",icon:"fas fa-qrcode",className:"mb-6",children:[(0,x.jsxs)("div",{className:"location-status mb-4",children:[(0,x.jsx)(D,{status:p?"success":"error",children:p?"Location Active":"Location Required"}),p&&(0,x.jsxs)("span",{className:"location-coords",children:[p.latitude.toFixed(6),", ",p.longitude.toFixed(6)]})]}),(0,x.jsx)("div",{className:"scanner-controls mb-4",children:c?(0,x.jsxs)(E,{onClick:j,variant:"outline",size:"large",children:[(0,x.jsx)("i",{className:"fas fa-stop"})," Stop Scanning"]}):(0,x.jsxs)(E,{onClick:async()=>{try{const e=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}});l.current.srcObject=e,d(!0),g("")}catch(e){g("Camera access required for QR scanning")}},size:"large",children:[(0,x.jsx)("i",{className:"fas fa-camera"})," Start Scanning"]})}),c&&(0,x.jsxs)("div",{className:"camera-container mb-4",children:[(0,x.jsx)("video",{ref:l,autoPlay:!0,playsInline:!0,className:"camera-feed"}),(0,x.jsx)("canvas",{ref:o,style:{display:"none"}})]}),m&&(0,x.jsxs)("div",{className:"error-message mb-4",children:[(0,x.jsx)("i",{className:"fas fa-exclamation-triangle"}),m]}),(0,x.jsxs)("div",{className:"scanned-barrels",children:[(0,x.jsxs)("h4",{children:["Scanned Barrels (",u.length,")"]}),0===u.length?(0,x.jsx)("p",{className:"text-muted",children:"No barrels scanned yet"}):(0,x.jsx)("div",{className:"barrel-list",children:u.map((e,t)=>(0,x.jsxs)("div",{className:"barrel-item",children:[(0,x.jsxs)("div",{className:"barrel-info",children:[(0,x.jsx)("span",{className:"barrel-id",children:e.barrelId}),(0,x.jsx)(D,{status:"scanned"===e.status?"info":"success",children:e.status}),(0,x.jsx)("span",{className:"scan-time",children:new Date(e.scannedAt).toLocaleTimeString()})]}),(0,x.jsxs)("div",{className:"barrel-actions",children:[(0,x.jsx)(E,{onClick:()=>w(e.barrelId,"picked_up"),size:"small",disabled:"scanned"!==e.status,children:"Pick Up"}),(0,x.jsx)(E,{onClick:()=>w(e.barrelId,"delivered"),size:"small",disabled:"picked_up"!==e.status,children:"Deliver"}),(0,x.jsx)(E,{onClick:()=>(async(e,t,a)=>{try{if(!(await fetch("/api/barrels/report-damage",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("token"))},body:JSON.stringify({barrelId:e,damageType:t,severity:a,reportedBy:s,location:p,timestamp:(new Date).toISOString()})})).ok)throw new Error("Failed to report damage");h(n=>n.map(n=>n.barrelId===e?(0,i.A)((0,i.A)({},n),{},{status:"damaged",damageType:t,severity:a}):n))}catch(n){g(n.message)}})(e.barrelId,"physical","medium"),size:"small",variant:"outline",disabled:"damaged"===e.status,children:"Report Damage"})]})]},t))})]})]}),(0,x.jsx)(R,{visible:v,onClose:()=>y(!1),children:(0,x.jsxs)("div",{className:"prompt-content",children:[(0,x.jsx)("h5",{children:"QR Scanning Guide"}),(0,x.jsxs)("ol",{children:[(0,x.jsx)("li",{children:"Position barrel QR code in camera view"}),(0,x.jsx)("li",{children:"Wait for automatic scan detection"}),(0,x.jsx)("li",{children:"Update barrel status (Pick Up \u2192 Deliver)"}),(0,x.jsx)("li",{children:"Report any damage immediately"})]})]})})]})};function Js(e){return{scan:"qrcode",pickup:"hand-paper",delivery:"truck",damage:"exclamation-triangle",location:"map-marker-alt"}[e]||"circle"}function Ys(e){return{completed:"success",pending:"warning",error:"error",in_progress:"info"}[e]||"info"}const Ks=()=>{const{userRole:e,getRoleColor:t}=L(),[a,s]=(0,n.useState)({barrelsScanned:0,barrelsPickedUp:0,barrelsDelivered:0,barrelsDamaged:0}),[r,l]=(0,n.useState)([]),[o,c]=(0,n.useState)(!1),[d,u]=(0,n.useState)(!0);(0,n.useEffect)(()=>{h(),p()},[]);const h=async()=>{try{const e=await fetch("/api/field-staff/stats/today",{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}}),t=await e.json();s(t)}catch(e){console.error("Error fetching today stats:",e)}},p=async()=>{try{const e=await fetch("/api/field-staff/activity/recent",{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}}),t=await e.json();l(t.activities||[])}catch(e){console.error("Error fetching recent activity:",e)}};return(0,x.jsxs)("div",{className:"field-staff-dashboard",children:[(0,x.jsxs)("div",{className:"dashboard-header",children:[(0,x.jsx)("h2",{children:"Field Staff Dashboard"}),(0,x.jsx)("div",{className:"header-actions",children:(0,x.jsxs)(E,{onClick:()=>c(!o),variant:o?"outline":"primary",children:[(0,x.jsx)("i",{className:"fas fa-qrcode"}),o?"Stop Scanning":"Start QR Scanning"]})})]}),(0,x.jsxs)("div",{className:"dashboard-grid",children:[(0,x.jsxs)(T,{title:"Today's Performance",icon:"fas fa-chart-line",className:"mb-6",children:[(0,x.jsxs)("div",{className:"stats-grid",children:[(0,x.jsxs)("div",{className:"stat-item",children:[(0,x.jsx)("div",{className:"stat-value",children:a.barrelsScanned}),(0,x.jsx)("div",{className:"stat-label",children:"Barrels Scanned"})]}),(0,x.jsxs)("div",{className:"stat-item",children:[(0,x.jsx)("div",{className:"stat-value",children:a.barrelsPickedUp}),(0,x.jsx)("div",{className:"stat-label",children:"Picked Up"})]}),(0,x.jsxs)("div",{className:"stat-item",children:[(0,x.jsx)("div",{className:"stat-value",children:a.barrelsDelivered}),(0,x.jsx)("div",{className:"stat-label",children:"Delivered"})]}),(0,x.jsxs)("div",{className:"stat-item",children:[(0,x.jsx)("div",{className:"stat-value",children:a.barrelsDamaged}),(0,x.jsx)("div",{className:"stat-label",children:"Damaged"})]})]}),(0,x.jsx)(P,{progress:a.barrelsScanned>0?a.barrelsDelivered/a.barrelsScanned*100:0,label:"Delivery Completion Rate"})]}),o&&(0,x.jsx)(Gs,{onBarrelScanned:e=>{s(e=>(0,i.A)((0,i.A)({},e),{},{barrelsScanned:e.barrelsScanned+1})),p()},onLocationUpdate:(e,t,a)=>{s(e=>(0,i.A)((0,i.A)({},e),{},{["barrels".concat(t.charAt(0).toUpperCase()+t.slice(1).replace("_",""))]:e["barrels".concat(t.charAt(0).toUpperCase()+t.slice(1).replace("_",""))]+1})),p()}}),(0,x.jsx)(T,{title:"Recent Activity",icon:"fas fa-history",className:"mb-6",children:0===r.length?(0,x.jsxs)("div",{className:"no-data",children:[(0,x.jsx)("i",{className:"fas fa-clock"}),(0,x.jsx)("p",{children:"No recent activity"})]}):(0,x.jsx)("div",{className:"activity-list",children:r.map((e,t)=>(0,x.jsxs)("div",{className:"activity-item",children:[(0,x.jsx)("div",{className:"activity-icon",children:(0,x.jsx)("i",{className:"fas fa-".concat(Js(e.type))})}),(0,x.jsxs)("div",{className:"activity-content",children:[(0,x.jsx)("div",{className:"activity-title",children:e.title}),(0,x.jsx)("div",{className:"activity-description",children:e.description}),(0,x.jsx)("div",{className:"activity-time",children:new Date(e.timestamp).toLocaleString()})]}),(0,x.jsx)(D,{status:Ys(e.status),children:e.status})]},t))})}),(0,x.jsx)(T,{title:"Quick Actions",icon:"fas fa-bolt",className:"mb-6",children:(0,x.jsxs)("div",{className:"quick-actions",children:[(0,x.jsxs)(E,{onClick:()=>c(!0),size:"large",className:"action-button",children:[(0,x.jsx)("i",{className:"fas fa-qrcode"}),"Scan Barrel QR"]}),(0,x.jsxs)(E,{onClick:()=>window.open("/field-staff/routes","_blank"),size:"large",variant:"outline",className:"action-button",children:[(0,x.jsx)("i",{className:"fas fa-route"}),"View Routes"]}),(0,x.jsxs)(E,{onClick:()=>window.open("/field-staff/reports","_blank"),size:"large",variant:"outline",className:"action-button",children:[(0,x.jsx)("i",{className:"fas fa-chart-bar"}),"Daily Reports"]})]})}),(0,x.jsx)(T,{title:"Location Services",icon:"fas fa-map-marker-alt",className:"mb-6",children:(0,x.jsxs)("div",{className:"location-status",children:[(0,x.jsx)(D,{status:"success",children:"GPS Active"}),(0,x.jsx)("p",{children:"Location tracking is enabled for barrel updates"}),(0,x.jsx)(E,{onClick:()=>navigator.geolocation.getCurrentPosition(e=>console.log("Location updated"),e=>console.error("Location error:",e)),size:"small",variant:"outline",children:"Refresh Location"})]})})]}),(0,x.jsx)(R,{visible:d,onClose:()=>u(!1),children:(0,x.jsxs)("div",{className:"prompt-content",children:[(0,x.jsx)("h5",{children:"Field Staff Workflow"}),(0,x.jsxs)("ol",{children:[(0,x.jsx)("li",{children:"Scan barrel QR codes at pickup locations"}),(0,x.jsx)("li",{children:'Update barrel status to "Picked Up"'}),(0,x.jsx)("li",{children:'Deliver barrels to lab and mark "Delivered"'}),(0,x.jsx)("li",{children:"Report any damage immediately"}),(0,x.jsx)("li",{children:"Track your daily performance metrics"})]})]})})]})};const Qs=()=>{const{userRole:e,getRoleColor:t}=L(),[a,s]=(0,n.useState)([]),[r,l]=(0,n.useState)(null),[o,c]=(0,n.useState)({barrelsReceived:0,drcMeasured:0,pendingVerification:0,totalValue:0}),[d,u]=(0,n.useState)(!0);(0,n.useEffect)(()=>{h(),p()},[]);const h=async()=>{try{const e=await fetch("/api/lab/barrels/received",{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}}),t=await e.json();s(t.barrels||[])}catch(e){console.error("Error fetching received barrels:",e)}},p=async()=>{try{const e=await fetch("/api/lab/stats/today",{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}}),t=await e.json();c(t)}catch(e){console.error("Error fetching today stats:",e)}};return(0,x.jsxs)("div",{className:"lab-staff-dashboard",children:[(0,x.jsxs)("div",{className:"dashboard-header",children:[(0,x.jsx)("h2",{children:"Lab Staff Dashboard"}),(0,x.jsx)("div",{className:"header-actions",children:(0,x.jsxs)(E,{onClick:h,variant:"outline",children:[(0,x.jsx)("i",{className:"fas fa-sync"}),"Refresh Barrels"]})})]}),(0,x.jsxs)("div",{className:"dashboard-grid",children:[(0,x.jsxs)(T,{title:"Today's Performance",icon:"fas fa-chart-line",className:"mb-6",children:[(0,x.jsxs)("div",{className:"stats-grid",children:[(0,x.jsxs)("div",{className:"stat-item",children:[(0,x.jsx)("div",{className:"stat-value",children:o.barrelsReceived}),(0,x.jsx)("div",{className:"stat-label",children:"Barrels Received"})]}),(0,x.jsxs)("div",{className:"stat-item",children:[(0,x.jsx)("div",{className:"stat-value",children:o.drcMeasured}),(0,x.jsx)("div",{className:"stat-label",children:"DRC Measured"})]}),(0,x.jsxs)("div",{className:"stat-item",children:[(0,x.jsx)("div",{className:"stat-value",children:o.pendingVerification}),(0,x.jsx)("div",{className:"stat-label",children:"Pending Verification"})]}),(0,x.jsxs)("div",{className:"stat-item",children:[(0,x.jsxs)("div",{className:"stat-value",children:["\u20b9",o.totalValue.toFixed(2)]}),(0,x.jsx)("div",{className:"stat-label",children:"Total Value"})]})]}),(0,x.jsx)(P,{progress:o.barrelsReceived>0?o.drcMeasured/o.barrelsReceived*100:0,label:"DRC Measurement Progress"})]}),(0,x.jsx)(T,{title:"Received Barrels",icon:"fas fa-boxes",className:"mb-6",children:0===a.length?(0,x.jsxs)("div",{className:"no-data",children:[(0,x.jsx)("i",{className:"fas fa-box-open"}),(0,x.jsx)("p",{children:"No barrels received today"})]}):(0,x.jsx)("div",{className:"barrel-list",children:a.map(e=>{return(0,x.jsxs)("div",{className:"barrel-item",children:[(0,x.jsxs)("div",{className:"barrel-header",children:[(0,x.jsxs)("span",{className:"barrel-id",children:["Barrel ",e.barrelId]}),(0,x.jsx)(D,{status:(t=e.status,{received:"info",drc_measured:"warning",pending_verification:"warning",verified:"success",rejected:"error"}[t]||"info"),children:e.status.replace("_"," ")})]}),(0,x.jsxs)("div",{className:"barrel-details",children:[(0,x.jsxs)("div",{className:"detail-row",children:[(0,x.jsx)("span",{children:"Capacity:"}),(0,x.jsxs)("span",{children:[e.capacity," L"]})]}),(0,x.jsxs)("div",{className:"detail-row",children:[(0,x.jsx)("span",{children:"Weight:"}),(0,x.jsxs)("span",{children:[e.currentWeight||"N/A"," kg"]})]}),(0,x.jsxs)("div",{className:"detail-row",children:[(0,x.jsx)("span",{children:"Received:"}),(0,x.jsx)("span",{children:new Date(e.receivedAt).toLocaleTimeString()})]}),e.drc&&(0,x.jsxs)("div",{className:"detail-row",children:[(0,x.jsx)("span",{children:"DRC:"}),(0,x.jsxs)("span",{children:[e.drc,"%"]})]}),e.calculatedPrice&&(0,x.jsxs)("div",{className:"detail-row total",children:[(0,x.jsx)("span",{children:"Price:"}),(0,x.jsxs)("span",{children:["\u20b9",e.calculatedPrice]})]})]}),(0,x.jsxs)("div",{className:"barrel-actions",children:[(0,x.jsxs)(E,{onClick:()=>l(e),size:"small",disabled:"verified"===e.status||"rejected"===e.status,children:[(0,x.jsx)("i",{className:"fas fa-flask"}),e.drc?"Update DRC":"Measure DRC"]}),(0,x.jsxs)(E,{onClick:()=>async function(e){try{(await fetch("/api/barrels/report-damage",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("token"))},body:JSON.stringify({barrelId:e,damageType:"other",severity:"medium",location:{latitude:0,longitude:0,accuracy:0},timestamp:(new Date).toISOString()})})).ok&&alert("Damage reported successfully")}catch(t){console.error("Error reporting damage:",t)}}(e.barrelId),size:"small",variant:"outline",disabled:"verified"===e.status,children:[(0,x.jsx)("i",{className:"fas fa-exclamation-triangle"}),"Report Damage"]})]})]},e.barrelId);var t})})}),r&&(0,x.jsx)(Vs,{barrelId:r.barrelId,onDRCUpdated:e=>{s(t=>t.map(t=>t.barrelId===e.barrelId?(0,i.A)((0,i.A)({},t),e):t)),p()}}),(0,x.jsx)(T,{title:"Quality Control",icon:"fas fa-microscope",className:"mb-6",children:(0,x.jsxs)("div",{className:"quality-metrics",children:[(0,x.jsxs)("div",{className:"metric-item",children:[(0,x.jsx)("span",{className:"metric-label",children:"Average DRC Today:"}),(0,x.jsxs)("span",{className:"metric-value",children:[28.5,"%"]})]}),(0,x.jsxs)("div",{className:"metric-item",children:[(0,x.jsx)("span",{className:"metric-label",children:"High Quality Barrels:"}),(0,x.jsx)("span",{className:"metric-value",children:a.filter(e=>e.drc&&e.drc>=30).length})]}),(0,x.jsxs)("div",{className:"metric-item",children:[(0,x.jsx)("span",{className:"metric-label",children:"Low Quality Barrels:"}),(0,x.jsx)("span",{className:"metric-value",children:a.filter(e=>e.drc&&e.drc<20).length})]})]})}),(0,x.jsx)(T,{title:"Equipment Status",icon:"fas fa-tools",className:"mb-6",children:(0,x.jsxs)("div",{className:"equipment-list",children:[(0,x.jsxs)("div",{className:"equipment-item",children:[(0,x.jsx)(D,{status:"success",children:"DRC Analyzer"}),(0,x.jsx)("span",{children:"Online"})]}),(0,x.jsxs)("div",{className:"equipment-item",children:[(0,x.jsx)(D,{status:"success",children:"Weighing Scale"}),(0,x.jsx)("span",{children:"Calibrated"})]}),(0,x.jsxs)("div",{className:"equipment-item",children:[(0,x.jsx)(D,{status:"warning",children:"Temperature Sensor"}),(0,x.jsx)("span",{children:"Needs Calibration"})]})]})})]}),(0,x.jsx)(R,{visible:d,onClose:()=>u(!1),children:(0,x.jsxs)("div",{className:"prompt-content",children:[(0,x.jsx)("h5",{children:"Lab Staff Workflow"}),(0,x.jsxs)("ol",{children:[(0,x.jsx)("li",{children:"Receive barrels from field staff"}),(0,x.jsx)("li",{children:"Measure DRC percentage accurately"}),(0,x.jsx)("li",{children:"System calculates effective rubber content"}),(0,x.jsx)("li",{children:"Submit for manager verification"}),(0,x.jsx)("li",{children:"Report any quality issues or damage"})]})]})})]})},$s=e=>{let{barrel:t,onClose:a,onVerify:s}=e;const[r,i]=(0,n.useState)("");return(0,x.jsx)("div",{className:"modal-overlay",children:(0,x.jsxs)("div",{className:"modal-content",children:[(0,x.jsxs)("div",{className:"modal-header",children:[(0,x.jsxs)("h3",{children:["Barrel Details - ",t.barrelId]}),(0,x.jsx)("button",{onClick:a,className:"close-button",children:(0,x.jsx)("i",{className:"fas fa-times"})})]}),(0,x.jsxs)("div",{className:"modal-body",children:[(0,x.jsxs)("div",{className:"barrel-details-grid",children:[(0,x.jsxs)("div",{className:"detail-section",children:[(0,x.jsx)("h4",{children:"Physical Properties"}),(0,x.jsxs)("div",{className:"detail-item",children:[(0,x.jsx)("span",{children:"Capacity:"}),(0,x.jsxs)("span",{children:[t.capacity," L"]})]}),(0,x.jsxs)("div",{className:"detail-item",children:[(0,x.jsx)("span",{children:"Current Weight:"}),(0,x.jsxs)("span",{children:[t.currentWeight||"N/A"," kg"]})]}),(0,x.jsxs)("div",{className:"detail-item",children:[(0,x.jsx)("span",{children:"Location:"}),(0,x.jsx)("span",{children:t.currentLocation||"Unknown"})]})]}),(0,x.jsxs)("div",{className:"detail-section",children:[(0,x.jsx)("h4",{children:"DRC Measurements"}),(0,x.jsxs)("div",{className:"detail-item",children:[(0,x.jsx)("span",{children:"DRC Percentage:"}),(0,x.jsxs)("span",{children:[t.drc,"%"]})]}),(0,x.jsxs)("div",{className:"detail-item",children:[(0,x.jsx)("span",{children:"Effective Rubber:"}),(0,x.jsxs)("span",{children:[t.effectiveRubber," L"]})]}),(0,x.jsxs)("div",{className:"detail-item",children:[(0,x.jsx)("span",{children:"Market Rate:"}),(0,x.jsxs)("span",{children:["\u20b9",t.marketRate,"/L"]})]})]}),(0,x.jsxs)("div",{className:"detail-section",children:[(0,x.jsx)("h4",{children:"Calculations"}),(0,x.jsxs)("div",{className:"detail-item total",children:[(0,x.jsx)("span",{children:"Calculated Price:"}),(0,x.jsxs)("span",{children:["\u20b9",t.calculatedPrice]})]}),(0,x.jsxs)("div",{className:"detail-item",children:[(0,x.jsx)("span",{children:"Status:"}),(0,x.jsx)(D,{status:"pending_verification"===t.status?"warning":"success",children:t.status.replace("_"," ")})]})]})]}),(0,x.jsxs)("div",{className:"verification-notes",children:[(0,x.jsx)("label",{children:"Verification Notes:"}),(0,x.jsx)("textarea",{value:r,onChange:e=>i(e.target.value),placeholder:"Add verification notes...",rows:"3"})]})]}),(0,x.jsxs)("div",{className:"modal-footer",children:[(0,x.jsx)(E,{onClick:a,variant:"outline",children:"Cancel"}),(0,x.jsx)(E,{onClick:()=>s("reject"),variant:"outline",children:"Reject"}),(0,x.jsx)(E,{onClick:()=>s("approve"),children:"Approve"})]})]})})},Xs=()=>{const{userRole:e,getRoleColor:t}=L(),[a,s]=(0,n.useState)([]),[r,i]=(0,n.useState)(!0),[l,o]=(0,n.useState)(null),[c,d]=(0,n.useState)(""),[u,h]=(0,n.useState)("all");(0,n.useEffect)(()=>{p();const e=setInterval(p,3e4);return()=>clearInterval(e)},[]);const p=async()=>{try{i(!0);const e=await fetch("/api/barrels/verification/pending",{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}}),t=await e.json();s(t.barrels||[])}catch(e){console.error("Error fetching pending barrels:",e)}finally{i(!1)}},f=async function(t,a){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";try{if(!(await fetch("/api/barrels/verification/".concat(t,"/").concat(a),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("token"))},body:JSON.stringify({notes:n,verifiedBy:e,verifiedAt:(new Date).toISOString()})})).ok)throw new Error("Failed to ".concat(a," barrel"));s(e=>e.filter(e=>e.barrelId!==t)),await m(t,a)}catch(r){console.error("Error ".concat(a,"ing barrel:"),r)}},m=async(e,t)=>{try{await fetch("/api/notifications/send",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("token"))},body:JSON.stringify({type:"BARREL_VERIFICATION",recipientRole:"approve"===t?"customer":"lab",title:"Barrel ".concat(e," ").concat("approve"===t?"Approved":"Rejected"),message:"Barrel ".concat(e," has been ").concat("approve"===t?"approved for billing":"rejected and requires review"),priority:"medium",data:{barrelId:e,action:t}})})}catch(a){console.error("Error sending notification:",a)}},g=a.filter(e=>"all"===u||e.status===u);return(0,x.jsxs)("div",{className:"manager-verification-dashboard",children:[(0,x.jsxs)("div",{className:"dashboard-header",children:[(0,x.jsx)("h2",{children:"Barrel Verification Dashboard"}),(0,x.jsx)("div",{className:"filter-controls",children:(0,x.jsxs)("select",{value:u,onChange:e=>h(e.target.value),className:"filter-select",children:[(0,x.jsx)("option",{value:"all",children:"All Status"}),(0,x.jsx)("option",{value:"pending_verification",children:"Pending Verification"}),(0,x.jsx)("option",{value:"verified",children:"Verified"}),(0,x.jsx)("option",{value:"rejected",children:"Rejected"}),(0,x.jsx)("option",{value:"damaged",children:"Damaged"})]})})]}),(0,x.jsxs)("div",{className:"verification-grid",children:[(0,x.jsx)(T,{title:"Pending Verification",icon:"fas fa-clipboard-check",className:"mb-6",children:r?(0,x.jsx)("div",{className:"loading",children:"Loading barrels..."}):0===g.length?(0,x.jsxs)("div",{className:"no-data",children:[(0,x.jsx)("i",{className:"fas fa-check-circle"}),(0,x.jsx)("p",{children:"No barrels pending verification"})]}):(0,x.jsx)("div",{className:"barrel-list",children:g.map(e=>{return(0,x.jsxs)("div",{className:"barrel-item",children:[(0,x.jsxs)("div",{className:"barrel-header",children:[(0,x.jsxs)("span",{className:"barrel-id",children:["Barrel ",e.barrelId]}),(0,x.jsx)(D,{status:(t=e.status,{pending_verification:"warning",verified:"success",rejected:"error",damaged:"error"}[t]||"info"),children:e.status.replace("_"," ")})]}),(0,x.jsxs)("div",{className:"barrel-details",children:[(0,x.jsxs)("div",{className:"detail-row",children:[(0,x.jsx)("span",{children:"Capacity:"}),(0,x.jsxs)("span",{children:[e.capacity," L"]})]}),(0,x.jsxs)("div",{className:"detail-row",children:[(0,x.jsx)("span",{children:"DRC:"}),(0,x.jsxs)("span",{children:[e.drc,"%"]})]}),(0,x.jsxs)("div",{className:"detail-row",children:[(0,x.jsx)("span",{children:"Effective Rubber:"}),(0,x.jsxs)("span",{children:[e.effectiveRubber," L"]})]}),(0,x.jsxs)("div",{className:"detail-row",children:[(0,x.jsx)("span",{children:"Market Rate:"}),(0,x.jsxs)("span",{children:["\u20b9",e.marketRate,"/L"]})]}),(0,x.jsxs)("div",{className:"detail-row total",children:[(0,x.jsx)("span",{children:"Calculated Price:"}),(0,x.jsxs)("span",{children:["\u20b9",e.calculatedPrice]})]})]}),(0,x.jsxs)("div",{className:"barrel-actions",children:[(0,x.jsx)(I,{content:"Approve this barrel for customer billing",children:(0,x.jsxs)(E,{onClick:()=>f(e.barrelId,"approve",c),size:"small",disabled:"pending_verification"!==e.status,children:[(0,x.jsx)("i",{className:"fas fa-check"})," Approve"]})}),(0,x.jsx)(I,{content:"Reject this barrel and send back to lab",children:(0,x.jsxs)(E,{onClick:()=>f(e.barrelId,"reject",c),size:"small",variant:"outline",disabled:"pending_verification"!==e.status,children:[(0,x.jsx)("i",{className:"fas fa-times"})," Reject"]})}),(0,x.jsx)(I,{content:"View detailed barrel information",children:(0,x.jsxs)(E,{onClick:()=>o(e),size:"small",variant:"outline",children:[(0,x.jsx)("i",{className:"fas fa-eye"})," Details"]})})]})]},e.barrelId);var t})})}),(0,x.jsxs)(T,{title:"Verification Summary",icon:"fas fa-chart-bar",className:"mb-6",children:[(0,x.jsxs)("div",{className:"summary-stats",children:[(0,x.jsxs)("div",{className:"stat-item",children:[(0,x.jsx)("span",{className:"stat-value",children:a.length}),(0,x.jsx)("span",{className:"stat-label",children:"Pending Review"})]}),(0,x.jsxs)("div",{className:"stat-item",children:[(0,x.jsx)("span",{className:"stat-value",children:a.filter(e=>"verified"===e.status).length}),(0,x.jsx)("span",{className:"stat-label",children:"Verified Today"})]}),(0,x.jsxs)("div",{className:"stat-item",children:[(0,x.jsxs)("span",{className:"stat-value",children:["\u20b9",a.reduce((e,t)=>e+(t.calculatedPrice||0),0).toFixed(2)]}),(0,x.jsx)("span",{className:"stat-label",children:"Total Value"})]})]}),(0,x.jsx)(P,{progress:a.length>0?a.filter(e=>"verified"===e.status).length/a.length*100:0,label:"Verification Progress"})]}),(0,x.jsxs)(T,{title:"Verification Notes",icon:"fas fa-sticky-note",className:"mb-6",children:[(0,x.jsx)("textarea",{value:c,onChange:e=>d(e.target.value),placeholder:"Add notes for verification decisions...",className:"notes-textarea",rows:"4"}),(0,x.jsx)("div",{className:"notes-actions",children:(0,x.jsx)(E,{onClick:()=>d(""),size:"small",variant:"outline",children:"Clear Notes"})})]})]}),l&&(0,x.jsx)($s,{barrel:l,onClose:()=>o(null),onVerify:e=>{f(l.barrelId,e,c),o(null)}})]})},Zs=()=>{const[e,t]=(0,n.useState)([]),[a,s]=(0,n.useState)(!0);(0,n.useEffect)(()=>{r()},[]);const r=async()=>{try{const e=await fetch("/api/barrels/billing/history",{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}}),a=await e.json();t(a.payments||[])}catch(e){console.error("Error fetching billing history:",e)}finally{s(!1)}};return a?(0,x.jsx)("div",{className:"loading",children:"Loading payment history..."}):0===e.length?(0,x.jsxs)("div",{className:"no-data",children:[(0,x.jsx)("i",{className:"fas fa-receipt"}),(0,x.jsx)("p",{children:"No payment history found"})]}):(0,x.jsx)("div",{className:"billing-history",children:e.map((e,t)=>(0,x.jsxs)("div",{className:"history-item",children:[(0,x.jsxs)("div",{className:"history-header",children:[(0,x.jsxs)("span",{className:"payment-id",children:["Payment #",e.id]}),(0,x.jsx)(D,{status:"success",children:e.status})]}),(0,x.jsxs)("div",{className:"history-details",children:[(0,x.jsxs)("div",{className:"detail-row",children:[(0,x.jsx)("span",{children:"Date:"}),(0,x.jsx)("span",{children:new Date(e.paidAt).toLocaleDateString()})]}),(0,x.jsxs)("div",{className:"detail-row",children:[(0,x.jsx)("span",{children:"Amount:"}),(0,x.jsxs)("span",{children:["\u20b9",e.totalAmount]})]}),(0,x.jsxs)("div",{className:"detail-row",children:[(0,x.jsx)("span",{children:"Method:"}),(0,x.jsx)("span",{children:e.paymentMethod})]}),(0,x.jsxs)("div",{className:"detail-row",children:[(0,x.jsx)("span",{children:"Barrels:"}),(0,x.jsx)("span",{children:e.barrelCount})]})]})]},t))})},er=()=>{const{userRole:e,getRoleColor:t}=L(),[a,s]=(0,n.useState)([]),[r,i]=(0,n.useState)(!0),[l,o]=(0,n.useState)([]),[c,d]=(0,n.useState)(""),[u,h]=(0,n.useState)(""),[p,f]=(0,n.useState)(!1);(0,n.useEffect)(()=>{m();const e=setInterval(m,3e4);return()=>clearInterval(e)},[]);const m=async()=>{try{i(!0);const e=await fetch("/api/barrels/billing/verified",{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}}),t=await e.json();s(t.barrels||[])}catch(e){console.error("Error fetching verified barrels:",e)}finally{i(!1)}},g=()=>l.reduce((e,t)=>e+(t.calculatedPrice||0),0),v=async()=>{try{await fetch("/api/notifications/send",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("token"))},body:JSON.stringify({type:"PAYMENT_CONFIRMATION",recipientRole:"accountant",title:"Payment Processed",message:"Customer payment of \u20b9".concat(g().toFixed(2)," processed for ").concat(l.length," barrels"),priority:"medium",data:{totalAmount:g(),barrelCount:l.length,paymentMethod:c}})})}catch(e){console.error("Error sending notification:",e)}};return(0,x.jsxs)("div",{className:"customer-billing-dashboard",children:[(0,x.jsxs)("div",{className:"dashboard-header",children:[(0,x.jsx)("h2",{children:"Barrel Billing Dashboard"}),(0,x.jsxs)("div",{className:"billing-summary",children:[(0,x.jsxs)("span",{className:"total-amount",children:["Total: \u20b9",g().toFixed(2)]}),(0,x.jsxs)("span",{className:"selected-count",children:[l.length," barrels selected"]})]})]}),(0,x.jsxs)("div",{className:"billing-grid",children:[(0,x.jsx)(T,{title:"Verified Barrels Ready for Payment",icon:"fas fa-receipt",className:"mb-6",children:r?(0,x.jsx)("div",{className:"loading",children:"Loading verified barrels..."}):0===a.length?(0,x.jsxs)("div",{className:"no-data",children:[(0,x.jsx)("i",{className:"fas fa-check-circle"}),(0,x.jsx)("p",{children:"No verified barrels available for payment"})]}):(0,x.jsx)("div",{className:"barrel-list",children:a.map(e=>{return(0,x.jsxs)("div",{className:"barrel-item",children:[(0,x.jsxs)("div",{className:"barrel-header",children:[(0,x.jsx)("input",{type:"checkbox",checked:l.some(t=>t.barrelId===e.barrelId),onChange:t=>((e,t)=>{if(t){const t=a.find(t=>t.barrelId===e);t&&o(e=>[...e,t])}else o(t=>t.filter(t=>t.barrelId!==e))})(e.barrelId,t.target.checked),className:"barrel-checkbox"}),(0,x.jsxs)("span",{className:"barrel-id",children:["Barrel ",e.barrelId]}),(0,x.jsx)(D,{status:(t=e.status,{verified:"success",paid:"success",pending_payment:"warning",overdue:"error"}[t]||"info"),children:e.status.replace("_"," ")})]}),(0,x.jsxs)("div",{className:"barrel-details",children:[(0,x.jsxs)("div",{className:"detail-row",children:[(0,x.jsx)("span",{children:"Capacity:"}),(0,x.jsxs)("span",{children:[e.capacity," L"]})]}),(0,x.jsxs)("div",{className:"detail-row",children:[(0,x.jsx)("span",{children:"DRC:"}),(0,x.jsxs)("span",{children:[e.drc,"%"]})]}),(0,x.jsxs)("div",{className:"detail-row",children:[(0,x.jsx)("span",{children:"Effective Rubber:"}),(0,x.jsxs)("span",{children:[e.effectiveRubber," L"]})]}),(0,x.jsxs)("div",{className:"detail-row",children:[(0,x.jsx)("span",{children:"Rate:"}),(0,x.jsxs)("span",{children:["\u20b9",e.marketRate,"/L"]})]}),(0,x.jsxs)("div",{className:"detail-row total",children:[(0,x.jsx)("span",{children:"Amount:"}),(0,x.jsxs)("span",{children:["\u20b9",e.calculatedPrice]})]})]}),(0,x.jsx)("div",{className:"barrel-actions",children:(0,x.jsx)(I,{content:"View detailed barrel information",children:(0,x.jsxs)(E,{size:"small",variant:"outline",children:[(0,x.jsx)("i",{className:"fas fa-eye"})," Details"]})})})]},e.barrelId);var t})})}),l.length>0&&(0,x.jsx)(T,{title:"Payment Summary",icon:"fas fa-credit-card",className:"mb-6",children:(0,x.jsxs)("div",{className:"payment-summary",children:[(0,x.jsxs)("div",{className:"summary-table",children:[(0,x.jsxs)("div",{className:"table-header",children:[(0,x.jsx)("span",{children:"Barrel ID"}),(0,x.jsx)("span",{children:"Effective Rubber"}),(0,x.jsx)("span",{children:"Rate"}),(0,x.jsx)("span",{children:"Amount"})]}),l.map(e=>(0,x.jsxs)("div",{className:"table-row",children:[(0,x.jsx)("span",{children:e.barrelId}),(0,x.jsxs)("span",{children:[e.effectiveRubber," L"]}),(0,x.jsxs)("span",{children:["\u20b9",e.marketRate,"/L"]}),(0,x.jsxs)("span",{children:["\u20b9",e.calculatedPrice]})]},e.barrelId)),(0,x.jsxs)("div",{className:"table-footer",children:[(0,x.jsx)("span",{children:"Total Amount:"}),(0,x.jsxs)("span",{children:["\u20b9",g().toFixed(2)]})]})]}),(0,x.jsxs)("div",{className:"payment-form",children:[(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{children:"Payment Method"}),(0,x.jsxs)("select",{value:c,onChange:e=>d(e.target.value),className:"form-select",required:!0,children:[(0,x.jsx)("option",{value:"",children:"Select Payment Method"}),(0,x.jsx)("option",{value:"cash",children:"Cash"}),(0,x.jsx)("option",{value:"bank_transfer",children:"Bank Transfer"}),(0,x.jsx)("option",{value:"cheque",children:"Cheque"}),(0,x.jsx)("option",{value:"upi",children:"UPI"}),(0,x.jsx)("option",{value:"card",children:"Card Payment"})]})]}),(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{children:"Payment Notes (Optional)"}),(0,x.jsx)("textarea",{value:u,onChange:e=>h(e.target.value),placeholder:"Add any payment notes...",className:"form-textarea",rows:"3"})]}),(0,x.jsxs)("div",{className:"payment-actions",children:[(0,x.jsx)(E,{onClick:()=>o([]),variant:"outline",disabled:p,children:"Clear Selection"}),(0,x.jsxs)(E,{onClick:async()=>{if(0!==l.length){f(!0);try{if(!(await fetch("/api/barrels/billing/pay",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("token"))},body:JSON.stringify({barrelIds:l.map(e=>e.barrelId),totalAmount:g(),paymentMethod:c,notes:u,paidAt:(new Date).toISOString()})})).ok)throw new Error("Payment processing failed");o([]),d(""),h(""),await m(),await v()}catch(e){console.error("Payment error:",e)}finally{f(!1)}}},disabled:!c||p,loading:p,children:[(0,x.jsx)("i",{className:"fas fa-credit-card"})," Process Payment"]})]})]})]})}),(0,x.jsx)(T,{title:"Recent Payments",icon:"fas fa-history",className:"mb-6",children:(0,x.jsx)(Zs,{})})]})]})},tr=e=>{let{children:t}=e;const a=(0,w.Zp)(),{logout:s,user:i}=y(),[l,o]=(0,n.useState)(!0),[c,d]=(0,n.useState)(!1),u=(0,n.useRef)(null);return(0,n.useEffect)(()=>{const e=e=>{u.current&&!u.current.contains(e.target)&&d(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),(0,x.jsxs)("div",{className:"dashboard-container",children:[(0,x.jsxs)("aside",{className:"sidebar sidebar--flush-left ".concat(l?"":"sidebar--hidden"),style:l?{}:{maxWidth:0,minWidth:0,overflow:"hidden",padding:0,border:"none"},children:[(0,x.jsxs)("div",{className:"sidebar-header",style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,x.jsx)("span",{children:"Delivery Staff"}),(0,x.jsx)("button",{onClick:()=>o(!1),style:{background:"none",border:"none",color:"white",cursor:"pointer",display:"md-none"},children:(0,x.jsx)("i",{className:"fas fa-times"})})]}),(0,x.jsxs)("ul",{className:"sidebar-nav",children:[(0,x.jsx)("li",{className:"nav-item",children:(0,x.jsx)(r.k2,{to:"/delivery",children:"Dashboard"})}),(0,x.jsx)("li",{className:"nav-item",children:(0,x.jsx)(r.k2,{to:"/delivery/route-plan",children:"Route Plan"})}),(0,x.jsx)("li",{className:"nav-item",children:(0,x.jsx)(r.k2,{to:"/delivery/tasks",children:"My Tasks"})}),(0,x.jsx)("li",{className:"nav-item",children:(0,x.jsx)(r.k2,{to:"/delivery/assigned-requests",children:"Assigned Requests"})}),(0,x.jsx)("li",{className:"nav-item",children:(0,x.jsx)(r.k2,{to:"/delivery/task-history",children:"Task History"})}),(0,x.jsx)("li",{className:"nav-item",children:(0,x.jsx)(r.k2,{to:"/delivery/shift-schedule",children:"My Shift Schedule"})}),(0,x.jsx)("li",{className:"nav-item",children:(0,x.jsx)(r.k2,{to:"/delivery/barrel-intake",children:"Barrel Intake"})}),(0,x.jsx)("li",{className:"nav-item",children:(0,x.jsx)(r.k2,{to:"/delivery/leave",children:"Leave"})}),(0,x.jsx)("li",{className:"nav-item",children:(0,x.jsx)(r.k2,{to:"/delivery/salary",children:"My Salary"})})]})]}),(0,x.jsxs)("div",{className:"main-content-wrapper",children:[(0,x.jsxs)("header",{className:"dashboard-header",style:{justifyContent:"space-between"},children:[(0,x.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"15px"},children:[(0,x.jsx)("button",{onClick:()=>o(e=>!e),style:{background:"transparent",border:"none",fontSize:"1.2rem",cursor:"pointer",color:"#333",padding:"5px"},children:(0,x.jsx)("i",{className:"fas fa-bars"})}),(0,x.jsx)("h3",{style:{margin:0,fontSize:"1.2rem",fontWeight:600,color:"#333"},children:"HFP Delivery"})]}),(0,x.jsxs)("div",{className:"user-header-actions",children:[(0,x.jsxs)("div",{className:"profile-menu",ref:u,children:[(0,x.jsxs)("button",{type:"button",className:"profile-link",onClick:()=>d(e=>!e),children:[(0,x.jsx)("i",{className:"fas fa-user-circle"}),(0,x.jsx)("span",{children:"Profile"})]}),c&&(0,x.jsxs)("div",{className:"profile-dropdown",style:{position:"absolute",right:0,top:45,background:"#fff",border:"1px solid #e5e7eb",borderRadius:8,padding:12,minWidth:240,boxShadow:"0 10px 24px rgba(0,0,0,0.10)",zIndex:1e3},children:[(0,x.jsxs)("div",{style:{display:"flex",gap:10,alignItems:"center",marginBottom:8},children:[(0,x.jsx)("div",{style:{width:36,height:36,borderRadius:"50%",background:"#f3f4f6",display:"grid",placeItems:"center",color:"#6b7280"},children:(0,x.jsx)("i",{className:"fas fa-user"})}),(0,x.jsxs)("div",{children:[(0,x.jsx)("div",{style:{fontWeight:700},children:(null===i||void 0===i?void 0:i.name)||(null===i||void 0===i?void 0:i.email)||"User"}),(0,x.jsx)("div",{style:{fontSize:12,color:"#6b7280"},children:(null===i||void 0===i?void 0:i.email)||""}),(0,x.jsx)("div",{style:{fontSize:12,color:"#374151",marginTop:2},children:((null===i||void 0===i?void 0:i.role)||"").replace("_"," ")})]})]}),(0,x.jsxs)("div",{style:{display:"grid",gap:8},children:[(0,x.jsx)(r.k2,{to:"/user/profile/view",onClick:()=>d(!1),className:"dropdown-item",children:"View Profile"}),(0,x.jsx)(r.k2,{to:"/user/profile",onClick:()=>d(!1),className:"dropdown-item",children:"Edit Profile"})]})]})]}),(0,x.jsx)("button",{className:"logout-button",onClick:async()=>{try{await s()}finally{a("/login")}},children:"Logout"})]})]}),(0,x.jsx)("main",{className:"dashboard-content",children:t})]})]})},ar=e=>{let{s:t}=e;return(0,x.jsx)("span",{className:"badge status-".concat(String(t).replace(/_/g,"-")),children:t})},nr=()=>{const[e,t]=(0,n.useState)([]),[a,s]=(0,n.useState)(!0),[r,i]=(0,n.useState)(null),l=((0,w.Zp)(),async()=>{s(!0);try{const[e,a]=await Promise.all([o(),c()]),n=[...e,...a];t(n),await d()}catch(e){console.error("Error loading dashboard data:",e),t([])}finally{s(!1)}}),o=async()=>{try{return await ht()}catch(e){return console.error("Error loading delivery tasks:",e),[]}},c=async()=>{try{const e=await fetch("".concat(u,"/api/sell-requests/delivery/my-assigned"),{headers:h()});if(e.ok){const t=await e.json();return(Array.isArray(null===t||void 0===t?void 0:t.records)?t.records:Array.isArray(t)?t:[]).map(e=>({_id:"sr_".concat(e._id),title:e._type?"".concat(e._type," Pickup"):null!=e.barrelCount?"Sell Request Pickup (".concat(e.barrelCount,")"):"Sell Request Pickup",status:e.status||"DELIVER_ASSIGNED",scheduledAt:e.assignedAt||e.updatedAt||e.createdAt,createdAt:e.createdAt,customerUserId:e.farmerId,pickupAddress:e.capturedAddress||"Customer pickup location",dropAddress:"HFP Lab / Yard",meta:{barrelCount:e.barrelCount,sellRequestId:e._id},isSellRequest:!0}))}return[]}catch(e){return console.error("Error loading assigned sell requests:",e),[]}},d=async()=>{try{const e=await fetch("".concat(u,"/api/delivery/shift-schedule"),{headers:h()});if(e.ok){const t=await e.json();i(t.myAssignment)}}catch(e){console.error("Error loading shift info:",e)}};(0,n.useEffect)(()=>{l()},[]);const u="http://localhost:5000",h=()=>{const e=localStorage.getItem("token");return e?{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}:{"Content-Type":"application/json"}},p=async(e,t)=>{await pt(e._id,{status:t}),await l()},f=async(e,t)=>{try{if("start_pickup"===t){(await fetch("".concat(u,"/api/sell-requests/").concat(e.meta.sellRequestId,"/status"),{method:"PUT",headers:h(),body:JSON.stringify({status:"PICKUP_STARTED"})})).ok&&await l()}else if("mark_picked"===t){(await fetch("".concat(u,"/api/sell-requests/").concat(e.meta.sellRequestId,"/collected"),{method:"PUT",headers:h(),body:JSON.stringify({totalVolumeKg:e.meta.barrelCount||0,notes:"Collected by delivery staff"})})).ok&&await l()}else if("deliver_to_lab"===t){(await fetch("".concat(u,"/api/sell-requests/").concat(e.meta.sellRequestId,"/delivered-to-lab"),{method:"PUT",headers:h()})).ok&&await l()}}catch(a){console.error("Error handling sell request action:",a),alert("Failed to update sell request status")}};return(0,x.jsxs)("div",{className:"delivery-dashboard",children:[(0,x.jsx)("div",{className:"delivery-header",children:(0,x.jsx)("h2",{children:"Delivery Dashboard"})}),r&&(0,x.jsxs)("div",{className:"shift-banner",children:[(0,x.jsxs)("h3",{style:{margin:"0 0 15px 0",fontSize:"20px"},children:[(0,x.jsx)("i",{className:"fas fa-clock",style:{marginRight:"8px"}}),"Today's Shift: ",r.name]}),(0,x.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"20px",marginBottom:"10px"},children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("div",{style:{fontSize:"14px",opacity:.9},children:"Start Time"}),(0,x.jsx)("div",{style:{fontSize:"18px",fontWeight:"bold"},children:r.startTime})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("div",{style:{fontSize:"14px",opacity:.9},children:"End Time"}),(0,x.jsx)("div",{style:{fontSize:"18px",fontWeight:"bold"},children:r.endTime})]})]})]}),a?(0,x.jsx)("p",{children:"Loading..."}):0===e.length?(0,x.jsx)("div",{className:"no-data",children:"No assigned tasks"}):(0,x.jsx)("div",{className:"delivery-grid",children:e.map(e=>{var t,a,n,s;return(0,x.jsxs)("div",{className:"task-card",children:[(0,x.jsxs)("div",{className:"task-card-header",children:[e.isSellRequest&&(0,x.jsx)("span",{className:"task-type-badge",children:"Sell Request"}),(0,x.jsx)("div",{className:"task-actions-menu",children:(0,x.jsx)("i",{className:"fas fa-ellipsis-h"})})]}),(0,x.jsx)("h3",{className:"task-title",children:e.title}),(0,x.jsxs)("div",{className:"task-customer",children:[(0,x.jsx)("i",{className:"fas fa-user-circle"}),(null===(t=e.customerUserId)||void 0===t?void 0:t.name)||(null===(a=e.customerUserId)||void 0===a?void 0:a.email)||"Unknown Customer"]}),(0,x.jsxs)("div",{className:"task-details",children:[(0,x.jsxs)("div",{className:"detail-row",children:[(0,x.jsx)("span",{className:"detail-label",children:"When"}),(0,x.jsx)("span",{className:"detail-value",children:e.scheduledAt?new Date(e.scheduledAt).toLocaleDateString():"-"})]}),(0,x.jsxs)("div",{className:"detail-row",children:[(0,x.jsx)("span",{className:"detail-label",children:"Barrels"}),(0,x.jsx)("span",{className:"detail-value",children:null!==(n=null===e||void 0===e||null===(s=e.meta)||void 0===s?void 0:s.barrelCount)&&void 0!==n?n:"-"})]}),(0,x.jsxs)("div",{className:"detail-row",children:[(0,x.jsx)("span",{className:"detail-label",children:"From"}),(0,x.jsx)("span",{className:"detail-value",style:{maxWidth:"120px",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},title:e.pickupAddress,children:e.pickupAddress})]})]}),(0,x.jsx)("div",{className:"task-status",children:(0,x.jsx)(ar,{s:e.status})}),(0,x.jsxs)("div",{className:"task-card-footer",children:[e.isSellRequest?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)("button",{className:"btn-icon primary",onClick:()=>f(e,"mark_picked"),children:[(0,x.jsx)("i",{className:"fas fa-check"})," Picked"]}),(0,x.jsxs)("button",{className:"btn-icon secondary",onClick:()=>f(e,"deliver_to_lab"),children:[(0,x.jsx)("i",{className:"fas fa-truck"})," To Lab"]})]}):(0,x.jsxs)(x.Fragment,{children:["pickup_scheduled"===e.status&&(0,x.jsxs)("button",{className:"btn-icon primary",onClick:()=>p(e,"enroute_pickup"),children:[(0,x.jsx)("i",{className:"fas fa-play"})," Start"]}),"enroute_pickup"===e.status&&(0,x.jsxs)("button",{className:"btn-icon primary",onClick:()=>p(e,"picked_up"),children:[(0,x.jsx)("i",{className:"fas fa-box"})," Picked"]}),"picked_up"===e.status&&(0,x.jsxs)("button",{className:"btn-icon primary",onClick:()=>p(e,"enroute_drop"),children:[(0,x.jsx)("i",{className:"fas fa-route"})," Delivering"]}),"enroute_drop"===e.status&&(0,x.jsxs)("button",{className:"btn-icon primary",onClick:()=>p(e,"delivered"),children:[(0,x.jsx)("i",{className:"fas fa-check-double"})," Done"]}),(0,x.jsx)("button",{className:"btn-icon secondary",onClick:()=>(async e=>{var t;const a=Array.isArray(null===e||void 0===e||null===(t=e.meta)||void 0===t?void 0:t.barrels)?e.meta.barrels.join(","):"",n=window.prompt("Enter Barrel IDs (comma separated):",a);if(null==n)return;const s=n.split(",").map(e=>e.trim()).filter(Boolean);try{await pt(e._id,{meta:{barrels:s}}),await l()}catch(r){alert((null===r||void 0===r?void 0:r.message)||"Failed to save barrel IDs")}})(e),title:"Set IDs",children:(0,x.jsx)("i",{className:"fas fa-barcode"})})]}),(0,x.jsx)("button",{className:"btn-icon secondary",onClick:()=>{},title:"View",children:(0,x.jsx)("i",{className:"fas fa-eye"})})]})]},e._id)})})]})},sr=()=>{const[e,t]=(0,n.useState)([]),[a,s]=(0,n.useState)(()=>(new Date).toISOString().slice(0,10));(0,n.useEffect)(()=>{(async()=>{try{t(await ht())}catch(e){t([])}})()},[]);const r=(0,n.useMemo)(()=>{if(!a)return e;const t=new Date(a);return e.filter(e=>!e.scheduledAt||new Date(e.scheduledAt).toDateString()===t.toDateString()).sort((e,t)=>(e.scheduledAt?new Date(e.scheduledAt).getTime():Number.MAX_SAFE_INTEGER)-(t.scheduledAt?new Date(t.scheduledAt).getTime():Number.MAX_SAFE_INTEGER))},[e,a]),i=(e,t)=>{const a=encodeURIComponent(e||""),n=encodeURIComponent(t||"");return"https://www.google.com/maps/dir/?api=1&origin=".concat(a,"&destination=").concat(n)},l=(0,n.useMemo)(()=>r.reduce((e,t)=>(e[t.status||"unknown"]=(e[t.status||"unknown"]||0)+1,e),{}),[r]);return(0,x.jsxs)("div",{children:[(0,x.jsx)("h2",{children:"Route Plan"}),(0,x.jsx)("div",{style:{display:"flex",gap:8,alignItems:"end",marginBottom:12},children:(0,x.jsxs)("label",{children:["Date",(0,x.jsx)("input",{type:"date",value:a,onChange:e=>s(e.target.value)})]})}),(0,x.jsxs)("div",{className:"dash-card",style:{marginBottom:12},children:[(0,x.jsx)("h4",{style:{marginTop:0,marginBottom:8},children:"Kottayam District Map"}),(0,x.jsx)("div",{className:"map-embed",children:(0,x.jsx)("iframe",{title:"Kottayam District Map",src:"https://www.google.com/maps?q=Kottayam%20district%2C%20Kerala&z=10&output=embed",loading:"lazy",referrerPolicy:"no-referrer-when-downgrade"})})]}),0===r.length?(0,x.jsx)("div",{className:"no-data",children:"No tasks for selected date"}):(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)("div",{className:"dash-card",style:{marginBottom:12},children:[(0,x.jsx)("h4",{style:{marginTop:0},children:"Day Summary"}),(0,x.jsx)("div",{style:{display:"flex",gap:12,flexWrap:"wrap"},children:Object.entries(l).map(e=>{let[t,a]=e;return(0,x.jsxs)("div",{className:"badge",style:{background:"#eef2ff",color:"#1e3a8a"},children:[t,": ",a]},t)})})]}),(0,x.jsx)("div",{className:"dash-card",children:(0,x.jsx)("ol",{style:{paddingLeft:20,lineHeight:1.6},children:r.map((e,t)=>(0,x.jsx)("li",{children:(0,x.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8,alignItems:"start"},children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("div",{style:{fontWeight:600},children:e.title}),(0,x.jsx)("div",{style:{fontSize:12,color:"#64748b"},children:e.scheduledAt?new Date(e.scheduledAt).toLocaleString("en-IN"):"\u2014"}),(0,x.jsx)("div",{style:{marginTop:6},children:(0,x.jsx)("a",{className:"btn btn-sm",target:"_blank",rel:"noreferrer",href:i(e.pickupAddress,e.dropAddress),children:"Open in Google Maps"})})]}),(0,x.jsxs)("div",{style:{textAlign:"right"},children:[(0,x.jsxs)("div",{children:["Pickup: ",e.pickupAddress]}),(0,x.jsxs)("div",{children:["Drop: ",e.dropAddress]}),(0,x.jsxs)("div",{style:{fontSize:12,color:"#64748b"},children:["Status: ",e.status]})]})]})},e._id))})})]})]})},rr=()=>{const[e,t]=(0,n.useState)(null),[a,s]=(0,n.useState)(!0),[r,i]=(0,n.useState)(""),l=localStorage.getItem("token"),o=async()=>{try{s(!0),i("");const e=await fetch("".concat("http://localhost:5000","/api/delivery/shift-schedule"),{headers:{Authorization:"Bearer ".concat(l)}}),a=await e.json();e.ok?t(a):i(a.message||"Failed to load shift schedule")}catch(r){console.error("Error fetching shift schedule:",r),i("Failed to load shift schedule")}finally{s(!1)}};(0,n.useEffect)(()=>{o()},[]);const c=e=>new Date(e).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"});if(a)return(0,x.jsx)("div",{className:"delivery-shift-schedule",children:(0,x.jsx)("div",{className:"loading",children:"Loading shift schedule..."})});if(r)return(0,x.jsxs)("div",{className:"delivery-shift-schedule",children:[(0,x.jsxs)("div",{className:"error",children:["Error: ",r]}),(0,x.jsx)("button",{onClick:o,className:"retry-btn",children:"Retry"})]});if(!e)return(0,x.jsx)("div",{className:"delivery-shift-schedule",children:(0,x.jsx)("div",{className:"no-data",children:"No shift schedule available"})});const d=(e=>{const t=new Date(e),a=[];for(let n=0;n<7;n++){const e=new Date(t);e.setDate(t.getDate()+n),a.push(e)}return a})(e.weekStart);return(0,x.jsxs)("div",{className:"delivery-shift-schedule",children:[(0,x.jsxs)("div",{className:"schedule-header",children:[(0,x.jsx)("h2",{children:"My Shift Schedule"}),(0,x.jsx)("div",{className:"week-info",children:(0,x.jsxs)("span",{className:"week-range",children:[c(e.weekStart)," - ",c(e.weekEnd)]})})]}),(0,x.jsxs)("div",{className:"my-assignment",children:[(0,x.jsx)("h3",{children:"My Shift Assignment"}),e.myAssignment?(0,x.jsxs)("div",{className:"assignment-card",children:[(0,x.jsxs)("div",{className:"shift-type",children:[(0,x.jsx)("i",{className:"fas ".concat("Morning"===e.myAssignment.shiftType?"fa-sun":"fa-moon")}),(0,x.jsxs)("span",{className:"shift-name",children:[e.myAssignment.shiftType," Shift"]})]}),(0,x.jsxs)("div",{className:"shift-times",children:[(0,x.jsxs)("div",{className:"time-slot",children:[(0,x.jsx)("span",{className:"time-label",children:"Start Time:"}),(0,x.jsx)("span",{className:"time-value",children:e.myAssignment.startTime})]}),(0,x.jsxs)("div",{className:"time-slot",children:[(0,x.jsx)("span",{className:"time-label",children:"End Time:"}),(0,x.jsx)("span",{className:"time-value",children:e.myAssignment.endTime})]})]}),(0,x.jsxs)("div",{className:"shift-duration",children:[(0,x.jsx)("span",{className:"duration-label",children:"Duration:"}),(0,x.jsx)("span",{className:"duration-value",children:e.myAssignment.duration})]}),e.myAssignment.description&&(0,x.jsxs)("div",{className:"shift-description",children:[(0,x.jsx)("span",{className:"description-label",children:"Description:"}),(0,x.jsx)("span",{className:"description-value",children:e.myAssignment.description})]})]}):(0,x.jsxs)("div",{className:"no-assignment",children:[(0,x.jsx)("i",{className:"fas fa-calendar-times"}),(0,x.jsx)("span",{children:"No shift assigned for this week"})]})]}),(0,x.jsxs)("div",{className:"all-shifts",children:[(0,x.jsx)("h3",{children:"All Available Shifts"}),(0,x.jsx)("div",{className:"shifts-grid",children:e.allShifts&&e.allShifts.length>0?e.allShifts.map((e,t)=>(0,x.jsxs)("div",{className:"shift-info",children:[(0,x.jsxs)("div",{className:"shift-header",children:[(0,x.jsx)("h4",{children:e.name}),(0,x.jsx)("span",{className:"shift-status ".concat(e.isActive?"active":"inactive"),children:e.isActive?"Active":"Inactive"})]}),(0,x.jsxs)("div",{className:"shift-details",children:[(0,x.jsxs)("div",{className:"detail-row",children:[(0,x.jsx)("span",{className:"detail-label",children:"Time:"}),(0,x.jsxs)("span",{className:"detail-value",children:[e.startTime," - ",e.endTime]})]}),(0,x.jsxs)("div",{className:"detail-row",children:[(0,x.jsx)("span",{className:"detail-label",children:"Duration:"}),(0,x.jsx)("span",{className:"detail-value",children:e.duration})]}),(0,x.jsxs)("div",{className:"detail-row",children:[(0,x.jsx)("span",{className:"detail-label",children:"Grace Period:"}),(0,x.jsxs)("span",{className:"detail-value",children:[e.gracePeriod," minutes"]})]}),(0,x.jsxs)("div",{className:"detail-row",children:[(0,x.jsx)("span",{className:"detail-label",children:"Assigned Staff:"}),(0,x.jsx)("span",{className:"detail-value",children:e.assignedStaffCount||0})]})]}),e.description&&(0,x.jsx)("div",{className:"shift-description",children:(0,x.jsx)("span",{className:"description-text",children:e.description})})]},t)):(0,x.jsxs)("div",{className:"no-shifts",children:[(0,x.jsx)("i",{className:"fas fa-calendar-alt"}),(0,x.jsx)("span",{children:"No shifts available"})]})})]}),(0,x.jsxs)("div",{className:"weekly-calendar",children:[(0,x.jsx)("h3",{children:"Weekly Calendar"}),(0,x.jsx)("div",{className:"calendar-grid",children:d.map((t,a)=>{const n=t.toDateString()===(new Date).toDateString();return(0,x.jsxs)("div",{className:"day ".concat(n?"today":""),children:[(0,x.jsx)("div",{className:"day-name",children:t.toLocaleDateString("en-US",{weekday:"short"})}),(0,x.jsx)("div",{className:"day-number",children:t.getDate()}),(0,x.jsx)("div",{className:"day-shift",children:e.myAssignment&&e.myAssignment.days&&e.myAssignment.days.includes(a)?(0,x.jsxs)("div",{className:"assigned-shift",children:[(0,x.jsx)("i",{className:"fas fa-clock"}),(0,x.jsx)("span",{children:e.myAssignment.shiftType})]}):(0,x.jsxs)("div",{className:"no-shift",children:[(0,x.jsx)("i",{className:"fas fa-minus"}),(0,x.jsx)("span",{children:"Off"})]})})]},a)})})]})]})};function ir(){const e=localStorage.getItem("token");return e?{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}:{"Content-Type":"application/json"}}const lr=()=>{var e,t;const[a,s]=(0,n.useState)(!1),[r,i]=(0,n.useState)("Location sharing is off"),[l,o]=(0,n.useState)(null),c=(0,n.useRef)(null),d=(0,n.useRef)(null);(0,n.useEffect)(()=>()=>{if(c.current&&navigator.geolocation)try{navigator.geolocation.clearWatch(c.current)}catch(e){}d.current&&clearInterval(d.current)},[]);const u=async e=>{try{const t={latitude:e.latitude,longitude:e.longitude,accuracy:e.accuracy,meta:{source:"browser_geolocation"}},a=await fetch("".concat("http://localhost:5000","/api/delivery/location"),{method:"POST",headers:ir(),body:JSON.stringify(t)});if(a.ok)i("Location updated");else{const e=await a.text();i("Update failed (".concat(a.status,") ").concat(e.slice(0,60)))}}catch(t){i((null===t||void 0===t?void 0:t.message)||"Failed to update")}};return(0,x.jsxs)("div",{children:[(0,x.jsx)("h2",{children:"Live Location"}),(0,x.jsxs)("div",{className:"dash-card",style:{marginBottom:12},children:[(0,x.jsx)("p",{style:{margin:0,color:"#475569"},children:"Share your current location with the manager during duty."}),(0,x.jsxs)("div",{style:{display:"flex",gap:8,marginTop:8},children:[a?(0,x.jsx)("button",{className:"btn-secondary",onClick:()=>{if(s(!1),i("Location sharing stopped"),c.current&&navigator.geolocation)try{navigator.geolocation.clearWatch(c.current)}catch(e){}d.current&&(clearInterval(d.current),d.current=null)},children:"Stop Sharing"}):(0,x.jsx)("button",{className:"btn",onClick:()=>{if(navigator.geolocation){s(!0),i("Requesting location permission..."),navigator.geolocation.getCurrentPosition(e=>{o(e.coords),i("Location acquired"),u(e.coords)},e=>i("Error: ".concat(e.message)),{enableHighAccuracy:!0,timeout:15e3,maximumAge:5e3});try{c.current=navigator.geolocation.watchPosition(e=>{o(e.coords),u(e.coords)},e=>i("Watch error: ".concat(e.message)),{enableHighAccuracy:!0,timeout:2e4,maximumAge:5e3})}catch(e){}d.current=setInterval(()=>{l&&u(l)},3e4)}else i("Geolocation not supported in this browser")},children:"Start Sharing"}),(0,x.jsx)("div",{style:{alignSelf:"center",color:"#64748b"},children:r})]})]}),(0,x.jsxs)("div",{className:"dash-card",children:[(0,x.jsx)("h4",{style:{marginTop:0},children:"Last Known"}),l?(0,x.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8},children:[(0,x.jsxs)("div",{children:["Latitude: ",(0,x.jsx)("strong",{children:l.latitude.toFixed(6)})]}),(0,x.jsxs)("div",{children:["Longitude: ",(0,x.jsx)("strong",{children:l.longitude.toFixed(6)})]}),(0,x.jsxs)("div",{children:["Accuracy: ",(0,x.jsxs)("strong",{children:[null===(e=l.accuracy)||void 0===e||null===(t=e.toFixed)||void 0===t?void 0:t.call(e,0)," m"]})]}),(0,x.jsx)("div",{children:(0,x.jsx)("a",{className:"btn btn-sm",target:"_blank",rel:"noreferrer",href:"https://www.google.com/maps?q=".concat(l.latitude,",").concat(l.longitude),children:"Open in Google Maps"})})]}):(0,x.jsx)("div",{className:"no-data",children:"No location yet"})]})]})},or=()=>{const[e,t]=(0,n.useState)([]),[a,s]=(0,n.useState)(""),[r,i]=(0,n.useState)(!0),l=(0,w.Zp)(),{user:o}=y(),c=(0,n.useCallback)(async()=>{i(!0);try{t(await ht({status:a||void 0}))}catch(e){t([])}finally{i(!1)}},[a]);(0,n.useEffect)(()=>{c()},[c]);const d=["pickup_scheduled","enroute_pickup","picked_up","enroute_drop","delivered","cancelled"],u=()=>{const e=localStorage.getItem("token");return e?{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}:{"Content-Type":"application/json"}};return(0,x.jsxs)("div",{children:[(0,x.jsx)("h2",{children:"My Tasks"}),(0,x.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"end",marginBottom:12},children:[(0,x.jsxs)("label",{children:["Status",(0,x.jsxs)("select",{value:a,onChange:e=>s(e.target.value),children:[(0,x.jsx)("option",{value:"",children:"All"}),d.map(e=>(0,x.jsx)("option",{value:e,children:e},e))]})]}),(0,x.jsx)("button",{className:"btn-secondary",onClick:c,disabled:r,children:r?"Loading...":"Refresh"})]}),r?(0,x.jsx)("p",{children:"Loading..."}):0===e.length?(0,x.jsxs)("div",{className:"no-data",children:["No tasks found",a?' for status "'.concat(a,'"'):"","."]}):(0,x.jsx)("div",{className:"table-wrap",children:(0,x.jsxs)("table",{className:"table",children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{children:"#"}),(0,x.jsx)("th",{children:"When"}),(0,x.jsx)("th",{children:"Title"}),(0,x.jsx)("th",{children:"Customer"}),(0,x.jsx)("th",{children:"Barrels"}),(0,x.jsx)("th",{children:"Pickup"}),(0,x.jsx)("th",{children:"Drop"}),(0,x.jsx)("th",{children:"Status"}),(0,x.jsx)("th",{children:"Update"}),(0,x.jsx)("th",{children:"Action"})]})}),(0,x.jsx)("tbody",{children:e.map((e,t)=>{var a,n,s,r;return(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{children:t+1}),(0,x.jsx)("td",{children:e.scheduledAt?new Date(e.scheduledAt).toLocaleString("en-IN"):"-"}),(0,x.jsx)("td",{children:e.title}),(0,x.jsx)("td",{children:(null===(a=e.customerUserId)||void 0===a?void 0:a.name)||(null===(n=e.customerUserId)||void 0===n?void 0:n.email)||"-"}),(0,x.jsx)("td",{children:null!==(s=null===e||void 0===e||null===(r=e.meta)||void 0===r?void 0:r.barrelCount)&&void 0!==s?s:"-"}),(0,x.jsx)("td",{children:e.pickupAddress}),(0,x.jsx)("td",{children:e.dropAddress}),(0,x.jsx)("td",{children:e.status}),(0,x.jsx)("td",{children:(0,x.jsx)("select",{value:e.status,onChange:async t=>{try{await pt(e._id,{status:t.target.value})}catch(a){alert((null===a||void 0===a?void 0:a.message)||"Failed to update status. Follow allowed sequence.")}c()},children:d.map(e=>(0,x.jsx)("option",{value:e,children:e},e))})}),(0,x.jsxs)("td",{style:{display:"flex",gap:8},children:["delivered"!==e.status&&(0,x.jsx)("button",{className:"btn-secondary",onClick:()=>(async e=>{try{var t,a,n,s,r;const c=["pickup_scheduled","enroute_pickup","picked_up","enroute_drop","delivered"];for(let t=Math.max(c.indexOf(e.status),0)+1;t<c.length;t++)await pt(e._id,{status:c[t]});const d=null===e||void 0===e||null===(t=e.meta)||void 0===t?void 0:t.sellRequestId;if(d)try{await fetch("".concat("http://localhost:5000","/api/sell-requests/").concat(d,"/deliver-to-lab"),{method:"PUT",headers:u()})}catch(i){}const h=(null===e||void 0===e||null===(a=e.customerUserId)||void 0===a?void 0:a.name)||(null===e||void 0===e||null===(n=e.customerUserId)||void 0===n?void 0:n.email)||"",p=null!==(s=null===e||void 0===e||null===(r=e.meta)||void 0===r?void 0:r.barrelCount)&&void 0!==s?s:"",f=(new Date).toISOString().slice(0,16),m=d||(null===e||void 0===e?void 0:e._id),x=new URLSearchParams({sampleId:String(m),customerName:String(h),barrelCount:String(p),receivedAt:f}),g="/lab/check-in?".concat(x.toString());"lab"!==String((null===o||void 0===o?void 0:o.role)||"").toLowerCase().replace(/\s+/g,"_")&&alert("Only Lab Staff can complete Sample Check-In. You will be asked to log in as Lab to continue."),l(g)}catch(d){alert((null===d||void 0===d?void 0:d.message)||"Failed to update status")}finally{await c()}})(e),children:"Delivered to Lab"}),(0,x.jsx)("button",{className:"btn-secondary",onClick:()=>(async e=>{var t;const a=Array.isArray(null===e||void 0===e||null===(t=e.meta)||void 0===t?void 0:t.barrels)?e.meta.barrels.join(","):"",n=window.prompt("Enter Barrel IDs (comma separated):",a);if(null==n)return;const s=n.split(",").map(e=>e.trim()).filter(Boolean);try{await pt(e._id,{meta:{barrels:s}}),await c()}catch(r){alert((null===r||void 0===r?void 0:r.message)||"Failed to save barrel IDs")}})(e),children:"Set Barrel IDs"}),(0,x.jsx)("button",{className:"btn-secondary",onClick:()=>(e=>{var t,a,n,s,r;console.log("Opening Lab Check-In for task:",e),console.log("Task meta:",null===e||void 0===e?void 0:e.meta),console.log("Task customerUserId:",null===e||void 0===e?void 0:e.customerUserId);const i=(null===e||void 0===e||null===(t=e.customerUserId)||void 0===t?void 0:t.name)||(null===e||void 0===e||null===(a=e.customerUserId)||void 0===a?void 0:a.email)||(null===e||void 0===e?void 0:e.customerName)||"Unknown Customer",c=(null===e||void 0===e||null===(n=e.meta)||void 0===n?void 0:n.barrelCount)||(null===e||void 0===e?void 0:e.barrelCount)||"1",d=(new Date).toISOString().slice(0,16),u=(null===e||void 0===e||null===(s=e.meta)||void 0===s?void 0:s.sellRequestId)||(null===e||void 0===e?void 0:e._id)||"TASK-".concat(Date.now());console.log("Extracted values:",{customer:i,count:c,receivedAt:d,sampleId:u});const h=new URLSearchParams;h.set("sampleId",String(u)),h.set("customerName",String(i)),h.set("barrelCount",String(c)),h.set("receivedAt",d),(Array.isArray(null===e||void 0===e||null===(r=e.meta)||void 0===r?void 0:r.barrels)?e.meta.barrels:[]).forEach(e=>{e&&h.append("barrels",String(e))});const p="/lab/check-in?".concat(h.toString());console.log("Final URL:",p),console.log("URLSearchParams:",h.toString()),"lab"!==String((null===o||void 0===o?void 0:o.role)||"").toLowerCase().replace(/\s+/g,"_")&&alert("Only Lab Staff can complete Sample Check-In. You will be asked to log in as Lab to continue."),l(p)})(e),children:"Open Lab Check-In"})]})]},e._id)})})]})})]})};function cr(){const e=localStorage.getItem("token");return e?{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}:{"Content-Type":"application/json"}}const dr=()=>{const[e,t]=(0,n.useState)([]),[a,s]=(0,n.useState)(!0),[r,i]=(0,n.useState)(""),[l,o]=(0,n.useState)(null),[c,d]=(0,n.useState)("all");(0,n.useEffect)(()=>{u()},[c]);const u=async()=>{s(!0),i("");try{const e=await fetch("".concat("http://localhost:5000","/api/delivery/task-history?filter=").concat(c),{headers:cr()});if(!e.ok)throw new Error("Failed to fetch history (".concat(e.status,")"));const a=await e.json();t(a.history||[])}catch(e){console.error("Error fetching history:",e),i(e.message||"Failed to load task history")}finally{s(!1)}},h=e=>e?new Date(e).toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"}):"-",p=e=>({pickup_scheduled:"#3b82f6",enroute_pickup:"#f59e0b",picked_up:"#10b981",enroute_drop:"#f59e0b",delivered:"#22c55e",cancelled:"#ef4444",completed:"#059669"}[e]||"#6b7280"),f=e=>{var t,a,n,s,r,i;return[{label:"Task Assigned",status:"completed",icon:"fa-user-check",timestamp:e.assignedAt||e.createdAt,description:"Manager assigned task: ".concat(e.title)},{label:"Barrel Scan",status:e.barrelScanData?"completed":"pending",icon:"fa-qrcode",timestamp:null===(t=e.barrelScanData)||void 0===t?void 0:t.scannedAt,description:e.barrelScanData?"Scanned ".concat(e.barrelScanData.barrelCount," barrels at ").concat(e.barrelScanData.location||"pickup location"):"Waiting for barrel scan"},{label:"Pickup",status:e.pickupAt?"completed":"enroute_pickup"===e.status?"in-progress":"pending",icon:"fa-truck",timestamp:e.pickupAt,description:e.pickupAt?"Picked up from ".concat(e.pickupAddress):"enroute_pickup"===e.status?"En route to pickup location":"Awaiting pickup"},{label:"Live Location",status:(null===(a=e.locationUpdates)||void 0===a?void 0:a.length)>0?"completed":"pending",icon:"fa-map-marker-alt",timestamp:null===(n=e.locationUpdates)||void 0===n||null===(s=n[e.locationUpdates.length-1])||void 0===s?void 0:s.timestamp,description:null!==(r=e.locationUpdates)&&void 0!==r&&r.length?"".concat(e.locationUpdates.length," location updates tracked"):"No location updates yet"},{label:"Barrel Intake",status:e.barrelIntake?"completed":"pending",icon:"fa-warehouse",timestamp:null===(i=e.barrelIntake)||void 0===i?void 0:i.createdAt,description:e.barrelIntake?"Intake recorded: ".concat(e.barrelIntake.barrelCount," barrels - ").concat(e.barrelIntake.name):"Barrel intake pending"},{label:"Delivery Complete",status:e.deliveredAt?"completed":"enroute_drop"===e.status?"in-progress":"pending",icon:"fa-check-circle",timestamp:e.deliveredAt,description:e.deliveredAt?"Delivered to ".concat(e.dropAddress):"enroute_drop"===e.status?"En route to delivery location":"Delivery pending"}]},m=e=>{let{task:t}=e;const a=f(t).filter(e=>"completed"===e.status).length,n=f(t).length,s=a/n*100;return(0,x.jsxs)("div",{className:"task-history-card",onClick:()=>o(t),children:[(0,x.jsxs)("div",{className:"task-card-header",children:[(0,x.jsxs)("div",{className:"task-title-section",children:[(0,x.jsx)("h4",{children:t.title}),(0,x.jsxs)("span",{className:"task-date",children:[(0,x.jsx)("i",{className:"fas fa-clock"}),(i=t.createdAt,i?new Date(i).toLocaleDateString("en-US",{month:"short",day:"numeric"}):"-")]})]}),(0,x.jsxs)("div",{className:"task-status-badge",style:{background:"".concat(p(t.status),"20"),color:p(t.status),border:"2px solid ".concat(p(t.status))},children:[(0,x.jsx)("i",{className:"fas ".concat((r=t.status,{pickup_scheduled:"fa-calendar-check",enroute_pickup:"fa-truck",picked_up:"fa-box",enroute_drop:"fa-truck-loading",delivered:"fa-check-circle",cancelled:"fa-times-circle",completed:"fa-check-double"}[r]||"fa-info-circle"))}),t.status.replace(/_/g," ").toUpperCase()]})]}),(0,x.jsxs)("div",{className:"task-progress-section",children:[(0,x.jsx)("div",{className:"progress-bar",children:(0,x.jsx)("div",{className:"progress-fill",style:{width:"".concat(s,"%"),background:"linear-gradient(90deg, ".concat(p(t.status),", ").concat(p(t.status),"aa)")}})}),(0,x.jsxs)("span",{className:"progress-text",children:[a,"/",n," steps completed"]})]}),(0,x.jsxs)("div",{className:"task-quick-info",children:[(0,x.jsxs)("div",{className:"quick-info-item",children:[(0,x.jsx)("i",{className:"fas fa-map-marker-alt"}),(0,x.jsx)("span",{children:t.pickupAddress})]}),(0,x.jsx)("i",{className:"fas fa-arrow-right"}),(0,x.jsxs)("div",{className:"quick-info-item",children:[(0,x.jsx)("i",{className:"fas fa-map-marker-alt"}),(0,x.jsx)("span",{children:t.dropAddress})]})]}),t.barrelIntake&&(0,x.jsxs)("div",{className:"intake-badge",children:[(0,x.jsx)("i",{className:"fas fa-boxes"}),t.barrelIntake.barrelCount," barrels | ",t.barrelIntake.name]})]});var r,i},g=e=>{let{task:t,onClose:a}=e;const n=f(t);return(0,x.jsx)("div",{className:"modal-overlay",onClick:a,children:(0,x.jsxs)("div",{className:"task-detail-modal",onClick:e=>e.stopPropagation(),children:[(0,x.jsxs)("div",{className:"modal-header",children:[(0,x.jsxs)("h3",{children:[(0,x.jsx)("i",{className:"fas fa-tasks"}),"Task History Details"]}),(0,x.jsx)("button",{className:"close-btn",onClick:a,children:(0,x.jsx)("i",{className:"fas fa-times"})})]}),(0,x.jsxs)("div",{className:"modal-content",children:[(0,x.jsxs)("div",{className:"task-summary",children:[(0,x.jsx)("h4",{children:t.title}),(0,x.jsxs)("div",{className:"summary-grid",children:[(0,x.jsxs)("div",{className:"summary-item",children:[(0,x.jsx)("span",{className:"label",children:"Task ID"}),(0,x.jsx)("span",{className:"value",children:t._id.slice(-8).toUpperCase()})]}),(0,x.jsxs)("div",{className:"summary-item",children:[(0,x.jsx)("span",{className:"label",children:"Created"}),(0,x.jsx)("span",{className:"value",children:h(t.createdAt)})]}),(0,x.jsxs)("div",{className:"summary-item",children:[(0,x.jsx)("span",{className:"label",children:"Status"}),(0,x.jsx)("span",{className:"value",children:(0,x.jsx)("span",{style:{color:p(t.status),fontWeight:600},children:t.status.replace(/_/g," ").toUpperCase()})})]})]})]}),(0,x.jsxs)("div",{className:"timeline-section",children:[(0,x.jsxs)("h4",{children:[(0,x.jsx)("i",{className:"fas fa-stream"}),"Workflow Timeline"]}),(0,x.jsx)("div",{className:"timeline",children:n.map((e,t)=>(0,x.jsxs)("div",{className:"timeline-item ".concat(e.status),children:[(0,x.jsxs)("div",{className:"timeline-marker",children:[(0,x.jsx)("div",{className:"marker-icon",style:{background:"completed"===e.status?"#10b981":"in-progress"===e.status?"#f59e0b":"#e5e7eb"},children:(0,x.jsx)("i",{className:"fas ".concat(e.icon)})}),t<n.length-1&&(0,x.jsx)("div",{className:"timeline-line",style:{background:"completed"===e.status?"#10b981":"#e5e7eb"}})]}),(0,x.jsxs)("div",{className:"timeline-content",children:[(0,x.jsxs)("div",{className:"timeline-header",children:[(0,x.jsx)("h5",{children:e.label}),e.timestamp&&(0,x.jsx)("span",{className:"timeline-time",children:h(e.timestamp)})]}),(0,x.jsx)("p",{className:"timeline-description",children:e.description})]})]},t))})]}),t.barrelScanData&&(0,x.jsxs)("div",{className:"detail-section",children:[(0,x.jsxs)("h4",{children:[(0,x.jsx)("i",{className:"fas fa-qrcode"}),"Barrel Scan Details"]}),(0,x.jsxs)("div",{className:"detail-grid",children:[(0,x.jsxs)("div",{className:"detail-item",children:[(0,x.jsx)("span",{className:"label",children:"Barrel Count"}),(0,x.jsx)("span",{className:"value",children:t.barrelScanData.barrelCount})]}),(0,x.jsxs)("div",{className:"detail-item",children:[(0,x.jsx)("span",{className:"label",children:"Scan Location"}),(0,x.jsx)("span",{className:"value",children:t.barrelScanData.location||"N/A"})]}),(0,x.jsxs)("div",{className:"detail-item",children:[(0,x.jsx)("span",{className:"label",children:"Scanned At"}),(0,x.jsx)("span",{className:"value",children:h(t.barrelScanData.scannedAt)})]})]})]}),t.locationUpdates&&t.locationUpdates.length>0&&(0,x.jsxs)("div",{className:"detail-section",children:[(0,x.jsxs)("h4",{children:[(0,x.jsx)("i",{className:"fas fa-route"}),"Location Tracking (",t.locationUpdates.length," updates)"]}),(0,x.jsx)("div",{className:"location-list",children:t.locationUpdates.slice(-5).reverse().map((e,t)=>{var a,n;return(0,x.jsxs)("div",{className:"location-item",children:[(0,x.jsx)("i",{className:"fas fa-map-pin"}),(0,x.jsxs)("div",{className:"location-info",children:[(0,x.jsxs)("span",{className:"location-coords",children:["Lat: ",null===(a=e.latitude)||void 0===a?void 0:a.toFixed(6),", Lng: ",null===(n=e.longitude)||void 0===n?void 0:n.toFixed(6)]}),(0,x.jsx)("span",{className:"location-time",children:h(e.timestamp)})]}),e.latitude&&e.longitude&&(0,x.jsx)("a",{className:"location-link",href:"https://www.google.com/maps?q=".concat(e.latitude,",").concat(e.longitude),target:"_blank",rel:"noreferrer",onClick:e=>e.stopPropagation(),children:(0,x.jsx)("i",{className:"fas fa-external-link-alt"})})]},t)})})]}),t.barrelIntake&&(0,x.jsxs)("div",{className:"detail-section",children:[(0,x.jsxs)("h4",{children:[(0,x.jsx)("i",{className:"fas fa-warehouse"}),"Barrel Intake Information"]}),(0,x.jsxs)("div",{className:"detail-grid",children:[(0,x.jsxs)("div",{className:"detail-item",children:[(0,x.jsx)("span",{className:"label",children:"Customer Name"}),(0,x.jsx)("span",{className:"value",children:t.barrelIntake.name})]}),(0,x.jsxs)("div",{className:"detail-item",children:[(0,x.jsx)("span",{className:"label",children:"Phone"}),(0,x.jsx)("span",{className:"value",children:t.barrelIntake.phone})]}),(0,x.jsxs)("div",{className:"detail-item",children:[(0,x.jsx)("span",{className:"label",children:"Barrel Count"}),(0,x.jsx)("span",{className:"value",children:t.barrelIntake.barrelCount})]}),(0,x.jsxs)("div",{className:"detail-item",children:[(0,x.jsx)("span",{className:"label",children:"Status"}),(0,x.jsx)("span",{className:"value intake-status",children:t.barrelIntake.status})]}),t.barrelIntake.notes&&(0,x.jsxs)("div",{className:"detail-item full-width",children:[(0,x.jsx)("span",{className:"label",children:"Notes"}),(0,x.jsx)("span",{className:"value",children:t.barrelIntake.notes})]}),t.barrelIntake.totalAmount&&(0,x.jsxs)("div",{className:"detail-item",children:[(0,x.jsx)("span",{className:"label",children:"Total Amount"}),(0,x.jsxs)("span",{className:"value",children:["\u20b9",t.barrelIntake.totalAmount]})]})]})]}),t.notes&&(0,x.jsxs)("div",{className:"detail-section",children:[(0,x.jsxs)("h4",{children:[(0,x.jsx)("i",{className:"fas fa-sticky-note"}),"Task Notes"]}),(0,x.jsx)("p",{className:"task-notes",children:t.notes})]})]}),(0,x.jsx)("div",{className:"modal-footer",children:(0,x.jsx)("button",{className:"btn-secondary",onClick:a,children:"Close"})})]})})};return(0,x.jsxs)("div",{className:"delivery-task-history",children:[(0,x.jsxs)("div",{className:"page-header",children:[(0,x.jsxs)("h2",{children:[(0,x.jsx)("i",{className:"fas fa-history"}),"Task History"]}),(0,x.jsxs)("div",{className:"header-actions",children:[(0,x.jsxs)("div",{className:"filter-group",children:[(0,x.jsx)("button",{className:"filter-btn ".concat("all"===c?"active":""),onClick:()=>d("all"),children:"All Tasks"}),(0,x.jsx)("button",{className:"filter-btn ".concat("today"===c?"active":""),onClick:()=>d("today"),children:"Today"}),(0,x.jsx)("button",{className:"filter-btn ".concat("week"===c?"active":""),onClick:()=>d("week"),children:"This Week"}),(0,x.jsx)("button",{className:"filter-btn ".concat("month"===c?"active":""),onClick:()=>d("month"),children:"This Month"})]}),(0,x.jsxs)("button",{className:"refresh-btn",onClick:u,disabled:a,children:[(0,x.jsx)("i",{className:"fas fa-sync-alt ".concat(a?"fa-spin":"")}),"Refresh"]})]})]}),r&&(0,x.jsxs)("div",{className:"error-banner",children:[(0,x.jsx)("i",{className:"fas fa-exclamation-triangle"}),r,(0,x.jsx)("button",{onClick:u,children:"Retry"})]}),a?(0,x.jsxs)("div",{className:"loading-container",children:[(0,x.jsx)("div",{className:"loader"}),(0,x.jsx)("p",{children:"Loading task history..."})]}):0===e.length?(0,x.jsxs)("div",{className:"no-data-container",children:[(0,x.jsx)("i",{className:"fas fa-inbox"}),(0,x.jsx)("h3",{children:"No Task History Found"}),(0,x.jsx)("p",{children:"Your completed and ongoing tasks will appear here"})]}):(0,x.jsx)("div",{className:"history-grid",children:e.map(e=>(0,x.jsx)(m,{task:e},e._id))}),l&&(0,x.jsx)(g,{task:l,onClose:()=>o(null)})]})},ur=e=>{let{readOnly:t=!1}=e;const[a,s]=(0,n.useState)({name:"",phone:"",barrelCount:"",notes:""}),[r,l]=(0,n.useState)(""),[o,c]=(0,n.useState)(""),[d,u]=(0,n.useState)(!1),[h,p]=(0,n.useState)([]),f=Ae(),m=e=>s((0,i.A)((0,i.A)({},a),{},{[e.target.name]:e.target.value}));(0,n.useEffect)(()=>{s(e=>(0,i.A)((0,i.A)({},e),{},{barrelCount:h.length?String(h.length):""}))},[h]);return(0,x.jsxs)("div",{style:{padding:16},children:[(0,x.jsx)("h2",{children:"Delivery Barrel Intake"}),t&&(0,x.jsx)("div",{style:{marginBottom:8,color:"#94a3b8"},children:"Read-only view (for Accountant review). Data will appear once backend intake endpoints are enabled."}),r&&(0,x.jsx)("div",{style:{color:"#16a34a",marginBottom:8},children:r}),o&&(0,x.jsx)("div",{style:{color:"tomato",marginBottom:8},children:o}),(0,x.jsxs)("div",{style:{marginBottom:16},children:[(0,x.jsx)(Gs,{onBarrelScanned:e=>{p(t=>t.some(t=>t.barrelId===e.barrelId)?t:[...t,e])}}),h.length>0&&(0,x.jsxs)("div",{style:{marginTop:12},children:[(0,x.jsxs)("div",{style:{fontWeight:600,marginBottom:8},children:["Scanned Barrels: ",h.length]}),(0,x.jsx)("div",{style:{display:"flex",flexWrap:"wrap",gap:8},children:h.map(e=>(0,x.jsxs)("div",{style:{border:"1px solid #e5e7eb",borderRadius:6,padding:"6px 10px",display:"flex",alignItems:"center",gap:8},children:[(0,x.jsx)("span",{children:e.barrelId}),!t&&(0,x.jsx)("button",{type:"button",className:"btn btn--sm",onClick:()=>{return t=e.barrelId,p(e=>e.filter(e=>e.barrelId!==t));var t},children:"Remove"})]},e.barrelId))}),!t&&(0,x.jsx)("div",{style:{marginTop:8},children:(0,x.jsx)("button",{type:"button",className:"btn",onClick:()=>p([]),children:"Clear All"})})]})]}),(0,x.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),l(""),c(""),t)return;if(!a.name||!a.phone||!a.barrelCount)return void c("Please fill Name, Phone and Barrel Count");if(await f("Confirm Intake","Record intake for ".concat(a.name," with ").concat(a.barrelCount," barrel(s)?")))try{u(!0);const e=localStorage.getItem("token"),t=e?{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)}:{"Content-Type":"application/json"},n={customerName:a.name,customerPhone:a.phone,barrelCount:Number(h.length||a.barrelCount)||0,notes:a.notes,barrelIds:h.map(e=>e.barrelId)},r=await fetch("".concat("http://localhost:5000","/api/delivery/barrels/intake"),{method:"POST",headers:t,body:JSON.stringify(n)});if(!r.ok)throw new Error("Submit failed (".concat(r.status,")"));l("Intake recorded"),s({name:"",phone:"",barrelCount:"",notes:""}),p([])}catch(n){c((null===n||void 0===n?void 0:n.message)||"Failed to record intake")}finally{u(!1)}},children:[(0,x.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12,maxWidth:640},children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{children:"Name"}),(0,x.jsx)("input",{name:"name",value:a.name,onChange:m,disabled:t||d})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{children:"Phone"}),(0,x.jsx)("input",{name:"phone",value:a.phone,onChange:m,disabled:t||d})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{children:"Number of Barrels"}),(0,x.jsx)("input",{name:"barrelCount",type:"number",min:"0",value:a.barrelCount,onChange:m,readOnly:!0,disabled:t||d})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{children:"Notes"}),(0,x.jsx)("input",{name:"notes",value:a.notes,onChange:m,disabled:t||d})]})]}),!t&&(0,x.jsx)("div",{style:{marginTop:12},children:(0,x.jsx)("button",{className:"btn",type:"submit",disabled:d,children:d?"Saving...":"Save Intake"})})]})]})};const hr=function(){const[e,t]=(0,n.useState)(""),[a,s]=(0,n.useState)("field"),[r,i]=(0,n.useState)(null),[l,o]=(0,n.useState)(!1),[c,d]=(0,n.useState)(""),u=localStorage.getItem("token");return(0,x.jsx)("div",{className:"card",style:{maxWidth:720,margin:"0 auto"},children:(0,x.jsxs)("div",{className:"card-body",children:[(0,x.jsx)("h2",{children:"Field: Barrel Movement"}),(0,x.jsx)("p",{className:"text-muted",children:"Scan or enter barrel ID to update current location between field and factory."}),(0,x.jsxs)("form",{onSubmit:async t=>{if(t.preventDefault(),d(""),i(null),e){o(!0);try{const t=await fetch("/api/barrels/".concat(e,"/location"),{method:"PUT",headers:{"Content-Type":"application/json",Authorization:u?"Bearer ".concat(u):void 0},body:JSON.stringify({currentLocation:a})}),n=await t.json();if(!t.ok)throw new Error((null===n||void 0===n?void 0:n.message)||"Failed to update location");i(n)}catch(t){d(t.message)}finally{o(!1)}}else d("Barrel ID is required")},className:"form-grid",children:[(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{children:"Barrel ID (Mongo _id)"}),(0,x.jsx)("input",{value:e,onChange:e=>t(e.target.value),required:!0})]}),(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{children:"Current Location"}),(0,x.jsxs)("select",{value:a,onChange:e=>s(e.target.value),children:[(0,x.jsx)("option",{value:"field",children:"Field"}),(0,x.jsx)("option",{value:"factory",children:"Factory"})]})]}),(0,x.jsx)("button",{className:"btn btn-primary",disabled:l,children:l?"Updating...":"Update Location"})]}),c&&(0,x.jsx)("div",{className:"alert alert-danger",style:{marginTop:12},children:c}),r&&(0,x.jsxs)("div",{className:"alert alert-success",style:{marginTop:12},children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("strong",{children:"Barrel:"})," ",r.barrelId]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("strong",{children:"Location:"})," ",r.currentLocation]})]})]})})},pr="http://localhost:5000";function fr(){const e=localStorage.getItem("token");return e?{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}:{"Content-Type":"application/json"}}const mr=()=>{const[e,t]=(0,n.useState)([]),[a,s]=(0,n.useState)(!1),[r,l]=(0,n.useState)(""),o=Ae(),[c,d]=(0,n.useState)({}),u=async()=>{s(!0),l("");try{const e=await fetch("".concat(pr,"/api/sell-requests/admin/all?status=TESTED"),{headers:fr()});if(!e.ok)throw new Error("Failed to load (".concat(e.status,")"));const a=await e.json(),n=Array.isArray(null===a||void 0===a?void 0:a.records)?a.records:Array.isArray(null===a||void 0===a?void 0:a.items)?a.items:Array.isArray(a)?a:[];t(n)}catch(e){l((null===e||void 0===e?void 0:e.message)||"Failed to load"),t([])}finally{s(!1)}};(0,n.useEffect)(()=>{u()},[]);return(0,x.jsxs)("div",{style:{padding:16},children:[(0,x.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,x.jsx)("h2",{children:"Delivery Intake / Verify"}),(0,x.jsx)("button",{onClick:u,disabled:a,children:a?"Refreshing...":"Refresh"})]}),r&&(0,x.jsx)("div",{style:{color:"tomato",marginTop:8},children:r}),(0,x.jsx)("div",{style:{color:"#6b7280",fontSize:13,marginTop:6},children:"Lab provides DRC% and barrel count. Enter market rate to calculate amount. After calculation, the manager will verify and generate invoice."}),(0,x.jsx)("div",{style:{marginTop:12,overflowX:"auto"},children:(0,x.jsxs)("table",{className:"dashboard-table",style:{minWidth:1100},children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{children:"Date"}),(0,x.jsx)("th",{children:"Buyer"}),(0,x.jsx)("th",{children:"Phone"}),(0,x.jsx)("th",{children:"Barrels"}),(0,x.jsx)("th",{children:"DRC%"}),(0,x.jsx)("th",{children:"Total (Kg)"}),(0,x.jsx)("th",{children:"Dry Kg"}),(0,x.jsx)("th",{children:"Market Rate (\u20b9/dry kg)"}),(0,x.jsx)("th",{children:"Amount (\u20b9)"}),(0,x.jsx)("th",{children:"\u20b9/Barrel"}),(0,x.jsx)("th",{children:"Action"})]})}),(0,x.jsxs)("tbody",{children:[e.map(e=>{var t,a,n,s,r;const h=e.overrideFarmerName||(null===(t=e.farmerId)||void 0===t?void 0:t.name)||e.name||"-",p=(null===(a=e.farmerId)||void 0===a?void 0:a.phoneNumber)||e.phone||"-",f=Number(e.drcPct||0),m=Number(e.totalVolumeKg||0),g=Math.round(m*(f/100)*100)/100,v=null!==(n=c[e._id])&&void 0!==n?n:null!==(s=e.marketRate)&&void 0!==s?s:"",y=e.amount?Number(e.amount):v?Math.round((Number(v)||0)*g):null,b=e.barrelCount&&y?y/Number(e.barrelCount):null;return(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{children:new Date(e.createdAt).toLocaleString()}),(0,x.jsx)("td",{children:h}),(0,x.jsx)("td",{children:p}),(0,x.jsx)("td",{children:null!==(r=e.barrelCount)&&void 0!==r?r:"-"}),(0,x.jsx)("td",{children:f?"".concat(f,"%"):"-"}),(0,x.jsx)("td",{children:m||"-"}),(0,x.jsx)("td",{children:isNaN(g)?"-":g}),(0,x.jsx)("td",{children:(0,x.jsx)("input",{type:"number",step:"any",min:"0",value:v,onChange:t=>d(a=>(0,i.A)((0,i.A)({},a),{},{[e._id]:t.target.value})),style:{width:160},placeholder:"e.g. 145"})}),(0,x.jsx)("td",{children:null==y||isNaN(y)?"-":y}),(0,x.jsx)("td",{children:null==b||isNaN(b)?"-":b.toFixed(2)}),(0,x.jsx)("td",{children:(0,x.jsx)("button",{className:"btn",onClick:()=>(async e=>{const t=Number(c[e]);if(!t||t<=0)return void alert("Enter valid market rate");if(await o("Calculate Amount","Calculate using market rate \u20b9".concat(t," per dry kg?")))try{l("");const a=await fetch("".concat(pr,"/api/sell-requests/").concat(e,"/calculate"),{method:"PUT",headers:fr(),body:JSON.stringify({marketRate:t})});if(!a.ok)throw new Error("Calculate failed (".concat(a.status,")"));await u()}catch(a){l((null===a||void 0===a?void 0:a.message)||"Calculate failed")}})(e._id),children:"Calculate"})})]},e._id)}),0===e.length&&!a&&(0,x.jsx)("tr",{children:(0,x.jsx)("td",{colSpan:7,style:{textAlign:"center",color:"#6b7280"},children:"No pending intakes."})})]})]})})]})},xr="http://localhost:5000";function gr(){const e=localStorage.getItem("token");return e?{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}:{"Content-Type":"application/json"}}const vr=()=>{const e=Ae(),[t,a]=(0,n.useState)([]),[s,r]=(0,n.useState)(!1),[l,o]=(0,n.useState)(""),[c,d]=(0,n.useState)({from:"",to:"",type:"casual",dayType:"full",reason:""}),[u,h]=(0,n.useState)({}),[p,f]=(0,n.useState)(!1),m=(new Date).toISOString().split("T")[0],g=new Date;g.setFullYear(g.getFullYear()+2);const v=g.toISOString().split("T")[0],y=e=>{if(!e)return"-";try{const t=new Date(e);return Number.isNaN(t.getTime())?"-":t.toLocaleDateString()}catch(t){return"-"}},b=e=>null===e||void 0===e?"-":"object"===typeof e?e.name||e.email||"-":String(e),j=async()=>{r(!0),o("");try{const e=await fetch("".concat(xr,"/api/leave/my-leaves"),{headers:gr()});if(!e.ok){await e.text();if(404===e.status)return o("Leave history is not available yet."),void a([]);throw new Error("Failed to load (".concat(e.status,")"))}const t=await e.json(),n=Array.isArray(null===t||void 0===t?void 0:t.leaves)?t.leaves:Array.isArray(t)?t:[];a(n)}catch(e){o(((null===e||void 0===e?void 0:e.message)||"Failed to load leaves").replace(/<[^>]*>/g,"")),a([])}finally{r(!1)}};(0,n.useEffect)(()=>{j()},[]);return(0,x.jsxs)("div",{style:{padding:16},children:[(0,x.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[(0,x.jsx)("h2",{style:{margin:0},children:"Leave"}),(0,x.jsx)("button",{className:"btn btn-outline-primary",onClick:()=>f(!0),children:"\ud83d\udccb View Leave History"})]}),l&&(0,x.jsx)("div",{style:{color:"tomato",marginBottom:8},children:l}),(0,x.jsxs)("form",{onSubmit:async t=>{t.preventDefault();if(await e("Apply Leave","Submit this leave request?"))try{h({});const{from:e,to:t,type:a,dayType:n,reason:s}=c,r={};if(e||(r.from="From date is required"),t||(r.to="To date is required"),s&&s.trim()||(r.reason="Reason is required"),a||(r.type="Type is required"),n&&["full","half"].includes(n)||(r.dayType="Select Full day or Half day"),Object.keys(r).length)return void h(r);const l=new Date(e),u=new Date(t);if(Number.isNaN(l.getTime())||Number.isNaN(u.getTime()))return void h(e=>(0,i.A)((0,i.A)({},e),{},{from:"Invalid date",to:"Invalid date"}));const p=new Date;if(p.setHours(0,0,0,0),l<p)return void h(e=>(0,i.A)((0,i.A)({},e),{},{from:"Start date cannot be in the past"}));if(u<p)return void h(e=>(0,i.A)((0,i.A)({},e),{},{to:"End date cannot be in the past"}));if(u<l)return void h(e=>(0,i.A)((0,i.A)({},e),{},{to:"End date cannot be earlier than start date"}));if("half"===n&&l.toDateString()!==u.toDateString())return void h(e=>(0,i.A)((0,i.A)({},e),{},{to:"Half day leave must be a single day"}));const f={startDate:e,endDate:t,leaveType:a,reason:s,dayType:n},m=await fetch("".concat(xr,"/api/leave/apply"),{method:"POST",headers:gr(),body:JSON.stringify(f)});if(!m.ok){const e=await m.text();if(404===m.status)return void o("Leave application is not available yet.");if(500===m.status)return void o("Unable to submit leave right now (server error). Please try again later.");throw new Error("Apply failed (".concat(m.status,") ").concat(e.slice(0,80)))}d({from:"",to:"",type:"casual",dayType:"full",reason:""}),await j()}catch(t){o(((null===t||void 0===t?void 0:t.message)||"Failed to apply").replace(/<[^>]*>/g,""))}},style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12,maxWidth:720},children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{children:"From"}),(0,x.jsx)("input",{type:"date",value:c.from,min:m,max:v,onChange:e=>{const t=e.target.value;d(e=>{let a=(0,i.A)((0,i.A)({},e),{},{from:t});return a.to&&new Date(a.to)<new Date(t)&&(a.to=t),"half"===a.dayType&&t&&(a.to=t),a}),u.from&&h(e=>(0,i.A)((0,i.A)({},e),{},{from:""})),u.to&&h(e=>(0,i.A)((0,i.A)({},e),{},{to:""}))},required:!0}),u.from&&(0,x.jsx)("div",{style:{color:"tomato",fontSize:12},children:u.from})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{children:"To"}),(0,x.jsx)("input",{type:"date",value:c.to,min:c.from||m,max:v,onChange:e=>{const t=e.target.value;d(e=>(0,i.A)((0,i.A)({},e),{},{to:t})),u.to&&h(e=>(0,i.A)((0,i.A)({},e),{},{to:""}))},required:!0}),u.to&&(0,x.jsx)("div",{style:{color:"tomato",fontSize:12},children:u.to})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{children:"Type"}),(0,x.jsxs)("select",{value:c.type,onChange:e=>d(t=>(0,i.A)((0,i.A)({},t),{},{type:e.target.value})),children:[(0,x.jsx)("option",{value:"casual",children:"Casual"}),(0,x.jsx)("option",{value:"sick",children:"Sick"}),(0,x.jsx)("option",{value:"earned",children:"Earned"})]}),u.type&&(0,x.jsx)("div",{style:{color:"tomato",fontSize:12},children:u.type})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{children:"Day Type"}),(0,x.jsxs)("select",{value:c.dayType,onChange:e=>d(t=>(0,i.A)((0,i.A)({},t),{},{dayType:e.target.value})),children:[(0,x.jsx)("option",{value:"full",children:"Full Day"}),(0,x.jsx)("option",{value:"half",children:"Half Day"})]}),u.dayType&&(0,x.jsx)("div",{style:{color:"tomato",fontSize:12},children:u.dayType})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{children:"Reason"}),(0,x.jsx)("input",{value:c.reason,onChange:e=>d(t=>(0,i.A)((0,i.A)({},t),{},{reason:e.target.value})),required:!0}),u.reason&&(0,x.jsx)("div",{style:{color:"tomato",fontSize:12},children:u.reason})]}),(0,x.jsx)("div",{style:{gridColumn:"1 / -1"},children:(0,x.jsx)("button",{className:"btn",type:"submit",children:"Apply"})})]}),(0,x.jsx)("div",{style:{marginTop:16,overflowX:"auto"},children:(0,x.jsxs)("table",{className:"dashboard-table",style:{minWidth:720},children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{children:"From"}),(0,x.jsx)("th",{children:"To"}),(0,x.jsx)("th",{children:"Type"}),(0,x.jsx)("th",{children:"Day"}),(0,x.jsx)("th",{children:"Status"}),(0,x.jsx)("th",{children:"Applied"})]})}),(0,x.jsxs)("tbody",{children:[t.map((e,t)=>(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{children:y(e.startDate)}),(0,x.jsx)("td",{children:y(e.endDate)}),(0,x.jsx)("td",{children:b(e.leaveType||e.type)}),(0,x.jsx)("td",{style:{textTransform:"capitalize"},children:b(e.dayType||"full")}),(0,x.jsx)("td",{children:b(e.status)}),(0,x.jsx)("td",{children:null!==e&&void 0!==e&&e.appliedAt?new Date(e.appliedAt).toLocaleString():"-"})]},e._id||t)),0===t.length&&!s&&(0,x.jsx)("tr",{children:(0,x.jsx)("td",{colSpan:6,style:{textAlign:"center",color:"#6b7280"},children:"No leave requests."})})]})]})}),(0,x.jsx)(me,{isOpen:p,onClose:()=>f(!1)})]})},yr="http://localhost:5000";function br(){const e=localStorage.getItem("token");return e?{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}:{"Content-Type":"application/json"}}const jr=()=>{const{user:e}=y(),[t,a]=(0,n.useState)([]),[s,r]=(0,n.useState)(!1),[i,l]=(0,n.useState)(""),o=async()=>{if(null!==e&&void 0!==e&&e._id){r(!0),l(""),a([]);try{let t=await fetch("".concat(yr,"/api/salary/history/").concat(e._id),{headers:br(),credentials:"include"});if(t.ok||(t=await fetch("".concat(yr,"/api/wages/payslips?userId=").concat(encodeURIComponent(e._id),"&group=delivery"),{headers:br(),credentials:"include"})),t.ok||(t=await fetch("".concat(yr,"/api/wages/payslips?group=delivery"),{headers:br(),credentials:"include"})),t.ok||(t=await fetch("".concat(yr,"/api/wages/payslips?role=delivery_staff"),{headers:br(),credentials:"include"})),t.ok||(t=await fetch("".concat(yr,"/api/salary/history?staffId=").concat(encodeURIComponent(e._id)),{headers:br(),credentials:"include"})),!t.ok){await t.text();if(404===t.status)return l("Salary history is not available yet."),void a([]);throw new Error("Failed to load (".concat(t.status,")"))}const{list:n}=await(async e=>{const t=(e.headers.get("content-type")||"").includes("application/json")?await e.json():{error:await e.text()};return{list:Array.isArray(null===t||void 0===t?void 0:t.data)?t.data:Array.isArray(null===t||void 0===t?void 0:t.payslips)?t.payslips:Array.isArray(t)?t:[],body:t}})(t);a(n)}catch(t){const e=((null===t||void 0===t?void 0:t.message)||"Failed to load salary").replace(/<[^>]*>/g,"");l(e)}finally{r(!1)}}};return(0,n.useEffect)(()=>{o()},[null===e||void 0===e?void 0:e._id]),(0,x.jsxs)("div",{style:{padding:16},children:[(0,x.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,x.jsx)("h2",{children:"My Salary"}),(0,x.jsx)("button",{onClick:o,disabled:s,children:s?"Refreshing...":"Refresh"})]}),i&&(0,x.jsx)("div",{style:{color:"tomato",marginTop:8},children:i}),(0,x.jsx)("div",{style:{marginTop:12,overflowX:"auto"},children:(0,x.jsxs)("table",{className:"dashboard-table",style:{minWidth:780},children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{children:"Month"}),(0,x.jsx)("th",{children:"Year"}),(0,x.jsx)("th",{children:"Gross"}),(0,x.jsx)("th",{children:"Deductions"}),(0,x.jsx)("th",{children:"Net Pay"}),(0,x.jsx)("th",{children:"Status"}),(0,x.jsx)("th",{children:"Approved At"}),(0,x.jsx)("th",{children:"Paid At"})]})}),(0,x.jsxs)("tbody",{children:[t.map((e,t)=>{var a,n,s,r,i,l,o,c,d,u,h,p,f,m,g,v,y;return(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{children:null!==(a=null!==(n=e.month)&&void 0!==n?n:null===(s=e.period)||void 0===s?void 0:s.month)&&void 0!==a?a:"-"}),(0,x.jsx)("td",{children:null!==(r=null!==(i=e.year)&&void 0!==i?i:null===(l=e.period)||void 0===l?void 0:l.year)&&void 0!==r?r:"-"}),(0,x.jsx)("td",{children:null!==(o=null!==(c=null!==(d=e.grossAmount)&&void 0!==d?d:e.grossSalary)&&void 0!==c?c:null===(u=e.amount)||void 0===u?void 0:u.gross)&&void 0!==o?o:"-"}),(0,x.jsx)("td",{children:null!==(h=null!==(p=null!==(f=e.totalDeductions)&&void 0!==f?f:e.deductions)&&void 0!==p?p:null===(m=e.amount)||void 0===m?void 0:m.deductions)&&void 0!==h?h:"-"}),(0,x.jsx)("td",{children:null!==(g=null!==(v=e.netPay)&&void 0!==v?v:null===(y=e.amount)||void 0===y?void 0:y.net)&&void 0!==g?g:"-"}),(0,x.jsx)("td",{children:e.status||e.state||"-"}),(0,x.jsx)("td",{children:e.approvedAt?new Date(e.approvedAt).toLocaleString():e.approved_at?new Date(e.approved_at).toLocaleString():"-"}),(0,x.jsx)("td",{children:e.paidAt?new Date(e.paidAt).toLocaleString():e.paid_at?new Date(e.paid_at).toLocaleString():"-"})]},e._id||t)}),0===t.length&&!s&&(0,x.jsx)("tr",{children:(0,x.jsx)("td",{colSpan:8,style:{textAlign:"center",color:"#6b7280"},children:"No salary records."})})]})]})})]})},wr="http://localhost:5000";function Nr(){const e=localStorage.getItem("token");return e?{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}:{"Content-Type":"application/json"}}const Sr=()=>{const[e,t]=(0,n.useState)([]),[a,s]=(0,n.useState)(!1),[r,i]=(0,n.useState)(""),[l,o]=(0,n.useState)(""),c=async()=>{s(!0),i("");try{const[e,a]=await Promise.all([fetch("".concat(wr,"/api/delivery/my"),{headers:Nr(),cache:"no-cache"}).catch(()=>null),fetch("".concat(wr,"/api/sell-requests/delivery/my-assigned"),{headers:Nr(),cache:"no-cache"}).catch(()=>null)]);let n=[];if(e&&e.ok){const t=await e.json();n=Array.isArray(t)?t:[]}let s=[];if(a&&a.ok){const e=await a.json();s=(Array.isArray(null===e||void 0===e?void 0:e.records)?e.records:Array.isArray(e)?e:[]).map(e=>({_id:"sr_".concat(e._id),title:e._type?"".concat(e._type," Pickup"):null!=e.barrelCount?"Sell Request Pickup (".concat(e.barrelCount,")"):"Sell Request Pickup",status:e.status||"DELIVER_ASSIGNED",scheduledAt:e.assignedAt||e.updatedAt||e.createdAt,createdAt:e.createdAt}))}const r=[...n,...s];t(r)}catch(e){i((null===e||void 0===e?void 0:e.message)||"Failed to load"),t([])}finally{s(!1)}};(0,n.useEffect)(()=>{c()},[]),(0,n.useEffect)(()=>{const e=setInterval(()=>{c()},1e4);return()=>clearInterval(e)},[]);const d=e=>{try{const t=new Date(e);return isNaN(t)?"-":t.toLocaleString()}catch(t){return"-"}};return(0,x.jsxs)("div",{style:{padding:16},children:[(0,x.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[(0,x.jsx)("h2",{children:"My Assigned Tasks"}),(0,x.jsx)("button",{onClick:c,disabled:a,children:a?"Refreshing...":"Refresh"})]}),r&&(0,x.jsx)("div",{style:{color:"tomato",marginBottom:8},children:r}),(0,x.jsx)("div",{style:{overflowX:"auto"},children:(0,x.jsxs)("table",{className:"dashboard-table",style:{minWidth:1e3},children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{children:"Task"}),(0,x.jsx)("th",{children:"Customer"}),(0,x.jsx)("th",{children:"Barrels"}),(0,x.jsx)("th",{children:"Status"}),(0,x.jsx)("th",{children:"Scheduled"}),(0,x.jsx)("th",{children:"Created"})]})}),(0,x.jsxs)("tbody",{children:[e.map(e=>{var t,a,n,s,r;return(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{children:e.title||"-"}),(0,x.jsx)("td",{children:(null===(t=e.customerUserId)||void 0===t?void 0:t.name)||(null===(a=e.customerUserId)||void 0===a?void 0:a.email)||"-"}),(0,x.jsx)("td",{children:null!==(n=null===e||void 0===e||null===(s=e.meta)||void 0===s?void 0:s.barrelCount)&&void 0!==n?n:null!==(r=e.barrelCount)&&void 0!==r?r:"-"}),(0,x.jsx)("td",{children:e.status||"pickup_scheduled"}),(0,x.jsx)("td",{children:d(e.scheduledAt)}),(0,x.jsx)("td",{children:d(e.createdAt)})]},e._id)}),!e.length&&!a&&(0,x.jsx)("tr",{children:(0,x.jsx)("td",{colSpan:6,style:{textAlign:"center",color:"#6b7280"},children:"No assignments."})})]})]})})]})},kr=e=>{let{title:t,desc:a,to:n,action:s="Open"}=e;return(0,x.jsx)("div",{className:"card",style:{borderRadius:12},children:(0,x.jsxs)("div",{className:"card-body",children:[(0,x.jsx)("h3",{style:{marginTop:0},children:t}),a?(0,x.jsx)("div",{style:{color:"#a3a3a3",marginBottom:12},children:a}):null,(0,x.jsx)(r.N_,{className:"btn btn-primary",to:n,children:s})]})})},Ar=e=>{let{title:t,children:a}=e;return(0,x.jsxs)("div",{style:{marginBottom:24},children:[(0,x.jsx)("h2",{style:{margin:"0 0 12px 0"},children:t}),(0,x.jsx)("div",{className:"card-grid",style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(220px, 1fr))",gap:16},children:a})]})},Cr=()=>(0,x.jsxs)("div",{children:[(0,x.jsxs)(Ar,{title:"Manager",children:[(0,x.jsx)(kr,{title:"Create Barrel",desc:"Create barrel IDs and print QR",to:"/admin/create-barrel",action:"Open"}),(0,x.jsx)(kr,{title:"Approve Barrel",desc:"Approve purchase by ID",to:"/admin/create-barrel",action:"Go"}),(0,x.jsx)(kr,{title:"Barrel History",desc:"View movement logs",to:"/manager/barrel-history",action:"View"}),(0,x.jsx)(kr,{title:"Scan Barrel",desc:"Scan and verify",to:"/manager/barrel-scan",action:"Scan"})]}),(0,x.jsxs)(Ar,{title:"Staff Modules",children:[(0,x.jsx)(kr,{title:"Staff Scan",desc:"Field/Staff scanner",to:"/staff/barrel-scan",action:"Scan"}),(0,x.jsx)(kr,{title:"Staff Barrel History",desc:"Lookup movement logs",to:"/staff/barrel-history",action:"View"}),(0,x.jsx)(kr,{title:"Delivery Scan",desc:"Delivery staff scanning",to:"/delivery/barrel-scan",action:"Scan"}),(0,x.jsx)(kr,{title:"Accountant Billing",desc:"Payments and billing",to:"/accountant/payments",action:"Open"}),(0,x.jsx)(kr,{title:"Lab DRC",desc:"Enter/compute DRC",to:"/lab/drc-update",action:"Open"})]})]}),_r=()=>{const[e,t]=(0,n.useState)(null),[a,s]=(0,n.useState)(""),[r,i]=(0,n.useState)(!1),l=async()=>{i(!0),s("");try{t(await ue())}catch(e){s((null===e||void 0===e?void 0:e.message)||"Failed to load")}finally{i(!1)}};(0,n.useEffect)(()=>{l()},[]);const o=e=>new Date(e).toLocaleDateString("en-IN",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),c=e=>e>100?{status:"high",color:"#10b981",text:"High Stock"}:e>50?{status:"medium",color:"#f59e0b",text:"Medium Stock"}:{status:"low",color:"#ef4444",text:"Low Stock"};return(0,x.jsxs)("div",{className:"godown-stock-container",children:[(0,x.jsxs)("div",{className:"stock-header",children:[(0,x.jsxs)("div",{className:"header-content",children:[(0,x.jsxs)("h1",{className:"stock-title",children:[(0,x.jsx)("i",{className:"fas fa-warehouse"}),"Godown Rubber Stock"]}),(0,x.jsx)("p",{className:"stock-subtitle",children:"Raw Latex Inventory Management"})]}),(0,x.jsx)("div",{className:"header-actions",children:(0,x.jsxs)("button",{className:"btn-refresh",onClick:l,disabled:r,children:[(0,x.jsx)("i",{className:"fas fa-sync-alt"}),"Refresh"]})})]}),a&&(0,x.jsxs)("div",{className:"error-banner",children:[(0,x.jsx)("i",{className:"fas fa-exclamation-triangle"}),a]}),r?(0,x.jsx)("div",{className:"loading-container",children:(0,x.jsxs)("div",{className:"loading-spinner",children:[(0,x.jsx)("i",{className:"fas fa-spinner fa-spin"}),(0,x.jsx)("span",{children:"Loading stock data..."})]})}):e?(0,x.jsxs)("div",{className:"stock-content",children:[(0,x.jsxs)("div",{className:"stock-cards",children:[(0,x.jsxs)("div",{className:"stock-card main-card",children:[(0,x.jsxs)("div",{className:"card-header",children:[(0,x.jsxs)("h3",{children:[(0,x.jsx)("i",{className:"fas fa-boxes"}),e.productName]}),(0,x.jsx)("div",{className:"stock-badge ".concat(c(e.quantityInLiters).status),children:c(e.quantityInLiters).text})]}),(0,x.jsxs)("div",{className:"card-body",children:[(0,x.jsxs)("div",{className:"quantity-display",children:[(0,x.jsxs)("div",{className:"quantity-value",children:[e.quantityInLiters,(0,x.jsx)("span",{className:"quantity-unit",children:"Liters"})]}),(0,x.jsx)("div",{className:"quantity-bar",children:(0,x.jsx)("div",{className:"quantity-fill",style:{width:"".concat(Math.min(e.quantityInLiters/200*100,100),"%"),backgroundColor:c(e.quantityInLiters).color}})})]}),(0,x.jsxs)("div",{className:"stock-details",children:[(0,x.jsxs)("div",{className:"detail-item",children:[(0,x.jsx)("i",{className:"fas fa-calendar-alt"}),(0,x.jsxs)("div",{children:[(0,x.jsx)("span",{className:"detail-label",children:"Last Updated"}),(0,x.jsx)("span",{className:"detail-value",children:o(e.lastUpdated)})]})]}),(0,x.jsxs)("div",{className:"detail-item",children:[(0,x.jsx)("i",{className:"fas fa-plus-circle"}),(0,x.jsxs)("div",{children:[(0,x.jsx)("span",{className:"detail-label",children:"Created"}),(0,x.jsx)("span",{className:"detail-value",children:o(e.createdAt)})]})]})]})]})]}),(0,x.jsxs)("div",{className:"stock-card info-card",children:[(0,x.jsxs)("h4",{children:[(0,x.jsx)("i",{className:"fas fa-info-circle"}),"Stock Information"]}),(0,x.jsxs)("div",{className:"info-grid",children:[(0,x.jsxs)("div",{className:"info-item",children:[(0,x.jsx)("span",{className:"info-label",children:"Product ID"}),(0,x.jsx)("span",{className:"info-value",children:e._id})]}),(0,x.jsxs)("div",{className:"info-item",children:[(0,x.jsx)("span",{className:"info-label",children:"Version"}),(0,x.jsxs)("span",{className:"info-value",children:["v",e.__v]})]}),(0,x.jsxs)("div",{className:"info-item",children:[(0,x.jsx)("span",{className:"info-label",children:"Status"}),(0,x.jsx)("span",{className:"info-value status-".concat(c(e.quantityInLiters).status),children:c(e.quantityInLiters).text})]})]})]})]}),(0,x.jsxs)("div",{className:"stock-actions",children:[(0,x.jsxs)("button",{className:"action-btn primary",children:[(0,x.jsx)("i",{className:"fas fa-edit"}),"Update Stock"]}),(0,x.jsxs)("button",{className:"action-btn secondary",children:[(0,x.jsx)("i",{className:"fas fa-chart-line"}),"View History"]}),(0,x.jsxs)("button",{className:"action-btn secondary",children:[(0,x.jsx)("i",{className:"fas fa-download"}),"Export Data"]})]})]}):(0,x.jsxs)("div",{className:"no-data",children:[(0,x.jsx)("i",{className:"fas fa-inbox"}),(0,x.jsx)("h3",{children:"No Stock Data Available"}),(0,x.jsx)("p",{children:"No rubber stock information found in the system."})]})]})},Lr=["D","E","F","G","H","I","J","K","L"],Tr=e=>{let{label:t,cols:a=10,statusMap:n,onClickSlot:s}=e;return(0,x.jsx)("div",{className:"hanger-block","aria-label":"Hanger block ".concat(t),children:Lr.map(e=>(0,x.jsx)("div",{className:"hanger-row",children:(0,x.jsx)("div",{className:"row-cells",children:Array.from({length:a}).map((a,r)=>{const i=r+1,l="".concat(t,"-").concat(e,"-").concat(i),o=n.get(l)||"free";return(0,x.jsx)("div",{className:"slot ".concat(o),role:"button",tabIndex:0,onClick:()=>s(t,e,i,o),"aria-label":"".concat(e).concat(i," ").concat(o),title:"".concat(e).concat(i," ").concat(o)},l)})})},"".concat(t,"-").concat(e)))})},Er=e=>{let{side:t="left"}=e;return(0,x.jsx)("div",{className:"row-labels ".concat(t),"aria-hidden":!0,children:Lr.map(e=>(0,x.jsx)("div",{className:"row-label",children:e},"".concat(t,"-").concat(e)))})},Dr=()=>{const[e,t]=(0,n.useState)([]),[a,s]=(0,n.useState)({block:"B",status:"empty_barrel"}),[r,l]=(0,n.useState)({block:"B",fromCol:1,toCol:10,status:"occupied"}),[o,c]=(0,n.useState)(!1),[d,u]=(0,n.useState)(""),h=(0,n.useMemo)(()=>{const t=new Map;for(const a of e){const e="vacant"===a.status?"free":a.status;t.set("".concat(a.block,"-").concat(a.row,"-").concat(a.col),e)}return t},[e]),p=(0,n.useMemo)(()=>e.filter(e=>"occupied"===e.status).length,[e]),f=async()=>{c(!0),u("");try{const e=await se();t(e)}catch(n){var e,a;u((null===(e=n.response)||void 0===e||null===(a=e.data)||void 0===a?void 0:a.message)||n.message)}finally{c(!1)}},m=async()=>{e&&0!==e.length||(await re(),await f())};(0,n.useEffect)(()=>{f()},[]),(0,n.useEffect)(()=>{m()},[e,m]);const g=async(t,a,n,s)=>{try{const s=e.find(e=>e.block===t&&e.row===a&&e.col===n);if(!s)return;const r=[{key:"occupied",label:"Occupied (Rubber Band)"},{key:"empty_barrel",label:"Empty Barrel"},{key:"complete_bill",label:"Complete Bill"},{key:"vacant",label:"Vacant"}],i=window.prompt("Set status for ".concat(a).concat(n,":\n+1) Occupied (Rubber Band)\n+2) Empty Barrel\n+3) Complete Bill\n+4) Vacant\nEnter 1-4"),"1"),l=parseInt(i,10);if(!l||l<1||l>4)return;const o=r[l-1].key,c="occupied"===o&&window.prompt("Rubber band label (optional):","")||"";await ie(s._id,o,c),await f()}catch(l){var r,i;alert((null===(r=l.response)||void 0===r||null===(i=r.data)||void 0===i?void 0:i.message)||l.message)}};return(0,x.jsxs)("div",{className:"hanger-page",children:[d&&(0,x.jsx)("div",{style:{color:"#fca5a5",marginBottom:12},children:d}),(0,x.jsxs)("div",{style:{display:"flex",gap:12,alignItems:"center",marginBottom:12},children:[(0,x.jsx)("button",{className:"btn",onClick:f,disabled:o,children:"Reload"}),(0,x.jsx)("button",{className:"btn",onClick:async()=>{await re(),await f()},disabled:o,children:"Seed Grid"}),(0,x.jsxs)("span",{style:{color:"#e2e8f0"},children:["Total: ",e.length," | Occupied: ",p]})]}),(0,x.jsxs)("div",{className:"hanger-wrap",children:[(0,x.jsx)(Er,{side:"left"}),(0,x.jsx)(Tr,{label:"A",cols:10,statusMap:h,onClickSlot:g}),(0,x.jsx)("div",{className:"hanger-gap"}),(0,x.jsx)(Tr,{label:"B",cols:10,statusMap:h,onClickSlot:g}),(0,x.jsx)(Er,{side:"right"})]}),(0,x.jsxs)("div",{className:"dash-card",style:{marginTop:12,padding:12,display:"flex",alignItems:"center",gap:8,flexWrap:"wrap"},children:[(0,x.jsx)("div",{style:{fontWeight:600},children:"Quick Fill"}),(0,x.jsxs)("label",{children:["Block",(0,x.jsxs)("select",{value:a.block,onChange:e=>s(t=>(0,i.A)((0,i.A)({},t),{},{block:e.target.value})),style:{marginLeft:6},children:[(0,x.jsx)("option",{value:"A",children:"A"}),(0,x.jsx)("option",{value:"B",children:"B"})]})]}),(0,x.jsxs)("label",{children:["Status",(0,x.jsxs)("select",{value:a.status,onChange:e=>s(t=>(0,i.A)((0,i.A)({},t),{},{status:e.target.value})),style:{marginLeft:6},children:[(0,x.jsx)("option",{value:"vacant",children:"Free"}),(0,x.jsx)("option",{value:"empty_barrel",children:"Empty Barrel"}),(0,x.jsx)("option",{value:"occupied",children:"Rubber Band"}),(0,x.jsx)("option",{value:"complete_bill",children:"Complete Bill"})]})]}),(0,x.jsx)("button",{className:"btn",onClick:async()=>{try{const t=e.filter(e=>e.block===(a.block||"B")).map(e=>e._id);if(!t.length)return;if(!window.confirm("Set ".concat(t.length," slots in Block ").concat(a.block," to ").concat(a.status,"?")))return;await le(t,a.status),await f()}catch(s){var t,n;alert((null===(t=s.response)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.message)||s.message)}},children:"Apply"})]}),(0,x.jsxs)("div",{className:"dash-card",style:{marginTop:12,padding:12,display:"flex",alignItems:"center",gap:8,flexWrap:"wrap"},children:[(0,x.jsx)("div",{style:{fontWeight:600},children:"Bulk by Columns"}),(0,x.jsxs)("label",{children:["Block",(0,x.jsxs)("select",{value:r.block,onChange:e=>l(t=>(0,i.A)((0,i.A)({},t),{},{block:e.target.value})),style:{marginLeft:6},children:[(0,x.jsx)("option",{value:"A",children:"A"}),(0,x.jsx)("option",{value:"B",children:"B"})]})]}),(0,x.jsxs)("label",{children:["From Col",(0,x.jsx)("input",{type:"number",min:1,max:10,value:r.fromCol,onChange:e=>l(t=>(0,i.A)((0,i.A)({},t),{},{fromCol:e.target.value})),style:{width:80,marginLeft:6}})]}),(0,x.jsxs)("label",{children:["To Col",(0,x.jsx)("input",{type:"number",min:1,max:10,value:r.toCol,onChange:e=>l(t=>(0,i.A)((0,i.A)({},t),{},{toCol:e.target.value})),style:{width:80,marginLeft:6}})]}),(0,x.jsxs)("label",{children:["Status",(0,x.jsxs)("select",{value:r.status,onChange:e=>l(t=>(0,i.A)((0,i.A)({},t),{},{status:e.target.value})),style:{marginLeft:6},children:[(0,x.jsx)("option",{value:"vacant",children:"Free"}),(0,x.jsx)("option",{value:"empty_barrel",children:"Empty Barrel"}),(0,x.jsx)("option",{value:"occupied",children:"Rubber Band"}),(0,x.jsx)("option",{value:"complete_bill",children:"Complete Bill"})]})]}),(0,x.jsx)("button",{className:"btn",onClick:async()=>{try{const t=r.block||"B",a=Math.max(1,Number(r.fromCol)||1),n=Math.max(a,Number(r.toCol)||a),s=e.filter(e=>e.block===t&&e.col>=a&&e.col<=n).map(e=>e._id);if(!s.length)return;if(!window.confirm("Set ".concat(s.length," slots in Block ").concat(t,", Col ").concat(a,"-").concat(n," to ").concat(r.status,"?")))return;await le(s,r.status),await f()}catch(n){var t,a;alert((null===(t=n.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.message)||n.message)}},children:"Apply Range"})]}),(0,x.jsxs)("div",{className:"legend",children:[(0,x.jsxs)("div",{className:"legend-item",children:[(0,x.jsx)("span",{className:"slot free"})," Free"]}),(0,x.jsxs)("div",{className:"legend-item",children:[(0,x.jsx)("span",{className:"slot occupied"})," Rubber Band"]}),(0,x.jsxs)("div",{className:"legend-item",children:[(0,x.jsx)("span",{className:"slot empty_barrel"})," Empty Barrel"]}),(0,x.jsxs)("div",{className:"legend-item",children:[(0,x.jsx)("span",{className:"slot complete_bill"})," Complete Bill"]})]})]})},Pr=()=>{var e,t;const[a,s]=(0,n.useState)(null),[r,i]=(0,n.useState)([]),[l,o]=(0,n.useState)(""),[c,d]=(0,n.useState)(!1),u=async()=>{d(!0),o("");try{const[e,t]=await Promise.all([ee("".concat(X,"/api/stock/summary")),ue()]);s((null===e||void 0===e?void 0:e.data)||e),i(Array.isArray(t)?t:(null===t||void 0===t?void 0:t.items)||[])}catch(e){o((null===e||void 0===e?void 0:e.message)||"Failed to load")}finally{d(!1)}};return(0,n.useEffect)(()=>{u()},[]),(0,x.jsxs)("div",{style:{padding:16},children:[(0,x.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:12},children:[(0,x.jsx)("h2",{style:{margin:0},children:"Yard Stock"}),(0,x.jsx)("button",{className:"btn",onClick:u,disabled:c,children:c?"Refreshing...":"Refresh"})]}),l&&(0,x.jsx)("div",{style:{color:"tomato",marginTop:8},children:l}),a&&(0,x.jsx)("div",{className:"dash-card",style:{marginTop:12,padding:12},children:(0,x.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(220px, 1fr))",gap:12},children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("div",{style:{fontSize:12,color:"#9aa"},children:"Raw Latex (Liters)"}),(0,x.jsx)("div",{style:{fontSize:26,fontWeight:700,color:"var(--text-strong)"},children:null!==(e=a.latexLiters)&&void 0!==e?e:"\u2014"})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("div",{style:{fontSize:12,color:"#9aa"},children:"Finished Goods Units"}),(0,x.jsx)("div",{style:{fontSize:26,fontWeight:700,color:"var(--text-strong)"},children:null!==(t=a.rubberBandUnits)&&void 0!==t?t:"\u2014"})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("div",{style:{fontSize:12,color:"#9aa"},children:"Updated"}),(0,x.jsx)("div",{children:nt(a.updatedAt)})]})]})}),(0,x.jsx)("div",{style:{marginTop:12,overflowX:"auto"},children:(0,x.jsxs)("table",{className:"dashboard-table",style:{minWidth:640},children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{children:"Name"}),(0,x.jsx)("th",{children:"Quantity (L)"}),(0,x.jsx)("th",{children:"Updated At"})]})}),(0,x.jsxs)("tbody",{children:[r.map(e=>{var t,a;return(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{children:e.productName||e.name}),(0,x.jsx)("td",{children:null!==(t=null!==(a=e.quantityInLiters)&&void 0!==a?a:e.qty)&&void 0!==t?t:"-"}),(0,x.jsx)("td",{children:st(e.updatedAt)})]},e._id||e.id||e.productName)}),0===r.length&&(0,x.jsx)("tr",{children:(0,x.jsx)("td",{colSpan:3,style:{textAlign:"center",color:"#9aa"},children:"No items"})})]})]})})]})},Rr=()=>{var e,t;const[a,s]=(0,n.useState)([]),[r,i]=(0,n.useState)(!1),[l,o]=(0,n.useState)(""),[c,d]=(0,n.useState)(""),[u,h]=(0,n.useState)({low:[],expiring:[]}),p=(0,n.useMemo)(()=>a.filter(e=>!c||e.name.toLowerCase().includes(c.toLowerCase())),[a,c]),f=async()=>{i(!0),o("");try{s(await he()),h(await pe())}catch(e){o((null===e||void 0===e?void 0:e.message)||"Failed to load")}finally{i(!1)}};return(0,n.useEffect)(()=>{f()},[]),(0,x.jsxs)("div",{children:[(0,x.jsx)("h2",{children:"Chemical Stock History"}),(0,x.jsxs)("div",{style:{display:"flex",gap:12,marginBottom:8},children:[(0,x.jsx)("input",{placeholder:"Filter by name",value:c,onChange:e=>d(e.target.value)}),(0,x.jsx)("button",{onClick:()=>function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"chemicals.csv";const a=[["name","unit","onHand","lotNo","quantity","unitCost","receivedAt","expiresAt"].join(",")].concat(e.flatMap(e=>{var t;return(null!==(t=e.lots)&&void 0!==t&&t.length?e.lots:[{lotNo:"",quantity:"",unitCost:"",receivedAt:"",expiresAt:""}]).map(t=>{var a,n,s;return[e.name,e.unit||"",null!==(a=e.onHand)&&void 0!==a?a:"",t.lotNo||"",null!==(n=t.quantity)&&void 0!==n?n:"",null!==(s=t.unitCost)&&void 0!==s?s:"",t.receivedAt||"",t.expiresAt||""].join(",")})})).join("\n"),n=new Blob([a],{type:"text/csv"}),s=URL.createObjectURL(n),r=document.createElement("a");r.href=s,r.download=t,r.click(),URL.revokeObjectURL(s)}(p),children:"Export CSV"}),(0,x.jsx)("button",{onClick:f,disabled:r,children:"Refresh"})]}),l&&(0,x.jsx)("div",{style:{color:"tomato"},children:l}),(0,x.jsxs)("div",{style:{display:"grid",gap:12},children:[(null===u||void 0===u||null===(e=u.low)||void 0===e?void 0:e.length)>0&&(0,x.jsxs)("div",{role:"alert",style:{background:"#FEF3C7",border:"1px solid #FDE68A",color:"#111827",padding:10,borderRadius:6},children:[(0,x.jsx)("strong",{style:{color:"#92400E"},children:"Low stock:"})," ",u.low.map(e=>"".concat(e.name," (").concat(e.onHand,")")).join(", ")]}),(null===u||void 0===u||null===(t=u.expiring)||void 0===t?void 0:t.length)>0&&(0,x.jsxs)("div",{role:"alert",style:{background:"#FFE4E6",border:"1px solid #FDA4AF",color:"#111827",padding:10,borderRadius:6},children:[(0,x.jsx)("strong",{style:{color:"#9D174D"},children:"Expiring soon:"})," ",u.expiring.map(e=>"".concat(e.name," lot ").concat(e.lotNo)).join(", ")]})]}),r?"Loading...":(0,x.jsx)("div",{style:{overflowX:"auto",marginTop:12},children:(0,x.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse"},children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{children:"Name"}),(0,x.jsx)("th",{children:"Unit"}),(0,x.jsx)("th",{children:"On Hand"}),(0,x.jsx)("th",{children:"Lots"})]})}),(0,x.jsxs)("tbody",{children:[p.map(e=>{var t;return(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{children:e.name}),(0,x.jsx)("td",{children:e.unit}),(0,x.jsx)("td",{children:e.onHand}),(0,x.jsx)("td",{children:null!==(t=e.lots)&&void 0!==t&&t.length?e.lots.map(e=>(0,x.jsxs)("div",{style:{display:"flex",gap:8},children:[(0,x.jsxs)("span",{children:["#",e.lotNo]}),(0,x.jsxs)("span",{children:["Qty: ",e.quantity]}),(0,x.jsxs)("span",{children:["Unit Cost: ",e.unitCost]}),(0,x.jsxs)("span",{children:["Recv: ",e.receivedAt?new Date(e.receivedAt).toLocaleDateString():"-"]}),(0,x.jsxs)("span",{children:["Exp: ",e.expiresAt?new Date(e.expiresAt).toLocaleDateString():"-"]})]},e.lotNo)):"\u2014"})]},e._id)}),!p.length&&(0,x.jsx)("tr",{children:(0,x.jsx)("td",{colSpan:4,style:{textAlign:"center"},children:"No chemicals"})})]})]})})]})},Ir=e=>new Date(e).toISOString().slice(0,10),Br=e=>{const t=new Date(e),a=t.getDay();return t.setDate(t.getDate()-a),t.setHours(0,0,0,0),t},Fr=()=>{const e=(0,n.useMemo)(()=>new Date,[]),[t,a]=(0,n.useState)(Ir(Br(e))),s=(0,n.useMemo)(()=>{const t=Br(e);return Ir(t)},[e]),[r,l]=(0,n.useState)({morningStart:"09:00",morningEnd:"17:00",eveningStart:"13:00",eveningEnd:"21:00"}),[o,c]=(0,n.useState)([]),[d,u]=(0,n.useState)([]),[h,p]=(0,n.useState)(!1),[f,m]=(0,n.useState)(""),g=async()=>{p(!0),m("");try{const e=await function(){let{from:e,to:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return ee("".concat(X,"/api/schedules"),{from:e,to:t})}({});u(Array.isArray(e)?e:[])}catch(a){var e,t;m((null===a||void 0===a||null===(e=a.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message)||(null===a||void 0===a?void 0:a.message)||"Failed")}finally{p(!1)}};(0,n.useEffect)(()=>{g()},[]),(0,n.useEffect)(()=>{(async()=>{m("");try{const e=await ne(t);e?(l({morningStart:e.morningStart||"09:00",morningEnd:e.morningEnd||"17:00",eveningStart:e.eveningStart||"13:00",eveningEnd:e.eveningEnd||"21:00"}),c(Array.isArray(e.assignments)?e.assignments.map(e=>({staff:e.staff,shiftType:e.shiftType})):[])):c([])}catch(e){c([])}})()},[t]);const v=(e,t,a)=>c(n=>n.map((n,s)=>s===e?(0,i.A)((0,i.A)({},n),{},{[t]:a}):n));return(0,x.jsxs)("div",{children:[(0,x.jsx)("h2",{children:"Worker Schedule"}),(0,x.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),m("");try{await(e=>{const t=["weekStart","morningStart","morningEnd","eveningStart","eveningEnd"];for(const a of t)if(null===e||void 0===e||!e[a])throw new Error("".concat(a," is required"));return te("".concat(X,"/api/schedules"),e)})((0,i.A)((0,i.A)({weekStart:t},r),{},{assignments:o})),await g()}catch(s){var a,n;m((null===s||void 0===s||null===(a=s.response)||void 0===a||null===(n=a.data)||void 0===n?void 0:n.message)||(null===s||void 0===s?void 0:s.message)||"Failed to save")}},style:{display:"grid",gap:12,gridTemplateColumns:"repeat(auto-fit, minmax(220px, 1fr))"},children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{children:"Week Start (Sunday)"}),(0,x.jsx)("br",{}),(0,x.jsx)("input",{type:"date",value:t,min:s,onChange:e=>a(e.target.value),required:!0}),(0,x.jsx)("div",{style:{fontSize:"12px",color:"#666",marginTop:"4px"},children:"Only current week and future weeks are allowed"})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{children:"Morning Start"}),(0,x.jsx)("br",{}),(0,x.jsx)("input",{type:"time",value:r.morningStart,onChange:e=>l(t=>(0,i.A)((0,i.A)({},t),{},{morningStart:e.target.value})),required:!0})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{children:"Morning End"}),(0,x.jsx)("br",{}),(0,x.jsx)("input",{type:"time",value:r.morningEnd,onChange:e=>l(t=>(0,i.A)((0,i.A)({},t),{},{morningEnd:e.target.value})),required:!0})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{children:"Evening Start"}),(0,x.jsx)("br",{}),(0,x.jsx)("input",{type:"time",value:r.eveningStart,onChange:e=>l(t=>(0,i.A)((0,i.A)({},t),{},{eveningStart:e.target.value})),required:!0})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{children:"Evening End"}),(0,x.jsx)("br",{}),(0,x.jsx)("input",{type:"time",value:r.eveningEnd,onChange:e=>l(t=>(0,i.A)((0,i.A)({},t),{},{eveningEnd:e.target.value})),required:!0})]}),(0,x.jsx)("div",{style:{alignSelf:"end"},children:(0,x.jsx)("button",{type:"submit",children:"Save Schedule"})})]}),(0,x.jsxs)("div",{style:{marginTop:16},children:[(0,x.jsx)("h3",{children:"Assignments"}),(0,x.jsx)("button",{type:"button",onClick:()=>c(e=>[...e,{staff:"",shiftType:"Morning"}]),children:"Add"}),(0,x.jsxs)("div",{style:{marginTop:8},children:[o.map((e,t)=>(0,x.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:6},children:[(0,x.jsx)("input",{placeholder:"Staff ID",value:e.staff,onChange:e=>v(t,"staff",e.target.value)}),(0,x.jsxs)("select",{value:e.shiftType,onChange:e=>v(t,"shiftType",e.target.value),children:[(0,x.jsx)("option",{children:"Morning"}),(0,x.jsx)("option",{children:"Evening"})]}),(0,x.jsx)("button",{onClick:()=>(e=>c(t=>t.filter((t,a)=>a!==e)))(t),type:"button",children:"Remove"})]},t)),!o.length&&(0,x.jsx)("div",{style:{color:"#888"},children:"No assignments"})]}),(0,x.jsx)("button",{type:"button",onClick:async()=>{try{const e=await ne(t);if(null===e||void 0===e||!e._id)throw new Error("Create the schedule first");await((e,t)=>{if(!e)throw new Error("schedule id is required");return ae("".concat(X,"/api/schedules/").concat(e,"/assignments"),{assignments:t})})(e._id,o),await g()}catch(n){var e,a;m((null===n||void 0===n||null===(e=n.response)||void 0===e||null===(a=e.data)||void 0===a?void 0:a.message)||(null===n||void 0===n?void 0:n.message)||"Failed to update assignments")}},children:"Save Assignments"})]}),f&&(0,x.jsx)("div",{style:{color:"tomato",marginTop:12},children:f}),(0,x.jsxs)("div",{style:{marginTop:24},children:[(0,x.jsx)("h3",{children:"Recent Weeks"}),h?"Loading...":(0,x.jsx)("ul",{children:d.map(e=>{var t;return(0,x.jsxs)("li",{children:[Ir(e.weekStart)," \u2014 M: ",e.morningStart,"-",e.morningEnd,", E: ",e.eveningStart,"-",e.eveningEnd," \u2014 Assignments: ",(null===(t=e.assignments)||void 0===t?void 0:t.length)||0]},e._id)})})]})]})},Or="http://localhost:5000",qr=()=>{try{const e=localStorage.getItem("token");return e?{Authorization:"Bearer ".concat(e)}:{}}catch(e){return{}}},zr=e=>new Promise(t=>setTimeout(t,e)),Mr=async(e,t)=>{let a=0,n=500;for(;;)try{return(await m.A.get(e,{withCredentials:!0,headers:qr(),params:t})).data}catch(r){var s;if(429===(null===r||void 0===r||null===(s=r.response)||void 0===s?void 0:s.status)&&a<3){await zr(n),a+=1,n*=2;continue}throw r}},Ur=(e,t)=>m.A.post(e,t,{withCredentials:!0,headers:(0,i.A)((0,i.A)({},qr()),{},{"Content-Type":"application/json"})}).then(e=>e.data),Wr=()=>{const[e,t]=(0,n.useState)({email:"",phone:"",name:"",address:"",staffId:"",role:"field"}),[a,s]=(0,n.useState)(!1),[r,l]=(0,n.useState)([]),[o,c]=(0,n.useState)(""),[d,u]=(0,n.useState)(""),[h,p]=(0,n.useState)([]),[f,g]=(0,n.useState)(!1),[v,y]=(0,n.useState)({}),[b,j]=(0,n.useState)(!1),[w,N]=(0,n.useState)(""),[S,k]=(0,n.useState)("all"),[A,C]=(0,n.useState)("all"),[_,L]=(0,n.useState)(!1),T=e=>String(e||"").replace(/\s+/g,""),E=e=>{const t=String(e||"").replace(/\s+/g,"");return t.startsWith("+")?"+"+t.slice(1).replace(/\D+/g,""):t.replace(/\D+/g,"")},D=async()=>{s(!0),c(""),u("");try{const e=await function(){let{page:e=1,limit:t=50}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Mr("".concat(Or,"/api/staff-invite/invites"),{page:e,limit:t})}({limit:200}),t=Array.isArray(e)?e:Array.isArray(null===e||void 0===e?void 0:e.rows)?e.rows:Array.isArray(null===e||void 0===e?void 0:e.records)?e.records:[];l(t);const a=await function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Mr("".concat(Or,"/api/user-management/staff"),(0,i.A)({},e))}({limit:200}),n=(null===a||void 0===a?void 0:a.users)||(null===a||void 0===a?void 0:a.records)||(null===a||void 0===a?void 0:a.data)||[];p(n)}catch(a){var e,t;c((null===a||void 0===a||null===(e=a.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message)||(null===a||void 0===a?void 0:a.message)||"Failed to load staff")}finally{s(!1)}},P=async e=>{c(""),u("");try{await(n=e,Ur("".concat(Or,"/api/staff-invite/invites/").concat(n,"/approve"),{})),u("Staff approved."),await D()}catch(s){var t,a;c((null===s||void 0===s||null===(t=s.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.message)||(null===s||void 0===s?void 0:s.message)||"Failed to approve")}var n},R=async(e,t)=>{c(""),u("");try{await(s=e,r=!t,Ur("".concat(Or,"/api/staff-invite/").concat(s,"/active"),{active:!!r})),u(t?"Staff deactivated":"Staff activated"),await D()}catch(i){var a,n;c((null===i||void 0===i||null===(a=i.response)||void 0===a||null===(n=a.data)||void 0===n?void 0:n.message)||(null===i||void 0===i?void 0:i.message)||"Failed to update status")}var s,r},I=e=>{const t=new De.Ay;let a=20;t.setFontSize(18),t.setTextColor(11,110,79),t.text("Holy Family Polymers",20,a),a+=10,t.setFontSize(14),t.setTextColor(0,0,0),t.text("Staff Registration Details",20,a),a+=15,t.setFontSize(14),t.setTextColor(11,110,79),t.text("Personal Information",20,a),a+=8,t.setFontSize(11),t.setTextColor(0,0,0);["Full Name: ".concat(e.name||"Not provided"),"Email Address: ".concat(e.email||"Not provided"),"Phone Number: ".concat(e.phone||"Not provided"),"Address: ".concat(e.address||"Not provided"),"Staff ID: ".concat(e.staffId||"Not assigned"),"Role: ".concat((e.role||"field_staff").replace("_"," ").toUpperCase())].forEach(e=>{t.text(e,25,a),a+=6}),a+=5,t.setFontSize(14),t.setTextColor(11,110,79),t.text("Registration Status",20,a),a+=8,t.setFontSize(11),t.setTextColor(0,0,0);["Current Status: ".concat(e.status||"Unknown"),"Invitation Sent: ".concat(e.createdAt?new Date(e.createdAt).toLocaleString():"Not available"),"Registration Completed: ".concat(e.verifiedAt?new Date(e.verifiedAt).toLocaleString():"Not completed"),"Approved: ".concat(e.approvedAt?new Date(e.approvedAt).toLocaleString():"Not approved")].forEach(e=>{t.text(e,25,a),a+=6}),a+=10,e.documents&&e.documents.length>0&&(t.setFontSize(14),t.setTextColor(11,110,79),t.text("Uploaded Documents",20,a),a+=8,t.setFontSize(11),t.setTextColor(0,0,0),e.documents.forEach((e,t)=>{e.text("".concat(t+1,". ").concat(e.type||"Document",": ").concat(e.filename||"Unknown"),25,a),a+=6}),a+=5),a+=10,t.setFontSize(10),t.setTextColor(128,128,128),t.text("Generated on: ".concat((new Date).toLocaleString()),20,a),t.text("Holy Family Polymers - Staff Management System",20,a+5),t.save("staff-".concat(e.staffId||e.name||"details",".pdf"))};(0,n.useEffect)(()=>{D()},[]);const B=()=>{const t={};var a;e.email.trim()?(a=e.email,/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(a)?b&&(t.email="Email already used"):t.email="Please enter a valid email address"):t.email="Email is required",e.phone.trim()?(e=>{const t=String(e||"").trim().replace(/[\s\-()]/g,""),a=t.startsWith("+")?t.slice(1):t;return!!/^\d+$/.test(a)&&!(a.length<10||a.length>15)&&"0"!==a[0]})(e.phone)||(t.phone="Please enter a valid phone number (e.g., +1234567890 or 1234567890)"):t.phone="Phone number is required",e.name.trim()?e.name.trim().length<2&&(t.name="Name must be at least 2 characters long"):t.name="Name is required",e.address.trim()?e.address.trim().length<10&&(t.address="Address must be at least 10 characters long"):t.address="Address is required";const n=T((e.staffId||"").toUpperCase().trim()),s="field"===e.role,r="lab"===e.role,i="delivery"===e.role,l="accountant"===e.role,o="manager"===e.role;return n?!s&&!r||/^HFP\d{2}$/.test(n)?l&&!/^ACC\d{2}$/.test(n)?t.staffId="For Accountant, use format ACC01 (5 characters)":o&&!/^MGR\d{2}$/.test(n)?t.staffId="For Manager, use format MGR01 (5 characters)":i&&!/^[A-Z]{3}-\d{4}-\d{3}$/.test(n)&&(t.staffId="For Delivery Staff, use format STF-2025-005"):t.staffId="For Field/Lab Staff, use format HFP01 (5 characters)":t.staffId="Staff ID is required",(e.staffId||"").match(/\s/)&&(t.staffId="Staff ID must not contain spaces"),["field","lab","delivery","accountant","manager"].includes(e.role)||(t.role="Select a valid role"),y(t),0===Object.keys(t).length},F={total:r.length,field:r.filter(e=>(e.role||"").includes("field")).length,lab:r.filter(e=>(e.role||"").includes("lab")).length,delivery:r.filter(e=>(e.role||"").includes("delivery")).length,accountant:r.filter(e=>(e.role||"").includes("accountant")).length,manager:r.filter(e=>(e.role||"").includes("manager")).length,active:r.filter(e=>"active"===(e.status||"")).length,pending:r.filter(e=>"verified"===(e.status||"")).length,approved:r.filter(e=>"approved"===(e.status||"")).length},O=(()=>{let e=[...r];if(w){const t=w.toLowerCase();e=e.filter(e=>(e.name||"").toLowerCase().includes(t)||(e.email||"").toLowerCase().includes(t)||(e.staffId||"").toLowerCase().includes(t)||(e.phone||"").includes(t))}return"all"!==S&&(e=e.filter(e=>(e.role||"field_staff").toLowerCase().includes(S))),"all"!==A&&(e=e.filter(e=>(e.status||"sent")===A)),e})();return(0,x.jsxs)("div",{style:{padding:16},children:[(0,x.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:20},children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("h2",{children:"Staff Management"}),(0,x.jsx)("p",{style:{margin:"8px 0 0 0",color:"#64748b"},children:"View and manage all staff with their IDs"})]}),(0,x.jsxs)("div",{style:{display:"flex",gap:12},children:[(0,x.jsx)("a",{href:"/admin/staff-records",className:"btn btn-outline",style:{textDecoration:"none"},children:"Staff Records"}),(0,x.jsx)("button",{className:"btn btn-primary",onClick:D,disabled:a,children:a?"Loading...":"Refresh"})]})]}),o&&(0,x.jsx)("div",{style:{color:"tomato",marginTop:8},children:o}),d&&(0,x.jsx)("div",{style:{color:"limegreen",marginTop:8},children:d}),(0,x.jsxs)("div",{className:"dash-card",style:{padding:20,marginBottom:20},children:[(0,x.jsx)("h3",{style:{margin:"0 0 16px 0",color:"#1e293b"},children:"Staff Overview"}),(0,x.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(150px, 1fr))",gap:16},children:[(0,x.jsxs)("div",{style:{textAlign:"center",padding:16,backgroundColor:"#f8fafc",borderRadius:8},children:[(0,x.jsx)("div",{style:{fontSize:14,color:"#64748b",marginBottom:4},children:"Total Staff"}),(0,x.jsx)("div",{style:{fontSize:24,fontWeight:700,color:"#1e293b"},children:F.total})]}),(0,x.jsxs)("div",{style:{textAlign:"center",padding:16,backgroundColor:"#f0f9ff",borderRadius:8},children:[(0,x.jsx)("div",{style:{fontSize:14,color:"#64748b",marginBottom:4},children:"Field Staff"}),(0,x.jsx)("div",{style:{fontSize:24,fontWeight:700,color:"#3b82f6"},children:F.field})]}),(0,x.jsxs)("div",{style:{textAlign:"center",padding:16,backgroundColor:"#f0fdf4",borderRadius:8},children:[(0,x.jsx)("div",{style:{fontSize:14,color:"#64748b",marginBottom:4},children:"Lab Staff"}),(0,x.jsx)("div",{style:{fontSize:24,fontWeight:700,color:"#16a34a"},children:F.lab})]}),(0,x.jsxs)("div",{style:{textAlign:"center",padding:16,backgroundColor:"#fef3c7",borderRadius:8},children:[(0,x.jsx)("div",{style:{fontSize:14,color:"#64748b",marginBottom:4},children:"Delivery Staff"}),(0,x.jsx)("div",{style:{fontSize:24,fontWeight:700,color:"#d97706"},children:F.delivery})]}),(0,x.jsxs)("div",{style:{textAlign:"center",padding:16,backgroundColor:"#f0f9ff",borderRadius:8},children:[(0,x.jsx)("div",{style:{fontSize:14,color:"#64748b",marginBottom:4},children:"Accountant"}),(0,x.jsx)("div",{style:{fontSize:24,fontWeight:700,color:"#3b82f6"},children:F.accountant})]}),(0,x.jsxs)("div",{style:{textAlign:"center",padding:16,backgroundColor:"#fef3c7",borderRadius:8},children:[(0,x.jsx)("div",{style:{fontSize:14,color:"#64748b",marginBottom:4},children:"Manager"}),(0,x.jsx)("div",{style:{fontSize:24,fontWeight:700,color:"#d97706"},children:F.manager})]}),(0,x.jsxs)("div",{style:{textAlign:"center",padding:16,backgroundColor:"#f0fdf4",borderRadius:8},children:[(0,x.jsx)("div",{style:{fontSize:14,color:"#64748b",marginBottom:4},children:"Active"}),(0,x.jsx)("div",{style:{fontSize:24,fontWeight:700,color:"#16a34a"},children:F.active})]}),(0,x.jsxs)("div",{style:{textAlign:"center",padding:16,backgroundColor:"#fef2f2",borderRadius:8},children:[(0,x.jsx)("div",{style:{fontSize:14,color:"#64748b",marginBottom:4},children:"Pending"}),(0,x.jsx)("div",{style:{fontSize:24,fontWeight:700,color:"#dc2626"},children:F.pending})]}),(0,x.jsxs)("div",{style:{textAlign:"center",padding:16,backgroundColor:"#f0f9ff",borderRadius:8},children:[(0,x.jsx)("div",{style:{fontSize:14,color:"#64748b",marginBottom:4},children:"Approved"}),(0,x.jsx)("div",{style:{fontSize:24,fontWeight:700,color:"#3b82f6"},children:F.approved})]})]})]}),(0,x.jsxs)("div",{className:"dash-card",style:{padding:20,marginBottom:20},children:[(0,x.jsx)("h3",{style:{margin:"0 0 16px 0",color:"#1e293b"},children:"Filter & Search Staff"}),(0,x.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:16},children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{style:{display:"block",marginBottom:6,fontWeight:500,color:"#374151"},children:"Search Staff"}),(0,x.jsx)("input",{type:"text",value:w,onChange:e=>N(e.target.value),placeholder:"Search by name, email, staff ID, or phone...",style:{width:"100%",padding:"8px 12px",borderRadius:6,border:"1px solid #d1d5db"}})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{style:{display:"block",marginBottom:6,fontWeight:500,color:"#374151"},children:"Filter by Role"}),(0,x.jsxs)("select",{value:S,onChange:e=>k(e.target.value),style:{width:"100%",padding:"8px 12px",borderRadius:6,border:"1px solid #d1d5db"},children:[(0,x.jsx)("option",{value:"all",children:"All Roles"}),(0,x.jsx)("option",{value:"field",children:"Field Staff"}),(0,x.jsx)("option",{value:"lab",children:"Lab Staff"}),(0,x.jsx)("option",{value:"delivery",children:"Delivery Staff"}),(0,x.jsx)("option",{value:"accountant",children:"Accountant"}),(0,x.jsx)("option",{value:"manager",children:"Manager"})]})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{style:{display:"block",marginBottom:6,fontWeight:500,color:"#374151"},children:"Filter by Status"}),(0,x.jsxs)("select",{value:A,onChange:e=>C(e.target.value),style:{width:"100%",padding:"8px 12px",borderRadius:6,border:"1px solid #d1d5db"},children:[(0,x.jsx)("option",{value:"all",children:"All Status"}),(0,x.jsx)("option",{value:"sent",children:"Pending Invite"}),(0,x.jsx)("option",{value:"verified",children:"Waiting Approval"}),(0,x.jsx)("option",{value:"approved",children:"Approved"}),(0,x.jsx)("option",{value:"active",children:"Active"}),(0,x.jsx)("option",{value:"suspended",children:"Deactivated"})]})]}),(0,x.jsx)("div",{style:{display:"flex",alignItems:"end"},children:(0,x.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:8,cursor:"pointer"},children:[(0,x.jsx)("input",{type:"checkbox",checked:_,onChange:e=>L(e.target.checked)}),(0,x.jsx)("span",{style:{fontSize:14,color:"#374151"},children:"Show Staff IDs Only"})]})})]}),(0,x.jsx)("div",{style:{marginTop:16,padding:12,backgroundColor:"#f8fafc",borderRadius:6},children:(0,x.jsxs)("div",{style:{fontSize:14,color:"#64748b"},children:["Showing ",O.length," of ",r.length," staff members",w&&' matching "'.concat(w,'"'),"all"!==S&&" in ".concat(S," role"),"all"!==A&&" with ".concat(A," status")]})})]}),(0,x.jsxs)("div",{className:"dash-card",style:{padding:20,marginBottom:20},children:[(0,x.jsx)("h3",{style:{margin:"0 0 16px 0",color:"#1e293b"},children:"Staff ID Summary"}),(0,x.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(300px, 1fr))",gap:16},children:["field","lab","delivery","accountant","manager"].map(e=>{const t=r.filter(t=>(t.role||"").includes(e)),a=t.filter(e=>e.staffId),n=t.filter(e=>!e.staffId);return(0,x.jsxs)("div",{style:{padding:16,backgroundColor:"#f8fafc",borderRadius:8,border:"1px solid #e2e8f0"},children:[(0,x.jsxs)("h4",{style:{margin:"0 0 12px 0",color:"#1e293b",textTransform:"capitalize"},children:["field"===e?"Field Staff":"lab"===e?"Lab Staff":"delivery"===e?"Delivery Staff":"accountant"===e?"Accountant":"Manager"," (",t.length,")"]}),a.length>0&&(0,x.jsxs)("div",{style:{marginBottom:12},children:[(0,x.jsxs)("div",{style:{fontSize:12,color:"#64748b",marginBottom:6},children:["\u2705 With Staff IDs (",a.length,")"]}),(0,x.jsxs)("div",{style:{display:"flex",flexWrap:"wrap",gap:4},children:[a.slice(0,5).map(e=>(0,x.jsx)("span",{style:{fontFamily:"monospace",fontSize:11,padding:"2px 6px",backgroundColor:"#dcfce7",color:"#16a34a",borderRadius:4,border:"1px solid #16a34a"},children:e.staffId},e._id)),a.length>5&&(0,x.jsxs)("span",{style:{fontSize:11,color:"#64748b"},children:["+",a.length-5," more"]})]})]}),n.length>0&&(0,x.jsxs)("div",{children:[(0,x.jsxs)("div",{style:{fontSize:12,color:"#64748b",marginBottom:6},children:["\u274c Missing Staff IDs (",n.length,")"]}),(0,x.jsxs)("div",{style:{fontSize:11,color:"#dc2626"},children:[n.slice(0,3).map(e=>e.name).join(", "),n.length>3&&" +".concat(n.length-3," more")]})]})]},e)})})]}),(0,x.jsxs)("form",{onSubmit:e=>{e.preventDefault(),c(""),y({}),B()&&g(!0)},style:{display:"grid",gap:16,gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",marginTop:12},children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{children:"Name *"}),(0,x.jsx)("br",{}),(0,x.jsx)("input",{type:"text",value:e.name,onChange:a=>t((0,i.A)((0,i.A)({},e),{},{name:a.target.value})),placeholder:"Full Name",required:!0,style:{borderColor:v.name?"#dc3545":""}}),v.name&&(0,x.jsx)("div",{style:{color:"#dc3545",fontSize:"12px",marginTop:"4px"},children:v.name})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{children:"Role *"}),(0,x.jsx)("br",{}),(0,x.jsxs)("select",{value:e.role,onChange:a=>t((0,i.A)((0,i.A)({},e),{},{role:a.target.value})),required:!0,style:{width:"100%",borderColor:v.role?"#dc3545":""},children:[(0,x.jsx)("option",{value:"field",children:"Field Staff"}),(0,x.jsx)("option",{value:"lab",children:"Lab Staff"}),(0,x.jsx)("option",{value:"delivery",children:"Delivery Staff"}),(0,x.jsx)("option",{value:"accountant",children:"Accountant"}),(0,x.jsx)("option",{value:"manager",children:"Manager"})]}),v.role&&(0,x.jsx)("div",{style:{color:"#dc3545",fontSize:"12px",marginTop:"4px"},children:v.role})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{children:"delivery"===e.role?"Staff ID (e.g., STF-2025-005) *":"accountant"===e.role?"Staff ID (e.g., ACC01) *":"manager"===e.role?"Staff ID (e.g., MGR01) *":"Staff ID (HFP01) *"}),(0,x.jsx)("br",{}),(0,x.jsxs)("div",{style:{display:"flex",gap:8},children:[(0,x.jsx)("input",{type:"text",value:e.staffId,onChange:a=>t((0,i.A)((0,i.A)({},e),{},{staffId:T(a.target.value.toUpperCase())})),placeholder:"delivery"===e.role?"STF-2025-005":"accountant"===e.role?"ACC01":"manager"===e.role?"MGR01":"HFP01",required:!0,maxLength:"delivery"===e.role?13:5,style:{flex:1,borderColor:v.staffId?"#dc3545":""},onKeyDown:e=>{" "===e.key&&e.preventDefault()}}),"delivery"!==e.role&&(0,x.jsx)("button",{type:"button",className:"btn btn-outline",onClick:()=>{const a="accountant"===e.role?"ACC":"manager"===e.role?"MGR":"HFP",n=[...r,...h];let s=0;n.forEach(e=>{const t=(e.staffId||e.staff_id||"").toString().toUpperCase(),n=t.startsWith(a)?t.slice(a.length).match(/^(\d{2})$/):null;if(n){const e=parseInt(n[1],10);Number.isNaN(e)||(s=Math.max(s,e))}});const l=Math.min(99,s+1),o="".concat(a).concat(String(l).padStart(2,"0"));t(e=>(0,i.A)((0,i.A)({},e),{},{staffId:o}))},children:"Generate"})]}),v.staffId&&(0,x.jsx)("div",{style:{color:"#dc3545",fontSize:"12px",marginTop:"4px"},children:v.staffId})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{children:"Email *"}),(0,x.jsx)("br",{}),(0,x.jsx)("input",{type:"email",value:e.email,onChange:a=>{const n=T(a.target.value);t((0,i.A)((0,i.A)({},e),{},{email:n}));const s=n.toLowerCase(),l=r.some(e=>(e.email||"").toLowerCase()===s),o=h.some(e=>(e.email||"").toLowerCase()===s);j(l||o)},placeholder:"staff@example.com",required:!0,style:{borderColor:v.email?"#dc3545":""}}),v.email&&(0,x.jsx)("div",{style:{color:"#dc3545",fontSize:"12px",marginTop:"4px"},children:v.email}),!v.email&&b&&(0,x.jsx)("div",{style:{color:"#d97706",fontSize:"12px",marginTop:"4px"},children:"Email already used"})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{children:"Phone Number *"}),(0,x.jsx)("br",{}),(0,x.jsx)("input",{type:"tel",inputMode:"numeric",value:e.phone,onChange:a=>t((0,i.A)((0,i.A)({},e),{},{phone:E(a.target.value)})),placeholder:"9876543210 or +919876543210",required:!0,style:{borderColor:v.phone?"#dc3545":""},onKeyDown:e=>{" "===e.key&&e.preventDefault()}}),v.phone&&(0,x.jsx)("div",{style:{color:"#dc3545",fontSize:"12px",marginTop:"4px"},children:v.phone})]}),(0,x.jsxs)("div",{style:{gridColumn:"1 / -1"},children:[(0,x.jsx)("label",{children:"Address *"}),(0,x.jsx)("br",{}),(0,x.jsx)("textarea",{value:e.address,onChange:a=>t((0,i.A)((0,i.A)({},e),{},{address:a.target.value})),placeholder:"Complete address with city, state, postal code",required:!0,rows:3,style:{width:"100%",borderColor:v.address?"#dc3545":""}}),v.address&&(0,x.jsx)("div",{style:{color:"#dc3545",fontSize:"12px",marginTop:"4px"},children:v.address})]}),(0,x.jsx)("div",{style:{gridColumn:"1 / -1",display:"flex",gap:12},children:(0,x.jsx)("button",{type:"submit",className:"btn btn-primary",disabled:a||Object.keys(v).length>0,children:a?"Validating...":"Send Invitation"})})]}),f&&(0,x.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3,opacity:1},children:(0,x.jsxs)("div",{style:{backgroundColor:"white",padding:"24px",borderRadius:"8px",maxWidth:"520px",width:"90%",boxShadow:"0 4px 20px rgba(0,0,0,0.3)",color:"#111",opacity:1},children:[(0,x.jsx)("h3",{style:{marginTop:0,marginBottom:"16px",color:"#0B6E4F"},children:"Confirm Staff Invitation"}),(0,x.jsx)("p",{style:{marginBottom:"16px",color:"#374151"},children:"Please review the details before sending the invitation:"}),(0,x.jsxs)("div",{style:{backgroundColor:"#f8f9fa",padding:"14px",borderRadius:"6px",marginBottom:"16px",color:"#111",opacity:1,border:"1px solid #e5e7eb"},children:[(0,x.jsxs)("div",{style:{marginBottom:6},children:[(0,x.jsx)("strong",{children:"Name:"})," ",(0,x.jsx)("span",{style:{color:"#111"},children:e.name})]}),(0,x.jsxs)("div",{style:{marginBottom:6},children:[(0,x.jsx)("strong",{children:"Email:"})," ",(0,x.jsx)("span",{style:{color:"#111"},children:e.email})]}),(0,x.jsxs)("div",{style:{marginBottom:6},children:[(0,x.jsx)("strong",{children:"Phone:"})," ",(0,x.jsx)("span",{style:{color:"#111"},children:e.phone})]}),(0,x.jsxs)("div",{style:{marginBottom:6},children:[(0,x.jsx)("strong",{children:"Address:"})," ",(0,x.jsx)("span",{style:{color:"#111"},children:e.address})]}),(0,x.jsxs)("div",{style:{marginBottom:6},children:[(0,x.jsx)("strong",{children:"Role:"})," ",(0,x.jsx)("span",{style:{color:"#111"},children:"lab"===e.role?"Lab Staff":"delivery"===e.role?"Delivery Staff":"accountant"===e.role?"Accountant":"manager"===e.role?"Manager":"Field Staff"})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("strong",{children:"Staff ID:"})," ",(0,x.jsx)("span",{style:{color:"#111"},children:(e.staffId||"").toUpperCase()})]})]}),(0,x.jsxs)("div",{style:{display:"flex",gap:"12px",justifyContent:"flex-end"},children:[(0,x.jsx)("button",{type:"button",className:"btn btn-outline",onClick:()=>{g(!1),y({})},disabled:a,children:"Cancel"}),(0,x.jsx)("button",{type:"button",className:"btn btn-primary",onClick:async()=>{c(""),u("");try{await(r={email:T(e.email.trim()),phone:E(e.phone.trim()),name:e.name.trim(),address:e.address.trim(),staffId:T((e.staffId||"").toUpperCase().trim()),role:"lab"===e.role?"lab_staff":"delivery"===e.role?"delivery_staff":"accountant"===e.role?"accountant":"manager"===e.role?"manager":"field_staff"},Ur("".concat(Or,"/api/staff-invite/invite"),r)),u("Invitation sent successfully."),t({email:"",phone:"",name:"",address:"",staffId:"",role:"field"}),g(!1),await D()}catch(i){var a,n,s;const e=null===i||void 0===i||null===(a=i.response)||void 0===a?void 0:a.status,t=404===e?"Backend endpoint /api/staff/invite not found (404). Please implement this API or update the URL.":409===e?"Email already used":(null===i||void 0===i||null===(n=i.response)||void 0===n||null===(s=n.data)||void 0===s?void 0:s.message)||(null===i||void 0===i?void 0:i.message)||"Failed to send invite";c(t)}var r},disabled:a,children:a?"Sending...":"Send Invitation"})]})]})}),r.filter(e=>"verified"===e.status).length>0&&(0,x.jsxs)("div",{style:{marginTop:24,padding:"20px",backgroundColor:"#fff3cd",borderRadius:"8px",border:"1px solid #ffeaa7"},children:[(0,x.jsxs)("h3",{style:{margin:"0 0 15px 0",color:"#856404"},children:["\ud83d\udd14 Pending Staff Approvals (",r.filter(e=>"verified"===e.status).length,")"]}),(0,x.jsx)("p",{style:{margin:"0 0 15px 0",color:"#856404",fontSize:"14px"},children:"The following staff members have completed their registration and are waiting for your approval:"}),(0,x.jsx)("div",{style:{display:"grid",gap:"15px"},children:r.filter(e=>"verified"===e.status).map(e=>(0,x.jsxs)("div",{style:{backgroundColor:"white",padding:"15px",borderRadius:"6px",border:"1px solid #e9ecef",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("div",{style:{fontWeight:"bold",fontSize:"16px"},children:e.name}),(0,x.jsxs)("div",{style:{color:"#666",fontSize:"14px",marginTop:"4px"},children:["\ud83d\udce7 ",e.email," \u2022 \ud83d\udcf1 ",e.phone," \u2022 \ud83c\udd94 ",e.staffId]}),(0,x.jsxs)("div",{style:{color:"#666",fontSize:"13px",marginTop:"2px"},children:["\ud83d\udccd ",e.address," \u2022 \ud83d\udc64 ",(e.role||"field_staff").replace("_"," ").toUpperCase()]}),e.verifiedAt&&(0,x.jsxs)("div",{style:{color:"#28a745",fontSize:"12px",marginTop:"4px"},children:["\u2705 Submitted: ",new Date(e.verifiedAt).toLocaleDateString()," at ",new Date(e.verifiedAt).toLocaleTimeString()]})]}),(0,x.jsxs)("div",{style:{display:"flex",gap:"8px"},children:[(0,x.jsx)("button",{className:"btn btn-success",onClick:()=>P(e._id||e.id),style:{minWidth:"100px"},children:"\u2713 Approve"}),(0,x.jsx)("button",{className:"btn btn-outline",onClick:()=>I(e),title:"View detailed information",children:"\ud83d\udcc4 Details"})]})]},e._id))})]}),(0,x.jsxs)("h3",{style:{marginTop:32,marginBottom:16},children:["All Staff (",O.length," shown)"]}),(0,x.jsx)("div",{style:{marginTop:8,overflowX:"auto"},children:(0,x.jsxs)("table",{className:"dashboard-table",style:{minWidth:1e3},children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{style:{width:"120px"},children:"Staff ID"}),(0,x.jsx)("th",{children:"Name"}),(0,x.jsx)("th",{children:"Email"}),(0,x.jsx)("th",{children:"Role"}),(0,x.jsx)("th",{children:"Phone"}),(0,x.jsx)("th",{children:"Status"}),(0,x.jsx)("th",{children:"Actions"})]})}),(0,x.jsxs)("tbody",{children:[O.map(e=>{var t;return(0,x.jsxs)("tr",{style:{backgroundColor:"verified"===e.status?"#fff3cd":"transparent"},children:[(0,x.jsxs)("td",{children:[(0,x.jsx)("div",{style:{fontFamily:"monospace",backgroundColor:e.staffId?"#e8f5e8":"#fef2f2",padding:"6px 8px",borderRadius:"6px",fontSize:"14px",fontWeight:"600",textAlign:"center",color:e.staffId?"#16a34a":"#dc2626",border:e.staffId?"1px solid #16a34a":"1px solid #dc2626"},children:e.staffId||"NO ID"}),e.staffId&&(0,x.jsxs)("div",{style:{fontSize:"10px",color:"#64748b",textAlign:"center",marginTop:"2px"},children:[e.staffId.length," chars"]})]}),(0,x.jsx)("td",{children:(0,x.jsxs)("div",{children:[(0,x.jsx)("strong",{children:e.name||"-"}),"verified"===e.status&&(0,x.jsxs)("div",{style:{fontSize:"12px",color:"#666",marginTop:"2px"},children:["\ud83d\udccd ",e.address||"No address provided"]})]})}),(0,x.jsx)("td",{children:e.email||"-"}),(0,x.jsx)("td",{children:(0,x.jsx)("span",{style:{textTransform:"capitalize",color:"field_staff"===e.role?"#0B6E4F":"delivery_staff"===e.role?"#ff6b35":"lab_staff"===e.role?"#6c5ce7":"accountant"===e.role?"#0ea5e9":"manager"===e.role?"#8b5cf6":"#666",fontWeight:"500"},children:(e.role||"field_staff").replace("_"," ")})}),(0,x.jsx)("td",{children:e.phone||"-"}),(0,x.jsxs)("td",{children:[(t=>{const a=e.status||(null===(t=e.userId)||void 0===t?void 0:t.status),n="sent"===a?"Pending Invite":"verified"===a?"Waiting Approval":"approved"===a?"Approved":"cancelled"===a?"Rejected":"active"===a?"Active":"suspended"===a?"Deactivated":a||"-",s="sent"===a?"#ffc107":"verified"===a?"#ff6b35":"approved"===a?"#28a745":"cancelled"===a?"#dc3545":"active"===a?"#28a745":"suspended"===a?"#6c757d":"#666";return(0,x.jsx)("span",{style:{color:s,fontWeight:"bold",fontSize:"13px",padding:"4px 8px",borderRadius:"4px",backgroundColor:"#ffc107"===s?"#fef3c7":"#ff6b35"===s?"#fed7aa":"#28a745"===s?"#dcfce7":"#dc3545"===s?"#fef2f2":"#6c757d"===s?"#f3f4f6":"#f8fafc"},children:n})})(),"verified"===e.status&&e.verifiedAt&&(0,x.jsxs)("div",{style:{fontSize:"11px",color:"#666",marginTop:"2px"},children:["Submitted: ",new Date(e.verifiedAt).toLocaleDateString()]})]}),(0,x.jsx)("td",{children:(0,x.jsxs)("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:["verified"===e.status&&(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("button",{className:"btn btn-sm btn-success",onClick:()=>P(e._id||e.id),title:"Approve this staff member",children:"\u2713 Approve"}),(0,x.jsx)("button",{className:"btn btn-sm btn-info",onClick:()=>I(e),title:"View detailed information",children:"\ud83d\udcc4 Details"})]}),"approved"===e.status&&(0,x.jsx)("button",{className:"btn btn-sm btn-outline",onClick:()=>{var t,a;return R((null===(t=e.userId)||void 0===t?void 0:t._id)||e._id||e.id,"active"===((null===(a=e.userId)||void 0===a?void 0:a.status)||e.status))},children:"active"===((null===(t=e.userId)||void 0===t?void 0:t.status)||e.status)?"Deactivate":"Activate"}),"verified"!==e.status&&(0,x.jsx)("button",{className:"btn btn-sm",onClick:()=>I(e),children:"Download PDF"})]})})]},e._id||e.id||e.email)}),0===O.length&&!a&&(0,x.jsx)("tr",{children:(0,x.jsx)("td",{colSpan:7,style:{textAlign:"center",color:"#9aa",padding:"40px"},children:0===r.length?"No staff found.":"No staff match the current filters."})})]})]})}),_&&(0,x.jsxs)("div",{className:"dash-card",style:{padding:20,marginBottom:20},children:[(0,x.jsx)("h3",{style:{margin:"0 0 16px 0",color:"#1e293b"},children:"Staff IDs Quick Reference"}),(0,x.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(200px, 1fr))",gap:12},children:O.map(e=>(0,x.jsxs)("div",{style:{padding:12,backgroundColor:e.staffId?"#f0fdf4":"#fef2f2",borderRadius:8,border:e.staffId?"1px solid #16a34a":"1px solid #dc2626",textAlign:"center"},children:[(0,x.jsx)("div",{style:{fontFamily:"monospace",fontSize:16,fontWeight:"700",color:e.staffId?"#16a34a":"#dc2626",marginBottom:4},children:e.staffId||"NO ID"}),(0,x.jsx)("div",{style:{fontSize:12,color:"#64748b"},children:e.name||"Unknown"}),(0,x.jsx)("div",{style:{fontSize:11,color:"#64748b",marginTop:2},children:(e.role||"field_staff").replace("_"," ")})]},e._id))}),0===O.length&&(0,x.jsx)("div",{style:{textAlign:"center",padding:40,color:"#64748b"},children:"No staff match the current filters."})]}),(0,x.jsx)("h3",{style:{marginTop:28},children:"Staff Users"}),(0,x.jsx)("div",{style:{marginTop:8,overflowX:"auto"},children:(0,x.jsxs)("table",{className:"dashboard-table",style:{minWidth:700},children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{children:"Name"}),(0,x.jsx)("th",{children:"Email"}),(0,x.jsx)("th",{children:"Status"}),(0,x.jsx)("th",{children:"Actions"})]})}),(0,x.jsxs)("tbody",{children:[h.map(e=>(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{children:e.name}),(0,x.jsx)("td",{children:e.email}),(0,x.jsx)("td",{children:e.status}),(0,x.jsx)("td",{children:(0,x.jsxs)("div",{style:{display:"flex",gap:8},children:[(0,x.jsx)("button",{className:"btn btn-sm btn-outline",onClick:()=>R(e._id,"active"===e.status),children:"active"===e.status?"Deactivate":"Activate"}),(0,x.jsx)("button",{className:"btn btn-sm btn-danger",onClick:async()=>{if(window.confirm("Delete this staff user?")){c(""),u("");try{await(n=e._id,m.A.delete("".concat(Or,"/api/user-management/").concat(n),{withCredentials:!0,headers:qr()}).then(e=>e.data)),u("Deleted"),await D()}catch(s){var t,a;c((null===s||void 0===s||null===(t=s.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.message)||(null===s||void 0===s?void 0:s.message)||"Delete failed")}var n}},children:"Delete"})]})})]},e._id)),0===h.length&&(0,x.jsx)("tr",{children:(0,x.jsx)("td",{colSpan:4,style:{textAlign:"center",color:"#9aa"},children:"No staff users."})})]})]})})]})},Hr=()=>{const{token:e}=(0,w.g)();console.log("StaffVerify component loaded with token:",e);const[t,a]=(0,n.useState)({name:"",address:"",phone:"",password:"",confirmPassword:""}),[s,l]=(0,n.useState)(null),[o,c]=(0,n.useState)(null),[d,u]=(0,n.useState)(""),[h,p]=(0,n.useState)(!1),[f,m]=(0,n.useState)(""),[g,v]=(0,n.useState)(!1),[y,b]=(0,n.useState)(""),[j,N]=(0,n.useState)(!0);(0,n.useEffect)(()=>{(async()=>{if(!e)return m("Invalid invitation link"),void N(!1);try{console.log("Fetching invite details for token:",e);const t=await(e=>Mr("".concat(Or,"/api/staff-invite/invite/").concat(e)))(e);console.log("Invite details received:",t),l(t),a(e=>(0,i.A)((0,i.A)({},e),{},{name:t.name||""}))}catch(r){var t,n,s;console.error("Failed to fetch invite details:",r),console.error("Error details:",null===r||void 0===r||null===(t=r.response)||void 0===t?void 0:t.data),m((null===r||void 0===r||null===(n=r.response)||void 0===n||null===(s=n.data)||void 0===s?void 0:s.message)||(null===r||void 0===r?void 0:r.message)||"Invalid or expired invitation link")}finally{N(!1)}})()},[e]);const S=e=>a((0,i.A)((0,i.A)({},t),{},{[e.target.name]:e.target.value}));return j?(0,x.jsx)("div",{className:"auth-wrapper dark-theme no-showcase",children:(0,x.jsx)("div",{className:"auth-grid",children:(0,x.jsxs)("div",{className:"form-container",children:[(0,x.jsx)("div",{className:"top-progress"}),(0,x.jsxs)("div",{style:{textAlign:"center",padding:"50px 20px"},children:[(0,x.jsx)("div",{className:"loading-spinner",style:{margin:"0 auto 20px"}}),(0,x.jsx)("p",{children:"Loading invitation details..."}),(0,x.jsxs)("p",{style:{fontSize:"12px",color:"#666",marginTop:"10px"},children:["Token: ",e?"".concat(e.substring(0,8),"..."):"Not found"]})]})]})})}):(0,x.jsx)("div",{className:"auth-wrapper dark-theme no-showcase",children:(0,x.jsx)("div",{className:"auth-grid",children:(0,x.jsxs)("div",{className:"form-container",children:[(0,x.jsx)("div",{className:"top-progress"}),(0,x.jsx)("div",{className:"back-row",children:(0,x.jsxs)(r.N_,{to:"/",className:"back-link",children:[(0,x.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,x.jsx)("path",{d:"M19 12H5M12 19l-7-7 7-7",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),"Home"]})}),(0,x.jsx)("h2",{children:"Complete Your Staff Account"}),s&&(0,x.jsxs)("div",{style:{backgroundColor:"#f8f9fa",padding:"15px",borderRadius:"8px",marginBottom:"20px",border:"1px solid #e9ecef"},children:[(0,x.jsx)("h3",{style:{margin:"0 0 10px 0",fontSize:"16px",color:"#0B6E4F"},children:"Invitation Details"}),(0,x.jsxs)("p",{style:{margin:"5px 0",fontSize:"14px"},children:[(0,x.jsx)("strong",{children:"Email:"})," ",s.email]}),(0,x.jsxs)("p",{style:{margin:"5px 0",fontSize:"14px"},children:[(0,x.jsx)("strong",{children:"Staff ID:"})," ",s.staffId]}),(0,x.jsxs)("p",{style:{margin:"5px 0",fontSize:"14px"},children:[(0,x.jsx)("strong",{children:"Role:"})," ",s.role.replace("_"," ").toUpperCase()]})]}),(0,x.jsx)("p",{style:{opacity:.8,marginTop:-6},children:"Set your profile details and password. Fields marked with * are required."}),f&&(0,x.jsxs)("div",{className:"error-message",role:"alert",children:[f,(0,x.jsxs)("div",{style:{marginTop:"15px"},children:[(0,x.jsx)(r.N_,{to:"/staff/login",className:"btn btn-outline",style:{display:"inline-block",textDecoration:"none",textAlign:"center",padding:"8px 16px",marginRight:"10px"},children:"Go to Staff Login"}),(0,x.jsx)(r.N_,{to:"/",className:"btn btn-outline",style:{display:"inline-block",textDecoration:"none",textAlign:"center",padding:"8px 16px"},children:"Go to Home"})]})]}),y&&(0,x.jsxs)("div",{className:"success-message",role:"status",children:[y,(0,x.jsx)("div",{style:{marginTop:"15px"},children:(0,x.jsx)(r.N_,{to:"/staff/login",className:"form-button",style:{display:"inline-block",textDecoration:"none",textAlign:"center",padding:"12px 24px",backgroundColor:"#0B6E4F",color:"white",borderRadius:"6px",fontSize:"14px"},children:"Go to Staff Login"})})]}),(0,x.jsxs)("form",{onSubmit:async a=>{a.preventDefault(),m(""),b("");const n=t.name.trim()?t.name.trim().length<2?"Full name must be at least 2 characters":t.address.trim()?t.address.trim().length<5?"Please enter a complete address":t.phone.trim()?/^[+]?[0-9\-\s()]{8,15}$/.test(t.phone.trim())?t.password?t.password.length<6?"Password must be at least 6 characters":t.password.length>50?"Password must be less than 50 characters":t.confirmPassword?t.password!==t.confirmPassword?"Passwords do not match":"":"Please confirm your password":"Password is required":"Please enter a valid phone number (8-15 digits)":"Phone number is required":"Address is required":"Full name is required";var s;if(n)m(n);else try{v(!0);let a="";if(o){p(!0);try{a=await(async e=>{const t=new FormData;t.append("file",e);try{var a;const e=await fetch("/api/uploads/public",{method:"POST",body:t});if(!e.ok){const t=await e.text();throw console.error("Upload failed:",e.status,t),new Error("Photo upload failed: ".concat(e.status," ").concat(t))}const n=await e.json();return console.log("Upload successful:",n),null!==n&&void 0!==n&&null!==(a=n.file)&&void 0!==a&&a.path?n.file.path:""}catch(f){throw console.error("Upload error:",f),f}})(o)}catch(l){console.warn("Photo upload failed, continuing without photo:",l.message),a=""}p(!1)}await(s={token:e,name:t.name.trim(),address:t.address.trim(),phone:t.phone.trim(),photoUrl:a||void 0,password:t.password},Ur("".concat(Or,"/api/staff-invite/verify-invite"),s)),b("Registration completed successfully! Your details have been submitted for admin approval. You will receive an email notification once approved. After approval, you can login using your Staff ID and the password you just set.")}catch(c){var r,i;m((null===c||void 0===c||null===(r=c.response)||void 0===r||null===(i=r.data)||void 0===i?void 0:i.message)||(null===c||void 0===c?void 0:c.message)||"Verification failed")}finally{v(!1)}},children:[(0,x.jsxs)("div",{className:"input-group floating",children:[(0,x.jsx)("input",{name:"name",value:t.name,onChange:S,className:"form-input",placeholder:" ",required:!0,maxLength:"100"}),(0,x.jsx)("label",{children:"Full Name *"})]}),(0,x.jsxs)("div",{className:"input-group floating",children:[(0,x.jsx)("textarea",{name:"address",value:t.address,onChange:S,className:"form-input",placeholder:" ",required:!0,rows:"3",maxLength:"500",style:{minHeight:"80px",resize:"vertical"}}),(0,x.jsx)("label",{children:"Complete Address *"})]}),(0,x.jsxs)("div",{className:"input-group floating",children:[(0,x.jsx)("input",{name:"phone",value:t.phone,onChange:S,className:"form-input",placeholder:" ",required:!0,type:"tel",maxLength:"15"}),(0,x.jsx)("label",{children:"Phone Number *"})]}),(0,x.jsxs)("div",{className:"input-group floating",children:[(0,x.jsx)("input",{type:"file",accept:".jpg,.jpeg,.png,.webp",onChange:e=>{var t;const a=null===(t=e.target.files)||void 0===t?void 0:t[0];if(a){c(a);const e=new FileReader;e.onload=e=>u(e.target.result),e.readAsDataURL(a)}},className:"form-input",style:{paddingTop:"20px"}}),(0,x.jsx)("label",{children:"Upload Photo (Optional)"}),d&&(0,x.jsxs)("div",{style:{marginTop:"10px"},children:[(0,x.jsx)("img",{src:d,alt:"Preview",style:{width:"100px",height:"100px",objectFit:"cover",borderRadius:"8px",border:"2px solid #ddd"}}),(0,x.jsx)("button",{type:"button",onClick:()=>{c(null),u("")},style:{marginLeft:"10px",padding:"4px 8px",fontSize:"12px",backgroundColor:"#dc3545",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"Remove"})]}),h&&(0,x.jsx)("div",{style:{marginTop:"10px",color:"#6c757d"},children:"Uploading photo..."})]}),(0,x.jsxs)("div",{className:"input-group floating",children:[(0,x.jsx)("input",{type:"password",name:"password",value:t.password,onChange:S,className:"form-input",placeholder:" ",required:!0,minLength:"6",maxLength:"50"}),(0,x.jsx)("label",{children:"Create Password *"}),(0,x.jsx)("small",{style:{color:"#666",fontSize:"12px",marginTop:"4px",display:"block"},children:"Minimum 6 characters. You'll use this to login after approval."})]}),(0,x.jsxs)("div",{className:"input-group floating",children:[(0,x.jsx)("input",{type:"password",name:"confirmPassword",value:t.confirmPassword,onChange:S,className:"form-input",placeholder:" ",required:!0,minLength:"6",maxLength:"50"}),(0,x.jsx)("label",{children:"Confirm Password *"})]}),(0,x.jsx)("button",{className:"form-button",type:"submit",disabled:g||y,children:g?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("span",{className:"loading-spinner",style:{marginRight:"8px"}}),"Submitting Details..."]}):y?"Registration Completed \u2713":"Complete Registration"}),!y&&(0,x.jsx)("p",{style:{fontSize:"13px",color:"#666",textAlign:"center",marginTop:"12px",lineHeight:"1.4"},children:"After submitting, your account will be reviewed by an admin. You'll receive an email notification once approved."})]})]})})})},Vr=()=>{var e,t,a,s,r,l,o,c;const[d,u]=(0,n.useState)([]),[h,p]=(0,n.useState)(!0),[f,g]=(0,n.useState)(""),[v,y]=(0,n.useState)({}),[b,j]=(0,n.useState)(null),w=async()=>{p(!0),g("");try{const e=await Te("latex60");u(Array.isArray(e)?e:[])}catch(a){var e,t;g((null===a||void 0===a||null===(e=a.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message)||(null===a||void 0===a?void 0:a.message)||"Failed to load pending rates")}finally{p(!1)}},N=async()=>{try{const{data:e}=await m.A.get("".concat("http://localhost:5000","/api/rates/latex/today"));j(e)}catch(e){j(null)}};(0,n.useEffect)(()=>{w(),N()},[]);const S=async e=>{try{await(async e=>{const{data:t}=await m.A.post("".concat(_e,"/api/rates/").concat(e,"/verify"),{},{headers:Le()});return t})(e),await w()}catch(n){var t,a;alert((null===n||void 0===n||null===(t=n.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.message)||(null===n||void 0===n?void 0:n.message)||"Failed to verify")}},k=e=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(e||0);return(0,x.jsxs)("div",{style:{padding:16},children:[(0,x.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:12,flexWrap:"wrap"},children:[(0,x.jsx)("h2",{style:{margin:0},children:"Admin Rate Verification"}),(0,x.jsxs)("div",{style:{display:"flex",gap:8},children:[(0,x.jsx)("button",{className:"btn-secondary",onClick:N,children:"Refresh Live"}),(0,x.jsx)("button",{className:"btn",onClick:w,disabled:h,children:h?"Refreshing...":"Refresh Pending"})]})]}),b&&(0,x.jsxs)("div",{className:"dash-card",style:{marginTop:12},children:[(0,x.jsx)("h4",{style:{marginTop:0},children:"Combined View (Admin latest + Rubber Board)"}),(0,x.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit,minmax(220px,1fr))",gap:12},children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("div",{style:{color:"#64748b",fontSize:12},children:"Admin Latest"}),b.admin?(0,x.jsxs)("div",{children:[(0,x.jsxs)("div",{children:["Company: ",k(b.admin.companyRate)]}),(0,x.jsxs)("div",{children:["Market: ",k(b.admin.marketRate)]}),(0,x.jsxs)("div",{children:["Date: ",new Date(b.admin.effectiveDate).toLocaleDateString("en-IN")]})]}):(0,x.jsx)("div",{children:"\u2014"})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("div",{style:{color:"#64748b",fontSize:12},children:"Rubber Board"}),(0,x.jsxs)("div",{children:["Source: ",(null===(e=b.market)||void 0===e?void 0:e.source)||"\u2014"]}),(0,x.jsxs)("div",{children:["As on: ",(null===(t=b.market)||void 0===t?void 0:t.asOnDate)||"\u2014"]}),(0,x.jsxs)("div",{style:{fontSize:12,color:"#6b7280"},children:["Kottayam: ",null!==(a=null===(s=b.market)||void 0===s||null===(r=s.markets)||void 0===r?void 0:r.Kottayam)&&void 0!==a?a:"\u2014"]}),(0,x.jsxs)("div",{style:{fontSize:12,color:"#6b7280"},children:["Kochi: ",null!==(l=null===(o=b.market)||void 0===o||null===(c=o.markets)||void 0===c?void 0:c.Kochi)&&void 0!==l?l:"\u2014"]})]})]})]}),(0,x.jsxs)("div",{className:"dash-card",style:{marginTop:12},children:[(0,x.jsx)("h4",{style:{marginTop:0},children:"Pending Proposals"}),f&&(0,x.jsx)("div",{className:"alert error",children:f}),h?(0,x.jsx)("p",{children:"Loading\u2026"}):0===d.length?(0,x.jsx)("div",{className:"no-data",children:"No pending proposals"}):(0,x.jsx)("div",{className:"table-wrap",children:(0,x.jsxs)("table",{className:"table",children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{children:"Effective"}),(0,x.jsx)("th",{children:"Company"}),(0,x.jsx)("th",{children:"Market"}),(0,x.jsx)("th",{children:"Notes"}),(0,x.jsx)("th",{})]})}),(0,x.jsx)("tbody",{children:d.map(e=>(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{children:new Date(e.effectiveDate).toLocaleDateString("en-IN")}),(0,x.jsx)("td",{children:k(e.companyRate)}),(0,x.jsx)("td",{children:k(e.marketRate)}),(0,x.jsx)("td",{children:e.notes||"\u2014"}),(0,x.jsxs)("td",{style:{display:"flex",gap:8},children:[(0,x.jsx)("button",{className:"btn-secondary",onClick:()=>(e=>{var t,a,n;return y({id:e._id,companyRate:null!==(t=e.companyRate)&&void 0!==t?t:"",marketRate:null!==(a=e.marketRate)&&void 0!==a?a:"",effectiveDate:e.effectiveDate?String(new Date(e.effectiveDate).toISOString().slice(0,10)):"",notes:null!==(n=e.notes)&&void 0!==n?n:""})})(e),children:"Edit"}),(0,x.jsx)("button",{className:"btn",onClick:()=>S(e._id),children:"Verify & Publish"})]})]},e._id))})]})})]}),(null===v||void 0===v?void 0:v.id)&&(0,x.jsxs)("div",{className:"dash-card",style:{marginTop:12},children:[(0,x.jsx)("h4",{style:{marginTop:0},children:"Edit Proposal"}),(0,x.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit,minmax(220px,1fr))",gap:12},children:[(0,x.jsxs)("label",{children:[(0,x.jsx)("div",{children:"Effective Date"}),(0,x.jsx)("input",{type:"date",value:v.effectiveDate,onChange:e=>y(t=>(0,i.A)((0,i.A)({},t),{},{effectiveDate:e.target.value}))})]}),(0,x.jsxs)("label",{children:[(0,x.jsx)("div",{children:"Company Rate"}),(0,x.jsx)("input",{type:"number",min:0,step:.01,value:v.companyRate,onChange:e=>y(t=>(0,i.A)((0,i.A)({},t),{},{companyRate:e.target.value}))})]}),(0,x.jsxs)("label",{children:[(0,x.jsx)("div",{children:"Market Rate"}),(0,x.jsx)("input",{type:"number",min:0,step:.01,value:v.marketRate,onChange:e=>y(t=>(0,i.A)((0,i.A)({},t),{},{marketRate:e.target.value}))})]}),(0,x.jsxs)("label",{style:{gridColumn:"1 / -1"},children:[(0,x.jsx)("div",{children:"Notes"}),(0,x.jsx)("textarea",{rows:3,value:v.notes,onChange:e=>y(t=>(0,i.A)((0,i.A)({},t),{},{notes:e.target.value}))})]})]}),(0,x.jsxs)("div",{style:{display:"flex",gap:8,marginTop:12},children:[(0,x.jsx)("button",{className:"btn",onClick:async()=>{if(null!==v&&void 0!==v&&v.id)try{await(async(e,t)=>{const{data:a}=await m.A.put("".concat(_e,"/api/rates/").concat(e),t,{headers:Le()});return a})(v.id,{companyRate:parseFloat(v.companyRate),marketRate:parseFloat(v.marketRate),effectiveDate:v.effectiveDate,notes:v.notes,product:"latex60"}),y({}),await w()}catch(a){var e,t;alert((null===a||void 0===a||null===(e=a.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message)||(null===a||void 0===a?void 0:a.message)||"Failed to update")}},children:"Save"}),(0,x.jsx)("button",{className:"btn-secondary",onClick:()=>y({}),children:"Cancel"})]})]})]})},Gr=()=>{const[e,t]=(0,n.useState)({title:"",customerUserId:"",assignedTo:"",pickupAddress:"",dropAddress:"",scheduledAt:"",notes:""}),[a,s]=(0,n.useState)([]),[r,l]=(0,n.useState)(""),[o,c]=(0,n.useState)(!0),[d,u]=(0,n.useState)(""),[h,p]=(0,n.useState)(""),f=async()=>{c(!0),u("");try{const e=await ht({status:r||void 0});s(Array.isArray(e)?e:[])}catch(a){var e,t;u((null===a||void 0===a||null===(e=a.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message)||(null===a||void 0===a?void 0:a.message)||"Failed to load"),s([])}finally{c(!1)}};(0,n.useEffect)(()=>{f()},[r]);const m=["pickup_scheduled","enroute_pickup","picked_up","enroute_drop","delivered","cancelled"];return(0,x.jsxs)("div",{style:{padding:16},children:[(0,x.jsx)("h2",{style:{marginTop:0},children:"Delivery Task Management"}),d&&(0,x.jsx)("div",{className:"alert error",children:d}),h&&(0,x.jsx)("div",{className:"alert success",children:h}),(0,x.jsxs)("div",{className:"dash-card",style:{marginBottom:16},children:[(0,x.jsx)("h4",{style:{marginTop:0},children:"Create Task"}),(0,x.jsxs)("form",{onSubmit:async a=>{a.preventDefault(),u(""),p("");try{const a={title:e.title,customerUserId:e.customerUserId||void 0,assignedTo:e.assignedTo,pickupAddress:e.pickupAddress,dropAddress:e.dropAddress,scheduledAt:e.scheduledAt||void 0,notes:e.notes||""};await ut(a),p("Task created"),t({title:"",customerUserId:"",assignedTo:"",pickupAddress:"",dropAddress:"",scheduledAt:"",notes:""}),await f()}catch(a){var n,s;u((null===a||void 0===a||null===(n=a.response)||void 0===n||null===(s=n.data)||void 0===s?void 0:s.message)||(null===a||void 0===a?void 0:a.message)||"Failed to create task")}},style:{display:"grid",gap:12,gridTemplateColumns:"repeat(auto-fit, minmax(220px, 1fr))"},children:[(0,x.jsxs)("label",{children:[(0,x.jsx)("div",{children:"Title *"}),(0,x.jsx)("input",{value:e.title,onChange:e=>t(t=>(0,i.A)((0,i.A)({},t),{},{title:e.target.value})),required:!0})]}),(0,x.jsxs)("label",{children:[(0,x.jsx)("div",{children:"Customer UserId (optional)"}),(0,x.jsx)("input",{value:e.customerUserId,onChange:e=>t(t=>(0,i.A)((0,i.A)({},t),{},{customerUserId:e.target.value})),placeholder:"ObjectId"})]}),(0,x.jsxs)("label",{children:[(0,x.jsx)("div",{children:"Assign to (Delivery Staff UserId) *"}),(0,x.jsx)("input",{value:e.assignedTo,onChange:e=>t(t=>(0,i.A)((0,i.A)({},t),{},{assignedTo:e.target.value})),required:!0,placeholder:"ObjectId"})]}),(0,x.jsxs)("label",{children:[(0,x.jsx)("div",{children:"Pickup Address *"}),(0,x.jsx)("input",{value:e.pickupAddress,onChange:e=>t(t=>(0,i.A)((0,i.A)({},t),{},{pickupAddress:e.target.value})),required:!0})]}),(0,x.jsxs)("label",{children:[(0,x.jsx)("div",{children:"Drop Address *"}),(0,x.jsx)("input",{value:e.dropAddress,onChange:e=>t(t=>(0,i.A)((0,i.A)({},t),{},{dropAddress:e.target.value})),required:!0})]}),(0,x.jsxs)("label",{children:[(0,x.jsx)("div",{children:"Scheduled At"}),(0,x.jsx)("input",{type:"datetime-local",value:e.scheduledAt,onChange:e=>t(t=>(0,i.A)((0,i.A)({},t),{},{scheduledAt:e.target.value}))})]}),(0,x.jsxs)("label",{style:{gridColumn:"1 / -1"},children:[(0,x.jsx)("div",{children:"Notes"}),(0,x.jsx)("textarea",{rows:2,value:e.notes,onChange:e=>t(t=>(0,i.A)((0,i.A)({},t),{},{notes:e.target.value}))})]}),(0,x.jsx)("div",{style:{gridColumn:"1 / -1"},children:(0,x.jsx)("button",{className:"btn",type:"submit",children:"Create Task"})})]})]}),(0,x.jsxs)("div",{className:"dash-card",children:[(0,x.jsxs)("div",{style:{display:"flex",alignItems:"end",justifyContent:"space-between",gap:12,flexWrap:"wrap"},children:[(0,x.jsx)("h4",{style:{margin:0},children:"All Tasks"}),(0,x.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"end"},children:[(0,x.jsxs)("label",{children:[(0,x.jsx)("div",{children:"Status"}),(0,x.jsxs)("select",{value:r,onChange:e=>l(e.target.value),children:[(0,x.jsx)("option",{value:"",children:"All"}),m.map(e=>(0,x.jsx)("option",{value:e,children:e},e))]})]}),(0,x.jsx)("button",{className:"btn-secondary",onClick:f,disabled:o,children:o?"Loading...":"Refresh"})]})]}),o?(0,x.jsx)("p",{children:"Loading..."}):0===a.length?(0,x.jsx)("div",{className:"no-data",children:"No tasks"}):(0,x.jsx)("div",{className:"table-wrap",children:(0,x.jsxs)("table",{className:"table",children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{children:"When"}),(0,x.jsx)("th",{children:"Title"}),(0,x.jsx)("th",{children:"Pickup"}),(0,x.jsx)("th",{children:"Drop"}),(0,x.jsx)("th",{children:"Assigned"}),(0,x.jsx)("th",{children:"Status"}),(0,x.jsx)("th",{children:"Update"})]})}),(0,x.jsx)("tbody",{children:a.map(e=>(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{children:e.scheduledAt?new Date(e.scheduledAt).toLocaleString("en-IN"):"-"}),(0,x.jsx)("td",{children:e.title}),(0,x.jsx)("td",{children:e.pickupAddress}),(0,x.jsx)("td",{children:e.dropAddress}),(0,x.jsx)("td",{children:String(e.assignedTo)}),(0,x.jsx)("td",{children:e.status}),(0,x.jsx)("td",{children:(0,x.jsx)("select",{value:e.status,onChange:async t=>{await pt(e._id,{status:t.target.value}),f()},children:m.map(e=>(0,x.jsx)("option",{value:e,children:e},e))})})]},e._id))})]})})]})]})},Jr="http://localhost:5000",Yr=()=>{const e=localStorage.getItem("token");return e?{Authorization:"Bearer ".concat(e)}:{}},Kr=()=>{const[e,t]=(0,n.useState)([]),[a,s]=(0,n.useState)(!1),[r,l]=(0,n.useState)(""),[o,c]=(0,n.useState)(""),[d,u]=(0,n.useState)("active"),[h,p]=(0,n.useState)(!1),[f,g]=(0,n.useState)(!1),[v,y]=(0,n.useState)(null),[b,j]=(0,n.useState)(""),w=async()=>{s(!0),l("");try{const e=await function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return m.A.get("".concat(Jr,"/api/staff-records"),{params:e,withCredentials:!0,headers:Yr()}).then(e=>e.data)}({status:d,includeDeleted:"deleted"===d});t(e.data||[])}catch(n){var e,a;l((null===n||void 0===n||null===(e=n.response)||void 0===e||null===(a=e.data)||void 0===a?void 0:a.message)||(null===n||void 0===n?void 0:n.message)||"Failed to load staff records")}finally{s(!1)}};(0,n.useEffect)(()=>{w()},[d]);const N=async e=>{try{l(""),await(n=e._id,m.A.put("".concat(Jr,"/api/staff-records/").concat(n,"/restore"),{},{withCredentials:!0,headers:(0,i.A)((0,i.A)({},Yr()),{},{"Content-Type":"application/json"})}).then(e=>e.data)),c("Staff record restored successfully"),await w()}catch(s){var t,a;l((null===s||void 0===s||null===(t=s.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.message)||(null===s||void 0===s?void 0:s.message)||"Failed to restore staff record")}var n},S=async e=>{try{l("");const t=!e.isActive;await function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return m.A.put("".concat(Jr,"/api/staff-records/").concat(e,"/status"),{isActive:t,reason:a},{withCredentials:!0,headers:(0,i.A)((0,i.A)({},Yr()),{},{"Content-Type":"application/json"})}).then(e=>e.data)}(e._id,t,"Status updated by admin"),c("Staff record ".concat(t?"activated":"deactivated"," successfully")),await w()}catch(n){var t,a;l((null===n||void 0===n||null===(t=n.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.message)||(null===n||void 0===n?void 0:n.message)||"Failed to update status")}},k=e=>e.isDeleted?(0,x.jsx)("span",{style:{color:"#dc3545",fontWeight:"bold"},children:"Deleted"}):e.isActive?(0,x.jsx)("span",{style:{color:"#28a745",fontWeight:"bold"},children:"Active"}):(0,x.jsx)("span",{style:{color:"#ffc107",fontWeight:"bold"},children:"Inactive"}),A=e=>e.isDeleted?(0,x.jsxs)("div",{style:{display:"flex",gap:"8px"},children:[(0,x.jsx)("button",{className:"btn btn-sm btn-success",onClick:()=>N(e),children:"Restore"}),(0,x.jsx)("button",{className:"btn btn-sm btn-danger",onClick:()=>{y(e),g(!0)},children:"Permanent Delete"})]}):(0,x.jsxs)("div",{style:{display:"flex",gap:"8px"},children:[(0,x.jsx)("button",{className:"btn btn-sm ".concat(e.isActive?"btn-warning":"btn-success"),onClick:()=>S(e),children:e.isActive?"Deactivate":"Activate"}),(0,x.jsx)("button",{className:"btn btn-sm btn-danger",onClick:()=>{y(e),p(!0)},children:"Delete Record"})]});return(0,x.jsxs)("div",{style:{padding:16},children:[(0,x.jsx)("h2",{children:"Staff Record Management"}),(0,x.jsx)("p",{style:{color:"#666",marginBottom:20},children:"Manage staff records separately from login credentials. Deleting a staff record preserves the user's login access."}),r&&(0,x.jsx)("div",{style:{color:"tomato",marginBottom:16},children:r}),o&&(0,x.jsx)("div",{style:{color:"limegreen",marginBottom:16},children:o}),(0,x.jsxs)("div",{style:{marginBottom:20},children:[(0,x.jsx)("label",{style:{marginRight:10},children:"Filter by status:"}),(0,x.jsxs)("select",{value:d,onChange:e=>u(e.target.value),style:{padding:"8px",borderRadius:"4px",border:"1px solid #ccc"},children:[(0,x.jsx)("option",{value:"active",children:"Active"}),(0,x.jsx)("option",{value:"inactive",children:"Inactive"}),(0,x.jsx)("option",{value:"deleted",children:"Deleted"})]})]}),(0,x.jsx)("div",{style:{overflowX:"auto"},children:(0,x.jsxs)("table",{className:"dashboard-table",style:{minWidth:800},children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{children:"Staff ID"}),(0,x.jsx)("th",{children:"Name"}),(0,x.jsx)("th",{children:"Email"}),(0,x.jsx)("th",{children:"Status"}),(0,x.jsx)("th",{children:"Created"}),(0,x.jsx)("th",{children:"Actions"})]})}),(0,x.jsx)("tbody",{children:a?(0,x.jsx)("tr",{children:(0,x.jsx)("td",{colSpan:6,style:{textAlign:"center"},children:"Loading..."})}):0===e.length?(0,x.jsx)("tr",{children:(0,x.jsx)("td",{colSpan:6,style:{textAlign:"center",color:"#9aa"},children:"No staff records found"})}):e.map(e=>{var t;return(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{children:e.staffId}),(0,x.jsx)("td",{children:e.name}),(0,x.jsx)("td",{children:(null===(t=e.user)||void 0===t?void 0:t.email)||"-"}),(0,x.jsx)("td",{children:k(e)}),(0,x.jsx)("td",{children:new Date(e.createdAt).toLocaleDateString()}),(0,x.jsx)("td",{children:A(e)})]},e._id)})})]})}),h&&(0,x.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:(0,x.jsxs)("div",{style:{backgroundColor:"white",padding:"24px",borderRadius:"8px",maxWidth:"500px",width:"90%",boxShadow:"0 4px 20px rgba(0,0,0,0.3)"},children:[(0,x.jsx)("h3",{style:{marginTop:0,marginBottom:"16px"},children:"Delete Staff Record"}),(0,x.jsx)("p",{style:{marginBottom:"16px"},children:"This will delete the staff record but preserve the login credentials. The user will still be able to log in but won't have staff access."}),(0,x.jsxs)("div",{style:{marginBottom:"16px"},children:[(0,x.jsx)("label",{children:"Reason for deletion:"}),(0,x.jsx)("textarea",{value:b,onChange:e=>j(e.target.value),placeholder:"Enter reason for deletion...",style:{width:"100%",padding:"8px",marginTop:"4px",borderRadius:"4px",border:"1px solid #ccc"},rows:3})]}),(0,x.jsxs)("div",{style:{display:"flex",gap:"12px",justifyContent:"flex-end"},children:[(0,x.jsx)("button",{className:"btn btn-outline",onClick:()=>{p(!1),y(null),j("")},children:"Cancel"}),(0,x.jsx)("button",{className:"btn btn-danger",onClick:async()=>{if(v)try{l(""),await function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return m.A.delete("".concat(Jr,"/api/staff-records/").concat(e),{data:{reason:t},withCredentials:!0,headers:(0,i.A)((0,i.A)({},Yr()),{},{"Content-Type":"application/json"})}).then(e=>e.data)}(v._id,b),c("Staff record deleted successfully. Login credentials preserved."),p(!1),y(null),j(""),await w()}catch(a){var e,t;l((null===a||void 0===a||null===(e=a.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message)||(null===a||void 0===a?void 0:a.message)||"Failed to delete staff record")}},children:"Delete Record"})]})]})}),f&&(0,x.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:(0,x.jsxs)("div",{style:{backgroundColor:"white",padding:"24px",borderRadius:"8px",maxWidth:"500px",width:"90%",boxShadow:"0 4px 20px rgba(0,0,0,0.3)"},children:[(0,x.jsx)("h3",{style:{marginTop:0,marginBottom:"16px",color:"#dc3545"},children:"\u26a0\ufe0f Permanent Delete"}),(0,x.jsxs)("p",{style:{marginBottom:"16px"},children:[(0,x.jsx)("strong",{children:"WARNING:"})," This will permanently delete the staff record and cannot be undone. The login credentials will still be preserved."]}),(0,x.jsxs)("div",{style:{display:"flex",gap:"12px",justifyContent:"flex-end"},children:[(0,x.jsx)("button",{className:"btn btn-outline",onClick:()=>{g(!1),y(null)},children:"Cancel"}),(0,x.jsx)("button",{className:"btn btn-danger",onClick:async()=>{var e;if(v)try{l(""),await(e=v._id,m.A.delete("".concat(Jr,"/api/staff-records/").concat(e,"/permanent"),{data:{confirm:!0},withCredentials:!0,headers:(0,i.A)((0,i.A)({},Yr()),{},{"Content-Type":"application/json"})}).then(e=>e.data)),c("Staff record permanently deleted"),g(!1),y(null),await w()}catch(n){var t,a;l((null===n||void 0===n||null===(t=n.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.message)||(null===n||void 0===n?void 0:n.message)||"Failed to permanently delete staff record")}},children:"Permanently Delete"})]})]})})]})},Qr="http://localhost:5000";function $r(){const e=localStorage.getItem("token");return e?{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}:{"Content-Type":"application/json"}}const Xr=()=>{const[e,t]=(0,n.useState)([]),[a,s]=(0,n.useState)([]),[r,i]=(0,n.useState)(""),[l,o]=(0,n.useState)(!1),[c,d]=(0,n.useState)(""),u=async()=>{try{const e=await fetch("".concat(Qr,"/api/chem-requests/admin/verified"),{headers:$r()});if(!e.ok)throw new Error("Failed to load verified (".concat(e.status,")"));const a=await e.json();t(Array.isArray(null===a||void 0===a?void 0:a.records)?a.records:[])}catch(e){i((null===e||void 0===e?void 0:e.message)||"Failed to load verified"),t([])}},h=async()=>{o(!0),i("");try{const e=c?"?status=".concat(encodeURIComponent(c)):"",t=await fetch("".concat(Qr,"/api/chem-requests/admin/history").concat(e),{headers:$r()});if(!t.ok)throw new Error("Failed to load history (".concat(t.status,")"));const a=await t.json();s(Array.isArray(null===a||void 0===a?void 0:a.records)?a.records:[])}catch(e){i((null===e||void 0===e?void 0:e.message)||"Failed to load history"),s([])}finally{o(!1)}};(0,n.useEffect)(()=>{u(),h()},[]);return(0,x.jsxs)("div",{style:{padding:16},children:[(0,x.jsx)("h2",{children:"Admin: Chemical Requests"}),r&&(0,x.jsx)("div",{style:{color:"tomato"},children:r}),(0,x.jsxs)("section",{style:{marginTop:12},children:[(0,x.jsx)("h3",{children:"Verified (Awaiting Purchase Instruction)"}),(0,x.jsx)("div",{style:{overflowX:"auto"},children:(0,x.jsxs)("table",{className:"dashboard-table",style:{minWidth:900},children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{children:"Chemical"}),(0,x.jsx)("th",{children:"Qty"}),(0,x.jsx)("th",{children:"Priority"}),(0,x.jsx)("th",{children:"Requested By"}),(0,x.jsx)("th",{children:"Purpose"}),(0,x.jsx)("th",{children:"Updated"}),(0,x.jsx)("th",{children:"Action"})]})}),(0,x.jsxs)("tbody",{children:[e.map(e=>{var t,a;return(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{children:e.chemicalName}),(0,x.jsx)("td",{children:e.quantity}),(0,x.jsx)("td",{style:{textTransform:"capitalize"},children:e.priority}),(0,x.jsx)("td",{children:(null===(t=e.requestedBy)||void 0===t?void 0:t.name)||(null===(a=e.requestedBy)||void 0===a?void 0:a.email)||"-"}),(0,x.jsx)("td",{title:e.purpose,children:e.purpose||"-"}),(0,x.jsx)("td",{children:new Date(e.updatedAt).toLocaleString()}),(0,x.jsx)("td",{children:(0,x.jsx)("button",{onClick:()=>(async e=>{try{const t=window.prompt("Admin note (optional)")||"",a=await fetch("".concat(Qr,"/api/chem-requests/").concat(e,"/send-for-purchase"),{method:"PUT",headers:$r(),body:JSON.stringify({note:t})});if(!a.ok)throw new Error("Send for purchase failed (".concat(a.status,")"));await u(),await h()}catch(t){i((null===t||void 0===t?void 0:t.message)||"Failed to send for purchase")}})(e._id),children:"Send for Purchase"})})]},e._id)}),0===e.length&&(0,x.jsx)("tr",{children:(0,x.jsx)("td",{colSpan:7,style:{textAlign:"center",color:"#6b7280"},children:"No verified items."})})]})]})})]}),(0,x.jsxs)("section",{style:{marginTop:24},children:[(0,x.jsx)("h3",{children:"History"}),(0,x.jsxs)("div",{style:{display:"flex",gap:12,alignItems:"center",marginBottom:8},children:[(0,x.jsx)("label",{children:"Filter"}),(0,x.jsxs)("select",{value:c,onChange:e=>d(e.target.value),children:[(0,x.jsx)("option",{value:"",children:"All"}),(0,x.jsx)("option",{value:"PENDING",children:"PENDING"}),(0,x.jsx)("option",{value:"MANAGER_VERIFIED",children:"MANAGER_VERIFIED"}),(0,x.jsx)("option",{value:"SENT_FOR_PURCHASE",children:"SENT_FOR_PURCHASE"}),(0,x.jsx)("option",{value:"PURCHASE_IN_PROGRESS",children:"PURCHASE_IN_PROGRESS"}),(0,x.jsx)("option",{value:"PURCHASED",children:"PURCHASED"}),(0,x.jsx)("option",{value:"COMPLETED",children:"COMPLETED"}),(0,x.jsx)("option",{value:"REJECTED_BY_MANAGER",children:"REJECTED_BY_MANAGER"})]}),(0,x.jsx)("button",{onClick:h,disabled:l,children:l?"Loading...":"Refresh"})]}),(0,x.jsx)("div",{style:{overflowX:"auto"},children:(0,x.jsxs)("table",{className:"dashboard-table",style:{minWidth:1100},children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{children:"Status"}),(0,x.jsx)("th",{children:"Chemical"}),(0,x.jsx)("th",{children:"Qty"}),(0,x.jsx)("th",{children:"Priority"}),(0,x.jsx)("th",{children:"Requested By"}),(0,x.jsx)("th",{children:"Purpose"}),(0,x.jsx)("th",{children:"Purchase"}),(0,x.jsx)("th",{children:"Updated"}),(0,x.jsx)("th",{children:"Complete"})]})}),(0,x.jsxs)("tbody",{children:[a.map(e=>{var t,a;return(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{children:e.status}),(0,x.jsx)("td",{children:e.chemicalName}),(0,x.jsx)("td",{children:e.quantity}),(0,x.jsx)("td",{style:{textTransform:"capitalize"},children:e.priority}),(0,x.jsx)("td",{children:(null===(t=e.requestedBy)||void 0===t?void 0:t.name)||(null===(a=e.requestedBy)||void 0===a?void 0:a.email)||"-"}),(0,x.jsx)("td",{title:e.purpose,children:e.purpose||"-"}),(0,x.jsx)("td",{children:e.purchaseInfo?"".concat(e.purchaseInfo.invoiceNo||""," / ").concat(e.purchaseInfo.supplier||""," / ").concat(e.purchaseInfo.quantity||""):"-"}),(0,x.jsx)("td",{children:new Date(e.updatedAt).toLocaleString()}),(0,x.jsx)("td",{children:"COMPLETED"!==e.status?(0,x.jsx)("button",{onClick:()=>(async e=>{try{const t=window.prompt("Completion note (optional)")||"",a=await fetch("".concat(Qr,"/api/chem-requests/").concat(e,"/complete"),{method:"PUT",headers:$r(),body:JSON.stringify({note:t})});if(!a.ok)throw new Error("Complete failed (".concat(a.status,")"));await h()}catch(t){i((null===t||void 0===t?void 0:t.message)||"Failed to complete")}})(e._id),children:"Complete"}):"-"})]},e._id)}),0===a.length&&!l&&(0,x.jsx)("tr",{children:(0,x.jsx)("td",{colSpan:9,style:{textAlign:"center",color:"#6b7280"},children:"No records."})})]})]})})]})]})},Zr=()=>{const[e,t]=(0,n.useState)(null),[a,s]=(0,n.useState)(""),[r,l]=(0,n.useState)(""),[o,c]=(0,n.useState)(""),[d,u]=(0,n.useState)("");return(0,x.jsxs)("div",{children:[(0,x.jsx)("h2",{children:"Worker Documents"}),(0,x.jsxs)("div",{style:{display:"flex",gap:12,alignItems:"center"},children:[(0,x.jsx)("input",{type:"file",onChange:e=>{var a;return t((null===(a=e.target.files)||void 0===a?void 0:a[0])||null)}}),(0,x.jsx)("input",{placeholder:"Label (optional)",value:a,onChange:e=>s(e.target.value)}),(0,x.jsx)("button",{onClick:async()=>{u(""),c("");try{var t;if(!e)throw new Error("Select a file");const a=await(async e=>{const t=new FormData;return t.append("file",e),(await m.A.post("".concat(X,"/api/uploads/document"),t,{withCredentials:!0,headers:(0,i.A)((0,i.A)({},Z()),{},{"Content-Type":"multipart/form-data"})})).data})(e);l((null===a||void 0===a||null===(t=a.file)||void 0===t?void 0:t.path)||""),c("Uploaded. Now save to worker profile.")}catch(s){var a,n;u((null===s||void 0===s||null===(a=s.response)||void 0===a||null===(n=a.data)||void 0===n?void 0:n.message)||(null===s||void 0===s?void 0:s.message)||"Upload failed")}},children:"Upload"}),(0,x.jsx)("button",{onClick:async()=>{u(""),c("");try{if(!r)throw new Error("Upload file first");await(e=>{let{label:t,url:a}=e;return te("".concat(X,"/api/workers/me/documents"),{label:t,url:a})})({label:a,url:r}),c("Saved to worker documents"),t(null),s(""),l("")}catch(i){var e,n;u((null===i||void 0===i||null===(e=i.response)||void 0===e||null===(n=e.data)||void 0===n?void 0:n.message)||(null===i||void 0===i?void 0:i.message)||"Save failed")}},disabled:!r,children:"Save"})]}),r&&(0,x.jsxs)("div",{children:["URL: ",(0,x.jsx)("code",{children:r})]}),o&&(0,x.jsx)("div",{style:{color:"limegreen"},children:o}),d&&(0,x.jsx)("div",{style:{color:"tomato"},children:d})]})},ei=()=>{const[e,t]=(0,n.useState)(""),[a,s]=(0,n.useState)(""),[r,i]=(0,n.useState)(""),l=async t=>{i(""),s("");try{const a=await t(e);s((null===a||void 0===a?void 0:a.message)||"Success")}catch(r){var a,n;i((null===r||void 0===r||null===(a=r.response)||void 0===a||null===(n=a.data)||void 0===n?void 0:n.message)||(null===r||void 0===r?void 0:r.message)||"Failed")}};return(0,x.jsxs)("div",{children:[(0,x.jsx)("h2",{children:"Barrel Assignments"}),(0,x.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[(0,x.jsx)("input",{placeholder:"Barrel ID",value:e,onChange:e=>t(e.target.value)}),(0,x.jsx)("button",{onClick:()=>l(oe),children:"Approve Purchase"}),(0,x.jsx)("button",{onClick:()=>l(de),children:"Request Disposal"}),(0,x.jsx)("button",{onClick:()=>l(ce),children:"Approve Disposal"})]}),a&&(0,x.jsx)("div",{style:{color:"limegreen"},children:a}),r&&(0,x.jsx)("div",{style:{color:"tomato"},children:r}),(0,x.jsx)("p",{style:{marginTop:12,color:"#94a3b8"},children:"Note: Movement create/list is available under staff and logistics endpoints."})]})};const ti=function(){const e=localStorage.getItem("token"),[t,a]=(0,n.useState)(!0),[s,r]=(0,n.useState)(""),[i,l]=(0,n.useState)([]),[o,c]=(0,n.useState)([]),[d,u]=(0,n.useState)({notifications:[],unread:0});return(0,n.useEffect)(()=>{(async()=>{a(!0),r("");try{const t={Authorization:e?"Bearer ".concat(e):void 0},[a,n,s]=await Promise.all([fetch("/api/repairs?status=awaiting-approval",{headers:t}),fetch("/api/damages?status=open",{headers:t}),fetch("/api/notifications?limit=10",{headers:t})]),[r,i,o]=await Promise.all([a.json(),n.json(),s.json()]);if(!a.ok)throw new Error((null===r||void 0===r?void 0:r.message)||"Failed to load approvals");if(!n.ok)throw new Error((null===i||void 0===i?void 0:i.message)||"Failed to load damages");if(!s.ok)throw new Error((null===o||void 0===o?void 0:o.message)||"Failed to load notifications");l(r||[]),c(i||[]),u(o||{notifications:[],unread:0})}catch(t){r(t.message)}finally{a(!1)}})()},[e]),(0,x.jsxs)("div",{className:"container",style:{padding:16},children:[(0,x.jsx)("h2",{children:"Admin: Barrel Workflow Overview"}),t&&(0,x.jsx)("div",{children:"Loading..."}),s&&(0,x.jsx)("div",{className:"alert alert-danger",children:s}),(0,x.jsxs)("div",{className:"grid",style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(260px, 1fr))",gap:16,marginTop:12},children:[(0,x.jsx)("div",{className:"card",children:(0,x.jsxs)("div",{className:"card-body",children:[(0,x.jsx)("div",{className:"h5",children:"Open Damages"}),(0,x.jsx)("div",{className:"display-6",children:o.length}),(0,x.jsx)("a",{href:"/manager/faulty-barrels",className:"btn btn-sm",style:{marginTop:8},children:"Review"})]})}),(0,x.jsx)("div",{className:"card",children:(0,x.jsxs)("div",{className:"card-body",children:[(0,x.jsx)("div",{className:"h5",children:"Awaiting Approvals"}),(0,x.jsx)("div",{className:"display-6",children:i.length}),(0,x.jsx)("a",{href:"/manager/repair-approvals",className:"btn btn-sm",style:{marginTop:8},children:"Approve"})]})}),(0,x.jsx)("div",{className:"card",children:(0,x.jsxs)("div",{className:"card-body",children:[(0,x.jsx)("div",{className:"h5",children:"Unread Notifications"}),(0,x.jsx)("div",{className:"display-6",children:d.unread||0}),(0,x.jsx)("a",{href:"/user/notifications",className:"btn btn-sm",style:{marginTop:8},children:"Open Inbox"})]})})]}),(0,x.jsx)("div",{className:"card",style:{marginTop:16},children:(0,x.jsxs)("div",{className:"card-body",children:[(0,x.jsx)("h4",{children:"Latest Notifications"}),(0,x.jsxs)("ul",{style:{margin:0,paddingLeft:16},children:[(d.notifications||[]).map(e=>(0,x.jsxs)("li",{style:{marginBottom:6},children:[(0,x.jsx)("strong",{children:e.title})," - ",e.message,(0,x.jsxs)("span",{className:"text-muted",style:{marginLeft:6},children:["(",new Date(e.createdAt).toLocaleString(),")"]})]},e._id)),(!d.notifications||0===d.notifications.length)&&(0,x.jsx)("li",{className:"text-muted",children:"No notifications."})]})]})}),(0,x.jsx)("div",{className:"card",style:{marginTop:16},children:(0,x.jsxs)("div",{className:"card-body",children:[(0,x.jsx)("h4",{children:"Approvals Queue"}),(0,x.jsx)("div",{className:"table-responsive",children:(0,x.jsxs)("table",{className:"table",children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{children:"Job"}),(0,x.jsx)("th",{children:"Barrel"}),(0,x.jsx)("th",{children:"Type"}),(0,x.jsx)("th",{children:"Updated"}),(0,x.jsx)("th",{children:"Action"})]})}),(0,x.jsxs)("tbody",{children:[i.map(t=>(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{children:t._id}),(0,x.jsx)("td",{children:t.barrelId}),(0,x.jsx)("td",{children:t.type}),(0,x.jsx)("td",{children:new Date(t.updatedAt).toLocaleString()}),(0,x.jsx)("td",{children:(0,x.jsxs)("div",{className:"btn-group",children:[(0,x.jsx)("button",{className:"btn btn-sm btn-success",onClick:()=>(async t=>{try{const a=await fetch("/api/repairs/".concat(t,"/approve"),{method:"POST",headers:{Authorization:e?"Bearer ".concat(e):void 0}}),n=await a.json();if(!a.ok)throw new Error((null===n||void 0===n?void 0:n.message)||"Approve failed");l(e=>e.filter(e=>e._id!==t))}catch(a){alert(a.message)}})(t._id),children:"Approve"}),(0,x.jsx)("button",{className:"btn btn-sm btn-outline-danger",onClick:()=>(async t=>{try{const a=await fetch("/api/repairs/".concat(t,"/reject"),{method:"POST",headers:{Authorization:e?"Bearer ".concat(e):void 0}}),n=await a.json();if(!a.ok)throw new Error((null===n||void 0===n?void 0:n.message)||"Reject failed");l(e=>e.filter(e=>e._id!==t))}catch(a){alert(a.message)}})(t._id),children:"Reject"})]})})]},t._id)),0===i.length&&(0,x.jsx)("tr",{children:(0,x.jsx)("td",{colSpan:"5",className:"text-muted",children:"No items."})})]})]})})]})})]})},ai=e=>{var t;const a={};if(e.barrelId?/^BHFP\d{2}$/i.test(e.barrelId)||(a.barrelId="Invalid format. Use BHFP followed by 2 digits (e.g., BHFP01)"):a.barrelId="Barrel ID is required",e.materialName?"Other"!==e.materialName||null!==(t=e.materialOther)&&void 0!==t&&t.trim()||(a.materialOther="Please specify the material"):a.materialName="Material is required",e.manufactureDate&&e.expiryDate){const t=new Date(e.manufactureDate);new Date(e.expiryDate)<t&&(a.expiryDate="Expiry date must be after manufacture date")}return e.batchNo&&e.batchNo.length>50&&(a.batchNo="Batch number is too long (max 50 characters)"),a},ni="http://localhost:5000";const si=function(){const e=(0,w.Zp)(),t=localStorage.getItem("token"),[a,s]=(0,n.useState)({barrelId:"",materialName:"",materialOther:"",batchNo:"",manufactureDate:"",expiryDate:"",unit:"L"}),[r,l]=(0,n.useState)(!1),[o,c]=(0,n.useState)(""),[d,u]=(0,n.useState)(null),[h,p]=(0,n.useState)(""),[f,m]=(0,n.useState)(!1),[g,v]=(0,n.useState)(""),[y,b]=(0,n.useState)("create"),[j,N]=(0,n.useState)({}),[S,k]=(0,n.useState)(!1),[A,C]=(0,n.useState)([]),[_,L]=(0,n.useState)(!1);(0,n.useEffect)(()=>{if(Object.keys(j).length>0){const e=ai(a);N(e)}},[a]);const T=async()=>{L(!0);try{const e=await fetch("".concat(ni,"/api/barrel-creation-requests?status=pending"),{headers:{"Content-Type":"application/json",Authorization:t?"Bearer ".concat(t):void 0}});if(e.ok){const t=await e.json();C(Array.isArray(t)?t:[])}}catch(e){console.error("Failed to load manager requests:",e)}finally{L(!1)}};(0,n.useEffect)(()=>{T()},[]);const E=e=>{const{name:t,value:a}=e.target;s(e=>(0,i.A)((0,i.A)({},e),{},{[t]:a}))},D=e=>{const{name:t}=e.target,n=ai(a);N(e=>(0,i.A)((0,i.A)({},e),{},{[t]:n[t]||""}))},P=()=>{const e=String(Math.floor(99*Math.random())+1).padStart(2,"0"),t="BHFP".concat(e);s(e=>(0,i.A)((0,i.A)({},e),{},{barrelId:t}))};return(0,x.jsx)("div",{className:"card",style:{maxWidth:860,margin:"0 auto"},children:(0,x.jsxs)("div",{className:"card-body",children:[A.length>0&&(0,x.jsxs)("div",{style:{marginBottom:24,padding:16,background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",borderRadius:8,color:"white"},children:[(0,x.jsxs)("h3",{style:{margin:"0 0 12px 0",display:"flex",alignItems:"center",gap:8},children:["\ud83d\udce6 Manager Requests - Barrels Needed",(0,x.jsxs)("span",{style:{fontSize:14,fontWeight:"normal",opacity:.9},children:["(",A.length," ",1===A.length?"request":"requests",")"]})]}),(0,x.jsx)("div",{style:{display:"grid",gap:12},children:A.map(e=>(0,x.jsxs)("div",{style:{background:"rgba(255,255,255,0.95)",padding:12,borderRadius:6,color:"#1e293b",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,x.jsxs)("div",{style:{display:"flex",gap:16,alignItems:"center",flex:1},children:[(0,x.jsxs)("div",{style:{background:"#3b82f6",color:"white",padding:"8px 16px",borderRadius:20,fontWeight:700,fontSize:18},children:[e.quantity," ",1===e.quantity?"Barrel":"Barrels"]}),(0,x.jsxs)("div",{style:{flex:1},children:[(0,x.jsxs)("div",{style:{fontWeight:600,fontSize:14},children:["For: ",e.userName||e.userEmail||"User"]}),e.notes&&(0,x.jsx)("div",{style:{fontSize:13,color:"#64748b",marginTop:2},children:e.notes}),(0,x.jsxs)("div",{style:{fontSize:12,color:"#94a3b8",marginTop:2},children:["Requested: ",new Date(e.createdAt).toLocaleString()]})]})]}),(0,x.jsx)("button",{onClick:()=>(async e=>{try{(await fetch("/api/barrel-creation-requests/".concat(e),{method:"PUT",headers:{"Content-Type":"application/json",Authorization:t?"Bearer ".concat(t):void 0},body:JSON.stringify({status:"in-progress"})})).ok&&await T()}catch(a){console.error("Failed to update request:",a)}})(e._id),style:{background:"#10b981",color:"white",border:"none",padding:"8px 16px",borderRadius:6,fontWeight:600,cursor:"pointer"},children:"\u2713 Start Creating"})]},e._id))})]}),(0,x.jsxs)("div",{style:{display:"flex",gap:8,marginBottom:12},children:[(0,x.jsx)("button",{type:"button",className:"btn ".concat("create"===y?"btn-primary":""),onClick:()=>b("create"),children:"Create Barrel"}),(0,x.jsx)("button",{type:"button",className:"btn ".concat("approve"===y?"btn-primary":""),onClick:()=>b("approve"),children:"Approve Barrel"})]}),"approve"===y&&(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:8},children:[(0,x.jsx)("input",{placeholder:"Barrel ID (e.g., BHFP01)",value:h,onChange:e=>p(e.target.value),style:{flex:1,minWidth:220}}),(0,x.jsx)("button",{className:"btn btn-warning",onClick:async()=>{const e=(h||"").trim();if(e)if(/^BHFP\d{2}$/i.test(e)){v(""),m(!0);try{const a=await fetch("".concat(ni,"/api/barrel-logistics/approve/purchase"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:t?"Bearer ".concat(t):void 0},body:JSON.stringify({barrelId:e})}),n=await a.json();if(!a.ok)throw new Error((null===n||void 0===n?void 0:n.message)||"Failed");v("Purchase approved")}catch(a){v(a.message)}finally{m(!1)}}else v("Invalid ID. Use format BHFP01");else v("Please enter Barrel ID")},children:"Approve Purchase"})]}),(0,x.jsx)("div",{className:"text-muted",style:{marginBottom:4},children:"Note: Movement create/list is available under staff and logistics endpoints."}),g&&(0,x.jsx)("div",{className:"text-muted",style:{marginBottom:12},children:g})]}),"create"===y&&(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,x.jsx)("h2",{children:"Create Barrel"}),(0,x.jsx)("button",{type:"button",className:"btn btn-secondary",onClick:P,children:"Generate ID"})]}),(0,x.jsxs)("form",{onSubmit:async n=>{n.preventDefault(),c(""),u(null);const r=ai(a);if(N(r),!(Object.keys(r).length>0)){k(!0);try{const n="Other"===a.materialName?a.materialOther:a.materialName,r={barrelId:a.barrelId,capacity:1,currentVolume:0,status:"in-storage",lastKnownLocation:"Factory",materialName:n||"",batchNo:a.batchNo||"",manufactureDate:a.manufactureDate||void 0,expiryDate:a.expiryDate||void 0,unit:a.unit||"L"},i=await fetch("".concat(ni,"/api/barrels"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:t?"Bearer ".concat(t):void 0},body:JSON.stringify(r)}),l=await i.json();if(!i.ok)throw new Error((null===l||void 0===l?void 0:l.message)||"Failed to create barrel");u(l);const o=new URLSearchParams({barrelId:(null===l||void 0===l?void 0:l.barrelId)||a.barrelId||"",mfg:a.manufactureDate||"",exp:a.expiryDate||""}).toString();e("/manager/barrel-allocation?".concat(o)),s({barrelId:"",materialName:"",materialOther:"",batchNo:"",manufactureDate:"",expiryDate:"",unit:"L"}),N({})}catch(i){c(i.message||"An error occurred while creating the barrel"),console.error("Create barrel error:",i)}finally{k(!1)}}},className:"form-grid",children:[(0,x.jsx)("div",{className:"form-row",children:(0,x.jsxs)("div",{className:"form-group",style:{flex:2},children:[(0,x.jsx)("label",{children:"Barrel ID"}),(0,x.jsxs)("div",{style:{display:"flex",gap:"8px"},children:[(0,x.jsx)("input",{name:"barrelId",value:a.barrelId,onChange:E,onBlur:D,placeholder:"BHFP01",className:j.barrelId?"error":"",style:{flex:1}}),(0,x.jsx)("button",{type:"button",className:"btn btn-secondary",onClick:P,style:{whiteSpace:"nowrap"},children:"Generate"})]}),j.barrelId&&(0,x.jsx)("div",{className:"text-danger",style:{fontSize:12,marginTop:"4px"},children:j.barrelId})]})}),a.barrelId&&(0,x.jsx)("div",{className:"form-row",style:{alignItems:"center",marginBottom:"16px"},children:(0,x.jsx)("div",{className:"form-group",children:(0,x.jsxs)("div",{style:{display:"flex",gap:"8px",flexWrap:"wrap"},children:[(0,x.jsxs)("a",{className:"btn btn-sm btn-outline",href:"https://api.qrserver.com/v1/create-qr-code/?size=512x512&data=".concat(encodeURIComponent(a.barrelId)),download:"QR-".concat(a.barrelId,".png"),target:"_blank",rel:"noreferrer",children:[(0,x.jsx)("i",{className:"fas fa-download"})," Download QR"]}),(0,x.jsxs)("button",{type:"button",className:"btn btn-sm btn-outline",onClick:()=>{const e="https://api.qrserver.com/v1/create-qr-code/?size=1024x1024&data=".concat(encodeURIComponent(a.barrelId));window.open(e,"_blank")},children:[(0,x.jsx)("i",{className:"fas fa-print"})," Print QR"]}),(0,x.jsxs)("a",{className:"btn btn-sm btn-outline",href:"/manager/barrel-scan",target:"_blank",rel:"noreferrer",children:[(0,x.jsx)("i",{className:"fas fa-qrcode"})," Manager Scan"]})]})})}),(0,x.jsxs)("div",{className:"form-row",children:[(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{children:"Material Name *"}),(0,x.jsxs)("select",{name:"materialName",value:a.materialName,onChange:E,onBlur:D,className:j.materialName?"error":"",children:[(0,x.jsx)("option",{value:"",children:"Select material"}),["Latex","Ammonia","Acetic Acid","Water","Other"].map(e=>(0,x.jsx)("option",{value:e,children:e},e))]}),j.materialName&&(0,x.jsx)("div",{className:"text-danger",style:{fontSize:12,marginTop:"4px"},children:j.materialName})]}),"Other"===a.materialName&&(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{children:"Specify Material *"}),(0,x.jsx)("input",{name:"materialOther",value:a.materialOther,onChange:E,onBlur:D,placeholder:"Enter material name",className:j.materialOther?"error":""}),j.materialOther&&(0,x.jsx)("div",{className:"text-danger",style:{fontSize:12,marginTop:"4px"},children:j.materialOther})]}),(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{children:"Batch No"}),(0,x.jsx)("input",{name:"batchNo",value:a.batchNo,onChange:E,onBlur:D,placeholder:"Enter batch number",maxLength:50}),j.batchNo&&(0,x.jsx)("div",{className:"text-danger",style:{fontSize:12,marginTop:"4px"},children:j.batchNo})]}),(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{children:"Unit *"}),(0,x.jsxs)("select",{name:"unit",value:a.unit,onChange:E,onBlur:D,className:j.unit?"error":"",children:[(0,x.jsx)("option",{value:"L",children:"Liters (L)"}),(0,x.jsx)("option",{value:"KG",children:"Kilograms (KG)"})]}),j.unit&&(0,x.jsx)("div",{className:"text-danger",style:{fontSize:12,marginTop:"4px"},children:j.unit})]})]}),(0,x.jsxs)("div",{className:"form-row",children:[(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{children:"Manufacture Date"}),(0,x.jsx)("input",{name:"manufactureDate",type:"date",value:a.manufactureDate,onChange:E,onBlur:D,max:(new Date).toISOString().split("T")[0]})]}),(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{children:"Expiry Date"}),(0,x.jsx)("input",{name:"expiryDate",type:"date",value:a.expiryDate,onChange:E,onBlur:D,min:a.manufactureDate||(new Date).toISOString().split("T")[0],className:j.expiryDate?"error":""}),j.expiryDate&&(0,x.jsx)("div",{className:"text-danger",style:{fontSize:12,marginTop:"4px"},children:j.expiryDate})]})]}),(0,x.jsxs)("div",{className:"form-actions",style:{marginTop:"24px"},children:[(0,x.jsx)("button",{type:"submit",className:"btn btn-primary",disabled:S||Object.keys(ai(a)).length>0,children:S?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("span",{className:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true",style:{marginRight:"8px"}}),"Creating..."]}):"Create Barrel"}),(0,x.jsx)("button",{type:"button",className:"btn btn-outline",onClick:()=>{s({barrelId:"",materialName:"",materialOther:"",batchNo:"",manufactureDate:"",expiryDate:"",unit:"L"}),N({}),c(""),u(null)},style:{marginLeft:"12px"},children:"Reset Form"})]})]}),o&&(0,x.jsx)("div",{className:"alert alert-danger",style:{marginTop:12},children:o}),d&&(0,x.jsxs)("div",{className:"alert alert-success",style:{marginTop:12},children:["Created: ",(0,x.jsx)("strong",{children:d.barrelId})]})]})]})})};const ri=()=>{const e=localStorage.getItem("token"),t=(0,n.useMemo)(()=>new URLSearchParams(window.location.search),[]),[a,s]=(0,n.useState)(t.get("barrelId")||""),[r,i]=(0,n.useState)(!1),[l,o]=(0,n.useState)(""),[c,d]=(0,n.useState)([]),u=async t=>{if(t){i(!0),o(""),d([]);try{const a=await fetch("/api/barrel-logistics/movement/".concat(encodeURIComponent(t)),{headers:{Authorization:e?"Bearer ".concat(e):void 0}}),n=await a.json();if(!a.ok)throw new Error((null===n||void 0===n?void 0:n.message)||"Failed to load history");d(Array.isArray(n)?n:[])}catch(a){o(a.message)}finally{i(!1)}}};(0,n.useEffect)(()=>{a&&u(a)},[]);return(0,x.jsx)("div",{className:"card",children:(0,x.jsxs)("div",{className:"card-body",children:[(0,x.jsx)("h2",{children:"Barrel History"}),(0,x.jsxs)("form",{onSubmit:e=>{e.preventDefault(),u(a)},style:{display:"flex",gap:8,marginBottom:12,alignItems:"center"},children:[(0,x.jsx)("input",{placeholder:"Barrel ID (e.g., BHFP01)",value:a,onChange:e=>s(e.target.value)}),(0,x.jsx)("button",{className:"btn btn-primary",type:"submit",disabled:!a||r,children:"Load"})]}),l&&(0,x.jsx)("div",{className:"alert alert-danger",children:l}),r&&(0,x.jsx)("div",{children:"Loading..."}),!r&&0===c.length&&!l&&(0,x.jsx)("div",{className:"text-muted",children:"No history."}),c.length>0&&(0,x.jsx)("div",{className:"table-responsive",children:(0,x.jsxs)("table",{className:"table",children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{children:"When"}),(0,x.jsx)("th",{children:"Type"}),(0,x.jsx)("th",{children:"From"}),(0,x.jsx)("th",{children:"To"}),(0,x.jsx)("th",{children:"\u0394 Volume"}),(0,x.jsx)("th",{children:"By"})]})}),(0,x.jsx)("tbody",{children:c.map(e=>{var t,a;return(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{children:new Date(e.createdAt).toLocaleString()}),(0,x.jsx)("td",{children:e.type}),(0,x.jsx)("td",{children:e.fromLocation||"-"}),(0,x.jsx)("td",{children:e.toLocation||"-"}),(0,x.jsx)("td",{children:null!==(t=e.volumeDelta)&&void 0!==t?t:"-"}),(0,x.jsx)("td",{children:(null===(a=e.createdBy)||void 0===a?void 0:a.name)||"-"})]},e._id)})})]})})]})})},ii="http://localhost:5000";function li(){const e=localStorage.getItem("token");return e?{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}:{"Content-Type":"application/json"}}async function oi(){const e=new URLSearchParams(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).toString(),t=await fetch("".concat(ii,"/api/barrels").concat(e?"?".concat(e):""),{headers:li()});if(!t.ok)throw new Error("Failed to fetch barrels (".concat(t.status,")"));return t.json()}const ci=["available","assigned","picked","in_transit","dropped","returned","scrapped"],di=()=>{var e,t,a,s,r,i;const l=(0,n.useRef)(null),[o,c]=(0,n.useState)(!1),[d,u]=(0,n.useState)(!1),[h,p]=(0,n.useState)(""),[f,m]=(0,n.useState)(null),[g,v]=(0,n.useState)(""),[y,b]=(0,n.useState)(!1),[j,w]=(0,n.useState)(""),[N,S]=(0,n.useState)(""),[k,A]=(0,n.useState)(null),C=()=>{const e=localStorage.getItem("token");return e?{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}:{"Content-Type":"application/json"}};(0,n.useEffect)(()=>{c("BarcodeDetector"in window)},[]);const _=()=>{u(!1);const e=l.current;null!==e&&void 0!==e&&e.srcObject&&(e.srcObject.getTracks().forEach(e=>e.stop()),e.srcObject=null)},L=async e=>{_(),p(e),w(""),m(null),b(!0);try{const t=e.trim(),a=await oi({id:t}),n=(Array.isArray(null===a||void 0===a?void 0:a.data)?a.data:Array.isArray(a)?a:[])[0]||null;m(n),v((null===n||void 0===n?void 0:n.status)||""),navigator.geolocation?(S("Capturing current location..."),navigator.geolocation.getCurrentPosition(async e=>{const{latitude:a,longitude:n,accuracy:s}=e.coords||{};A({latitude:a,longitude:n,accuracy:s}),S("Updating manager with your current location...");try{const e=await fetch("".concat("http://localhost:5000","/api/delivery/location"),{method:"POST",headers:C(),body:JSON.stringify({latitude:a,longitude:n,accuracy:s,meta:{event:"barrel_scan",barrelId:t}})});if(e.ok)S("Location shared with manager.");else{const t=await e.text();S("Location update failed (".concat(e.status,") ").concat(t.slice(0,60)))}}catch(r){S((null===r||void 0===r?void 0:r.message)||"Failed to send location")}},e=>{S("Location error: ".concat(e.message))},{enableHighAccuracy:!0,timeout:15e3,maximumAge:5e3})):S("Geolocation not supported")}catch(t){w((null===t||void 0===t?void 0:t.message)||"Lookup failed")}finally{b(!1)}};return(0,x.jsxs)("div",{style:{padding:16},children:[(0,x.jsx)("h2",{children:"Barrel QR Scanner"}),j&&(0,x.jsx)("div",{style:{color:"tomato",marginBottom:8},children:j}),o?(0,x.jsxs)("div",{style:{marginBottom:12},children:[(0,x.jsx)("video",{ref:l,style:{width:"100%",maxWidth:480,background:"#000"}}),d?(0,x.jsx)("button",{className:"btn",onClick:_,children:"Stop Scan"}):(0,x.jsx)("button",{className:"btn",onClick:async()=>{if(!o)try{w(""),u(!0),window.Html5Qrcode||await new Promise((e,t)=>{const a=document.createElement("script");a.src="https://unpkg.com/html5-qrcode@2.3.10/html5-qrcode.min.js",a.async=!0,a.onload=e,a.onerror=t,document.body.appendChild(a)});const a="qr-reader-fallback";let n=document.getElementById(a);var e,t;if(!n)n=document.createElement("div"),n.id=a,n.style.maxWidth="480px",n.style.width="100%",null===(e=l.current)||void 0===e||null===(t=e.parentNode)||void 0===t||t.insertBefore(n,l.current);const s=new window.Html5Qrcode(a);return void await s.start({facingMode:"environment"},{fps:10,qrbox:{width:250,height:250}},async e=>{await L(e),s.stop().catch(()=>{}),s.clear().catch(()=>{}),u(!1)},()=>{})}catch(a){return w((null===a||void 0===a?void 0:a.message)||"Fallback scanner failed"),void u(!1)}w("");try{const e=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}}),t=l.current;t.srcObject=e,await t.play(),u(!0);const a=new window.BarcodeDetector({formats:["qr_code","code_128","code_39"]}),n=async()=>{if(d)try{const e=await createImageBitmap(t),s=await a.detect(e);if(s&&s.length>0){const e=s[0].rawValue;await L(e)}else requestAnimationFrame(n)}catch(e){requestAnimationFrame(n)}};requestAnimationFrame(n)}catch(a){w((null===a||void 0===a?void 0:a.message)||"Camera access failed")}},children:"Start Scan"})]}):(0,x.jsxs)("div",{style:{marginBottom:12},children:[(0,x.jsx)("div",{id:"qr-reader-fallback",style:{maxWidth:480,marginBottom:8}}),(0,x.jsx)("div",{style:{color:"#6b7280",marginBottom:8},children:"Camera scanning fallback enabled."}),(0,x.jsxs)("form",{onSubmit:async e=>{e.preventDefault();const t=e.target.elements.code.value;t&&await L(t)},style:{display:"flex",gap:8},children:[(0,x.jsx)("input",{name:"code",placeholder:"Enter/scan barrel QR code"}),(0,x.jsx)("button",{className:"btn",type:"submit",children:"Lookup"})]})]}),h&&(0,x.jsxs)("div",{style:{marginTop:8,color:"#374151"},children:["Last code: ",(0,x.jsx)("b",{children:h})]}),y&&(0,x.jsx)("div",{children:"Loading..."}),f&&(0,x.jsxs)("div",{style:{marginTop:16},children:[(0,x.jsx)("h3",{children:"Barrel Details"}),(0,x.jsxs)("div",{children:["ID: ",f._id]}),(0,x.jsxs)("div",{children:["Status: ",f.status]}),(0,x.jsxs)("div",{children:["Location: ",f.location||"-"]}),N&&(0,x.jsx)("div",{style:{marginTop:8,color:"#475569"},children:N}),k&&(0,x.jsxs)("div",{style:{marginTop:6},children:[(0,x.jsxs)("div",{style:{fontSize:13,color:"#64748b"},children:["Lat ",null===(e=k.latitude)||void 0===e||null===(t=e.toFixed)||void 0===t?void 0:t.call(e,6)," \u2022 Lng ",null===(a=k.longitude)||void 0===a||null===(s=a.toFixed)||void 0===s?void 0:s.call(a,6)," \u2022 \xb1",null===(r=k.accuracy)||void 0===r||null===(i=r.toFixed)||void 0===i?void 0:i.call(r,0)," m"]}),(0,x.jsx)("a",{className:"btn btn-sm",target:"_blank",rel:"noreferrer",href:"https://www.google.com/maps?q=".concat(k.latitude,",").concat(k.longitude),style:{marginTop:6},children:"Open Location in Google Maps"})]}),(0,x.jsxs)("div",{style:{marginTop:12,display:"flex",gap:8,alignItems:"center"},children:[(0,x.jsxs)("select",{value:g,onChange:e=>v(e.target.value),children:[(0,x.jsx)("option",{value:"",children:"Select status"}),ci.map(e=>(0,x.jsx)("option",{value:e,children:e},e))]}),(0,x.jsx)("button",{className:"btn",onClick:async()=>{if(null!==f&&void 0!==f&&f._id&&g){b(!0),w("");try{"in_transit"===g?await async function(e){const t=await fetch("".concat(ii,"/api/barrels/").concat(e,"/mark-in-use"),{method:"POST",headers:li()});if(!t.ok)throw new Error("Failed to mark in use (".concat(t.status,")"));return t.json()}(f._id):await async function(e,t){const a=await fetch("".concat(ii,"/api/barrels/").concat(e),{method:"PUT",headers:li(),body:JSON.stringify(t)});if(!a.ok)throw new Error("Failed to update barrel (".concat(a.status,")"));return a.json()}(f._id,{status:g});const e=await oi({id:f._id}),t=Array.isArray(null===e||void 0===e?void 0:e.data)?e.data:Array.isArray(e)?e:[];m(t[0]||null)}catch(e){w((null===e||void 0===e?void 0:e.message)||"Update failed")}finally{b(!1)}}},disabled:y||!g,children:"Save"})]})]})]})};function ui(e){return e?{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}:{"Content-Type":"application/json"}}const hi=()=>{const{user:e,token:t}=y(),[a,s]=(0,n.useState)(!1),[r,i]=(0,n.useState)(""),[l,o]=(0,n.useState)([]),c=(0,n.useMemo)(()=>(new Date).getFullYear(),[]);(0,n.useEffect)(()=>{(async()=>{if(null!==e&&void 0!==e&&e._id&&t){s(!0),i("");try{const a=await fetch("".concat("http://localhost:5000","/api/salary/history/").concat(e._id,"?year=").concat(c,"&limit=12"),{headers:ui(t)});if(!a.ok)throw new Error("Failed (".concat(a.status,")"));const n=await a.json();o(Array.isArray(null===n||void 0===n?void 0:n.data)?n.data:Array.isArray(n)?n:[])}catch(a){i((null===a||void 0===a?void 0:a.message)||"Failed to load")}finally{s(!1)}}})()},[null===e||void 0===e?void 0:e._id,t,c]);const d=l.map(e=>{var t,a,n,s,r,i,l,o,c,d;return{id:e._id,month:e.month,year:e.year,dailyEarnings:null!==(t=null!==(a=e.dailyEarningsTotal)&&void 0!==a?a:e.overtime)&&void 0!==t?t:0,credited:null!==(n=null!==(s=e.netSalary)&&void 0!==s?s:e.netPay)&&void 0!==n?n:0,advance:null!==(r=null!==(i=e.advanceTotal)&&void 0!==i?i:e.advance)&&void 0!==r?r:0,balance:(null!==(l=null!==(o=e.netSalary)&&void 0!==o?o:e.netPay)&&void 0!==l?l:0)-(null!==(c=null!==(d=e.advanceTotal)&&void 0!==d?d:e.advance)&&void 0!==c?c:0),status:e.status,updatedAt:e.updatedAt}});return(0,x.jsxs)("div",{style:{padding:16},children:[(0,x.jsx)("h2",{children:"Labour Salary Details"}),r&&(0,x.jsx)("div",{style:{color:"tomato",marginBottom:8},children:r}),a&&(0,x.jsx)("div",{children:"Loading..."}),(0,x.jsx)("div",{style:{overflowX:"auto"},children:(0,x.jsxs)("table",{className:"dashboard-table",style:{minWidth:820},children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{children:"Month"}),(0,x.jsx)("th",{children:"Year"}),(0,x.jsx)("th",{children:"Daily Earnings"}),(0,x.jsx)("th",{children:"Credited"}),(0,x.jsx)("th",{children:"Advance"}),(0,x.jsx)("th",{children:"Balance"}),(0,x.jsx)("th",{children:"Status"}),(0,x.jsx)("th",{children:"Updated"})]})}),(0,x.jsxs)("tbody",{children:[d.map(e=>(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{children:e.month}),(0,x.jsx)("td",{children:e.year}),(0,x.jsx)("td",{children:e.dailyEarnings}),(0,x.jsx)("td",{children:e.credited}),(0,x.jsx)("td",{children:e.advance}),(0,x.jsx)("td",{children:e.balance}),(0,x.jsx)("td",{children:(0,x.jsx)("span",{className:"badge status-".concat((e.status||"draft").toLowerCase()),children:e.status||"draft"})}),(0,x.jsx)("td",{children:e.updatedAt?new Date(e.updatedAt).toLocaleString():"-"})]},e.id)),0===d.length&&!a&&(0,x.jsx)("tr",{children:(0,x.jsx)("td",{colSpan:8,style:{textAlign:"center",color:"#6b7280"},children:"No salary data."})})]})]})})]})};const pi=function(){return(0,x.jsx)(_,{children:(0,x.jsxs)(w.BV,{children:[(0,x.jsxs)(w.qh,{element:(0,x.jsx)(F,{}),children:[(0,x.jsx)(w.qh,{path:"/",element:(0,x.jsx)(Wn,{})}),(0,x.jsx)(w.qh,{path:"/about",element:(0,x.jsx)(Hn,{})}),(0,x.jsx)(w.qh,{path:"/history",element:(0,x.jsx)(Gn,{})}),(0,x.jsx)(w.qh,{path:"/gallery",element:(0,x.jsx)(Jn,{})}),(0,x.jsx)(w.qh,{path:"/contact",element:(0,x.jsx)(Vn,{})})]}),(0,x.jsx)(w.qh,{path:"/login",element:(0,x.jsx)(W,{children:(0,x.jsx)(Yn,{})})}),(0,x.jsx)(w.qh,{path:"/staff/labour-salary-details",element:(0,x.jsx)(js,{children:(0,x.jsx)(ws,{children:(0,x.jsx)(hi,{})})})}),(0,x.jsx)(w.qh,{path:"/lab/dashboard",element:(0,x.jsx)(Bt,{children:(0,x.jsx)(Ot,{children:(0,x.jsx)(Ft,{})})})}),(0,x.jsx)(w.qh,{path:"/lab/leave",element:(0,x.jsx)(Bt,{children:(0,x.jsx)(Ot,{children:(0,x.jsx)(Ht,{})})})}),(0,x.jsx)(w.qh,{path:"/lab/shift-schedule",element:(0,x.jsx)(Bt,{children:(0,x.jsx)(Ot,{children:(0,x.jsx)(Vt,{})})})}),(0,x.jsx)(w.qh,{path:"/lab/check-in",element:(0,x.jsx)(Bt,{children:(0,x.jsx)(Ot,{children:(0,x.jsx)(qt,{})})})}),(0,x.jsx)(w.qh,{path:"/lab/drc-update",element:(0,x.jsx)(Bt,{children:(0,x.jsx)(Ot,{children:(0,x.jsx)(Mt,{})})})}),(0,x.jsx)(w.qh,{path:"/lab/queue",element:(0,x.jsx)(Bt,{children:(0,x.jsx)(Ot,{children:(0,x.jsx)(Ut,{})})})}),(0,x.jsx)(w.qh,{path:"/lab/barrel-weights",element:(0,x.jsx)(Bt,{children:(0,x.jsx)(Ot,{children:(0,x.jsx)(aa,{})})})}),(0,x.jsx)(w.qh,{path:"/lab/repair-jobs",element:(0,x.jsx)(Bt,{children:(0,x.jsx)(Ot,{children:(0,x.jsx)(na,{})})})}),(0,x.jsx)(w.qh,{path:"/lab/chem-requests",element:(0,x.jsx)(Bt,{children:(0,x.jsx)(Ot,{children:(0,x.jsx)(ta,{})})})}),(0,x.jsx)(w.qh,{path:"/lab/reports",element:(0,x.jsx)(Bt,{children:(0,x.jsx)(Ot,{children:(0,x.jsx)(Wt,{})})})}),(0,x.jsx)(w.qh,{path:"/lab/sell-tests",element:(0,x.jsx)(Bt,{children:(0,x.jsx)(Ot,{children:(0,x.jsx)(Kt,{})})})}),(0,x.jsx)(w.qh,{path:"/lab/quality-classifier",element:(0,x.jsx)(Bt,{children:(0,x.jsx)(Ot,{children:(0,x.jsx)($t,{})})})}),(0,x.jsx)(w.qh,{path:"/lab/quality-comparison",element:(0,x.jsx)(Bt,{children:(0,x.jsx)(Ot,{children:(0,x.jsx)(Xt,{})})})}),(0,x.jsx)(w.qh,{path:"/lab/salary",element:(0,x.jsx)(Bt,{children:(0,x.jsx)(Ot,{children:(0,x.jsx)(Gt,{})})})}),(0,x.jsx)(w.qh,{path:"/staff/login",element:(0,x.jsx)(W,{children:(0,x.jsx)(Xn,{})})}),(0,x.jsx)(w.qh,{path:"/register",element:(0,x.jsx)(W,{children:(0,x.jsx)(Kn,{})})}),(0,x.jsx)(w.qh,{path:"/forgot-password",element:(0,x.jsx)(W,{children:(0,x.jsx)(Qn,{})})}),(0,x.jsx)(w.qh,{path:"/reset-password/:token",element:(0,x.jsx)(W,{children:(0,x.jsx)($n,{})})}),(0,x.jsx)(w.qh,{path:"/staff/verify/:token",element:(0,x.jsx)(Hr,{})}),(0,x.jsx)(w.qh,{path:"/staff/register/:token",element:(0,x.jsx)(W,{children:(0,x.jsx)(Hr,{})})}),(0,x.jsx)(w.qh,{path:"/user",element:(0,x.jsx)(U,{children:(0,x.jsx)(M,{children:(0,x.jsx)(ls,{})})})}),(0,x.jsx)(w.qh,{path:"/user/profile",element:(0,x.jsx)(U,{children:(0,x.jsx)(M,{children:(0,x.jsx)(es,{})})})}),(0,x.jsx)(w.qh,{path:"/user/profile/view",element:(0,x.jsx)(U,{children:(0,x.jsx)(M,{children:(0,x.jsx)(ts,{})})})}),(0,x.jsx)(w.qh,{path:"/user/live-rate",element:(0,x.jsx)(U,{children:(0,x.jsx)(M,{children:(0,x.jsx)(ss,{})})})}),(0,x.jsx)(w.qh,{path:"/user/transactions",element:(0,x.jsx)(U,{children:(0,x.jsx)(M,{children:(0,x.jsx)(ds,{})})})}),(0,x.jsx)(w.qh,{path:"/user/transactions/:id",element:(0,x.jsx)(U,{children:(0,x.jsx)(M,{children:(0,x.jsx)(hs,{})})})}),(0,x.jsx)(w.qh,{path:"/user/requests",element:(0,x.jsx)(U,{children:(0,x.jsx)(M,{children:(0,x.jsx)(xs,{})})})}),(0,x.jsx)(w.qh,{path:"/user/sell-requests",element:(0,x.jsx)(U,{children:(0,x.jsx)(M,{children:(0,x.jsx)(ys,{})})})}),(0,x.jsx)(w.qh,{path:"/user/my-actions",element:(0,x.jsx)(U,{children:(0,x.jsx)(M,{children:(0,x.jsx)(bs,{})})})}),(0,x.jsx)(w.qh,{path:"/user/notifications",element:(0,x.jsx)(U,{children:(0,x.jsx)(M,{children:(0,x.jsx)(is,{})})})}),(0,x.jsx)(w.qh,{path:"/delivery",element:(0,x.jsx)(Hs,{children:(0,x.jsx)(tr,{children:(0,x.jsx)(nr,{})})})}),(0,x.jsx)(w.qh,{path:"/delivery/route-plan",element:(0,x.jsx)(Hs,{children:(0,x.jsx)(tr,{children:(0,x.jsx)(sr,{})})})}),(0,x.jsx)(w.qh,{path:"/delivery/shift-schedule",element:(0,x.jsx)(Hs,{children:(0,x.jsx)(tr,{children:(0,x.jsx)(rr,{})})})}),(0,x.jsx)(w.qh,{path:"/delivery/live-location",element:(0,x.jsx)(Hs,{children:(0,x.jsx)(tr,{children:(0,x.jsx)(lr,{})})})}),(0,x.jsx)(w.qh,{path:"/delivery/tasks",element:(0,x.jsx)(Hs,{children:(0,x.jsx)(tr,{children:(0,x.jsx)(or,{})})})}),(0,x.jsx)(w.qh,{path:"/delivery/lab-check-in",element:(0,x.jsx)(U,{children:(0,x.jsx)(tr,{children:(0,x.jsx)(qt,{})})})}),(0,x.jsx)(w.qh,{path:"/delivery/task-history",element:(0,x.jsx)(Hs,{children:(0,x.jsx)(tr,{children:(0,x.jsx)(dr,{})})})}),(0,x.jsx)(w.qh,{path:"/delivery/barrel-scan",element:(0,x.jsx)(Hs,{children:(0,x.jsx)(tr,{children:(0,x.jsx)(di,{})})})}),(0,x.jsx)(w.qh,{path:"/delivery/barrel-intake",element:(0,x.jsx)(Hs,{children:(0,x.jsx)(tr,{children:(0,x.jsx)(ur,{})})})}),(0,x.jsx)(w.qh,{path:"/delivery/barrel-movement",element:(0,x.jsx)(Hs,{children:(0,x.jsx)(tr,{children:(0,x.jsx)(hr,{})})})}),(0,x.jsx)(w.qh,{path:"/delivery/assigned-requests",element:(0,x.jsx)(Hs,{children:(0,x.jsx)(tr,{children:(0,x.jsx)(Sr,{})})})}),(0,x.jsx)(w.qh,{path:"/delivery/leave",element:(0,x.jsx)(Hs,{children:(0,x.jsx)(tr,{children:(0,x.jsx)(vr,{})})})}),(0,x.jsx)(w.qh,{path:"/delivery/salary",element:(0,x.jsx)(Hs,{children:(0,x.jsx)(tr,{children:(0,x.jsx)(jr,{})})})}),(0,x.jsx)(w.qh,{path:"/staff",element:(0,x.jsx)(js,{children:(0,x.jsx)(ws,{children:(0,x.jsx)(Ns,{})})})}),(0,x.jsx)(w.qh,{path:"/staff/operations",element:(0,x.jsx)(js,{children:(0,x.jsx)(ws,{children:(0,x.jsx)(Ns,{})})})}),(0,x.jsx)(w.qh,{path:"/staff/hanger-spaces",element:(0,x.jsx)(js,{children:(0,x.jsx)(ws,{children:(0,x.jsx)(Fs,{})})})}),(0,x.jsx)(w.qh,{path:"/staff/operations/upload-document",element:(0,x.jsx)(js,{children:(0,x.jsx)(ws,{children:n.createElement(a(9432).A)})})}),(0,x.jsx)(w.qh,{path:"/staff/documents",element:(0,x.jsx)(js,{children:(0,x.jsx)(ws,{children:n.createElement(a(9432).A)})})}),(0,x.jsx)(w.qh,{path:"/staff/profile",element:(0,x.jsx)(js,{children:(0,x.jsx)(ws,{children:(0,x.jsx)(ks,{})})})}),(0,x.jsx)(w.qh,{path:"/staff/wage-rates",element:(0,x.jsx)(js,{children:(0,x.jsx)(ws,{children:(0,x.jsx)(Ps,{})})})}),(0,x.jsx)(w.qh,{path:"/staff/salary",element:(0,x.jsx)(js,{children:(0,x.jsx)(ws,{children:(0,x.jsx)(Ts,{})})})}),(0,x.jsx)(w.qh,{path:"/staff/salary/daily",element:(0,x.jsx)(js,{children:(0,x.jsx)(ws,{children:(0,x.jsx)(Ts,{defaultView:"daily"})})})}),(0,x.jsx)(w.qh,{path:"/staff/salary/monthly",element:(0,x.jsx)(js,{children:(0,x.jsx)(ws,{children:(0,x.jsx)(Ts,{defaultView:"staff"})})})}),(0,x.jsx)(w.qh,{path:"/staff/leave",element:(0,x.jsx)(js,{children:(0,x.jsx)(ws,{children:(0,x.jsx)(Es,{})})})}),(0,x.jsx)(w.qh,{path:"/staff/schedule",element:(0,x.jsx)(js,{children:(0,x.jsx)(ws,{children:(0,x.jsx)(Ds,{})})})}),(0,x.jsx)(w.qh,{path:"/staff/issues",element:(0,x.jsx)(js,{children:(0,x.jsx)(ws,{children:(0,x.jsx)(Rs,{})})})}),(0,x.jsx)(w.qh,{path:"/staff/barrel-history",element:(0,x.jsx)(js,{children:(0,x.jsx)(ws,{children:(0,x.jsx)(ri,{})})})}),(0,x.jsx)(w.qh,{path:"/staff/barrel-scan",element:(0,x.jsx)(js,{children:(0,x.jsx)(ws,{children:(0,x.jsx)(di,{})})})}),(0,x.jsx)(w.qh,{path:"/staff/return-barrels",element:(0,x.jsx)(js,{children:(0,x.jsx)(ws,{children:(0,x.jsx)(As,{})})})}),(0,x.jsx)(w.qh,{path:"/staff/route-plan",element:(0,x.jsx)(js,{children:(0,x.jsx)(ws,{children:(0,x.jsx)(Us,{})})})}),(0,x.jsx)(w.qh,{path:"/staff/pickups",element:(0,x.jsx)(js,{children:(0,x.jsx)(ws,{children:(0,x.jsx)(Ws,{})})})}),(0,x.jsx)(w.qh,{path:"/field-staff/dashboard",element:(0,x.jsx)(js,{children:(0,x.jsx)(ws,{children:(0,x.jsx)(Ks,{})})})}),(0,x.jsx)(w.qh,{path:"/lab/dashboard",element:(0,x.jsx)(Bt,{children:(0,x.jsx)(ws,{children:(0,x.jsx)(Qs,{})})})}),(0,x.jsx)(w.qh,{path:"/manager/verification",element:(0,x.jsx)(G,{children:(0,x.jsx)(J,{children:(0,x.jsx)(Xs,{})})})}),(0,x.jsx)(w.qh,{path:"/user/billing",element:(0,x.jsx)(U,{children:(0,x.jsx)(M,{children:(0,x.jsx)(er,{})})})}),(0,x.jsx)(w.qh,{path:"/manager",element:(0,x.jsx)(G,{children:(0,x.jsx)(J,{children:(0,x.jsx)(Y,{})})})}),(0,x.jsx)(w.qh,{path:"/manager/home",element:(0,x.jsx)(G,{children:(0,x.jsx)(J,{children:(0,x.jsx)(K,{})})})}),(0,x.jsx)(w.qh,{path:"/manager/live",element:(0,x.jsx)(G,{children:(0,x.jsx)(J,{children:(0,x.jsx)(fe,{})})})}),(0,x.jsx)(w.qh,{path:"/manager/live-locations",element:(0,x.jsx)(G,{children:(0,x.jsx)(J,{children:(0,x.jsx)($,{})})})}),(0,x.jsx)(w.qh,{path:"/manager/leaves",element:(0,x.jsx)(G,{children:(0,x.jsx)(J,{children:(0,x.jsx)(xe,{})})})}),(0,x.jsx)(w.qh,{path:"/manager/leave-history",element:(0,x.jsx)(G,{children:(0,x.jsx)(J,{children:(0,x.jsx)(Rt,{})})})}),(0,x.jsx)(w.qh,{path:"/manager/returned-barrels",element:(0,x.jsx)(G,{children:(0,x.jsx)(J,{children:(0,x.jsx)(It,{})})})}),(0,x.jsx)(w.qh,{path:"/manager/hanger-space",element:(0,x.jsx)(G,{children:(0,x.jsx)(J,{children:(0,x.jsx)(be,{})})})}),(0,x.jsx)(w.qh,{path:"/manager/shifts",element:(0,x.jsx)(G,{children:(0,x.jsx)(J,{children:(0,x.jsx)(Ne,{})})})}),(0,x.jsx)(w.qh,{path:"/manager/sell-requests",element:(0,x.jsx)(G,{children:(0,x.jsx)(J,{children:(0,x.jsx)(xt,{})})})}),(0,x.jsx)(w.qh,{path:"/manager/barrel-allocation",element:(0,x.jsx)(G,{children:(0,x.jsx)(J,{children:(0,x.jsx)(jt,{})})})}),(0,x.jsx)(w.qh,{path:"/manager/barrel-requests",element:(0,x.jsx)(G,{children:(0,x.jsx)(J,{children:(0,x.jsx)(St,{})})})}),(0,x.jsx)(w.qh,{path:"/manager/notifications",element:(0,x.jsx)(G,{children:(0,x.jsx)(J,{children:(0,x.jsx)(kt,{})})})}),(0,x.jsx)(w.qh,{path:"/manager/faulty-barrels",element:(0,x.jsx)(G,{children:(0,x.jsx)(J,{children:(0,x.jsx)(Lt,{})})})}),(0,x.jsx)(w.qh,{path:"/manager/repair-approvals",element:(0,x.jsx)(G,{children:(0,x.jsx)(J,{children:(0,x.jsx)(Pt,{})})})}),(0,x.jsx)(w.qh,{path:"/manager/completed",element:(0,x.jsx)(G,{children:(0,x.jsx)(J,{children:(0,x.jsx)(Dt,{})})})}),(0,x.jsx)(w.qh,{path:"/manager/latex-billing",element:(0,x.jsx)(G,{children:(0,x.jsx)(J,{children:(0,x.jsx)(Ce,{})})})}),(0,x.jsx)(w.qh,{path:"/manager/barrel-intakes",element:(0,x.jsx)(w.C5,{to:"/manager/sell-requests",replace:!0})}),(0,x.jsx)(w.qh,{path:"/manager/rates",element:(0,x.jsx)(G,{children:(0,x.jsx)(J,{children:(0,x.jsx)(Ee,{})})})}),(0,x.jsx)(w.qh,{path:"/manager/wages",element:(0,x.jsx)(G,{children:(0,x.jsx)(J,{children:(0,x.jsx)(Pe,{})})})}),(0,x.jsx)(w.qh,{path:"/manager/staff-salary",element:(0,x.jsx)(G,{children:(0,x.jsx)(J,{children:(0,x.jsx)(tt,{})})})}),(0,x.jsx)(w.qh,{path:"/manager/stock",element:(0,x.jsx)(G,{children:(0,x.jsx)(J,{children:(0,x.jsx)(lt,{})})})}),(0,x.jsx)(w.qh,{path:"/manager/chem-requests",element:(0,x.jsx)(G,{children:(0,x.jsx)(J,{children:(0,x.jsx)(_t,{})})})}),(0,x.jsx)(w.qh,{path:"/manager/chemicals",element:(0,x.jsx)(G,{children:(0,x.jsx)(J,{children:(0,x.jsx)(ot,{})})})}),(0,x.jsx)(w.qh,{path:"/manager/barrel-scan",element:(0,x.jsx)(G,{children:(0,x.jsx)(J,{children:(0,x.jsx)(di,{})})})}),(0,x.jsx)(w.qh,{path:"/manager/barrel-history",element:(0,x.jsx)(G,{children:(0,x.jsx)(J,{children:(0,x.jsx)(ri,{})})})}),(0,x.jsx)(w.qh,{path:"/admin/home",element:(0,x.jsx)(H,{children:(0,x.jsx)(V,{children:(0,x.jsx)(Cr,{})})})}),(0,x.jsx)(w.qh,{path:"/admin/create-barrel",element:(0,x.jsx)(H,{children:(0,x.jsx)(V,{children:(0,x.jsx)(si,{})})})}),(0,x.jsx)(w.qh,{path:"/admin/rates",element:(0,x.jsx)(H,{children:(0,x.jsx)(V,{children:(0,x.jsx)(Vr,{})})})}),(0,x.jsx)(w.qh,{path:"/admin/delivery",element:(0,x.jsx)(H,{children:(0,x.jsx)(V,{children:(0,x.jsx)(Gr,{})})})}),(0,x.jsx)(w.qh,{path:"/admin/yard-stock",element:(0,x.jsx)(H,{children:(0,x.jsx)(V,{children:(0,x.jsx)(Pr,{})})})}),(0,x.jsx)(w.qh,{path:"/admin/godown-rubber-stock",element:(0,x.jsx)(H,{children:(0,x.jsx)(V,{children:(0,x.jsx)(_r,{})})})}),(0,x.jsx)(w.qh,{path:"/admin/staff",element:(0,x.jsx)(H,{children:(0,x.jsx)(V,{children:(0,x.jsx)(Wr,{})})})}),(0,x.jsx)(w.qh,{path:"/admin/staff-records",element:(0,x.jsx)(H,{children:(0,x.jsx)(V,{children:(0,x.jsx)(Kr,{})})})}),(0,x.jsx)(w.qh,{path:"/admin/hanger-space",element:(0,x.jsx)(H,{children:(0,x.jsx)(V,{children:(0,x.jsx)(Dr,{})})})}),(0,x.jsx)(w.qh,{path:"/admin/chemical-stock-history",element:(0,x.jsx)(H,{children:(0,x.jsx)(V,{children:(0,x.jsx)(Rr,{})})})}),(0,x.jsx)(w.qh,{path:"/admin/worker-schedule",element:(0,x.jsx)(H,{children:(0,x.jsx)(V,{children:(0,x.jsx)(Fr,{})})})}),(0,x.jsx)(w.qh,{path:"/admin/worker-documents",element:(0,x.jsx)(H,{children:(0,x.jsx)(V,{children:(0,x.jsx)(Zr,{})})})}),(0,x.jsx)(w.qh,{path:"/admin/barrels-workflow",element:(0,x.jsx)(H,{children:(0,x.jsx)(V,{children:(0,x.jsx)(ti,{})})})}),(0,x.jsx)(w.qh,{path:"/admin/barrel-history",element:(0,x.jsx)(H,{children:(0,x.jsx)(V,{children:(0,x.jsx)(ri,{})})})}),(0,x.jsx)(w.qh,{path:"/admin/chem-requests",element:(0,x.jsx)(H,{children:(0,x.jsx)(V,{children:(0,x.jsx)(Xr,{})})})}),(0,x.jsx)(w.qh,{path:"/accountant",element:(0,x.jsx)(w.C5,{to:"/accountant/latex",replace:!0})}),(0,x.jsx)(w.qh,{path:"/accountant/debug-route",element:n.createElement(a(4760).A)}),(0,x.jsx)(w.qh,{path:"/accountant/latex",element:(0,x.jsx)(sa,{children:(0,x.jsx)(an,{children:(0,x.jsx)(vn,{})})})}),(0,x.jsx)(w.qh,{path:"/accountant/salary",element:(0,x.jsx)(sa,{children:(0,x.jsx)(an,{children:(0,x.jsx)(bn,{})})})}),(0,x.jsx)(w.qh,{path:"/accountant/stock",element:(0,x.jsx)(sa,{children:(0,x.jsx)(an,{children:(0,x.jsx)(jn,{})})})}),(0,x.jsx)(w.qh,{path:"/accountant/attendance",element:(0,x.jsx)(sa,{children:(0,x.jsx)(an,{children:(0,x.jsx)(wn,{})})})}),(0,x.jsx)(w.qh,{path:"/accountant/my-attendance",element:(0,x.jsx)(sa,{children:(0,x.jsx)(an,{children:(0,x.jsx)(En,{})})})}),(0,x.jsx)(w.qh,{path:"/accountant/mark-attendance",element:(0,x.jsx)(sa,{children:(0,x.jsx)(an,{children:(0,x.jsx)(Nn,{})})})}),(0,x.jsx)(w.qh,{path:"/accountant/leave",element:(0,x.jsx)(sa,{children:(0,x.jsx)(an,{children:(0,x.jsx)(An,{})})})}),(0,x.jsx)(w.qh,{path:"/accountant/payments",element:(0,x.jsx)(sa,{children:(0,x.jsx)(an,{children:(0,x.jsx)(Cn,{})})})}),(0,x.jsx)(w.qh,{path:"/accountant/salaries",element:(0,x.jsx)(sa,{children:(0,x.jsx)(an,{children:(0,x.jsx)(Tn,{})})})}),(0,x.jsx)(w.qh,{path:"/accountant/barrels",element:(0,x.jsx)(sa,{children:(0,x.jsx)(an,{children:(0,x.jsx)(mr,{})})})}),(0,x.jsx)(w.qh,{path:"/accountant/wages",element:(0,x.jsx)(sa,{children:(0,x.jsx)(an,{children:(0,x.jsx)(Mn,{})})})}),(0,x.jsx)(w.qh,{path:"/accountant/branches",element:(0,x.jsx)(sa,{children:(0,x.jsx)(an,{children:(0,x.jsx)(Un,{})})})}),(0,x.jsx)(w.qh,{path:"/accountant/expense",element:(0,x.jsx)(sa,{children:(0,x.jsx)(an,{children:(0,x.jsx)(Dn,{})})})}),(0,x.jsx)(w.qh,{path:"/accountant/vendors",element:(0,x.jsx)(sa,{children:(0,x.jsx)(an,{children:(0,x.jsx)(Pn,{})})})}),(0,x.jsx)(w.qh,{path:"/accountant/tax",element:(0,x.jsx)(sa,{children:(0,x.jsx)(an,{children:(0,x.jsx)(Rn,{})})})}),(0,x.jsx)(w.qh,{path:"/accountant/audit",element:(0,x.jsx)(sa,{children:(0,x.jsx)(an,{children:(0,x.jsx)(In,{})})})}),(0,x.jsx)(w.qh,{path:"/accountant/profitability",element:(0,x.jsx)(sa,{children:(0,x.jsx)(an,{children:(0,x.jsx)(Bn,{})})})}),(0,x.jsx)(w.qh,{path:"/accountant/bank-reconciliation",element:(0,x.jsx)(sa,{children:(0,x.jsx)(an,{children:(0,x.jsx)(Fn,{})})})}),(0,x.jsx)(w.qh,{path:"/accountant/alerts",element:(0,x.jsx)(sa,{children:(0,x.jsx)(an,{children:(0,x.jsx)(On,{})})})}),(0,x.jsx)(w.qh,{path:"/accountant/documents",element:(0,x.jsx)(sa,{children:(0,x.jsx)(an,{children:(0,x.jsx)(qn,{})})})}),(0,x.jsx)(w.qh,{path:"/accountant/reports",element:(0,x.jsx)(sa,{children:(0,x.jsx)(an,{children:(0,x.jsx)(zn,{})})})}),(0,x.jsx)(w.qh,{path:"/admin/barrel-assignments",element:(0,x.jsx)(H,{children:(0,x.jsx)(V,{children:(0,x.jsx)(ei,{})})})}),(0,x.jsx)(w.qh,{path:"/probe",element:(0,x.jsx)(n.Fragment,{children:n.createElement(a(3945).A)})})]})})};s.createRoot(document.getElementById("root")).render((0,x.jsx)(n.StrictMode,{children:(0,x.jsx)(d,{clientId:"484477736924-4gt8ieqt7pgs931f4i8g91ig1q2ipc3a.apps.googleusercontent.com",children:(0,x.jsx)(r.Kd,{future:{v7_relativeSplatPath:!0},children:(0,x.jsx)(v,{children:(0,x.jsx)(j,{children:(0,x.jsx)(ke,{children:(0,x.jsx)(pi,{})})})})})})})),(()=>{let e,t=null,a=0,n=0,s=0,r=0,i=!1;const l=s=>{a=s.clientX,n=s.clientY,(e||(e=document.createElement("div"),e.className="cursor-ripple pulsing is-hidden",document.body.appendChild(e),e)).classList.remove("is-hidden"),t||(t=requestAnimationFrame(c))},o=()=>{e&&e.classList.add("is-hidden")},c=()=>{s+=.18*(a-s),r+=.18*(n-r),e&&(e.style.transform="translate3d(".concat(s,"px, ").concat(r,"px, 0)")),t=Math.abs(a-s)>.1||Math.abs(n-r)>.1?requestAnimationFrame(c):null};new MutationObserver(()=>{null!==document.querySelector(".ripple-cursor")?i||(i=!0,window.addEventListener("mousemove",l,{passive:!0}),window.addEventListener("mouseleave",o,{passive:!0})):i&&(i=!1,window.removeEventListener("mousemove",l),window.removeEventListener("mouseleave",o),e&&e.parentNode&&e.parentNode.removeChild(e),e=null)}).observe(document.body,{subtree:!0,childList:!0,attributes:!0})})()})();
//# sourceMappingURL=main.2f1738a9.js.map