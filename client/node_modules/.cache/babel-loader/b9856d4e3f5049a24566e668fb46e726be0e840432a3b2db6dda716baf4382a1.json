{"ast":null,"code":"// Utility functions for token management and debugging\n\nexport const validateTokenFormat = token => {\n  if (!token || typeof token !== 'string' || token.trim() === '') {\n    return {\n      valid: false,\n      reason: 'Token is empty or not a string'\n    };\n  }\n  const tokenParts = token.split('.');\n  if (tokenParts.length !== 3) {\n    return {\n      valid: false,\n      reason: `JWT should have 3 parts, got ${tokenParts.length}`\n    };\n  }\n\n  // Check if each part is base64-like (basic validation)\n  for (let i = 0; i < tokenParts.length; i++) {\n    if (!tokenParts[i] || tokenParts[i].length === 0) {\n      return {\n        valid: false,\n        reason: `Part ${i + 1} is empty`\n      };\n    }\n  }\n  return {\n    valid: true\n  };\n};\nexport const clearCorruptedToken = () => {\n  console.log('Clearing corrupted token from localStorage');\n  localStorage.removeItem('token');\n  localStorage.removeItem('user');\n  // Clear axios default header\n  if (window.axios && window.axios.defaults) {\n    delete window.axios.defaults.headers.common['Authorization'];\n  }\n};\nexport const debugToken = () => {\n  const token = localStorage.getItem('token');\n  console.log('Current token in localStorage:', token ? `${token.substring(0, 20)}...` : 'null');\n  if (token) {\n    const validation = validateTokenFormat(token);\n    console.log('Token validation:', validation);\n    if (!validation.valid) {\n      console.log('Token is corrupted, clearing...');\n      clearCorruptedToken();\n    }\n  }\n};\n\n// Add to window for debugging in browser console\nif (typeof window !== 'undefined') {\n  window.debugToken = debugToken;\n  window.clearCorruptedToken = clearCorruptedToken;\n}","map":{"version":3,"names":["validateTokenFormat","token","trim","valid","reason","tokenParts","split","length","i","clearCorruptedToken","console","log","localStorage","removeItem","window","axios","defaults","headers","common","debugToken","getItem","substring","validation"],"sources":["G:/holy-family-polymers/client/src/utils/tokenUtils.js"],"sourcesContent":["// Utility functions for token management and debugging\r\n\r\nexport const validateTokenFormat = (token) => {\r\n    if (!token || typeof token !== 'string' || token.trim() === '') {\r\n        return { valid: false, reason: 'Token is empty or not a string' };\r\n    }\r\n    \r\n    const tokenParts = token.split('.');\r\n    if (tokenParts.length !== 3) {\r\n        return { valid: false, reason: `JWT should have 3 parts, got ${tokenParts.length}` };\r\n    }\r\n    \r\n    // Check if each part is base64-like (basic validation)\r\n    for (let i = 0; i < tokenParts.length; i++) {\r\n        if (!tokenParts[i] || tokenParts[i].length === 0) {\r\n            return { valid: false, reason: `Part ${i + 1} is empty` };\r\n        }\r\n    }\r\n    \r\n    return { valid: true };\r\n};\r\n\r\nexport const clearCorruptedToken = () => {\r\n    console.log('Clearing corrupted token from localStorage');\r\n    localStorage.removeItem('token');\r\n    localStorage.removeItem('user');\r\n    // Clear axios default header\r\n    if (window.axios && window.axios.defaults) {\r\n        delete window.axios.defaults.headers.common['Authorization'];\r\n    }\r\n};\r\n\r\nexport const debugToken = () => {\r\n    const token = localStorage.getItem('token');\r\n    console.log('Current token in localStorage:', token ? `${token.substring(0, 20)}...` : 'null');\r\n    \r\n    if (token) {\r\n        const validation = validateTokenFormat(token);\r\n        console.log('Token validation:', validation);\r\n        \r\n        if (!validation.valid) {\r\n            console.log('Token is corrupted, clearing...');\r\n            clearCorruptedToken();\r\n        }\r\n    }\r\n};\r\n\r\n// Add to window for debugging in browser console\r\nif (typeof window !== 'undefined') {\r\n    window.debugToken = debugToken;\r\n    window.clearCorruptedToken = clearCorruptedToken;\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n"],"mappings":"AAAA;;AAEA,OAAO,MAAMA,mBAAmB,GAAIC,KAAK,IAAK;EAC1C,IAAI,CAACA,KAAK,IAAI,OAAOA,KAAK,KAAK,QAAQ,IAAIA,KAAK,CAACC,IAAI,CAAC,CAAC,KAAK,EAAE,EAAE;IAC5D,OAAO;MAAEC,KAAK,EAAE,KAAK;MAAEC,MAAM,EAAE;IAAiC,CAAC;EACrE;EAEA,MAAMC,UAAU,GAAGJ,KAAK,CAACK,KAAK,CAAC,GAAG,CAAC;EACnC,IAAID,UAAU,CAACE,MAAM,KAAK,CAAC,EAAE;IACzB,OAAO;MAAEJ,KAAK,EAAE,KAAK;MAAEC,MAAM,EAAE,gCAAgCC,UAAU,CAACE,MAAM;IAAG,CAAC;EACxF;;EAEA;EACA,KAAK,IAAIC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGH,UAAU,CAACE,MAAM,EAAEC,CAAC,EAAE,EAAE;IACxC,IAAI,CAACH,UAAU,CAACG,CAAC,CAAC,IAAIH,UAAU,CAACG,CAAC,CAAC,CAACD,MAAM,KAAK,CAAC,EAAE;MAC9C,OAAO;QAAEJ,KAAK,EAAE,KAAK;QAAEC,MAAM,EAAE,QAAQI,CAAC,GAAG,CAAC;MAAY,CAAC;IAC7D;EACJ;EAEA,OAAO;IAAEL,KAAK,EAAE;EAAK,CAAC;AAC1B,CAAC;AAED,OAAO,MAAMM,mBAAmB,GAAGA,CAAA,KAAM;EACrCC,OAAO,CAACC,GAAG,CAAC,4CAA4C,CAAC;EACzDC,YAAY,CAACC,UAAU,CAAC,OAAO,CAAC;EAChCD,YAAY,CAACC,UAAU,CAAC,MAAM,CAAC;EAC/B;EACA,IAAIC,MAAM,CAACC,KAAK,IAAID,MAAM,CAACC,KAAK,CAACC,QAAQ,EAAE;IACvC,OAAOF,MAAM,CAACC,KAAK,CAACC,QAAQ,CAACC,OAAO,CAACC,MAAM,CAAC,eAAe,CAAC;EAChE;AACJ,CAAC;AAED,OAAO,MAAMC,UAAU,GAAGA,CAAA,KAAM;EAC5B,MAAMlB,KAAK,GAAGW,YAAY,CAACQ,OAAO,CAAC,OAAO,CAAC;EAC3CV,OAAO,CAACC,GAAG,CAAC,gCAAgC,EAAEV,KAAK,GAAG,GAAGA,KAAK,CAACoB,SAAS,CAAC,CAAC,EAAE,EAAE,CAAC,KAAK,GAAG,MAAM,CAAC;EAE9F,IAAIpB,KAAK,EAAE;IACP,MAAMqB,UAAU,GAAGtB,mBAAmB,CAACC,KAAK,CAAC;IAC7CS,OAAO,CAACC,GAAG,CAAC,mBAAmB,EAAEW,UAAU,CAAC;IAE5C,IAAI,CAACA,UAAU,CAACnB,KAAK,EAAE;MACnBO,OAAO,CAACC,GAAG,CAAC,iCAAiC,CAAC;MAC9CF,mBAAmB,CAAC,CAAC;IACzB;EACJ;AACJ,CAAC;;AAED;AACA,IAAI,OAAOK,MAAM,KAAK,WAAW,EAAE;EAC/BA,MAAM,CAACK,UAAU,GAAGA,UAAU;EAC9BL,MAAM,CAACL,mBAAmB,GAAGA,mBAAmB;AACpD","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}