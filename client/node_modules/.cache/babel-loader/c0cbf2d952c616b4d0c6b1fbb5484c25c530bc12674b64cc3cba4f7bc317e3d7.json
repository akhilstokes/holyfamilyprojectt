{"ast":null,"code":"import axios from 'axios';\nconst API = process.env.REACT_APP_API_URL || 'http://localhost:5000';\nconst safeGet = async (url, opts = {}, fallback = null) => {\n  try {\n    const res = await axios.get(url, opts);\n    return res.data;\n  } catch {\n    return fallback;\n  }\n};\nconst safePost = async (url, payload = {}, opts = {}, fallback = null) => {\n  try {\n    const res = await axios.post(url, payload, opts);\n    return res.data;\n  } catch {\n    return fallback;\n  }\n};\nexport const saveBuyerProfile = async profile => {\n  const token = localStorage.getItem('token');\n  const headers = token ? {\n    Authorization: `Bearer ${token}`\n  } : {};\n  const res = await safePost(`${API}/api/buyers/profile`, profile, {\n    headers\n  }, {\n    success: true\n  });\n  // Maintain a local cache for admin view fallback\n  try {\n    const list = JSON.parse(localStorage.getItem('buyer_profiles_all') || '[]');\n    const next = [...list.filter(x => x.email !== profile.email), {\n      ...profile,\n      updatedAt: new Date().toISOString()\n    }];\n    localStorage.setItem('buyer_profiles_all', JSON.stringify(next));\n  } catch {}\n  return res;\n};\nexport const fetchBuyerProfiles = async () => {\n  const token = localStorage.getItem('token');\n  const headers = token ? {\n    Authorization: `Bearer ${token}`\n  } : {};\n  const res = await safeGet(`${API}/api/buyers/profiles`, {\n    headers\n  }, null);\n  if (res !== null && res !== void 0 && res.success && Array.isArray(res.profiles)) return res.profiles;\n  // Fallback to local cache\n  try {\n    return JSON.parse(localStorage.getItem('buyer_profiles_all') || '[]');\n  } catch {\n    return [];\n  }\n};","map":{"version":3,"names":["axios","API","process","env","REACT_APP_API_URL","safeGet","url","opts","fallback","res","get","data","safePost","payload","post","saveBuyerProfile","profile","token","localStorage","getItem","headers","Authorization","success","list","JSON","parse","next","filter","x","email","updatedAt","Date","toISOString","setItem","stringify","fetchBuyerProfiles","Array","isArray","profiles"],"sources":["G:/holy-family-polymers/client/src/services/buyersService.js"],"sourcesContent":["import axios from 'axios';\r\n\r\nconst API = process.env.REACT_APP_API_URL || 'http://localhost:5000';\r\n\r\nconst safeGet = async (url, opts = {}, fallback = null) => {\r\n  try {\r\n    const res = await axios.get(url, opts);\r\n    return res.data;\r\n  } catch {\r\n    return fallback;\r\n  }\r\n};\r\n\r\nconst safePost = async (url, payload = {}, opts = {}, fallback = null) => {\r\n  try {\r\n    const res = await axios.post(url, payload, opts);\r\n    return res.data;\r\n  } catch {\r\n    return fallback;\r\n  }\r\n};\r\n\r\nexport const saveBuyerProfile = async (profile) => {\r\n  const token = localStorage.getItem('token');\r\n  const headers = token ? { Authorization: `Bearer ${token}` } : {};\r\n  const res = await safePost(`${API}/api/buyers/profile`, profile, { headers }, { success: true });\r\n  // Maintain a local cache for admin view fallback\r\n  try {\r\n    const list = JSON.parse(localStorage.getItem('buyer_profiles_all') || '[]');\r\n    const next = [...list.filter((x) => x.email !== profile.email), { ...profile, updatedAt: new Date().toISOString() }];\r\n    localStorage.setItem('buyer_profiles_all', JSON.stringify(next));\r\n  } catch {}\r\n  return res;\r\n};\r\n\r\nexport const fetchBuyerProfiles = async () => {\r\n  const token = localStorage.getItem('token');\r\n  const headers = token ? { Authorization: `Bearer ${token}` } : {};\r\n  const res = await safeGet(`${API}/api/buyers/profiles`, { headers }, null);\r\n  if (res?.success && Array.isArray(res.profiles)) return res.profiles;\r\n  // Fallback to local cache\r\n  try {\r\n    return JSON.parse(localStorage.getItem('buyer_profiles_all') || '[]');\r\n  } catch {\r\n    return [];\r\n  }\r\n};\r\n\r\n\r\n"],"mappings":"AAAA,OAAOA,KAAK,MAAM,OAAO;AAEzB,MAAMC,GAAG,GAAGC,OAAO,CAACC,GAAG,CAACC,iBAAiB,IAAI,uBAAuB;AAEpE,MAAMC,OAAO,GAAG,MAAAA,CAAOC,GAAG,EAAEC,IAAI,GAAG,CAAC,CAAC,EAAEC,QAAQ,GAAG,IAAI,KAAK;EACzD,IAAI;IACF,MAAMC,GAAG,GAAG,MAAMT,KAAK,CAACU,GAAG,CAACJ,GAAG,EAAEC,IAAI,CAAC;IACtC,OAAOE,GAAG,CAACE,IAAI;EACjB,CAAC,CAAC,MAAM;IACN,OAAOH,QAAQ;EACjB;AACF,CAAC;AAED,MAAMI,QAAQ,GAAG,MAAAA,CAAON,GAAG,EAAEO,OAAO,GAAG,CAAC,CAAC,EAAEN,IAAI,GAAG,CAAC,CAAC,EAAEC,QAAQ,GAAG,IAAI,KAAK;EACxE,IAAI;IACF,MAAMC,GAAG,GAAG,MAAMT,KAAK,CAACc,IAAI,CAACR,GAAG,EAAEO,OAAO,EAAEN,IAAI,CAAC;IAChD,OAAOE,GAAG,CAACE,IAAI;EACjB,CAAC,CAAC,MAAM;IACN,OAAOH,QAAQ;EACjB;AACF,CAAC;AAED,OAAO,MAAMO,gBAAgB,GAAG,MAAOC,OAAO,IAAK;EACjD,MAAMC,KAAK,GAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC;EAC3C,MAAMC,OAAO,GAAGH,KAAK,GAAG;IAAEI,aAAa,EAAE,UAAUJ,KAAK;EAAG,CAAC,GAAG,CAAC,CAAC;EACjE,MAAMR,GAAG,GAAG,MAAMG,QAAQ,CAAC,GAAGX,GAAG,qBAAqB,EAAEe,OAAO,EAAE;IAAEI;EAAQ,CAAC,EAAE;IAAEE,OAAO,EAAE;EAAK,CAAC,CAAC;EAChG;EACA,IAAI;IACF,MAAMC,IAAI,GAAGC,IAAI,CAACC,KAAK,CAACP,YAAY,CAACC,OAAO,CAAC,oBAAoB,CAAC,IAAI,IAAI,CAAC;IAC3E,MAAMO,IAAI,GAAG,CAAC,GAAGH,IAAI,CAACI,MAAM,CAAEC,CAAC,IAAKA,CAAC,CAACC,KAAK,KAAKb,OAAO,CAACa,KAAK,CAAC,EAAE;MAAE,GAAGb,OAAO;MAAEc,SAAS,EAAE,IAAIC,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC;IAAE,CAAC,CAAC;IACpHd,YAAY,CAACe,OAAO,CAAC,oBAAoB,EAAET,IAAI,CAACU,SAAS,CAACR,IAAI,CAAC,CAAC;EAClE,CAAC,CAAC,MAAM,CAAC;EACT,OAAOjB,GAAG;AACZ,CAAC;AAED,OAAO,MAAM0B,kBAAkB,GAAG,MAAAA,CAAA,KAAY;EAC5C,MAAMlB,KAAK,GAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC;EAC3C,MAAMC,OAAO,GAAGH,KAAK,GAAG;IAAEI,aAAa,EAAE,UAAUJ,KAAK;EAAG,CAAC,GAAG,CAAC,CAAC;EACjE,MAAMR,GAAG,GAAG,MAAMJ,OAAO,CAAC,GAAGJ,GAAG,sBAAsB,EAAE;IAAEmB;EAAQ,CAAC,EAAE,IAAI,CAAC;EAC1E,IAAIX,GAAG,aAAHA,GAAG,eAAHA,GAAG,CAAEa,OAAO,IAAIc,KAAK,CAACC,OAAO,CAAC5B,GAAG,CAAC6B,QAAQ,CAAC,EAAE,OAAO7B,GAAG,CAAC6B,QAAQ;EACpE;EACA,IAAI;IACF,OAAOd,IAAI,CAACC,KAAK,CAACP,YAAY,CAACC,OAAO,CAAC,oBAAoB,CAAC,IAAI,IAAI,CAAC;EACvE,CAAC,CAAC,MAAM;IACN,OAAO,EAAE;EACX;AACF,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}