{"ast":null,"code":"import React,{useState,useEffect,useMemo}from'react';import axios from'axios';import'./AdminDashboard.css';// Updated to use current stock endpoints (no negative values; exact decimals)\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const StockManagement=()=>{const[currentStock,setCurrentStock]=useState(0);const[quantityChange,setQuantityChange]=useState('');const[msg,setMsg]=useState('');const config=useMemo(()=>({headers:{Authorization:\"Bearer \".concat(localStorage.getItem('token'))}}),[]);const loadStock=async()=>{try{setMsg('');const{data}=await axios.get('/api/stock',config);setCurrentStock(data.quantityInLiters);}catch(e){setMsg('Failed to load stock');}};const updateStock=async e=>{e.preventDefault();setMsg('');const num=Number(quantityChange);if(Number.isNaN(num)){setMsg('Enter a valid number');return;}try{const{data}=await axios.put('/api/stock',{quantityChange:num},config);setCurrentStock(data.quantityInLiters);setQuantityChange('');setMsg('Stock updated');}catch(e){var _e$response,_e$response$data;setMsg(((_e$response=e.response)===null||_e$response===void 0?void 0:(_e$response$data=_e$response.data)===null||_e$response$data===void 0?void 0:_e$response$data.message)||'Failed to update stock');}};useEffect(()=>{loadStock();},[]);return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{className:\"page-title\",children:\"Stock Management\"}),/*#__PURE__*/_jsx(\"div\",{className:\"stats-cards-grid\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"stat-card\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"card-icon green\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-boxes\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"card-info\",children:[/*#__PURE__*/_jsx(\"h4\",{children:\"Current Stock (L)\"}),/*#__PURE__*/_jsx(\"p\",{children:currentStock})]})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"admin-content\",style:{marginTop:'2rem'},children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Adjust Stock\"}),msg&&/*#__PURE__*/_jsx(\"div\",{className:\"success-message\",style:{marginBottom:12},children:msg}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:updateStock,className:\"stock-form\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"number\",placeholder:\"Quantity change (e.g., 10 or -5)\",value:quantityChange,onChange:e=>setQuantityChange(e.target.value),required:true}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:\"Apply\"})]})]})]});};export default StockManagement;","map":{"version":3,"names":["React","useState","useEffect","useMemo","axios","jsx","_jsx","jsxs","_jsxs","StockManagement","currentStock","setCurrentStock","quantityChange","setQuantityChange","msg","setMsg","config","headers","Authorization","concat","localStorage","getItem","loadStock","data","get","quantityInLiters","e","updateStock","preventDefault","num","Number","isNaN","put","_e$response","_e$response$data","response","message","children","className","style","marginTop","marginBottom","onSubmit","type","placeholder","value","onChange","target","required"],"sources":["G:/holy-family-polymers/client/src/pages/admin_dashboard/StockManagement.js"],"sourcesContent":["import React, { useState, useEffect, useMemo } from 'react';\r\nimport axios from 'axios';\r\nimport './AdminDashboard.css';\r\n\r\n// Updated to use current stock endpoints (no negative values; exact decimals)\r\nconst StockManagement = () => {\r\n  const [currentStock, setCurrentStock] = useState(0);\r\n  const [quantityChange, setQuantityChange] = useState('');\r\n  const [msg, setMsg] = useState('');\r\n\r\n  const config = useMemo(\r\n    () => ({ headers: { Authorization: `Bearer ${localStorage.getItem('token')}` } }),\r\n    []\r\n  );\r\n\r\n  const loadStock = async () => {\r\n    try {\r\n      setMsg('');\r\n      const { data } = await axios.get('/api/stock', config);\r\n      setCurrentStock(data.quantityInLiters);\r\n    } catch (e) {\r\n      setMsg('Failed to load stock');\r\n    }\r\n  };\r\n\r\n  const updateStock = async (e) => {\r\n    e.preventDefault();\r\n    setMsg('');\r\n    const num = Number(quantityChange);\r\n    if (Number.isNaN(num)) {\r\n      setMsg('Enter a valid number');\r\n      return;\r\n    }\r\n    try {\r\n      const { data } = await axios.put('/api/stock', { quantityChange: num }, config);\r\n      setCurrentStock(data.quantityInLiters);\r\n      setQuantityChange('');\r\n      setMsg('Stock updated');\r\n    } catch (e) {\r\n      setMsg(e.response?.data?.message || 'Failed to update stock');\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    loadStock();\r\n  }, []);\r\n\r\n  return (\r\n    <div>\r\n      <h2 className=\"page-title\">Stock Management</h2>\r\n\r\n      {/* Current Stock */}\r\n      <div className=\"stats-cards-grid\">\r\n        <div className=\"stat-card\">\r\n          <div className=\"card-icon green\">\r\n            <i className=\"fas fa-boxes\"></i>\r\n          </div>\r\n          <div className=\"card-info\">\r\n            <h4>Current Stock (L)</h4>\r\n            <p>{currentStock}</p>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Update Stock (positive adds, negative subtracts; clamped at 0) */}\r\n      <div className=\"admin-content\" style={{ marginTop: '2rem' }}>\r\n        <h3>Adjust Stock</h3>\r\n        {msg && <div className=\"success-message\" style={{ marginBottom: 12 }}>{msg}</div>}\r\n        <form onSubmit={updateStock} className=\"stock-form\">\r\n          <input\r\n            type=\"number\"\r\n            placeholder=\"Quantity change (e.g., 10 or -5)\"\r\n            value={quantityChange}\r\n            onChange={(e) => setQuantityChange(e.target.value)}\r\n            required\r\n          />\r\n          <button type=\"submit\">Apply</button>\r\n        </form>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default StockManagement;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}